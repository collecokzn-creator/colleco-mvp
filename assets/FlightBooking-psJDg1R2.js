import{r as a,j as e}from"./index-BCXrhMbA.js";import{s as C,g as F,c as w}from"./client-DmVibFEL.js";function B(){const[o,g]=a.useState(""),[i,j]=a.useState(""),[x,f]=a.useState(""),[c,k]=a.useState(0),[u,d]=a.useState(null),[n,N]=a.useState(null),[m,v]=a.useState(""),[h,y]=a.useState(!1),[b,p]=a.useState([]);async function S(t){t.preventDefault(),d("loading");try{const s=await w({from:o,to:i,date:x,price:Number(c),currency:"ZAR",customer:{name:"Web User"},returnFlight:h&&m?{from:i,to:o,date:m,price:Number(c)}:void 0});d("ok"),N(s.checkout||null),s&&s.booking&&Array.isArray(s.booking.items)&&p(s.booking.items.filter(r=>r.type==="flight"))}catch{d("error")}}return e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-xl font-bold mb-4",children:"Book Flight"}),e.jsxs("form",{onSubmit:S,className:"space-y-3 max-w-md",children:[e.jsxs("label",{children:["From",e.jsx("input",{value:o,onChange:t=>g(t.target.value),className:"w-full p-2 border"})]}),e.jsxs("label",{children:["To",e.jsx("input",{value:i,onChange:t=>j(t.target.value),className:"w-full p-2 border"})]}),e.jsxs("label",{children:["Date",e.jsx("input",{type:"date",value:x,onChange:t=>f(t.target.value),className:"w-full p-2 border"})]}),e.jsx("label",{className:"block",children:e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:t=>y(t.target.checked)})," Round-trip"]})}),h&&e.jsxs("label",{children:["Return Date",e.jsx("input",{type:"date",value:m,onChange:t=>v(t.target.value),className:"w-full p-2 border"})]}),e.jsxs("label",{children:["Price",e.jsx("input",{type:"number",value:c,onChange:t=>k(t.target.value),className:"w-full p-2 border"})]}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Book"})]}),u==="ok"&&n&&e.jsxs("div",{className:"mt-4",children:["Checkout: ",e.jsx("a",{href:n.checkoutUrl,children:n.checkoutUrl})]}),u==="ok"&&!n&&e.jsx("div",{className:"mt-4 text-green-700",children:"Booking confirmed (no payment required)"}),u==="error"&&e.jsx("div",{className:"mt-4 text-red-700",children:"Booking failed"}),b.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:"font-semibold",children:"Flights"}),b.map(t=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{children:[t.name," â€” ",e.jsx("strong",{children:t.status||"Scheduled"})]}),e.jsx("button",{onClick:()=>{C(s=>{s&&s.item&&s.item.id===t.id&&p(r=>r.map(l=>l.id===t.id?{...l,status:s.item.status}:l))})},className:"px-2 py-1 border rounded text-sm",children:"Monitor"}),e.jsx("button",{onClick:async()=>{try{const s=await F(t.id);p(r=>r.map(l=>l.id===t.id?{...l,status:s.item.status}:l))}catch{}},className:"px-2 py-1 border rounded text-sm",children:"Refresh"})]},t.id))]})]})}export{B as default};
