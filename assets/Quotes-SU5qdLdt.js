import{u as p,r as d,j as t}from"./index-BCXrhMbA.js";import{f}from"./currency-SRo7-frQ.js";import{g as h,a as w,d as N,c as g}from"./quotes-BmeI0V5E.js";import"./jspdf.es.min-C6ZdERfm.js";import"./unsupportedIterableToArray-4EWRbQKi.js";function k(){const c=p(),[o,a]=d.useState([]),[l,i]=d.useState(!1);d.useEffect(()=>{let e=!0;return i(!0),h().then(r=>{e&&a(r||[])}).finally(()=>{e&&i(!1)}),()=>{e=!1}},[]);const x=e=>({subtotal:0,tax:0,total:0});async function u(e){if(window.confirm("Delete this quote?"))try{await N(e),a(r=>r.filter(s=>s.id!==e))}catch(r){console.warn("delete failed",r)}}async function m(e){const r=o.find(n=>n.id===e);if(!r)return;const s={...r,id:void 0,clientName:`${r.clientName} (Copy)`,createdAt:void 0,updatedAt:void 0};try{const n=await g(s);a(b=>[n,...b])}catch(n){console.warn("clone failed",n)}}return t.jsxs("div",{className:"px-6 py-8 text-brand-brown max-w-6xl mx-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold mb-1",children:"Quotes"}),t.jsx("p",{className:"text-brand-brown/70 text-sm",children:"Manage, export and track client quotations independently of itineraries."})]}),t.jsx("button",{onClick:()=>c("/quote/new"),className:"px-4 py-2 rounded bg-brand-brown text-cream text-sm font-medium hover:bg-brand-brown/90",children:"New Quote"})]}),l?t.jsx("div",{children:"Loading…"}):o.length===0&&t.jsx("div",{className:"bg-cream rounded border border-cream-border p-6 text-sm text-brand-brown/70",children:"No quotes yet. Create your first using the New Quote button."}),t.jsx("ul",{className:"space-y-3",children:o.map(e=>{const{total:r}=x();return t.jsxs("li",{className:"bg-cream rounded border border-cream-border p-4 flex flex-col md:flex-row md:items-center gap-4",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"font-semibold truncate",children:e.clientName||"Untitled Quote"}),t.jsxs("p",{className:"text-[11px] text-brand-brown/60",children:[e.items.length," items • ",f(r,e.currency)," • Status: ",e.status]}),t.jsxs("p",{className:"text-[11px] text-brand-brown/50",children:["Updated ",new Date(e.updatedAt).toLocaleString()]})]}),t.jsxs("div",{className:"flex gap-2 flex-wrap",children:[t.jsx("button",{onClick:()=>c("/quote/new?edit="+e.id),className:"px-3 py-1.5 text-xs rounded border border-brand-brown hover:bg-cream-hover",children:"Open"}),t.jsx("button",{onClick:()=>w(e),className:"px-3 py-1.5 text-xs rounded border border-brand-brown hover:bg-cream-hover",children:"PDF"}),t.jsx("button",{onClick:()=>m(e.id),className:"px-3 py-1.5 text-xs rounded border border-brand-brown hover:bg-cream-hover",children:"Clone"}),t.jsx("button",{onClick:()=>u(e.id),className:"px-3 py-1.5 text-xs rounded border border-red-600 text-red-600 hover:bg-red-50",children:"Delete"})]})]},e.id)})})]})}export{k as default};
