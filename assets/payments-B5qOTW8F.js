const r="payments:v1";function o(){try{const n=localStorage.getItem(r);return n?JSON.parse(n):{sessions:{},payments:[]}}catch{return{sessions:{},payments:[]}}}function u(n){try{localStorage.setItem(r,JSON.stringify(n))}catch{}}function y(n=[],e="USD"){const t=n.reduce((i,p)=>i+Math.max(0,Number(p.amount||0)),0),a=Math.round(t*.029*100)/100+.3,s=Math.round(t*.05*100)/100,c=Math.round(t*.15*100)/100,m=Math.round((t+a+s+c)*100)/100;return{currency:e,subtotal:t,paymentProcessor:a,platformFee:s,taxes:c,total:m}}function d({items:n=[],currency:e="USD",metadata:t={}}){const a=o(),s=Math.random().toString(36).slice(2);a.sessions[s]={id:s,items:n,currency:e,metadata:t,createdAt:Date.now(),status:"open"},u(a);const c=new URLSearchParams({sessionId:s});return{sessionId:s,checkoutUrl:`/payment-success?${c.toString()}`}}function l(n){const e=o(),t=e.sessions[n];if(!t)return null;t.status="paid";const a=y(t.items,t.currency),s={id:n,amount:a.total,currency:t.currency,items:t.items,metadata:t.metadata,paidAt:Date.now()};return e.payments.push(s),u(e),s}function f(n){return o().payments.find(t=>t.id===n)||null}function h(){return o().payments||[]}function S(){return(o().payments||[]).reduce((n,e)=>n+(e.amount||0),0)}export{d as a,l as c,f as g,h as l,S as t};
