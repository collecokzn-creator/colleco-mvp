{"version":3,"file":"Checkout-B26h3dT9.js","sources":["../../src/pages/Checkout.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { useSearchParams, useNavigate } from 'react-router-dom';\r\nimport Button from '../components/ui/Button';\r\nimport { CreditCard, Loader, AlertCircle } from 'lucide-react';\r\n\r\nexport default function Checkout() {\r\n  const [searchParams] = useSearchParams();\r\n  const navigate = useNavigate();\r\n  const bookingId = searchParams.get('bookingId');\r\n  \r\n  const [booking, setBooking] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [processor, setProcessor] = useState(''); // client must choose: 'yoco' or 'paystack'\r\n  const [redirecting, setRedirecting] = useState(false);\r\n  const [customerEmail, setCustomerEmail] = useState('');\r\n  const [emailError, setEmailError] = useState('');\r\n\r\n  useEffect(() => {\r\n    if (!bookingId) {\r\n      setError('No booking ID provided');\r\n      setLoading(false);\r\n      return;\r\n    }\r\n\r\n    async function loadBooking() {\r\n      try {\r\n        const response = await fetch(`/api/bookings/${bookingId}`);\r\n        if (!response.ok) {\r\n          throw new Error(`Failed to load booking: ${response.statusText}`);\r\n        }\r\n        const data = await response.json();\r\n        setBooking(data);\r\n        setLoading(false);\r\n      } catch (err) {\r\n        console.error('Failed to load booking:', err);\r\n        setError(err.message);\r\n        setLoading(false);\r\n      }\r\n    }\r\n\r\n    loadBooking();\r\n  }, [bookingId]);\r\n\r\n  async function handlePayment() {\r\n    if (!booking) return;\r\n\r\n    if (!processor) {\r\n      setError('Please select a payment provider before continuing');\r\n      return;\r\n    }\r\n\r\n    // Validate email\r\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\r\n    if (!customerEmail.trim()) {\r\n      setEmailError('Email is required for booking confirmation');\r\n      return;\r\n    }\r\n    if (!emailRegex.test(customerEmail)) {\r\n      setEmailError('Please enter a valid email address');\r\n      return;\r\n    }\r\n\r\n    setRedirecting(true);\r\n    try {\r\n      // Update booking with customer email\r\n      const updateResponse = await fetch(`/api/bookings/${booking.id}`, {\r\n        method: 'PATCH',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          metadata: {\r\n            ...booking.metadata,\r\n            customerEmail\r\n          }\r\n        })\r\n      });\r\n\r\n      if (!updateResponse.ok) {\r\n        console.warn('Failed to update booking with email, continuing anyway');\r\n      }\r\n\r\n      // Generate payment URL from backend\r\n      const response = await fetch('/api/payments/generate-url', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          bookingId: booking.id,\r\n          processor,\r\n          amount: booking.pricing.total,\r\n          returnUrl: `${window.location.origin}/pay/success`,\r\n          cancelUrl: `${window.location.origin}/pay/cancel`,\r\n          notifyUrl: `${window.location.origin}/api/webhooks/${processor}`\r\n        })\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Payment generation failed: ${response.statusText}`);\r\n      }\r\n\r\n      const { paymentUrl } = await response.json();\r\n      \r\n      // Redirect to payment processor\r\n      window.location.href = paymentUrl;\r\n    } catch (err) {\r\n      console.error('Payment failed:', err);\r\n      setError(`Payment failed: ${err.message}`);\r\n      setRedirecting(false);\r\n    }\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen bg-cream flex items-center justify-center\">\r\n        <div className=\"text-center\">\r\n          <Loader className=\"h-8 w-8 animate-spin text-brand-orange mx-auto mb-4\" />\r\n          <p className=\"text-brand-brown\">Loading booking details...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"min-h-screen bg-cream flex items-center justify-center p-4\">\r\n        <div className=\"max-w-md w-full bg-white rounded-xl shadow-sm border border-cream-border p-6\">\r\n          <div className=\"flex items-start gap-3 mb-4\">\r\n            <AlertCircle className=\"h-6 w-6 text-red-500 flex-shrink-0\" />\r\n            <div>\r\n              <h2 className=\"text-lg font-bold text-brand-brown mb-1\">Checkout Error</h2>\r\n              <p className=\"text-sm text-gray-600\">{error}</p>\r\n            </div>\r\n          </div>\r\n          <Button fullWidth onClick={() => navigate('/')}>\r\n            Return to Home\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!booking) {\r\n    return (\r\n      <div className=\"min-h-screen bg-cream flex items-center justify-center\">\r\n        <p className=\"text-brand-brown\">Booking not found</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const nights = booking.lineItems.reduce((sum, item) => Math.max(sum, item.nights || 0), 0);\r\n  \r\n  // Detect if this is a package booking (accommodation + multiple services bundled together)\r\n  const isPackageBooking = () => {\r\n    if (!booking.lineItems || booking.lineItems.length < 2) return false;\r\n    \r\n    // Check if accommodation is included\r\n    const hasAccommodation = booking.lineItems.some(item => \r\n      item.description.toLowerCase().includes('accommodation') || \r\n      item.description.toLowerCase().includes('room') ||\r\n      item.description.toLowerCase().includes('hotel')\r\n    );\r\n    \r\n    // Count other services (parking, meals, breakfast, dinner, lunch, conference, etc.)\r\n    const otherServices = booking.lineItems.filter(item => \r\n      !item.description.toLowerCase().includes('accommodation') && \r\n      !item.description.toLowerCase().includes('room') &&\r\n      !item.description.toLowerCase().includes('hotel')\r\n    );\r\n    \r\n    // It's a package if accommodation + 2+ other services\r\n    return hasAccommodation && otherServices.length >= 2;\r\n  };\r\n  \r\n  const isPackage = isPackageBooking();\r\n  \r\n  // Get list of included services for package display\r\n  const _getIncludedServices = () => {\r\n    return booking.lineItems\r\n      .map(item => item.description)\r\n      .join(', ');\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-cream py-8 px-4\">\r\n      <div className=\"max-w-3xl mx-auto\">\r\n        <h1 className=\"text-3xl font-bold text-brand-brown mb-6\">Checkout</h1>\r\n\r\n        {/* Booking Summary */}\r\n        <div className=\"bg-white rounded-xl shadow-sm border border-cream-border p-6 mb-6\">\r\n          <h2 className=\"text-lg font-bold text-brand-brown mb-4\">Booking Summary</h2>\r\n          \r\n          <div className=\"space-y-3 mb-6\">\r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-gray-600\">Booking ID:</span>\r\n              <span className=\"font-semibold text-brand-brown\">{booking.id}</span>\r\n            </div>\r\n            {booking.metadata?.propertyName && (\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span className=\"text-gray-600\">Property:</span>\r\n                <span className=\"font-semibold text-brand-brown\">{booking.metadata.propertyName}</span>\r\n              </div>\r\n            )}\r\n            {booking.metadata?.location && (\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span className=\"text-gray-600\">Location:</span>\r\n                <span className=\"font-semibold text-brand-brown\">{booking.metadata.location}</span>\r\n              </div>\r\n            )}\r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-gray-600\">Type:</span>\r\n              <span className=\"font-semibold text-brand-brown\">\r\n                {booking.bookingType === 'FIT' ? 'Individual Booking' : 'Group Booking'}\r\n              </span>\r\n            </div>\r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-gray-600\">Check-in:</span>\r\n              <span className=\"font-semibold text-brand-brown\">{booking.checkInDate}</span>\r\n            </div>\r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-gray-600\">Check-out:</span>\r\n              <span className=\"font-semibold text-brand-brown\">{booking.checkOutDate}</span>\r\n            </div>\r\n            <div className=\"flex justify-between text-sm\">\r\n              <span className=\"text-gray-600\">Nights:</span>\r\n              <span className=\"font-semibold text-brand-brown\">{nights}</span>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Line Items - Show as Package or Itemized Breakdown */}\r\n          <div className=\"border-t pt-4 mb-4\">\r\n            {isPackage ? (\r\n              // Package Display: Show total with included items\r\n              <div>\r\n                <h3 className=\"text-sm font-semibold text-brand-brown mb-3\">All-Inclusive Package</h3>\r\n                <div className=\"p-3 bg-blue-50 border border-blue-200 rounded-lg\">\r\n                  <p className=\"text-sm font-semibold text-brand-brown mb-2\">This package includes:</p>\r\n                  <ul className=\"text-xs text-gray-700 space-y-1\">\r\n                    {booking.lineItems.map((item, index) => (\r\n                      <li key={index} className=\"flex items-start gap-2\">\r\n                        <span className=\"text-brand-orange mt-1\">✓</span>\r\n                        <span>{item.description}</span>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              // Itemized Display: Show breakdown per service\r\n              <div>\r\n                <h3 className=\"text-sm font-semibold text-brand-brown mb-3\">Price Breakdown</h3>\r\n                <div className=\"space-y-3\">\r\n                  {booking.lineItems.map((item, index) => {\r\n                    const unitPrice = item.retailPrice || item.basePrice || 0;\r\n                    const itemTotal = item.totalRetail || item.finalPrice || 0;\r\n                    \r\n                    return (\r\n                      <div key={index} className=\"flex justify-between text-sm\">\r\n                        <div className=\"flex-1\">\r\n                          <p className=\"font-medium text-brand-brown\">{item.description}</p>\r\n                          <p className=\"text-xs text-gray-500\">\r\n                            {item.quantity > 1 && `${item.quantity} × `}\r\n                            {item.nights > 1 \r\n                              ? `${item.nights} night${item.nights > 1 ? 's' : ''} × ZAR ${unitPrice.toFixed(2)}` \r\n                              : `ZAR ${unitPrice.toFixed(2)}`}\r\n                          </p>\r\n                        </div>\r\n                        <span className=\"font-semibold text-brand-brown whitespace-nowrap ml-4\">\r\n                          ZAR {itemTotal.toFixed(2)}\r\n                        </span>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Pricing Summary */}\r\n          <div className=\"border-t pt-4\">\r\n            <div className=\"space-y-2\">\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span className=\"text-gray-600\">Subtotal (excl. VAT):</span>\r\n                <span className=\"font-semibold text-brand-brown\">ZAR {booking.pricing.subtotal.toFixed(2)}</span>\r\n              </div>\r\n              <div className=\"flex justify-between text-sm\">\r\n                <span className=\"text-gray-600\">VAT (included):</span>\r\n                <span className=\"font-semibold text-brand-brown\">ZAR {booking.pricing.vat.toFixed(2)}</span>\r\n              </div>\r\n              <div className=\"flex justify-between text-lg font-bold pt-2 border-t\">\r\n                <span className=\"text-brand-brown\">Total:</span>\r\n                <span className=\"text-brand-orange\">ZAR {booking.pricing.total.toFixed(2)}</span>\r\n              </div>\r\n              <p className=\"text-xs text-gray-500 mt-2\">\r\n                Price shown is the full amount, inclusive of taxes and any service fees. No extra booking fees at checkout.\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Payment Terms */}\r\n          <div className=\"mt-4 p-3 bg-cream rounded-lg\">\r\n            <p className=\"text-xs font-semibold text-brand-brown mb-1\">Payment Terms:</p>\r\n            {booking.bookingType === 'FIT' ? (\r\n              <p className=\"text-xs text-gray-600\">\r\n                Full payment of ZAR {booking.pricing.total.toFixed(2)} due now\r\n              </p>\r\n            ) : (\r\n              <div className=\"text-xs text-gray-600\">\r\n                <p>Deposit (25%): ZAR {booking.paymentTerms.depositAmount.toFixed(2)} due now</p>\r\n                <p>Balance: ZAR {booking.paymentTerms.balanceAmount.toFixed(2)} due by {booking.paymentTerms.balanceDueDate}</p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Payment Method Selection */}\r\n        <div className=\"bg-white rounded-xl shadow-sm border border-cream-border p-6 mb-6\">\r\n          <h2 className=\"text-lg font-bold text-brand-brown mb-4\">Contact Information</h2>\r\n          \r\n          <div className=\"mb-6\">\r\n            <label htmlFor=\"customerEmail\" className=\"block text-sm font-semibold text-brand-brown mb-2\">\r\n              Email Address\r\n            </label>\r\n            <input\r\n              id=\"customerEmail\"\r\n              type=\"email\"\r\n              value={customerEmail}\r\n              onChange={(e) => {\r\n                setCustomerEmail(e.target.value);\r\n                setEmailError('');\r\n              }}\r\n              placeholder=\"your.email@example.com\"\r\n              className={`w-full px-4 py-2 rounded-lg border-2 transition-colors ${\r\n                emailError\r\n                  ? 'border-red-500 bg-red-50'\r\n                  : 'border-cream-border bg-white hover:border-brand-orange focus:border-brand-orange'\r\n              } focus:outline-none`}\r\n            />\r\n            {emailError && (\r\n              <p className=\"text-sm text-red-600 mt-2\">{emailError}</p>\r\n            )}\r\n            <p className=\"text-xs text-gray-500 mt-2\">\r\n              Your booking confirmation and payment receipt will be sent to this email address.\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Payment Method Selection */}\r\n        <div className=\"bg-white rounded-xl shadow-sm border border-cream-border p-6 mb-6\">\r\n          <h2 className=\"text-lg font-bold text-brand-brown mb-4\">Payment Method</h2>\r\n          \r\n          <div className=\"space-y-3\">\r\n            <label className=\"flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer hover:border-brand-orange transition-colors\">\r\n              <input\r\n                type=\"radio\"\r\n                name=\"processor\"\r\n                value=\"yoco\"\r\n                checked={processor === 'yoco'}\r\n                onChange={e => setProcessor(e.target.value)}\r\n                className=\"w-4 h-4 text-brand-orange\"\r\n              />\r\n              <div className=\"flex-1\">\r\n                <p className=\"font-semibold text-brand-brown\">Yoco</p>\r\n                <p className=\"text-xs text-gray-600\">Credit/debit card payments</p>\r\n              </div>\r\n              <CreditCard className=\"h-5 w-5 text-gray-400\" />\r\n            </label>\r\n\r\n            <label className=\"flex items-center gap-3 p-3 border-2 rounded-lg cursor-pointer hover:border-brand-orange transition-colors\">\r\n              <input\r\n                type=\"radio\"\r\n                name=\"processor\"\r\n                value=\"paystack\"\r\n                checked={processor === 'paystack'}\r\n                onChange={e => setProcessor(e.target.value)}\r\n                className=\"w-4 h-4 text-brand-orange\"\r\n              />\r\n              <div className=\"flex-1\">\r\n                <p className=\"font-semibold text-brand-brown\">Paystack</p>\r\n                <p className=\"text-xs text-gray-600\">Credit card, local payment methods</p>\r\n              </div>\r\n              <CreditCard className=\"h-5 w-5 text-gray-400\" />\r\n            </label>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Checkout Button */}\r\n        <Button\r\n          fullWidth\r\n          onClick={handlePayment}\r\n          disabled={redirecting || !processor}\r\n          className=\"py-4 text-lg\"\r\n        >\r\n          {redirecting ? (\r\n            <span className=\"flex items-center justify-center gap-2\">\r\n              <Loader className=\"h-5 w-5 animate-spin\" />\r\n              Redirecting to {processor ? processor.charAt(0).toUpperCase() + processor.slice(1) : 'payment provider'}...\r\n            </span>\r\n          ) : (\r\n            <span className=\"flex items-center justify-center gap-2\">\r\n              <CreditCard className=\"h-5 w-5\" />\r\n              Proceed to Payment\r\n            </span>\r\n          )}\r\n        </Button>\r\n\r\n        <p className=\"text-center text-xs text-gray-500 mt-4\">\r\n          Secure payment powered by {processor ? processor.charAt(0).toUpperCase() + processor.slice(1) : 'our payment processors'}.\r\n          Your payment information is encrypted and secure.\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["useState","useEffect","jsxs","jsx"],"mappings":"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"}