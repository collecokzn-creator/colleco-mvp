{"version":3,"file":"GamificationWidget-C6rM1rFK.js","sources":["../../src/components/GamificationWidget.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport { Trophy, Star, Flame, ChevronRight } from 'lucide-react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { getAchievements, getStreaks, getRewardTier } from '../utils/gamificationEngine';\r\n\r\n/**\r\n * GamificationWidget\r\n * Compact widget showing user's points, streak, and tier in header/dashboard\r\n */\r\nexport default function GamificationWidget({ userId, compact = false }) {\r\n  const navigate = useNavigate();\r\n  const [achievements, setAchievements] = useState(null);\r\n  const [streaks, setStreaks] = useState(null);\r\n  const [rewardTier, setRewardTier] = useState(null);\r\n  const [showTooltip, setShowTooltip] = useState(false);\r\n  const [justEarnedPoints, setJustEarnedPoints] = useState(null);\r\n\r\n  const loadData = useCallback(() => {\r\n    const achievementsData = getAchievements(userId);\r\n    const streaksData = getStreaks(userId);\r\n    const tierData = getRewardTier(userId);\r\n\r\n    setAchievements(achievementsData);\r\n    setStreaks(streaksData);\r\n    setRewardTier(tierData);\r\n  }, [userId]);\r\n\r\n  useEffect(() => {\r\n    if (!userId) return;\r\n    loadData();\r\n  }, [loadData, userId]);\r\n\r\n  useEffect(() => {\r\n    // Listen for point awards\r\n    const handlePointsAwarded = (event) => {\r\n      if (event.detail.userId === userId) {\r\n        setJustEarnedPoints(event.detail.points);\r\n        loadData();\r\n\r\n        // Clear animation after 3 seconds\r\n        setTimeout(() => setJustEarnedPoints(null), 3000);\r\n      }\r\n    };\r\n\r\n    window.addEventListener('gamification:points-awarded', handlePointsAwarded);\r\n    return () => window.removeEventListener('gamification:points-awarded', handlePointsAwarded);\r\n  }, [userId, loadData]);\r\n\r\n  \r\n\r\n  if (!achievements) return null;\r\n\r\n  const points = achievements.totalPoints || 0;\r\n  const streak = streaks?.login?.current || 0;\r\n  const tier = rewardTier?.current;\r\n\r\n  if (compact) {\r\n    return (\r\n      <button\r\n        onClick={() => navigate('/gamification')}\r\n        onMouseEnter={() => setShowTooltip(true)}\r\n        onMouseLeave={() => setShowTooltip(false)}\r\n        className=\"relative flex items-center gap-2 px-3 py-1.5 bg-gradient-to-r from-brand-orange to-amber-500 text-white rounded-full hover:shadow-lg transition-all\"\r\n      >\r\n        <Trophy className=\"w-4 h-4\" />\r\n        <span className=\"font-bold text-sm\">{points.toLocaleString()}</span>\r\n        \r\n        {streak > 0 && (\r\n          <div className=\"flex items-center gap-1 border-l border-white/30 pl-2\">\r\n            <Flame className=\"w-3 h-3\" />\r\n            <span className=\"text-xs\">{streak}</span>\r\n          </div>\r\n        )}\r\n\r\n        {/* Points award animation */}\r\n        <AnimatePresence>\r\n          {justEarnedPoints && (\r\n            <motion.div\r\n              initial={{ opacity: 1, y: 0, scale: 1 }}\r\n              animate={{ opacity: 0, y: -30, scale: 1.2 }}\r\n              exit={{ opacity: 0 }}\r\n              transition={{ duration: 2 }}\r\n              className=\"absolute -top-6 right-0 text-green-400 font-bold text-sm whitespace-nowrap\"\r\n            >\r\n              +{justEarnedPoints} pts\r\n            </motion.div>\r\n          )}\r\n        </AnimatePresence>\r\n\r\n        {/* Tooltip */}\r\n        {showTooltip && (\r\n          <div className=\"absolute top-full mt-2 right-0 bg-gray-900 text-white px-3 py-2 rounded-lg shadow-xl text-xs whitespace-nowrap z-50\">\r\n            <p className=\"font-semibold\">{tier?.name} Tier</p>\r\n            <p className=\"text-gray-300\">{points.toLocaleString()} points</p>\r\n            {streak > 0 && <p className=\"text-orange-300\">{streak}-day streak ðŸ”¥</p>}\r\n            <p className=\"text-gray-400 mt-1\">Click for details</p>\r\n          </div>\r\n        )}\r\n      </button>\r\n    );\r\n  }\r\n\r\n  // Full widget for dashboards\r\n  return (\r\n    <motion.div\r\n      onClick={() => navigate('/gamification')}\r\n      className=\"bg-gradient-to-br from-brand-orange to-amber-500 rounded-xl p-4 text-white cursor-pointer hover:shadow-xl transition-shadow relative overflow-hidden\"\r\n      whileHover={{ scale: 1.02 }}\r\n    >\r\n      {/* Background decoration */}\r\n      <div className=\"absolute top-0 right-0 opacity-10\">\r\n        <Trophy className=\"w-32 h-32 -mr-8 -mt-8\" />\r\n      </div>\r\n\r\n      <div className=\"relative z-10\">\r\n        <div className=\"flex items-center justify-between mb-3\">\r\n          <div className=\"flex items-center gap-2\">\r\n            <Trophy className=\"w-5 h-5\" />\r\n            <h3 className=\"font-bold text-sm\">Gamification</h3>\r\n          </div>\r\n          <ChevronRight className=\"w-4 h-4\" />\r\n        </div>\r\n\r\n        <div className=\"space-y-2\">\r\n          {/* Points */}\r\n          <div className=\"flex items-center justify-between\">\r\n            <span className=\"text-white/80 text-xs\">Total Points</span>\r\n            <span className=\"text-2xl font-bold\">{points.toLocaleString()}</span>\r\n          </div>\r\n\r\n          {/* Tier */}\r\n          {tier && (\r\n            <div className=\"flex items-center justify-between\">\r\n              <span className=\"text-white/80 text-xs\">Tier</span>\r\n              <div className=\"flex items-center gap-1\">\r\n                <Star className=\"w-3 h-3\" />\r\n                <span className=\"font-semibold text-sm\">{tier.name}</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Streak */}\r\n          {streak > 0 && (\r\n            <div className=\"flex items-center justify-between\">\r\n              <span className=\"text-white/80 text-xs\">Daily Streak</span>\r\n              <div className=\"flex items-center gap-1\">\r\n                <Flame className=\"w-3 h-3\" />\r\n                <span className=\"font-semibold text-sm\">{streak} days</span>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Badges */}\r\n          {achievements.badges && achievements.badges.length > 0 && (\r\n            <div className=\"flex items-center justify-between pt-2 border-t border-white/20\">\r\n              <span className=\"text-white/80 text-xs\">Badges Earned</span>\r\n              <span className=\"font-semibold text-sm\">{achievements.badges.length}</span>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Points award animation */}\r\n        <AnimatePresence>\r\n          {justEarnedPoints && (\r\n            <motion.div\r\n              initial={{ opacity: 1, scale: 1, y: 0 }}\r\n              animate={{ opacity: 0, scale: 1.5, y: -20 }}\r\n              exit={{ opacity: 0 }}\r\n              transition={{ duration: 2 }}\r\n              className=\"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-green-300 font-bold text-3xl pointer-events-none\"\r\n            >\r\n              +{justEarnedPoints}\r\n            </motion.div>\r\n          )}\r\n        </AnimatePresence>\r\n      </div>\r\n    </motion.div>\r\n  );\r\n}\r\n"],"names":["useState","useCallback","useEffect","jsxs","jsx"],"mappings":"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"}