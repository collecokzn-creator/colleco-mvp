{"version":3,"file":"PartnerTransferDashboard-B8YkEh26.js","sources":["../../src/pages/PartnerTransferDashboard.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport Footer from '../components/Footer.jsx';\r\n\r\nexport default function PartnerTransferDashboard() {\r\n  const [requests, setRequests] = useState([]);\r\n  const [activeRequest, setActiveRequest] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    loadRequests();\r\n    \r\n    // Poll for new requests every 5 seconds\r\n    const interval = setInterval(loadRequests, 5000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  async function loadRequests() {\r\n    try {\r\n      const res = await fetch('/api/transfers/requests');\r\n      const data = await res.json();\r\n      \r\n      if (data.ok) {\r\n        setRequests(data.requests || []);\r\n      }\r\n    } catch (e) {\r\n      console.error('[partner] load requests failed', e);\r\n    }\r\n  }\r\n\r\n  async function acceptRequest(requestId) {\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch(`/api/transfers/request/${requestId}/accept`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          driver: {\r\n            name: 'Your Name', // Would come from partner profile\r\n            vehicle: 'Toyota Quantum',\r\n            plate: 'ABC 123 GP',\r\n            eta: '10 min'\r\n          }\r\n        })\r\n      });\r\n      \r\n      const data = await res.json();\r\n      \r\n      if (data.ok) {\r\n        setActiveRequest(data.request);\r\n        loadRequests(); // Refresh list\r\n      }\r\n    } catch (e) {\r\n      console.error('[partner] accept failed', e);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function updateStatus(requestId, status) {\r\n    try {\r\n      const res = await fetch(`/api/transfers/request/${requestId}/status`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ status })\r\n      });\r\n      \r\n      const data = await res.json();\r\n      \r\n      if (data.ok) {\r\n        setActiveRequest(data.request);\r\n        if (status === 'completed') {\r\n          setActiveRequest(null);\r\n        }\r\n        loadRequests();\r\n      }\r\n    } catch (e) {\r\n      console.error('[partner] status update failed', e);\r\n    }\r\n  }\r\n\r\n  const pendingRequests = requests.filter(r => r.status === 'searching' || r.status === 'matched');\r\n  const myActiveRequests = requests.filter(r => \r\n    r.status === 'accepted' || r.status === 'en-route' || r.status === 'arrived'\r\n  );\r\n\r\n  return (\r\n    <div className=\"max-w-6xl mx-auto p-6\">\r\n      <h1 className=\"text-3xl font-bold mb-6 text-brand-brown\">Partner Transfer Dashboard</h1>\r\n\r\n      {/* Active Trip */}\r\n      {activeRequest && (\r\n        <div className=\"mb-8 p-6 bg-cream-sand border-2 border-brand-orange rounded-lg\">\r\n          <h2 className=\"text-xl font-bold mb-4 text-brand-brown\">ðŸš— Active Trip</h2>\r\n          <div className=\"grid grid-cols-2 gap-4 mb-4\">\r\n            <div>\r\n              <p className=\"text-sm text-gray-600\">Pickup</p>\r\n              <p className=\"font-semibold\">{activeRequest.pickup}</p>\r\n            </div>\r\n            <div>\r\n              <p className=\"text-sm text-gray-600\">Dropoff</p>\r\n              <p className=\"font-semibold\">{activeRequest.dropoff}</p>\r\n            </div>\r\n            <div>\r\n              <p className=\"text-sm text-gray-600\">Passengers</p>\r\n              <p className=\"font-semibold\">{activeRequest.pax}</p>\r\n            </div>\r\n            <div>\r\n              <p className=\"text-sm text-gray-600\">Price</p>\r\n              <p className=\"font-semibold\">R{activeRequest.price}</p>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"flex gap-3 mt-4\">\r\n            {activeRequest.status === 'accepted' && (\r\n              <button\r\n                onClick={() => updateStatus(activeRequest.id, 'en-route')}\r\n                className=\"px-4 py-2 bg-brand-orange text-white rounded font-semibold hover:bg-brand-gold\"\r\n              >\r\n                Start Journey\r\n              </button>\r\n            )}\r\n            {activeRequest.status === 'en-route' && (\r\n              <button\r\n                onClick={() => updateStatus(activeRequest.id, 'arrived')}\r\n                className=\"px-4 py-2 bg-brand-orange text-white rounded font-semibold hover:bg-brand-gold\"\r\n              >\r\n                Mark as Arrived\r\n              </button>\r\n            )}\r\n            {activeRequest.status === 'arrived' && (\r\n              <button\r\n                onClick={() => updateStatus(activeRequest.id, 'completed')}\r\n                className=\"px-4 py-2 bg-gray-600 text-white rounded font-semibold hover:bg-gray-700\"\r\n              >\r\n                Complete Trip\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* My Active Requests */}\r\n      {myActiveRequests.length > 0 && !activeRequest && (\r\n        <div className=\"mb-8\">\r\n          <h2 className=\"text-xl font-bold mb-4 text-brand-brown\">My Active Requests</h2>\r\n          <div className=\"space-y-3\">\r\n            {myActiveRequests.map(req => (\r\n              <div key={req.id} className=\"p-4 bg-white border rounded-lg\">\r\n                <div className=\"flex justify-between items-start\">\r\n                  <div>\r\n                    <p className=\"font-semibold\">{req.pickup} â†’ {req.dropoff}</p>\r\n                    <p className=\"text-sm text-gray-600\">{req.pax} passengers â€¢ R{req.price}</p>\r\n                    <p className=\"text-xs text-gray-500 mt-1\">Status: {req.status}</p>\r\n                  </div>\r\n                  <button\r\n                    onClick={() => setActiveRequest(req)}\r\n                    className=\"px-3 py-1 bg-brand-orange text-white text-sm rounded hover:bg-brand-gold transition\"\r\n                  >\r\n                    View\r\n                  </button>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Incoming Requests */}\r\n      <div>\r\n        <h2 className=\"text-xl font-bold mb-4 text-brand-brown\">\r\n          Incoming Requests {pendingRequests.length > 0 && (\r\n            <span className=\"ml-2 px-2 py-1 bg-brand-russty text-white text-sm rounded-full\">\r\n              {pendingRequests.length} new\r\n            </span>\r\n          )}\r\n        </h2>\r\n\r\n        {pendingRequests.length === 0 ? (\r\n          <div className=\"p-8 bg-gray-50 rounded-lg text-center\">\r\n            <p className=\"text-gray-500\">No pending requests. We&apos;ll notify you when a customer needs a transfer.</p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n            {pendingRequests.map(req => (\r\n              <div key={req.id} className=\"p-4 bg-white border-2 border-brand-orange rounded-lg shadow-sm hover:shadow-md transition\">\r\n                <div className=\"flex items-start justify-between mb-3\">\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"font-semibold text-lg\">{req.pickup}</p>\r\n                    <p className=\"text-sm text-gray-600\">â†“</p>\r\n                    <p className=\"font-semibold text-lg\">{req.dropoff}</p>\r\n                  </div>\r\n                  <div className=\"text-right\">\r\n                    <p className=\"text-2xl font-bold text-brand-orange\">R{req.price}</p>\r\n                  </div>\r\n                </div>\r\n\r\n                <div className=\"grid grid-cols-2 gap-2 mb-3 text-sm\">\r\n                  <div>\r\n                    <p className=\"text-gray-600\">Passengers</p>\r\n                    <p className=\"font-semibold\">{req.pax}</p>\r\n                  </div>\r\n                  <div>\r\n                    <p className=\"text-gray-600\">Type</p>\r\n                    <p className=\"font-semibold capitalize\">{req.bookingType}</p>\r\n                  </div>\r\n                  {req.bookingType === 'prearranged' && (\r\n                    <>\r\n                      <div className=\"col-span-2\">\r\n                        <p className=\"text-gray-600\">Pickup Time</p>\r\n                        <p className=\"font-semibold\">{new Date(req.date).toLocaleString()}</p>\r\n                      </div>\r\n                    </>\r\n                  )}\r\n                </div>\r\n\r\n                <div className=\"flex gap-2\">\r\n                  <button\r\n                    onClick={() => acceptRequest(req.id)}\r\n                    disabled={loading}\r\n                    className=\"flex-1 px-4 py-2 bg-brand-orange text-white rounded font-semibold hover:bg-brand-gold disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed\"\r\n                  >\r\n                    Accept\r\n                  </button>\r\n                  <button\r\n                    className=\"px-4 py-2 bg-gray-300 text-gray-700 rounded font-semibold hover:bg-gray-400\"\r\n                  >\r\n                    Decline\r\n                  </button>\r\n                </div>\r\n\r\n                {req.bookingType === 'instant' && (\r\n                  <p className=\"text-xs text-brand-russty mt-2\">âš¡ Instant request - respond quickly!</p>\r\n                )}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n        \r\n        <Footer />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["useState","useEffect","jsxs","jsx"],"mappings":"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"}