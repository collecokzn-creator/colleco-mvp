{"version":3,"file":"Quotes-Bdqb_3aS.js","sources":["../../src/pages/Quotes.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { formatCurrency } from '../utils/currency';\r\nimport { generateQuotePdf } from '../utils/pdfGenerators';\r\nimport WorkflowPanel from '../components/WorkflowPanel';\r\nimport Button from '../components/ui/Button.jsx';\r\nimport * as api from '../api/quotes';\r\n// removed unused globeIcon import\r\nimport logger from '../utils/logger';\r\n\r\nexport default function Quotes() {\r\n  const navigate = useNavigate();\r\n  const [quotes, setQuotes] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    let mounted = true;\r\n    setLoading(true);\r\n    api.getQuotes().then(qs => { if(mounted) setQuotes(qs || []); }).finally(()=>{ if(mounted) setLoading(false); });\r\n    return () => { mounted = false; };\r\n  }, []);\r\n\r\n  const computeTotals = (q) => {\r\n    const subtotal = (q?.items || []).reduce((sum, item) => sum + (item.quantity || 0) * (item.unitPrice || 0), 0);\r\n    const taxRate = q?.taxRate || 0;\r\n    const tax = subtotal * (taxRate / 100);\r\n    const total = subtotal + tax;\r\n    return { subtotal, tax, total };\r\n  };\r\n\r\n  async function handleDelete(id) {\r\n    if(!window.confirm('Are you sure you want to delete this quote?')) return;\r\n    try {\r\n      await api.deleteQuote(id);\r\n      setQuotes(prev => prev.filter(p => p.id !== id));\r\n    } catch (e) { logger.warn('delete failed', e); }\r\n  }\r\n\r\n  async function handleClone(id) {\r\n    const src = quotes.find(q => q.id === id);\r\n    if(!src) return;\r\n    const copy = { ...src, id: undefined, clientName: `${src.clientName} (Copy)`, createdAt: undefined, updatedAt: undefined };\r\n    try {\r\n      const created = await api.createQuote(copy);\r\n      setQuotes(prev => [created, ...prev]);\r\n    } catch (e) { logger.warn('clone failed', e); }\r\n  }\r\n\r\n  return (\r\n    <div className=\"overflow-x-hidden bg-cream min-h-screen\">\r\n      <div className=\"max-w-6xl mx-auto px-4 sm:px-6 py-8\">\r\n        \r\n        {/* Header */}\r\n        <div className=\"mb-8\">\r\n          <div className=\"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4\">\r\n            <div className=\"flex-1\">\r\n              <h1 className=\"text-3xl sm:text-4xl font-bold text-brand-brown mb-2\">Quotes</h1>\r\n              <p className=\"text-brand-russty\">Manage client quotations and pricing</p>\r\n            </div>\r\n            <Button onClick={() => navigate('/quote/new')} variant=\"primary\" size=\"md\">New Quote</Button>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Stats Cards */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n          <div className=\"bg-white rounded-lg shadow-sm border border-cream-border p-6 hover:shadow-md transition-shadow\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-brand-russty\">Total Quotes</p>\r\n                <p className=\"text-3xl font-bold text-brand-orange\">{quotes.length}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"bg-white rounded-lg shadow-sm border border-cream-border p-6 hover:shadow-md transition-shadow\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-brand-russty\">Accepted</p>\r\n                <p className=\"text-3xl font-bold text-brand-orange\">{quotes.filter(q => q.status === 'accepted').length}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          \r\n          <div className=\"bg-white rounded-lg shadow-sm border border-cream-border p-6 hover:shadow-md transition-shadow\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <p className=\"text-sm text-brand-russty\">Pending</p>\r\n                <p className=\"text-3xl font-bold text-brand-orange\">{quotes.filter(q => q.status === 'sent').length}</p>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Workflow Panel */}\r\n        <div className=\"mb-6\">\r\n          <WorkflowPanel currentPage=\"quotes\" basketCount={0} hasQuote={quotes.length > 0} />\r\n        </div>\r\n\r\n        {/* Quotes List */}\r\n        {loading ? (\r\n          <div className=\"text-center py-12\">\r\n            <div className=\"inline-block w-12 h-12 border-4 border-brand-orange border-t-transparent rounded-full animate-spin\"></div>\r\n            <p className=\"mt-4 text-brand-russty\">Loading quotes...</p>\r\n          </div>\r\n        ) : quotes.length === 0 ? (\r\n          <div className=\"bg-white rounded-lg shadow-sm border border-cream-border p-12 text-center\">\r\n            <div className=\"text-6xl mb-4 opacity-20\">ðŸ“‹</div>\r\n            <h3 className=\"text-xl font-semibold text-brand-brown mb-2\">No quotes yet</h3>\r\n            <p className=\"text-brand-russty mb-6\">Create your first quote to get started</p>\r\n            <Button onClick={() => navigate('/quote/new')} variant=\"primary\" size=\"md\">Create Quote</Button>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4\">\r\n            {quotes.map(q => {\r\n              const { subtotal: _subtotal, tax: _tax, total } = computeTotals(q);\r\n              const getStatusStyle = (status) => {\r\n                const s = status?.toLowerCase();\r\n                if (s === 'accepted' || s === 'paid') return 'bg-green-100 text-green-800';\r\n                if (s === 'sent') return 'bg-brand-orange/10 text-brand-orange';\r\n                if (s === 'rejected' || s === 'cancelled') return 'bg-red-100 text-red-800';\r\n                return 'bg-cream-sand text-brand-brown';\r\n              };\r\n              \r\n              return (\r\n                <div key={q.id} className=\"bg-white rounded-lg shadow-sm border border-cream-border p-6 hover:shadow-md transition-shadow\">\r\n                  <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\">\r\n                    \r\n                    {/* Quote Info */}\r\n                    <div className=\"flex-1\">\r\n                      <h3 className=\"text-lg font-semibold text-brand-brown mb-2\">\r\n                        {q.clientName || 'Untitled Quote'}\r\n                      </h3>\r\n                      <div className=\"flex flex-wrap items-center gap-3 mb-2\">\r\n                        <span className={`px-3 py-1 rounded-full text-xs font-semibold ${getStatusStyle(q.status)}`}>\r\n                          {q.status || 'Draft'}\r\n                        </span>\r\n                        <span className=\"text-sm text-brand-russty\">\r\n                          {q.items?.length || 0} {q.items?.length === 1 ? 'item' : 'items'}\r\n                        </span>\r\n                        <span className=\"text-sm font-semibold text-brand-orange\">\r\n                          {formatCurrency(total, q.currency)}\r\n                        </span>\r\n                      </div>\r\n                      <p className=\"text-xs text-brand-russty\">\r\n                        Updated {new Date(q.updatedAt).toLocaleDateString('en-US', { \r\n                          year: 'numeric', \r\n                          month: 'short', \r\n                          day: 'numeric'\r\n                        })}\r\n                      </p>\r\n                    </div>\r\n\r\n                    {/* Actions */}\r\n                    <div className=\"flex flex-wrap gap-2\">\r\n                      <Button onClick={() => navigate('/quote/new?edit=' + q.id)} variant=\"primary\" size=\"sm\">Open</Button>\r\n                      <Button onClick={() => generateQuotePdf(q)} variant=\"outline\" size=\"sm\">PDF</Button>\r\n                      <Button onClick={() => handleClone(q.id)} variant=\"secondary\" size=\"sm\">Clone</Button>\r\n                      <Button onClick={() => handleDelete(q.id)} variant=\"danger\" size=\"sm\">Delete</Button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["useState","useEffect","api.getQuotes","api.deleteQuote","api.createQuote","jsxs","jsx"],"mappings":"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"}