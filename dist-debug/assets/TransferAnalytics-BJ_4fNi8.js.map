{"version":3,"file":"TransferAnalytics-BJ_4fNi8.js","sources":["../../src/pages/TransferAnalytics.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\n\r\nexport default function TransferAnalytics() {\r\n  const [metrics, setMetrics] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [timeRange, setTimeRange] = useState('week'); // 'week', 'month', 'year'\r\n\r\n  const loadMetrics = useCallback(async () => {\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch(`/api/transfers/analytics?range=${timeRange}`);\r\n      const data = await res.json();\r\n      \r\n      if (data.ok) {\r\n        setMetrics(data.metrics);\r\n      }\r\n    } catch (e) {\r\n      console.error('[analytics] load failed', e);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [timeRange]);\r\n\r\n  useEffect(() => {\r\n    loadMetrics();\r\n  }, [loadMetrics]);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"max-w-7xl mx-auto p-6\">\r\n        <h1 className=\"text-3xl font-bold mb-6\">Transfer Analytics</h1>\r\n        <p className=\"text-gray-500\">Loading analytics...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"max-w-7xl mx-auto p-6\">\r\n      <div className=\"flex justify-between items-center mb-6\">\r\n        <h1 className=\"text-3xl font-bold text-brand-brown\">Transfer Analytics</h1>\r\n        \r\n        <div className=\"flex gap-2\">\r\n          {['week', 'month', 'year'].map(range => (\r\n            <button\r\n              key={range}\r\n              onClick={() => setTimeRange(range)}\r\n              className={`px-4 py-2 rounded font-semibold capitalize transition ${\r\n                timeRange === range\r\n                  ? 'bg-brand-orange text-white'\r\n                  : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\r\n              }`}\r\n            >\r\n              {range}\r\n            </button>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Key Metrics */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8\">\r\n        <div className=\"p-6 bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-xl shadow-lg\">\r\n          <p className=\"text-sm opacity-90 mb-1\">Total Transfers</p>\r\n          <p className=\"text-4xl font-bold\">{metrics?.totalTransfers || 0}</p>\r\n          <p className=\"text-xs opacity-80 mt-2\">\r\n            +{metrics?.transferGrowth || 0}% vs last {timeRange}\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"p-6 bg-gradient-to-br from-green-500 to-green-600 text-white rounded-xl shadow-lg\">\r\n          <p className=\"text-sm opacity-90 mb-1\">Revenue</p>\r\n          <p className=\"text-4xl font-bold\">R{metrics?.totalRevenue || 0}</p>\r\n          <p className=\"text-xs opacity-80 mt-2\">\r\n            +{metrics?.revenueGrowth || 0}% vs last {timeRange}\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"p-6 bg-gradient-to-br from-purple-500 to-purple-600 text-white rounded-xl shadow-lg\">\r\n          <p className=\"text-sm opacity-90 mb-1\">Active Partners</p>\r\n          <p className=\"text-4xl font-bold\">{metrics?.activePartners || 0}</p>\r\n          <p className=\"text-xs opacity-80 mt-2\">\r\n            {metrics?.partnerUtilization || 0}% utilization\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"p-6 bg-gradient-to-br from-orange-500 to-orange-600 text-white rounded-xl shadow-lg\">\r\n          <p className=\"text-sm opacity-90 mb-1\">Avg Rating</p>\r\n          <p className=\"text-4xl font-bold\">{metrics?.avgRating || 0} ⭐</p>\r\n          <p className=\"text-xs opacity-80 mt-2\">\r\n            {metrics?.totalRatings || 0} reviews\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Popular Routes */}\r\n      <div className=\"bg-white rounded-xl shadow-sm border p-6 mb-6\">\r\n        <h2 className=\"text-xl font-bold mb-4 text-brand-brown\">Popular Routes</h2>\r\n        <div className=\"space-y-3\">\r\n          {(metrics?.popularRoutes || []).slice(0, 5).map((route, idx) => (\r\n            <div key={idx} className=\"flex items-center justify-between p-3 bg-gray-50 rounded\">\r\n              <div className=\"flex items-center gap-3\">\r\n                <span className=\"text-2xl font-bold text-gray-400\">#{idx + 1}</span>\r\n                <div>\r\n                  <p className=\"font-semibold\">{route.pickup} → {route.dropoff}</p>\r\n                  <p className=\"text-sm text-gray-600\">{route.count} trips</p>\r\n                </div>\r\n              </div>\r\n              <div className=\"text-right\">\r\n                <p className=\"font-bold text-brand-orange\">R{route.avgPrice}</p>\r\n                <p className=\"text-xs text-gray-500\">avg price</p>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Partner Performance */}\r\n      <div className=\"bg-white rounded-xl shadow-sm border p-6 mb-6\">\r\n        <h2 className=\"text-xl font-bold mb-4 text-brand-brown\">Top Partners</h2>\r\n        <div className=\"overflow-x-auto\">\r\n          <table className=\"w-full\">\r\n            <thead>\r\n              <tr className=\"border-b\">\r\n                <th className=\"text-left py-3 px-4\">Partner</th>\r\n                <th className=\"text-right py-3 px-4\">Trips</th>\r\n                <th className=\"text-right py-3 px-4\">Revenue</th>\r\n                <th className=\"text-right py-3 px-4\">Rating</th>\r\n                <th className=\"text-right py-3 px-4\">Acceptance Rate</th>\r\n              </tr>\r\n            </thead>\r\n            <tbody>\r\n              {(metrics?.topPartners || []).slice(0, 10).map((partner, idx) => (\r\n                <tr key={idx} className=\"border-b hover:bg-gray-50\">\r\n                  <td className=\"py-3 px-4\">\r\n                    <div>\r\n                      <p className=\"font-semibold\">{partner.name}</p>\r\n                      <p className=\"text-xs text-gray-500\">{partner.vehicle}</p>\r\n                    </div>\r\n                  </td>\r\n                  <td className=\"text-right py-3 px-4 font-semibold\">{partner.trips}</td>\r\n                  <td className=\"text-right py-3 px-4 font-semibold text-green-600\">\r\n                    R{partner.revenue}\r\n                  </td>\r\n                  <td className=\"text-right py-3 px-4\">\r\n                    <span className=\"inline-flex items-center gap-1\">\r\n                      {partner.rating} ⭐\r\n                    </span>\r\n                  </td>\r\n                  <td className=\"text-right py-3 px-4\">\r\n                    <span className={`font-semibold ${\r\n                      partner.acceptanceRate >= 80 ? 'text-green-600' :\r\n                      partner.acceptanceRate >= 60 ? 'text-yellow-600' :\r\n                      'text-red-600'\r\n                    }`}>\r\n                      {partner.acceptanceRate}%\r\n                    </span>\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n            </tbody>\r\n          </table>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Hourly Distribution */}\r\n      <div className=\"bg-white rounded-xl shadow-sm border p-6\">\r\n        <h2 className=\"text-xl font-bold mb-4 text-brand-brown\">Peak Hours</h2>\r\n        <div className=\"grid grid-cols-12 gap-2\">\r\n          {(metrics?.hourlyDistribution || Array(24).fill(0)).map((count, hour) => {\r\n            const maxCount = Math.max(...(metrics?.hourlyDistribution || [1]));\r\n            const height = (count / maxCount) * 100;\r\n            \r\n            return (\r\n              <div key={hour} className=\"flex flex-col items-center\">\r\n                <div className=\"w-full bg-gray-100 rounded h-32 flex items-end\">\r\n                  <div \r\n                    className=\"w-full bg-brand-orange rounded\"\r\n                    style={{ height: `${height}%` }}\r\n                    title={`${hour}:00 - ${count} trips`}\r\n                  ></div>\r\n                </div>\r\n                <p className=\"text-xs text-gray-500 mt-1\">{hour}h</p>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["useState","useCallback","useEffect","jsxs","jsx"],"mappings":"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"}