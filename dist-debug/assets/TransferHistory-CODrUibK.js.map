{"version":3,"file":"TransferHistory-CODrUibK.js","sources":["../../src/pages/TransferHistory.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Link } from 'react-router-dom';\r\n\r\nexport default function TransferHistory() {\r\n  const [transfers, setTransfers] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [filter, setFilter] = useState('all'); // 'all', 'completed', 'cancelled'\r\n\r\n  useEffect(() => {\r\n    loadTransfers();\r\n  }, []);\r\n\r\n  async function loadTransfers() {\r\n    try {\r\n      const res = await fetch('/api/transfers/history');\r\n      const data = await res.json();\r\n      \r\n      if (data.ok) {\r\n        setTransfers(data.transfers || []);\r\n      }\r\n    } catch (e) {\r\n      console.error('[history] load failed', e);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function downloadReceipt(transferId) {\r\n    try {\r\n      const res = await fetch(`/api/transfers/request/${transferId}/receipt`);\r\n      const data = await res.json();\r\n      \r\n      if (data.ok && data.receiptUrl) {\r\n        window.open(data.receiptUrl, '_blank');\r\n      }\r\n    } catch (e) {\r\n      console.error('[receipt] download failed', e);\r\n    }\r\n  }\r\n\r\n  const filteredTransfers = filter === 'all' \r\n    ? transfers \r\n    : transfers.filter(t => t.status === filter);\r\n\r\n  return (\r\n    <div className=\"max-w-4xl mx-auto p-6\">\r\n      <h1 className=\"text-3xl font-bold mb-6 text-brand-brown\">Transfer History</h1>\r\n\r\n      {/* Filter Tabs */}\r\n      <div className=\"mb-6 flex gap-2 border-b\">\r\n        {['all', 'completed', 'cancelled'].map(f => (\r\n          <button\r\n            key={f}\r\n            onClick={() => setFilter(f)}\r\n            className={`px-4 py-2 font-semibold capitalize transition ${\r\n              filter === f \r\n                ? 'text-brand-orange border-b-2 border-brand-orange' \r\n                : 'text-gray-600 hover:text-brand-brown'\r\n            }`}\r\n          >\r\n            {f}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {loading ? (\r\n        <div className=\"text-center py-12\">\r\n          <p className=\"text-gray-500\">Loading your transfer history...</p>\r\n        </div>\r\n      ) : filteredTransfers.length === 0 ? (\r\n        <div className=\"text-center py-12 bg-gray-50 rounded-lg\">\r\n          <p className=\"text-gray-500 mb-4\">No transfers found</p>\r\n          <Link to=\"/transfers\" className=\"text-brand-orange hover:underline\">\r\n            Book your first transfer ‚Üí\r\n          </Link>\r\n        </div>\r\n      ) : (\r\n        <div className=\"space-y-4\">\r\n          {filteredTransfers.map(transfer => (\r\n            <div key={transfer.id} className=\"p-4 bg-white border rounded-lg hover:shadow-md transition\">\r\n              <div className=\"flex justify-between items-start mb-3\">\r\n                <div className=\"flex-1\">\r\n                  <p className=\"font-semibold text-lg\">{transfer.pickup}</p>\r\n                  <p className=\"text-sm text-gray-500\">‚Üì</p>\r\n                  <p className=\"font-semibold text-lg\">{transfer.dropoff}</p>\r\n                </div>\r\n                <div className=\"text-right\">\r\n                  <p className=\"text-2xl font-bold text-brand-brown\">R{transfer.price}</p>\r\n                  <span className={`inline-block px-2 py-1 text-xs font-semibold rounded mt-1 ${\r\n                    transfer.status === 'completed' ? 'bg-cream-sand text-brand-brown' :\r\n                    transfer.status === 'cancelled' ? 'bg-amber-100 text-brand-russty' :\r\n                    'bg-gray-100 text-gray-800'\r\n                  }`}>\r\n                    {transfer.status}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm mb-3\">\r\n                <div>\r\n                  <p className=\"text-gray-600\">Date</p>\r\n                  <p className=\"font-semibold\">\r\n                    {new Date(transfer.createdAt).toLocaleDateString()}\r\n                  </p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-gray-600\">Time</p>\r\n                  <p className=\"font-semibold\">\r\n                    {new Date(transfer.createdAt).toLocaleTimeString()}\r\n                  </p>\r\n                </div>\r\n                {transfer.driver && (\r\n                  <>\r\n                    <div>\r\n                      <p className=\"text-gray-600\">Driver</p>\r\n                      <p className=\"font-semibold\">{transfer.driver.name}</p>\r\n                    </div>\r\n                    <div>\r\n                      <p className=\"text-gray-600\">Vehicle</p>\r\n                      <p className=\"font-semibold\">{transfer.driver.vehicle}</p>\r\n                    </div>\r\n                  </>\r\n                )}\r\n              </div>\r\n\r\n              <div className=\"flex gap-2 pt-3 border-t\">\r\n                <button\r\n                  onClick={() => downloadReceipt(transfer.id)}\r\n                  className=\"px-4 py-2 bg-gray-100 text-gray-700 rounded font-semibold hover:bg-gray-200 transition text-sm\"\r\n                >\r\n                  üìÑ Receipt\r\n                </button>\r\n                <Link\r\n                  to={`/transfers?rebook=${transfer.id}`}\r\n                  className=\"px-4 py-2 bg-brand-orange text-white rounded font-semibold hover:bg-brand-gold transition text-sm\"\r\n                >\r\n                  üîÑ Book Again\r\n                </Link>\r\n                {transfer.status === 'completed' && !transfer.rated && (\r\n                  <button className=\"px-4 py-2 bg-brand-orange text-white rounded font-semibold hover:bg-brand-gold transition text-sm\">\r\n                    ‚≠ê Rate Driver\r\n                  </button>\r\n                )}\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Summary Stats */}\r\n      <div className=\"mt-8 grid grid-cols-3 gap-4\">\r\n        <div className=\"p-4 bg-blue-50 rounded-lg text-center\">\r\n          <p className=\"text-3xl font-bold text-blue-600\">{transfers.length}</p>\r\n          <p className=\"text-sm text-gray-600\">Total Trips</p>\r\n        </div>\r\n        <div className=\"p-4 bg-green-50 rounded-lg text-center\">\r\n          <p className=\"text-3xl font-bold text-green-600\">\r\n            {transfers.filter(t => t.status === 'completed').length}\r\n          </p>\r\n          <p className=\"text-sm text-gray-600\">Completed</p>\r\n        </div>\r\n        <div className=\"p-4 bg-purple-50 rounded-lg text-center\">\r\n          <p className=\"text-3xl font-bold text-purple-600\">\r\n            R{transfers.reduce((sum, t) => sum + (t.price || 0), 0)}\r\n          </p>\r\n          <p className=\"text-sm text-gray-600\">Total Spent</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["useState","useEffect","jsxs","jsx","Fragment"],"mappings":";;;;;AAGA,SAAwB,kBAAkB;AACxC,QAAM,CAAC,WAAW,YAAY,IAAIA,aAAAA,SAAS,CAAA,CAAE;AAC7C,QAAM,CAAC,SAAS,UAAU,IAAIA,aAAAA,SAAS,IAAI;AAC3C,QAAM,CAAC,QAAQ,SAAS,IAAIA,aAAAA,SAAS,KAAK;AAE1CC,eAAAA,UAAU,MAAM;AACd,kBAAA;AAAA,EACF,GAAG,CAAA,CAAE;AAEL,iBAAe,gBAAgB;AAC7B,QAAI;AACF,YAAM,MAAM,MAAM,MAAM,wBAAwB;AAChD,YAAM,OAAO,MAAM,IAAI,KAAA;AAEvB,UAAI,KAAK,IAAI;AACX,qBAAa,KAAK,aAAa,EAAE;AAAA,MACnC;AAAA,IACF,SAAS,GAAG;AACV,cAAQ,MAAM,yBAAyB,CAAC;AAAA,IAC1C,UAAA;AACE,iBAAW,KAAK;AAAA,IAClB;AAAA,EACF;AAEA,iBAAe,gBAAgB,YAAY;AACzC,QAAI;AACF,YAAM,MAAM,MAAM,MAAM,0BAA0B,UAAU,UAAU;AACtE,YAAM,OAAO,MAAM,IAAI,KAAA;AAEvB,UAAI,KAAK,MAAM,KAAK,YAAY;AAC9B,eAAO,KAAK,KAAK,YAAY,QAAQ;AAAA,MACvC;AAAA,IACF,SAAS,GAAG;AACV,cAAQ,MAAM,6BAA6B,CAAC;AAAA,IAC9C;AAAA,EACF;AAEA,QAAM,oBAAoB,WAAW,QACjC,YACA,UAAU,OAAO,CAAA,MAAK,EAAE,WAAW,MAAM;AAE7C,SACEC,kCAAAA,KAAC,OAAA,EAAI,WAAU,yBACb,UAAA;AAAA,IAAAC,kCAAAA,IAAC,MAAA,EAAG,WAAU,4CAA2C,UAAA,oBAAgB;AAAA,IAGzEA,kCAAAA,IAAC,OAAA,EAAI,WAAU,4BACZ,UAAA,CAAC,OAAO,aAAa,WAAW,EAAE,IAAI,CAAA,MACrCA,kCAAAA;AAAAA,MAAC;AAAA,MAAA;AAAA,QAEC,SAAS,MAAM,UAAU,CAAC;AAAA,QAC1B,WAAW,iDACT,WAAW,IACP,qDACA,sCACN;AAAA,QAEC,UAAA;AAAA,MAAA;AAAA,MARI;AAAA,IAAA,CAUR,GACH;AAAA,IAEC,UACCA,kCAAAA,IAAC,OAAA,EAAI,WAAU,qBACb,UAAAA,sCAAC,OAAE,WAAU,iBAAgB,UAAA,mCAAA,CAAgC,EAAA,CAC/D,IACE,kBAAkB,WAAW,IAC/BD,kCAAAA,KAAC,OAAA,EAAI,WAAU,2CACb,UAAA;AAAA,MAAAC,kCAAAA,IAAC,KAAA,EAAE,WAAU,sBAAqB,UAAA,sBAAkB;AAAA,4CACnD,MAAA,EAAK,IAAG,cAAa,WAAU,qCAAoC,UAAA,6BAAA,CAEpE;AAAA,IAAA,EAAA,CACF,IAEAA,kCAAAA,IAAC,OAAA,EAAI,WAAU,aACZ,UAAA,kBAAkB,IAAI,CAAA,aACrBD,uCAAC,OAAA,EAAsB,WAAU,6DAC/B,UAAA;AAAA,MAAAA,kCAAAA,KAAC,OAAA,EAAI,WAAU,yCACb,UAAA;AAAA,QAAAA,kCAAAA,KAAC,OAAA,EAAI,WAAU,UACb,UAAA;AAAA,UAAAC,kCAAAA,IAAC,KAAA,EAAE,WAAU,yBAAyB,UAAA,SAAS,QAAO;AAAA,UACtDA,kCAAAA,IAAC,KAAA,EAAE,WAAU,yBAAwB,UAAA,KAAC;AAAA,UACtCA,kCAAAA,IAAC,KAAA,EAAE,WAAU,yBAAyB,mBAAS,QAAA,CAAQ;AAAA,QAAA,GACzD;AAAA,QACAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,cACb,UAAA;AAAA,UAAAA,kCAAAA,KAAC,KAAA,EAAE,WAAU,uCAAsC,UAAA;AAAA,YAAA;AAAA,YAAE,SAAS;AAAA,UAAA,GAAM;AAAA,UACpEC,kCAAAA,IAAC,QAAA,EAAK,WAAW,6DACf,SAAS,WAAW,cAAc,mCAClC,SAAS,WAAW,cAAc,mCAClC,2BACF,IACG,mBAAS,OAAA,CACZ;AAAA,QAAA,EAAA,CACF;AAAA,MAAA,GACF;AAAA,MAEAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,sDACb,UAAA;AAAA,QAAAA,uCAAC,OAAA,EACC,UAAA;AAAA,UAAAC,kCAAAA,IAAC,KAAA,EAAE,WAAU,iBAAgB,UAAA,QAAI;AAAA,UACjCA,kCAAAA,IAAC,KAAA,EAAE,WAAU,iBACV,UAAA,IAAI,KAAK,SAAS,SAAS,EAAE,mBAAA,EAAmB,CACnD;AAAA,QAAA,GACF;AAAA,+CACC,OAAA,EACC,UAAA;AAAA,UAAAA,kCAAAA,IAAC,KAAA,EAAE,WAAU,iBAAgB,UAAA,QAAI;AAAA,UACjCA,kCAAAA,IAAC,KAAA,EAAE,WAAU,iBACV,UAAA,IAAI,KAAK,SAAS,SAAS,EAAE,mBAAA,EAAmB,CACnD;AAAA,QAAA,GACF;AAAA,QACC,SAAS,UACRD,kCAAAA,KAAAE,kBAAAA,UAAA,EACE,UAAA;AAAA,UAAAF,uCAAC,OAAA,EACC,UAAA;AAAA,YAAAC,kCAAAA,IAAC,KAAA,EAAE,WAAU,iBAAgB,UAAA,UAAM;AAAA,kDAClC,KAAA,EAAE,WAAU,iBAAiB,UAAA,SAAS,OAAO,KAAA,CAAK;AAAA,UAAA,GACrD;AAAA,iDACC,OAAA,EACC,UAAA;AAAA,YAAAA,kCAAAA,IAAC,KAAA,EAAE,WAAU,iBAAgB,UAAA,WAAO;AAAA,kDACnC,KAAA,EAAE,WAAU,iBAAiB,UAAA,SAAS,OAAO,QAAA,CAAQ;AAAA,UAAA,EAAA,CACxD;AAAA,QAAA,EAAA,CACF;AAAA,MAAA,GAEJ;AAAA,MAEAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,4BACb,UAAA;AAAA,QAAAC,kCAAAA;AAAAA,UAAC;AAAA,UAAA;AAAA,YACC,SAAS,MAAM,gBAAgB,SAAS,EAAE;AAAA,YAC1C,WAAU;AAAA,YACX,UAAA;AAAA,UAAA;AAAA,QAAA;AAAA,QAGDA,kCAAAA;AAAAA,UAAC;AAAA,UAAA;AAAA,YACC,IAAI,qBAAqB,SAAS,EAAE;AAAA,YACpC,WAAU;AAAA,YACX,UAAA;AAAA,UAAA;AAAA,QAAA;AAAA,QAGA,SAAS,WAAW,eAAe,CAAC,SAAS,SAC5CA,sCAAC,UAAA,EAAO,WAAU,qGAAoG,UAAA,gBAAA,CAEtH;AAAA,MAAA,EAAA,CAEJ;AAAA,IAAA,EAAA,GAhEQ,SAAS,EAiEnB,CACD,GACH;AAAA,IAIFD,kCAAAA,KAAC,OAAA,EAAI,WAAU,+BACb,UAAA;AAAA,MAAAA,kCAAAA,KAAC,OAAA,EAAI,WAAU,yCACb,UAAA;AAAA,QAAAC,kCAAAA,IAAC,KAAA,EAAE,WAAU,oCAAoC,UAAA,UAAU,QAAO;AAAA,QAClEA,kCAAAA,IAAC,KAAA,EAAE,WAAU,yBAAwB,UAAA,cAAA,CAAW;AAAA,MAAA,GAClD;AAAA,MACAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,0CACb,UAAA;AAAA,QAAAC,kCAAAA,IAAC,KAAA,EAAE,WAAU,qCACV,UAAA,UAAU,OAAO,OAAK,EAAE,WAAW,WAAW,EAAE,OAAA,CACnD;AAAA,QACAA,kCAAAA,IAAC,KAAA,EAAE,WAAU,yBAAwB,UAAA,YAAA,CAAS;AAAA,MAAA,GAChD;AAAA,MACAD,kCAAAA,KAAC,OAAA,EAAI,WAAU,2CACb,UAAA;AAAA,QAAAA,kCAAAA,KAAC,KAAA,EAAE,WAAU,sCAAqC,UAAA;AAAA,UAAA;AAAA,UAC9C,UAAU,OAAO,CAAC,KAAK,MAAM,OAAO,EAAE,SAAS,IAAI,CAAC;AAAA,QAAA,GACxD;AAAA,QACAC,kCAAAA,IAAC,KAAA,EAAE,WAAU,yBAAwB,UAAA,cAAA,CAAW;AAAA,MAAA,EAAA,CAClD;AAAA,IAAA,EAAA,CACF;AAAA,EAAA,GACF;AAEJ;"}