{"version":3,"file":"Transfers-BrDFal9x.js","sources":["../../src/components/LiveMap.jsx","../../src/components/TransferChat.jsx","../../src/components/DriverRating.jsx","../../src/components/RideSelector.jsx","../../src/utils/notifications.js","../../src/pages/Transfers.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef, useCallback } from 'react';\n\n// Lightweight logger for development ‚Äî avoids ESLint no-console across the file\nconst _log = (level, ...args) => {\n  if (!import.meta.env.DEV) return;\n  if (level === 'warn') {\n    /* eslint-disable-next-line no-console */\n    console.warn(...args);\n  } else if (level === 'error') {\n    /* eslint-disable-next-line no-console */\n    console.error(...args);\n  } else {\n    /* eslint-disable-next-line no-console */\n    console.log(...args);\n  }\n};\n\nexport default function LiveMap({ pickup, dropoff, driverLocation, showRoute = true, nearbyDrivers = [], height = '400px', waypoints = [], onRouteInfo }) {\n  const mapRef = useRef(null);\n  const [map, setMap] = useState(null);\n  const [_markers, setMarkers] = useState({ pickup: null, dropoff: null, driver: null });\n  const nearbyMarkersRef = useRef([]); // use ref to avoid effect dependency loop\n  const [_waypointMarkers, _setWaypointMarkers] = useState([]); // unused currently; reserved for future waypoint visuals\n  const [directionsRenderer, setDirectionsRenderer] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  _log('log', '[LiveMap] Render:', { pickup, dropoff, driverLocation, showRoute, nearbyDriversCount: nearbyDrivers.length, waypointsCount: waypoints.length, mapExists: !!map });\n\n  const initMap = useCallback(() => {\n    if (!mapRef.current || !window.google) {\n      _log('log', '[LiveMap] initMap called but mapRef or google not ready');\n      return;\n    }\n\n    _log('log', '[LiveMap] Initializing map...');\n    try {\n      const mapInstance = new window.google.maps.Map(mapRef.current, {\n        center: { lat: -29.8587, lng: 31.0218 }, // Durban default\n        zoom: 13,\n        mapTypeControl: false,\n        streetViewControl: false,\n        fullscreenControl: true,\n        zoomControl: true,\n      });\n\n      setMap(mapInstance);\n      setLoading(false);\n      _log('log', '[LiveMap] Map initialized successfully');\n      \n      const renderer = new window.google.maps.DirectionsRenderer({\n        map: mapInstance,\n        suppressMarkers: false,\n        polylineOptions: {\n          strokeColor: '#FF6B35',\n          strokeWeight: 4,\n        }\n      });\n      \n      setDirectionsRenderer(renderer);\n    } catch (e) {\n      _log('error', '[LiveMap] Failed to initialize map:', e);\n      setError('Failed to initialize map');\n      setLoading(false);\n    }\n  }, []);\n\n  function geocodeAddress(address, callback) {\n    if (!window.google) return;\n    \n    const geocoder = new window.google.maps.Geocoder();\n    geocoder.geocode({ address: address }, (results, status) => {\n      if (status === 'OK' && results[0]) {\n        callback(results[0].geometry.location);\n      }\n    });\n  }\n\n  const updateMapMarkers = useCallback(() => {\n    if (!map || !window.google) return;\n\n    // Pickup marker - only create if doesn't exist or location changed\n    if (pickup) {\n      geocodeAddress(pickup, (location) => {\n        setMarkers(prev => {\n          // Remove old pickup marker if exists\n          if (prev.pickup) prev.pickup.setMap(null);\n          \n          const marker = new window.google.maps.Marker({\n            position: location,\n            map: map,\n            title: 'Pickup',\n            icon: {\n              path: window.google.maps.SymbolPath.CIRCLE,\n              scale: 10,\n              fillColor: '#4CAF50',\n              fillOpacity: 1,\n              strokeColor: '#fff',\n              strokeWeight: 2,\n            },\n            label: {\n              text: 'P',\n              color: '#fff',\n              fontSize: '12px',\n              fontWeight: 'bold'\n            }\n          });\n          return { ...prev, pickup: marker };\n        });\n      });\n    }\n\n    // Dropoff marker - only create if doesn't exist or location changed\n    if (dropoff) {\n      geocodeAddress(dropoff, (location) => {\n        setMarkers(prev => {\n          // Remove old dropoff marker if exists\n          if (prev.dropoff) prev.dropoff.setMap(null);\n          \n          const marker = new window.google.maps.Marker({\n            position: location,\n            map: map,\n            title: 'Dropoff',\n            icon: {\n              path: window.google.maps.SymbolPath.CIRCLE,\n              scale: 10,\n              fillColor: '#F44336',\n              fillOpacity: 1,\n              strokeColor: '#fff',\n              strokeWeight: 2,\n            },\n            label: {\n              text: 'D',\n              color: '#fff',\n              fontSize: '12px',\n              fontWeight: 'bold'\n            }\n          });\n          return { ...prev, dropoff: marker };\n        });\n      });\n    }\n\n    // Driver marker - update position if exists, create if doesn't\n    if (driverLocation && driverLocation.lat && driverLocation.lng) {\n      setMarkers(prev => {\n        const newPosition = { lat: driverLocation.lat, lng: driverLocation.lng };\n        \n        if (prev.driver) {\n          // Just update the position of existing marker\n          prev.driver.setPosition(newPosition);\n          return prev;\n        } else {\n          // Create new driver marker\n          const marker = new window.google.maps.Marker({\n            position: newPosition,\n            map: map,\n            title: 'Driver',\n            icon: {\n              url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`\n                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"40\" height=\"40\" viewBox=\"0 0 40 40\">\n                  <circle cx=\"20\" cy=\"20\" r=\"18\" fill=\"#2196F3\" stroke=\"white\" stroke-width=\"2\"/>\n                  <text x=\"20\" y=\"26\" font-size=\"20\" text-anchor=\"middle\" fill=\"white\">üöó</text>\n                </svg>\n              `),\n              scaledSize: new window.google.maps.Size(40, 40),\n              anchor: new window.google.maps.Point(20, 20),\n            },\n          });\n          return { ...prev, driver: marker };\n        }\n      });\n    }\n  }, [map, pickup, dropoff, driverLocation]);\n\n  const drawRoute = useCallback(() => {\n    if (!directionsRenderer || !window.google) return;\n    if (!pickup || !dropoff) return;\n\n    const directionsService = new window.google.maps.DirectionsService();\n    \n    // Build waypoints array for multi-stop journeys\n    const waypointsArray = waypoints\n      .filter(w => w && w.trim())\n      .map(location => ({\n        location,\n        stopover: true\n      }));\n    \n    directionsService.route(\n      {\n        origin: pickup,\n        destination: dropoff,\n        waypoints: waypointsArray,\n        optimizeWaypoints: true, // Optimize route order\n        travelMode: window.google.maps.TravelMode.DRIVING,\n      },\n      (result, status) => {\n        if (status === 'OK') {\n          directionsRenderer.setDirections(result);\n          \n          // Log optimized waypoint order if route was optimized\n          if (waypointsArray.length > 0 && result.routes[0].waypoint_order) {\n            /* optimized waypoint order available */\n          }\n\n          // Aggregate route metrics and report to parent if requested\n          try {\n            const legs = result.routes?.[0]?.legs || [];\n            const distanceMeters = legs.reduce((sum, l) => sum + (l.distance?.value || 0), 0);\n            const durationSeconds = legs.reduce((sum, l) => sum + (l.duration?.value || 0), 0);\n\n            if (typeof onRouteInfo === 'function') {\n              onRouteInfo({\n                distanceMeters,\n                durationSeconds,\n                distanceText: legs.map(l => l.distance?.text).filter(Boolean).join(' + ') || null,\n                durationText: legs.map(l => l.duration?.text).filter(Boolean).join(' + ') || null,\n                legsCount: legs.length\n              });\n            }\n          } catch (_) {\n            // no-op\n          }\n        } else {\n          _log('error', '[LiveMap] Directions request failed:', status);\n        }\n      }\n    );\n  }, [directionsRenderer, pickup, dropoff, waypoints, onRouteInfo]);\n\n  useEffect(() => {\n    // Load Google Maps script\n    _log('log', '[LiveMap] Script loading effect triggered', { hasGoogle: !!window.google });\n    if (!window.google) {\n      const apiKey = import.meta.env.VITE_GOOGLE_MAPS_API_KEY;\n      _log('log', '[LiveMap] API Key present:', !!apiKey, 'Length:', apiKey?.length);\n      if (!apiKey || apiKey === 'YOUR_API_KEY') {\n        const errorMsg = 'Google Maps API key not configured. Map preview unavailable. Set VITE_GOOGLE_MAPS_API_KEY in environment variables.';\n        _log('warn', '[LiveMap]', errorMsg);\n        setError(errorMsg);\n        setLoading(false);\n        return;\n      }\n      \n      const script = document.createElement('script');\n      script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&libraries=places`;\n      script.async = true;\n      script.defer = true;\n      _log('log', '[LiveMap] Adding Google Maps script to page');\n      document.head.appendChild(script);\n      \n      script.onload = () => {\n        _log('log', '[LiveMap] Google Maps script loaded successfully');\n        setTimeout(() => {\n          _log('log', '[LiveMap] Attempting to initialize map');\n          initMap();\n        }, 100);\n      };\n      \n      script.onerror = (e) => {\n        const errorMsg = 'Failed to load Google Maps script - check API key and billing';\n        _log('error', '[LiveMap]', errorMsg, e);\n        setError(errorMsg);\n        setLoading(false);\n      };\n    } else {\n      _log('log', '[LiveMap] Google Maps already loaded, initializing directly');\n      initMap();\n    }\n  }, [initMap]); // run on mount and when initMap changes\n\n  useEffect(() => {\n    if (map && window.google) {\n      updateMapMarkers();\n    }\n  }, [updateMapMarkers, map]);\n\n  useEffect(() => {\n    if (map && window.google && showRoute && pickup && dropoff) {\n      drawRoute();\n    }\n  }, [drawRoute, map, showRoute, pickup, dropoff]);\n\n  // Update nearby drivers markers\n  useEffect(() => {\n    if (!map || !window.google) return;\n\n    // Clear existing nearby markers\n    nearbyMarkersRef.current.forEach(marker => marker.setMap(null));\n\n    // Create new markers for nearby drivers\n    const newNearbyMarkers = nearbyDrivers.map((driver, index) => {\n      return new window.google.maps.Marker({\n        position: { lat: driver.lat, lng: driver.lng },\n        map: map,\n        title: `${driver.name || 'Driver'} - ${driver.eta || 5} min away`,\n        icon: {\n          url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(`\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 32 32\">\n              <circle cx=\"16\" cy=\"16\" r=\"14\" fill=\"#FF9800\" stroke=\"white\" stroke-width=\"2\"/>\n              <text x=\"16\" y=\"21\" font-size=\"16\" text-anchor=\"middle\" fill=\"white\">üöê</text>\n            </svg>\n          `),\n          scaledSize: new window.google.maps.Size(32, 32),\n          anchor: new window.google.maps.Point(16, 16),\n        },\n        zIndex: 100 + index,\n      });\n    });\n\n    nearbyMarkersRef.current = newNearbyMarkers;\n\n    // Fit bounds to show all nearby drivers if present\n    if (nearbyDrivers.length > 0 && pickup) {\n      const bounds = new window.google.maps.LatLngBounds();\n      nearbyDrivers.forEach(driver => {\n        bounds.extend({ lat: driver.lat, lng: driver.lng });\n      });\n      map.fitBounds(bounds);\n      // Don't zoom in too much\n      const listener = window.google.maps.event.addListener(map, 'idle', () => {\n        if (map.getZoom() > 15) map.setZoom(15);\n        window.google.maps.event.removeListener(listener);\n      });\n    }\n  }, [map, nearbyDrivers, pickup]);\n\n  return (\n    <div className=\"relative w-full rounded-lg overflow-hidden border-2 border-gray-300\" style={{ height }}>\n      <div ref={mapRef} className=\"w-full h-full\" />\n      \n      {/* Loading overlay */}\n      {loading && (\n        <div className=\"absolute inset-0 flex items-center justify-center bg-cream/90\">\n          <div className=\"text-center\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-orange mx-auto mb-2\"></div>\n            <p className=\"text-sm text-brand-brown\">Loading map...</p>\n          </div>\n        </div>\n      )}\n      \n      {/* Error overlay */}\n      {error && (\n        <div className=\"absolute inset-0 flex items-center justify-center bg-red-50\">\n          <div className=\"text-center p-4 max-w-sm\">\n            <p className=\"text-red-600 font-semibold\">Map Not Available</p>\n            <p className=\"text-sm text-red-500 mt-1 mb-3\">{error}</p>\n            <p className=\"text-xs text-gray-600\">\n              To fix: Add <code className=\"bg-white px-1 rounded text-gray-800\">VITE_GOOGLE_MAPS_API_KEY</code> to your environment variables or GitHub repository secrets.\n            </p>\n          </div>\n        </div>\n      )}\n      \n      {/* Map overlay with info */}\n      {!loading && !error && (\n        <div className=\"absolute top-4 left-4 bg-white px-4 py-2 rounded-lg shadow-lg text-sm\">\n          {nearbyDrivers.length > 0 ? (\n            <>\n              <p className=\"font-semibold text-gray-700\">Nearby Shuttles</p>\n              <p className=\"text-xs text-orange-600\">{nearbyDrivers.length} available</p>\n            </>\n          ) : (\n            <>\n              <p className=\"font-semibold text-gray-700\">Live Tracking</p>\n              {driverLocation && (\n                <p className=\"text-xs text-brand-orange\">Driver location updating</p>\n              )}\n            </>\n          )}\n        </div>\n      )}\n    </div>\n  );\n}\n","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\n\r\nexport default function TransferChat({ requestId, role = 'customer' }) {\r\n  const [messages, setMessages] = useState([]);\r\n  const [newMessage, setNewMessage] = useState('');\r\n  const [ws, setWs] = useState(null);\r\n  const messagesEndRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    // Connect to WebSocket\r\n    const wsUrl = `${window.location.protocol === 'https:' ? 'wss:' : 'ws:'}//${window.location.hostname}:${window.location.port || '4000'}/ws/transfer/${requestId}`;\r\n    \r\n    // Fallback: Use polling if WebSocket not available\r\n    if (!window.WebSocket) {\r\n      startPolling();\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const socket = new WebSocket(wsUrl);\r\n      \r\n      socket.onopen = () => {\r\n        socket.send(JSON.stringify({ type: 'join', requestId, role }));\r\n      };\r\n      \r\n      socket.onmessage = (event) => {\r\n        try {\r\n          const data = JSON.parse(event.data);\r\n          if (data.type === 'message') {\r\n            setMessages(prev => [...prev, data.message]);\r\n          } else if (data.type === 'history') {\r\n            setMessages(data.messages || []);\r\n          }\r\n        } catch (e) {\r\n          // Ignore parse errors\r\n        }\r\n      };\r\n      \r\n      socket.onerror = () => {\r\n        startPolling();\r\n      };\r\n      \r\n      setWs(socket);\r\n      \r\n      return () => {\r\n        if (socket.readyState === WebSocket.OPEN) {\r\n          socket.close();\r\n        }\r\n      };\r\n    } catch (e) {\r\n      startPolling();\r\n    }\r\n  }, [requestId, role, startPolling]);\r\n\r\n  const startPolling = useCallback(() => {\r\n    const interval = setInterval(async () => {\r\n      try {\r\n        const res = await fetch(`/api/transfers/request/${requestId}/messages`);\r\n        const data = await res.json();\r\n        if (data.ok && data.messages) {\r\n          setMessages(data.messages);\r\n        }\r\n      } catch (e) {\r\n        console.error('[chat] poll failed', e);\r\n      }\r\n    }, 3000);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [requestId]);\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  function scrollToBottom() {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }\r\n\r\n  async function sendMessage(e) {\r\n    e.preventDefault();\r\n    if (!newMessage.trim()) return;\r\n\r\n    const message = {\r\n      id: Date.now(),\r\n      requestId,\r\n      from: role,\r\n      text: newMessage,\r\n      timestamp: Date.now()\r\n    };\r\n\r\n    if (ws && ws.readyState === WebSocket.OPEN) {\r\n      ws.send(JSON.stringify({ type: 'message', message }));\r\n    } else {\r\n      // Fallback: HTTP POST\r\n      try {\r\n        await fetch(`/api/transfers/request/${requestId}/messages`, {\r\n          method: 'POST',\r\n          headers: { 'Content-Type': 'application/json' },\r\n          body: JSON.stringify({ message })\r\n        });\r\n      } catch (e) {\r\n        console.error('[chat] send failed', e);\r\n      }\r\n    }\r\n\r\n    setMessages(prev => [...prev, message]);\r\n    setNewMessage('');\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full bg-white rounded-lg border shadow-sm\">\r\n      <div className=\"p-4 border-b bg-gray-50\">\r\n        <h3 className=\"font-semibold text-gray-800\">\r\n          {role === 'customer' ? 'üí¨ Chat with Driver' : 'üí¨ Chat with Customer'}\r\n        </h3>\r\n      </div>\r\n\r\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-3 bg-gray-50\">\r\n        {messages.length === 0 ? (\r\n          <p className=\"text-center text-gray-400 text-sm py-8\">No messages yet. Start chatting!</p>\r\n        ) : (\r\n          messages.map(msg => (\r\n            <div\r\n              key={msg.id}\r\n              className={`flex ${msg.from === role ? 'justify-end' : 'justify-start'}`}\r\n            >\r\n              <div\r\n                className={`max-w-xs px-4 py-2 rounded-lg ${\r\n                  msg.from === role\r\n                    ? 'bg-brand-orange text-white'\r\n                    : 'bg-white border text-gray-800'\r\n                }`}\r\n              >\r\n                <p className=\"text-sm\">{msg.text}</p>\r\n                <p className=\"text-xs opacity-70 mt-1\">\r\n                  {new Date(msg.timestamp).toLocaleTimeString()}\r\n                </p>\r\n              </div>\r\n            </div>\r\n          ))\r\n        )}\r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n\r\n      <form onSubmit={sendMessage} className=\"p-4 border-t bg-white flex gap-2\">\r\n        <input\r\n          type=\"text\"\r\n          value={newMessage}\r\n          onChange={e => setNewMessage(e.target.value)}\r\n          placeholder=\"Type a message...\"\r\n          className=\"flex-1 border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n        />\r\n        <button\r\n          type=\"submit\"\r\n          className=\"px-6 py-2 bg-brand-orange text-white rounded-lg font-semibold hover:bg-brand-gold transition\"\r\n        >\r\n          Send\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState } from 'react';\r\n\r\nexport default function DriverRating({ requestId, driver, onSubmit }) {\r\n  const [rating, setRating] = useState(0);\r\n  const [hoverRating, setHoverRating] = useState(0);\r\n  const [review, setReview] = useState('');\r\n  const [submitted, setSubmitted] = useState(false);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  async function handleSubmit(e) {\r\n    e.preventDefault();\r\n    if (rating === 0) {\r\n      alert('Please select a rating');\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch(`/api/transfers/request/${requestId}/rate`, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ rating, review, driverName: driver?.name })\r\n      });\r\n\r\n      const data = await res.json();\r\n      \r\n      if (data.ok) {\r\n        setSubmitted(true);\r\n        if (onSubmit) onSubmit(data);\r\n      }\r\n    } catch (e) {\r\n      console.error('[rating] submit failed', e);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  if (submitted) {\r\n    return (\r\n      <div className=\"p-6 bg-cream-sand border border-cream-border rounded-lg text-center\">\r\n        <div className=\"text-4xl mb-2\">‚úÖ</div>\r\n        <p className=\"font-semibold text-brand-brown\">Thank you for your feedback!</p>\r\n        <p className=\"text-sm text-brand-russty mt-1\">Your rating helps us improve our service.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-6 bg-white border-2 border-brand-orange rounded-lg\">\r\n      <h3 className=\"text-xl font-bold mb-4 text-brand-brown\">Rate Your Driver</h3>\r\n      \r\n      {driver && (\r\n        <div className=\"mb-4 p-3 bg-gray-50 rounded\">\r\n          <p className=\"text-sm text-gray-600\">Driver</p>\r\n          <p className=\"font-semibold\">{driver.name}</p>\r\n          <p className=\"text-sm text-gray-500\">{driver.vehicle} ‚Ä¢ {driver.plate}</p>\r\n        </div>\r\n      )}\r\n\r\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n        <div>\r\n          <label className=\"block mb-2 font-semibold\">How was your experience?</label>\r\n          <div className=\"flex gap-2\">\r\n            {[1, 2, 3, 4, 5].map(star => (\r\n              <button\r\n                key={star}\r\n                type=\"button\"\r\n                onClick={() => setRating(star)}\r\n                onMouseEnter={() => setHoverRating(star)}\r\n                onMouseLeave={() => setHoverRating(0)}\r\n                className=\"text-4xl transition-transform hover:scale-110\"\r\n              >\r\n                {(hoverRating || rating) >= star ? '‚≠ê' : '‚òÜ'}\r\n              </button>\r\n            ))}\r\n          </div>\r\n          {rating > 0 && (\r\n            <p className=\"text-sm text-gray-600 mt-2\">\r\n              {rating === 1 && 'Poor'}\r\n              {rating === 2 && 'Fair'}\r\n              {rating === 3 && 'Good'}\r\n              {rating === 4 && 'Very Good'}\r\n              {rating === 5 && 'Excellent'}\r\n            </p>\r\n          )}\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block mb-2 font-semibold\">Leave a review (optional)</label>\r\n          <textarea\r\n            value={review}\r\n            onChange={e => setReview(e.target.value)}\r\n            placeholder=\"Share your experience...\"\r\n            rows={4}\r\n            className=\"w-full border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-brand-orange\"\r\n          />\r\n        </div>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          disabled={loading || rating === 0}\r\n          className=\"w-full px-6 py-3 bg-brand-orange text-white rounded-lg font-semibold hover:bg-brand-gold transition disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed\"\r\n        >\r\n          {loading ? 'Submitting...' : 'Submit Rating'}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n","import React, { useState, useEffect, useCallback } from 'react';\r\nimport { \r\n  Star, \r\n  \r\n  TrendingUp, \r\n  User, \r\n  Car, \r\n  Shield, \r\n  Award,\r\n  Heart,\r\n  Clock,\r\n  CheckCircle2,\r\n  Filter,\r\n  ArrowUpDown\r\n} from 'lucide-react';\r\n\r\nexport default function RideSelector({ \r\n  pickup, \r\n  dropoff, \r\n  vehicleType, \r\n  passengers,\r\n  onSelectRide,\r\n  onSkip,\r\n  onCancel \r\n}) {\r\n  // Local debug logger ‚Äî enabled in dev or when `VITE_DEBUG_RIDES=1`\r\n  const _log = (level, ...args) => {\r\n    if (!(import.meta.env.DEV || import.meta?.env?.VITE_DEBUG_RIDES === '1')) return;\r\n    // eslint-disable-next-line no-console\r\n    if (level === 'error') console.error(...args);\r\n    // eslint-disable-next-line no-console\r\n    else if (level === 'warn') console.warn(...args);\r\n    // eslint-disable-next-line no-console\r\n    else console.log(...args);\r\n  };\r\n  const [rides, setRides] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [filterBy, setFilterBy] = useState('all'); // all, price, rating, popularity, brand\r\n  const [sortBy, setSortBy] = useState('recommended'); // recommended, price_low, price_high, rating, popularity\r\n  const [favoriteDrivers, setFavoriteDrivers] = useState([]);\r\n  const [selectedRide, setSelectedRide] = useState(null);\r\n  const [preferredBrand, setPreferredBrand] = useState('');\r\n  const [preferredDriver, setPreferredDriver] = useState('');\r\n\r\n  const fetchAvailableRides = useCallback(async () => {\r\n    setLoading(true);\r\n    const useDemo = (import.meta?.env?.VITE_DEMO_SHUTTLE ?? '1') === '1';\r\n\r\n    const generateMockRides = () => {\r\n      const brands = [\r\n        { name: 'Uber', isPremium: false },\r\n        { name: 'Executive Transfers', isPremium: true },\r\n        { name: 'City Cabs', isPremium: false },\r\n        { name: 'VIP Shuttles', isPremium: true },\r\n        { name: 'SafeRide', isPremium: false },\r\n        { name: 'Luxury Limo Service', isPremium: true }\r\n      ];\r\n      const drivers = [\r\n        'Thabo Mkhize', 'Sipho Ndlovu', 'Zanele Khumalo', 'Bheki Dlamini',\r\n        'Nomusa Zulu', 'Jabu Mthembu', 'Thandiwe Sithole', 'Mandla Ngubane'\r\n      ];\r\n      const models = ['Toyota Corolla', 'BMW 3 Series', 'Mercedes E-Class', 'VW Polo', 'Honda Accord', 'Nissan Altima'];\r\n      const colors = ['White', 'Black', 'Silver', 'Gray', 'Blue'];\r\n      const features = ['AC', 'WiFi', 'USB', 'Premium Sound', 'Leather Seats', 'Sunroof'];\r\n      const languages = ['English', 'Zulu', 'Xhosa', 'Afrikaans'];\r\n      const specialties = ['Airport Transfers', 'Long Distance', 'Business Travel', 'Family Friendly'];\r\n\r\n      const basePrice = 150;\r\n      const out = [];\r\n      for (let i = 0; i < 10; i++) {\r\n        const brand = brands[i % brands.length];\r\n        const driver = drivers[i % drivers.length];\r\n        const model = models[i % models.length];\r\n        const color = colors[i % colors.length];\r\n        const plate = `CA ${Math.floor(100000 + Math.random() * 900000)}`;\r\n        const rating = 4.0 + Math.random() * 1.0;\r\n        const totalReviews = 50 + Math.floor(Math.random() * 500);\r\n        const completedTrips = 100 + Math.floor(Math.random() * 1400);\r\n        const estimatedArrival = 5 + Math.floor(Math.random() * 20);\r\n        const isVerified = Math.random() > 0.3;\r\n        const isSuperDriver = rating >= 4.7 && completedTrips > 500;\r\n        const isPopular = completedTrips > 800 && rating >= 4.5;\r\n        let priceMultiplier = 1.0;\r\n        if (brand.isPremium) priceMultiplier += 0.6;\r\n        if (vehicleType === 'suv') priceMultiplier += 0.3;\r\n        else if (vehicleType === 'van') priceMultiplier += 0.5;\r\n        else if (vehicleType === 'luxury') priceMultiplier += 1.0;\r\n        priceMultiplier += (Math.random() * 0.2 - 0.1);\r\n        const price = Math.round(basePrice * priceMultiplier / 5) * 5;\r\n        const vehicleFeatures = features.filter((_, idx) => (i + idx) % 2 === 0).slice(0, 3);\r\n        const driverLangs = languages.filter((_, idx) => (i + idx) % 2 === 0).slice(0, 2);\r\n        const driverSpecs = specialties.filter((_, idx) => (i + idx) % 3 === 0).slice(0, 2);\r\n        const latestReview = totalReviews > 100 && Math.random() > 0.5 ? {\r\n          comment: 'Excellent service, very professional and punctual!',\r\n          author: 'Client ' + (i + 1)\r\n        } : null;\r\n\r\n        out.push({\r\n          id: `RIDE-${Date.now()}-${i}`,\r\n          driver: {\r\n            id: `DRIVER-${i}`,\r\n            name: driver,\r\n            photo: null,\r\n            isVerified,\r\n            isSuperDriver,\r\n            languages: driverLangs,\r\n            specialties: driverSpecs\r\n          },\r\n          brand,\r\n          vehicle: {\r\n            model,\r\n            color,\r\n            plate,\r\n            features: vehicleFeatures\r\n          },\r\n          price,\r\n          rating: Number(rating.toFixed(1)),\r\n          totalReviews,\r\n          completedTrips,\r\n          estimatedArrival,\r\n          isPopular,\r\n          latestReview\r\n        });\r\n      }\r\n      return out;\r\n    };\r\n\r\n    try {\r\n      _log('log', '[RideSelector] Fetching rides for:', { pickup, dropoff, vehicleType, passengers });\r\n      const response = await fetch('/api/transfers/available-rides', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({\r\n          pickup,\r\n          dropoff,\r\n          vehicleType,\r\n          passengers\r\n        })\r\n      });\r\n\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        const list = data.rides || [];\r\n        _log('log', '[RideSelector] Received rides:', list.length);\r\n        setRides(list.length ? list : (useDemo ? generateMockRides() : []));\r\n      } else {\r\n        _log('error', '[RideSelector] Failed to fetch rides');\r\n        setRides(useDemo ? generateMockRides() : []);\r\n      }\r\n    } catch (error) {\r\n      _log('error', 'Failed to fetch rides:', error);\r\n      setRides(useDemo ? generateMockRides() : []);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [pickup, dropoff, vehicleType, passengers]);\r\n\r\n  const loadFavoriteDrivers = useCallback(() => {\r\n    try {\r\n      const saved = localStorage.getItem('colleco.favoriteDrivers');\r\n      setFavoriteDrivers(saved ? JSON.parse(saved) : []);\r\n    } catch (error) {\r\n      _log('error', 'Failed to load favorite drivers:', error);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    fetchAvailableRides();\r\n    loadFavoriteDrivers();\r\n  }, [fetchAvailableRides, loadFavoriteDrivers]);\r\n  const toggleFavoriteDriver = (driverId) => {\r\n    const updated = favoriteDrivers.includes(driverId)\r\n      ? favoriteDrivers.filter(id => id !== driverId)\r\n      : [...favoriteDrivers, driverId];\r\n    \r\n    setFavoriteDrivers(updated);\r\n    localStorage.setItem('colleco.favoriteDrivers', JSON.stringify(updated));\r\n  };\r\n\r\n  const getFilteredAndSortedRides = () => {\r\n    let filtered = [...rides];\r\n    _log('log', `[RideSelector] Starting filter: ${filterBy}, Total rides: ${filtered.length}`);\r\n\r\n    // Preferred brand/driver filters (exact or contains)\r\n    if (preferredBrand.trim()) {\r\n      const q = preferredBrand.trim().toLowerCase();\r\n      filtered = filtered.filter(r => (r.brand.name || '').toLowerCase().includes(q));\r\n    }\r\n    if (preferredDriver.trim()) {\r\n      const qd = preferredDriver.trim().toLowerCase();\r\n      filtered = filtered.filter(r => (r.driver.name || '').toLowerCase().includes(qd));\r\n    }\r\n\r\n    // Apply filters\r\n    if (filterBy === 'favorites') {\r\n      filtered = filtered.filter(ride => favoriteDrivers.includes(ride.driver.id));\r\n      _log('log', `[RideSelector] After favorites filter: ${filtered.length}`);\r\n    } else if (filterBy === 'premium') {\r\n      filtered = filtered.filter(ride => ride.brand.isPremium);\r\n      _log('log', `[RideSelector] After premium filter: ${filtered.length}`);\r\n    } else if (filterBy === 'budget') {\r\n      if (rides.length > 0) {\r\n        const minPrice = Math.min(...rides.map(r => r.price));\r\n        _log('log', `[RideSelector] Min price: R${minPrice}, Budget threshold: R${minPrice * 1.1}`);\r\n        filtered = filtered.filter(ride => ride.price <= minPrice * 1.1); // Within 10% of lowest\r\n        _log('log', `[RideSelector] After budget filter: ${filtered.length}`);\r\n      }\r\n    } else if (filterBy === 'top_rated') {\r\n      filtered = filtered.filter(ride => ride.rating >= 4.5);\r\n      _log('log', `[RideSelector] After top_rated filter: ${filtered.length}`);\r\n    }\r\n\r\n    // Apply sorting\r\n    switch (sortBy) {\r\n      case 'price_low':\r\n        filtered.sort((a, b) => a.price - b.price);\r\n        break;\r\n      case 'price_high':\r\n        filtered.sort((a, b) => b.price - a.price);\r\n        break;\r\n      case 'rating':\r\n        filtered.sort((a, b) => b.rating - a.rating);\r\n        break;\r\n      case 'popularity':\r\n        filtered.sort((a, b) => b.completedTrips - a.completedTrips);\r\n        break;\r\n      case 'recommended':\r\n      default:\r\n        // Weighted scoring: rating (40%) + popularity (30%) + favorite (30%)\r\n        filtered.sort((a, b) => {\r\n          const scoreA = (a.rating / 5 * 40) + \r\n                        (Math.min(a.completedTrips / 1000, 1) * 30) +\r\n                        (favoriteDrivers.includes(a.driver.id) ? 30 : 0);\r\n          const scoreB = (b.rating / 5 * 40) + \r\n                        (Math.min(b.completedTrips / 1000, 1) * 30) +\r\n                        (favoriteDrivers.includes(b.driver.id) ? 30 : 0);\r\n          return scoreB - scoreA;\r\n        });\r\n    }\r\n\r\n    _log('log', `[RideSelector] Final filtered count: ${filtered.length}`);\r\n    return filtered;\r\n  };\r\n\r\n  // Auto Smart: compute composite score and pick the best\r\n  const scoreRide = (ride) => {\r\n    // Normalize components: safety ~ verified + superDriver + rating\r\n    const safety = (ride.driver.isVerified ? 1 : 0) + (ride.driver.isSuperDriver ? 0.5 : 0) + (ride.rating / 5);\r\n    // Reliability: completed trips and total reviews (scaled)\r\n    const reliability = Math.min(1, (ride.completedTrips / 1500)) * 0.7 + Math.min(1, (ride.totalReviews / 400)) * 0.3;\r\n    // Affordability: inverse of price relative to min price in set\r\n    const prices = rides.map(r => r.price);\r\n    const minPrice = prices.length ? Math.min(...prices) : ride.price;\r\n    const affordability = Math.min(1, minPrice / ride.price);\r\n    // Premium penalty small unless user chose premium vehicleType\r\n    const premiumPenalty = (ride.brand.isPremium && vehicleType !== 'luxury') ? 0.1 : 0;\r\n    // Weighted composite\r\n    const score = (safety * 0.4) + (reliability * 0.3) + (affordability * 0.3) - premiumPenalty;\r\n    return score;\r\n  };\r\n\r\n  const _autoPickBestRide = () => {\r\n    const list = getFilteredAndSortedRides();\r\n    if (!list.length) return;\r\n    const best = list\r\n      .map(r => ({ ride: r, score: scoreRide(r) }))\r\n      .sort((a, b) => b.score - a.score)[0].ride;\r\n    setSelectedRide(best);\r\n          <div className=\"px-4 py-3 border-b bg-cream/40\">\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\r\n              <div>\r\n                <label className=\"block text-xs text-gray-600 mb-1\">Preferred Brand</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={preferredBrand}\r\n                  onChange={e => setPreferredBrand(e.target.value)}\r\n                  placeholder=\"e.g. Uber, Executive Transfers\"\r\n                  className=\"w-full border rounded-md px-3 py-2 text-sm\"\r\n                />\r\n              </div>\r\n              <div>\r\n                <label className=\"block text-xs text-gray-600 mb-1\">Preferred Driver</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={preferredDriver}\r\n                  onChange={e => setPreferredDriver(e.target.value)}\r\n                  placeholder=\"e.g. Thabo Mkhize\"\r\n                  className=\"w-full border rounded-md px-3 py-2 text-sm\"\r\n                />\r\n              </div>\r\n            </div>\r\n          </div>\r\n    onSelectRide?.(best);\r\n  };\r\n\r\n  const formatCurrency = (amount) => {\r\n    return new Intl.NumberFormat('en-ZA', {\r\n      style: 'currency',\r\n      currency: 'ZAR',\r\n      minimumFractionDigits: 0\r\n    }).format(amount);\r\n  };\r\n\r\n  const getRatingColor = (rating) => {\r\n    if (rating >= 4.8) return 'text-green-600';\r\n    if (rating >= 4.5) return 'text-blue-600';\r\n    if (rating >= 4.0) return 'text-yellow-600';\r\n    return 'text-gray-600';\r\n  };\r\n\r\n  const getPriceLabel = (price, allPrices) => {\r\n    const minPrice = Math.min(...allPrices);\r\n    const maxPrice = Math.max(...allPrices);\r\n    \r\n    if (price === minPrice) return 'Lowest Price';\r\n    if (price === maxPrice) return 'Premium';\r\n    return 'Competitive';\r\n  };\r\n\r\n  const filteredRides = getFilteredAndSortedRides();\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"fixed inset-0 bg-black/50 z-modal flex items-center justify-center\">\r\n        <div className=\"bg-white rounded-lg p-8 max-w-md\">\r\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-brand-orange mx-auto\"></div>\r\n          <p className=\"text-center mt-4 text-gray-600\">Finding available rides...</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 bg-black/50 z-modal flex items-center justify-center p-4 overflow-y-auto\">\r\n      <div className=\"bg-white rounded-lg max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col my-8\">\r\n        {/* Header */}\r\n        <div className=\"p-3 sm:p-6 border-b bg-gradient-to-r from-brand-orange to-orange-600\">\r\n          <h2 className=\"text-2xl font-bold text-white mb-2\">Pick Your Ride</h2>\r\n          <p className=\"text-white/90 text-sm\">\r\n            {pickup} ‚Üí {dropoff}\r\n          </p>\r\n        </div>\r\n\r\n        {/* Filters & Sort */}\r\n        <div className=\"p-4 border-b bg-cream-50 space-y-3\">\r\n          <div className=\"flex flex-wrap gap-3\">\r\n            <div className=\"flex-1 min-w-0 sm:min-w-[200px]\">\r\n              <label className=\"block text-xs font-medium text-gray-700 mb-1\">\r\n                <Filter className=\"h-3 w-3 inline mr-1\" />\r\n                Filter By\r\n              </label>\r\n              <select\r\n                value={filterBy}\r\n                onChange={(e) => setFilterBy(e.target.value)}\r\n                className=\"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-orange text-sm\"\r\n              >\r\n                <option value=\"all\">All Rides</option>\r\n                <option value=\"favorites\">My Favorites</option>\r\n                <option value=\"premium\">Premium Brands</option>\r\n                <option value=\"budget\">Budget Options</option>\r\n                <option value=\"top_rated\">Top Rated (4.5+)</option>\r\n              </select>\r\n            </div>\r\n\r\n            <div className=\"flex-1 min-w-0 sm:min-w-[200px]\">\r\n              <label className=\"block text-xs font-medium text-gray-700 mb-1\">\r\n                <ArrowUpDown className=\"h-3 w-3 inline mr-1\" />\r\n                Sort By\r\n              </label>\r\n              <select\r\n                value={sortBy}\r\n                onChange={(e) => setSortBy(e.target.value)}\r\n                className=\"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-orange text-sm\"\r\n              >\r\n                <option value=\"recommended\">Recommended</option>\r\n                <option value=\"price_low\">Price: Low to High</option>\r\n                <option value=\"price_high\">Price: High to Low</option>\r\n                <option value=\"rating\">Highest Rated</option>\r\n                <option value=\"popularity\">Most Popular</option>\r\n              </select>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"text-xs text-gray-600\">\r\n            Showing {filteredRides.length} of {rides.length} available rides\r\n          </div>\r\n        </div>\r\n\r\n        {/* Rides List */}\r\n        <div className=\"flex-1 overflow-y-auto p-4 space-y-4\">\r\n          {filteredRides.length === 0 ? (\r\n            <div className=\"text-center py-12\">\r\n              <Car className=\"h-16 w-16 text-gray-300 mx-auto mb-4\" />\r\n              <p className=\"text-gray-600\">No rides match your filters</p>\r\n              <button\r\n                onClick={() => setFilterBy('all')}\r\n                className=\"mt-3 text-brand-orange hover:underline text-sm\"\r\n              >\r\n                Clear filters\r\n              </button>\r\n            </div>\r\n          ) : (\r\n            filteredRides.map((ride) => (\r\n              <div\r\n                key={ride.id}\r\n                onClick={() => setSelectedRide(ride)}\r\n                className={`border rounded-lg p-4 cursor-pointer transition-all ${\r\n                  selectedRide?.id === ride.id\r\n                    ? 'border-brand-orange bg-orange-50 shadow-lg'\r\n                    : 'border-gray-200 hover:border-brand-orange hover:shadow-md'\r\n                }`}\r\n              >\r\n                <div className=\"flex gap-2 sm:gap-4\">\r\n                  {/* Driver Photo */}\r\n                  <div className=\"flex-shrink-0\">\r\n                    <div className=\"w-16 sm:w-20 h-16 sm:h-20 bg-gray-200 rounded-full overflow-hidden relative\">\r\n                      {ride.driver.photo ? (\r\n                        <img \r\n                          src={ride.driver.photo} \r\n                          alt={ride.driver.name}\r\n                          className=\"w-full h-full object-cover\"\r\n                        />\r\n                      ) : (\r\n                        <User className=\"w-full h-full p-4 text-gray-400\" />\r\n                      )}\r\n                      {ride.driver.isVerified && (\r\n                        <div className=\"absolute bottom-0 right-0 bg-blue-500 rounded-full p-1\">\r\n                          <CheckCircle2 className=\"h-3 w-3 text-white\" />\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Ride Details */}\r\n                  <div className=\"flex-1 min-w-0\">\r\n                    <div className=\"flex items-start justify-between mb-2\">\r\n                      <div>\r\n                        <div className=\"flex items-center gap-2 mb-1\">\r\n                          <h3 className=\"font-semibold text-lg text-gray-900\">\r\n                            {ride.driver.name}\r\n                          </h3>\r\n                          <button\r\n                            onClick={(e) => {\r\n                              e.stopPropagation();\r\n                              toggleFavoriteDriver(ride.driver.id);\r\n                            }}\r\n                            className=\"text-gray-400 hover:text-red-500 transition-colors\"\r\n                          >\r\n                            <Heart\r\n                              className={`h-4 w-4 ${\r\n                                favoriteDrivers.includes(ride.driver.id)\r\n                                  ? 'fill-red-500 text-red-500'\r\n                                  : ''\r\n                              }`}\r\n                            />\r\n                          </button>\r\n                        </div>\r\n                        <div className=\"flex items-center gap-3 text-sm text-gray-600\">\r\n                          <span className=\"flex items-center gap-1\">\r\n                            <Car className=\"h-3 w-3\" />\r\n                            {ride.brand.name}\r\n                          </span>\r\n                          {ride.brand.isPremium && (\r\n                            <span className=\"flex items-center gap-1 text-yellow-600\">\r\n                              <Award className=\"h-3 w-3\" />\r\n                              Premium\r\n                            </span>\r\n                          )}\r\n                        </div>\r\n                      </div>\r\n\r\n                      <div className=\"text-right\">\r\n                        <div className=\"text-2xl font-bold text-gray-900\">\r\n                          {formatCurrency(ride.price)}\r\n                        </div>\r\n                        <div className=\"text-xs text-gray-500\">\r\n                          {getPriceLabel(ride.price, rides.map(r => r.price))}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Stats Row */}\r\n                    <div className=\"flex items-center gap-4 mb-3 text-sm\">\r\n                      <div className=\"flex items-center gap-1\">\r\n                        <Star className={`h-4 w-4 fill-current ${getRatingColor(ride.rating)}`} />\r\n                        <span className={`font-semibold ${getRatingColor(ride.rating)}`}>\r\n                          {ride.rating.toFixed(1)}\r\n                        </span>\r\n                        <span className=\"text-gray-500\">\r\n                          ({ride.totalReviews} reviews)\r\n                        </span>\r\n                      </div>\r\n\r\n                      <div className=\"flex items-center gap-1 text-gray-600\">\r\n                        <TrendingUp className=\"h-4 w-4\" />\r\n                        <span>{ride.completedTrips.toLocaleString()} trips</span>\r\n                      </div>\r\n\r\n                      <div className=\"flex items-center gap-1 text-gray-600\">\r\n                        <Clock className=\"h-4 w-4\" />\r\n                        <span>ETA: {ride.estimatedArrival} min</span>\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Vehicle Info */}\r\n                    <div className=\"flex items-center gap-4 mb-3 text-sm\">\r\n                      <span className=\"text-gray-700\">\r\n                        <strong>{ride.vehicle.model}</strong> ‚Ä¢ {ride.vehicle.color} ‚Ä¢ {ride.vehicle.plate}\r\n                      </span>\r\n                      {ride.vehicle.features.length > 0 && (\r\n                        <span className=\"text-gray-500\">\r\n                          {ride.vehicle.features.join(' ‚Ä¢ ')}\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* Badges */}\r\n                    <div className=\"flex flex-wrap gap-2\">\r\n                      {ride.driver.languages.map((lang) => (\r\n                        <span\r\n                          key={lang}\r\n                          className=\"px-2 py-1 bg-blue-100 text-blue-700 text-xs rounded-full\"\r\n                        >\r\n                          {lang}\r\n                        </span>\r\n                      ))}\r\n                      {ride.driver.specialties.map((specialty) => (\r\n                        <span\r\n                          key={specialty}\r\n                          className=\"px-2 py-1 bg-green-100 text-green-700 text-xs rounded-full\"\r\n                        >\r\n                          {specialty}\r\n                        </span>\r\n                      ))}\r\n                      {ride.isPopular && (\r\n                        <span className=\"px-2 py-1 bg-orange-100 text-brand-orange text-xs rounded-full flex items-center gap-1\">\r\n                          <TrendingUp className=\"h-3 w-3\" />\r\n                          Popular Choice\r\n                        </span>\r\n                      )}\r\n                      {ride.driver.isSuperDriver && (\r\n                        <span className=\"px-2 py-1 bg-purple-100 text-purple-700 text-xs rounded-full flex items-center gap-1\">\r\n                          <Shield className=\"h-3 w-3\" />\r\n                          Super Driver\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n\r\n                    {/* Recent Review Snippet */}\r\n                    {ride.latestReview && (\r\n                      <div className=\"mt-3 p-2 bg-gray-50 rounded text-xs text-gray-600 italic border-l-2 border-brand-orange\">\r\n                        &quot;{ride.latestReview.comment}&quot; - {ride.latestReview.author}\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ))\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer Actions */}\r\n        <div className=\"p-4 border-t bg-gray-50 flex flex-wrap justify-between items-center gap-3\">\r\n          <div className=\"flex gap-2\">\r\n            <button\r\n              onClick={onCancel}\r\n              className=\"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 transition-colors text-sm\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            \r\n            {onSkip && (\r\n              <button\r\n                onClick={() => onSkip(rides)}\r\n                className=\"px-4 py-2 border border-brand-orange text-brand-orange rounded-lg hover:bg-orange-50 transition-colors text-sm\"\r\n              >\r\n                Skip for now\r\n              </button>\r\n            )}\r\n          </div>\r\n          \r\n          <button\r\n            onClick={() => selectedRide && onSelectRide(selectedRide)}\r\n            disabled={!selectedRide}\r\n            className=\"px-3 sm:px-6 py-2 bg-brand-orange text-white rounded-lg hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2 text-sm sm:text-base\"\r\n          >\r\n            <CheckCircle2 className=\"h-4 w-4\" />\r\n            Confirm Ride {selectedRide && `- ${formatCurrency(selectedRide.price)}`}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","// Push notification utility for transfer updates\r\n\r\nlet notificationPermission = 'default';\r\n\r\nexport async function requestNotificationPermission() {\r\n  if (!('Notification' in window)) {\r\n    console.warn('[notifications] Not supported in this browser');\r\n    return false;\r\n  }\r\n\r\n  if (Notification.permission === 'granted') {\r\n    notificationPermission = 'granted';\r\n    return true;\r\n  }\r\n\r\n  if (Notification.permission !== 'denied') {\r\n    const permission = await Notification.requestPermission();\r\n    notificationPermission = permission;\r\n    return permission === 'granted';\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nexport function showNotification(title, options = {}) {\r\n  if (notificationPermission !== 'granted') {\r\n    console.warn('[notifications] Permission not granted');\r\n    return;\r\n  }\r\n\r\n  const defaultOptions = {\r\n    icon: '/assets/icons/icon-192x192.png',\r\n    badge: '/assets/icons/icon-96x96.png',\r\n    vibrate: [200, 100, 200],\r\n    tag: 'transfer-notification',\r\n    requireInteraction: false,\r\n    ...options\r\n  };\r\n\r\n  try {\r\n    const notification = new Notification(title, defaultOptions);\r\n    \r\n    notification.onclick = () => {\r\n      window.focus();\r\n      notification.close();\r\n      if (options.onClick) {\r\n        options.onClick();\r\n      }\r\n    };\r\n\r\n    // Auto-close after 10 seconds\r\n    setTimeout(() => notification.close(), 10000);\r\n\r\n    return notification;\r\n  } catch (e) {\r\n    console.error('[notifications] Show failed', e);\r\n  }\r\n}\r\n\r\nexport function notifyTransferStatus(status, request) {\r\n  const notifications = {\r\n    matched: {\r\n      title: '‚úÖ Driver Found!',\r\n      body: 'A driver has been matched to your transfer request.',\r\n      icon: '/assets/icons/icon-192x192.png'\r\n    },\r\n    accepted: {\r\n      title: 'üöó Driver Accepted',\r\n      body: `${request?.driver?.name || 'Your driver'} is preparing to pick you up.`,\r\n      icon: '/assets/icons/icon-192x192.png'\r\n    },\r\n    'en-route': {\r\n      title: 'üõ£Ô∏è Driver En Route',\r\n      body: `${request?.driver?.name || 'Your driver'} is on the way. ETA: ${request?.driver?.eta || '10 min'}`,\r\n      icon: '/assets/icons/icon-192x192.png',\r\n      requireInteraction: true\r\n    },\r\n    arrived: {\r\n      title: 'üìç Driver Arrived!',\r\n      body: `${request?.driver?.name || 'Your driver'} is at your pickup location.`,\r\n      icon: '/assets/icons/icon-192x192.png',\r\n      requireInteraction: true,\r\n      vibrate: [200, 100, 200, 100, 200]\r\n    },\r\n    completed: {\r\n      title: '‚úÖ Trip Completed',\r\n      body: 'Thank you for using CollEco Transfer! Please rate your driver.',\r\n      icon: '/assets/icons/icon-192x192.png'\r\n    }\r\n  };\r\n\r\n  const config = notifications[status];\r\n  if (config) {\r\n    showNotification(config.title, config);\r\n  }\r\n}\r\n\r\nexport function notifyNewMessage(from, message) {\r\n  showNotification('üí¨ New Message', {\r\n    body: `${from}: ${message.slice(0, 100)}${message.length > 100 ? '...' : ''}`,\r\n    tag: 'transfer-chat',\r\n    requireInteraction: false\r\n  });\r\n}\r\n\r\n// Register service worker for push notifications (optional)\r\nexport async function registerPushNotifications() {\r\n  if (!('serviceWorker' in navigator) || !('PushManager' in window)) {\r\n    console.warn('[push] Service Worker or Push API not supported');\r\n    return false;\r\n  }\r\n\r\n  try {\r\n    const registration = await navigator.serviceWorker.ready;\r\n    \r\n    const subscription = await registration.pushManager.subscribe({\r\n      userVisibleOnly: true,\r\n      applicationServerKey: urlBase64ToUint8Array(\r\n        import.meta.env.VITE_VAPID_PUBLIC_KEY || ''\r\n      )\r\n    });\r\n\r\n    // Send subscription to server\r\n    await fetch('/api/push/subscribe', {\r\n      method: 'POST',\r\n      headers: { 'Content-Type': 'application/json' },\r\n      body: JSON.stringify(subscription)\r\n    });\r\n\r\n    return true;\r\n  } catch (e) {\r\n    console.error('[push] Registration failed', e);\r\n    return false;\r\n  }\r\n}\r\n\r\nfunction urlBase64ToUint8Array(base64String) {\r\n  const padding = '='.repeat((4 - base64String.length % 4) % 4);\r\n  const base64 = (base64String + padding)\r\n    .replace(/-/g, '+')\r\n    .replace(/_/g, '/');\r\n\r\n  const rawData = window.atob(base64);\r\n  const outputArray = new Uint8Array(rawData.length);\r\n\r\n  for (let i = 0; i < rawData.length; ++i) {\r\n    outputArray[i] = rawData.charCodeAt(i);\r\n  }\r\n  return outputArray;\r\n}\r\n","import React, { useState } from \"react\";\r\nimport BookingNav from '../components/BookingNav';\r\nimport LiveMap from '../components/LiveMap';\r\nimport TransferChat from '../components/TransferChat';\r\nimport DriverRating from '../components/DriverRating';\r\nimport RideSelector from '../components/RideSelector';\r\nimport { requestNotificationPermission, notifyTransferStatus } from '../utils/notifications';\r\nimport Button from '../components/ui/Button.jsx';\r\nimport { Clock, Car, DollarSign } from 'lucide-react';\r\n\r\nexport default function Transfers() {\r\n  const [pickup, setPickup] = useState(\"\");\r\n  const [dropoff, setDropoff] = useState(\"\");\r\n  const [date, setDate] = useState(\"\");\r\n  const [time, setTime] = useState(\"\");\r\n  const [pax, setPax] = useState(1);\r\n  const [vehicleType, setVehicleType] = useState(\"sedan\"); // sedan, suv, van, luxury\r\n  const [luggage, setLuggage] = useState(1);\r\n  const [specialRequirements, setSpecialRequirements] = useState(\"\");\r\n  const [estimatedPrice, setEstimatedPrice] = useState(null);\r\n  const [bookingType, setBookingType] = useState(\"instant\"); // \"instant\" or \"prearranged\"\r\n  const [isRoundTrip, setIsRoundTrip] = useState(false);\r\n  const [isMultiStop, setIsMultiStop] = useState(false);\r\n  const [returnDate, setReturnDate] = useState(\"\");\r\n  const [returnTime, setReturnTime] = useState(\"\");\r\n  const [additionalStops, setAdditionalStops] = useState([]);\r\n  const [multiDayService, setMultiDayService] = useState(false);\r\n  const [serviceDays, setServiceDays] = useState(1);\r\n  const [recurringDays, setRecurringDays] = useState([]);\r\n  const [request, setRequest] = useState(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const [status, setStatus] = useState(null); // null, 'searching', 'matched', 'accepted', 'en-route', 'arrived', 'completed'\r\n  const [driverLocation, setDriverLocation] = useState(null);\r\n  const [showChat, setShowChat] = useState(false);\r\n  const [previousStatus, setPreviousStatus] = useState(null);\r\n  const [nearbyDrivers, setNearbyDrivers] = useState([]);\r\n  const [loadingNearby, setLoadingNearby] = useState(false);\r\n  const [routeInfo, setRouteInfo] = useState(null);\r\n  const [_formErrors, setFormErrors] = useState({});\r\n  const [showRideSelector, setShowRideSelector] = useState(false);\r\n  const [selectedRide, setSelectedRide] = useState(null);\r\n  const [ridePending, setRidePending] = useState(false);\r\n  const [availableRides, setAvailableRides] = useState([]);\r\n\r\n  React.useEffect(() => {\r\n    if (typeof window !== 'undefined' && typeof window.scrollTo === 'function') {\r\n      window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n    // Request notification permission on load\r\n    requestNotificationPermission();\r\n  }, []);\r\n\r\n  // Auto-update serviceDays based on selected recurring days when multi-day service active\r\n  React.useEffect(() => {\r\n    if (multiDayService) {\r\n      if (recurringDays.length > 0) {\r\n        setServiceDays(recurringDays.length);\r\n      }\r\n    }\r\n  }, [recurringDays, multiDayService]);\r\n\r\n  // Fetch nearby available drivers based on pickup location\r\n  async function fetchNearbyDrivers(location) {\r\n    if (!location || location.length < 3) {\r\n      setNearbyDrivers([]);\r\n      return;\r\n    }\r\n    \r\n    setLoadingNearby(true);\r\n    try {\r\n      const res = await fetch(`/api/transfers/nearby?location=${encodeURIComponent(location)}`);\r\n      const data = await res.json();\r\n      \r\n      if (data.ok && data.drivers) {\r\n        setNearbyDrivers(data.drivers);\r\n      } else {\r\n        setNearbyDrivers([]);\r\n      }\r\n    } catch (e) {\r\n      console.error('[transfers] fetch nearby drivers failed', e);\r\n      setNearbyDrivers([]);\r\n    } finally {\r\n      setLoadingNearby(false);\r\n    }\r\n  }\r\n\r\n  // Watch pickup location and fetch nearby drivers\r\n  React.useEffect(() => {\r\n    const timer = setTimeout(() => {\r\n      fetchNearbyDrivers(pickup);\r\n    }, 500); // Debounce 500ms\r\n    \r\n    return () => clearTimeout(timer);\r\n  }, [pickup]);\r\n\r\n  // Estimate price when route details change\r\n  const estimatePrice = React.useCallback(async () => {\r\n    try {\r\n      const stops = additionalStops.filter(s => s.trim());\r\n      const res = await fetch('/api/transfers/estimate', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ pickup, dropoff, vehicleType, pax, luggage, isRoundTrip, additionalStops: stops })\r\n      });\r\n      const data = await res.json();\r\n      if (data.ok && data.estimate) {\r\n        setEstimatedPrice(data.estimate);\r\n      }\r\n    } catch (e) {\r\n      console.error('[transfers] price estimation failed', e);\r\n    }\r\n  }, [pickup, dropoff, vehicleType, pax, luggage, isRoundTrip, additionalStops]);\r\n\r\n  React.useEffect(() => {\r\n    if (pickup && dropoff && pickup.length > 3 && dropoff.length > 3) {\r\n      const timer = setTimeout(() => {\r\n        estimatePrice();\r\n      }, 800);\r\n      return () => clearTimeout(timer);\r\n    } else {\r\n      setEstimatedPrice(null);\r\n    }\r\n  }, [pickup, dropoff, vehicleType, pax, luggage, isRoundTrip, additionalStops, estimatePrice]);\r\n\r\n  async function cancelRequest() {\r\n    if (!request?.id) return;\r\n    \r\n    const confirmed = confirm('Are you sure you want to cancel this transfer request?');\r\n    if (!confirmed) return;\r\n    \r\n    try {\r\n      const res = await fetch(`/api/transfers/request/${request.id}/cancel`, {\r\n        method: 'POST'\r\n      });\r\n      const data = await res.json();\r\n      if (data.ok) {\r\n        setStatus(null);\r\n        setRequest(null);\r\n        setDriverLocation(null);\r\n        alert('Transfer request cancelled successfully.');\r\n      }\r\n    } catch (e) {\r\n      console.error('[transfers] cancel failed', e);\r\n      alert('Failed to cancel request. Please try again.');\r\n    }\r\n  }\r\n\r\n  async function submitRequest(e) {\r\n    e.preventDefault();\r\n    \r\n    // Validate form\r\n    const errors = {};\r\n    if (!pickup || pickup.length < 3) errors.pickup = 'Please enter a valid pickup location';\r\n    if (!dropoff || dropoff.length < 3) errors.dropoff = 'Please enter a valid dropoff location';\r\n    if (bookingType === 'prearranged' && !date) errors.date = 'Please select a date';\r\n    if (bookingType === 'prearranged' && !time) errors.time = 'Please select a time';\r\n    if (pax < 1 || pax > 12) errors.pax = 'Passengers must be between 1 and 12';\r\n    if (luggage < 0 || luggage > 20) errors.luggage = 'Luggage count must be between 0 and 20';\r\n    \r\n    if (Object.keys(errors).length > 0) {\r\n      setFormErrors(errors);\r\n      return;\r\n    }\r\n    \r\n    setFormErrors({});\r\n    \r\n    // Show ride selector for user to pick their preferred ride\r\n    setShowRideSelector(true);\r\n  }\r\n\r\n  function handleSkipRideSelection(rides) {\r\n    // User chose to skip ride selection for now\r\n    setAvailableRides(rides);\r\n    setShowRideSelector(false);\r\n    setRidePending(true);\r\n    setSelectedRide(null);\r\n  }\r\n\r\n  async function autoAssignCheapestRide() {\r\n    if (!availableRides || availableRides.length === 0) {\r\n      alert('No available rides to assign. Please try again.');\r\n      return;\r\n    }\r\n\r\n    // Find the cheapest ride\r\n    const cheapestRide = availableRides.reduce((min, ride) => \r\n      ride.price < min.price ? ride : min\r\n    );\r\n\r\n    await confirmRideSelection(cheapestRide);\r\n  }\r\n\r\n  function reopenRideSelector() {\r\n    setRidePending(false);\r\n    setShowRideSelector(true);\r\n  }\r\n\r\n  async function confirmRideSelection(ride) {\r\n    setSelectedRide(ride);\r\n    setShowRideSelector(false);\r\n    setRidePending(false);\r\n    setLoading(true);\r\n    setStatus('searching');\r\n    \r\n    try {\r\n      const payload = {\r\n        pickup,\r\n        dropoff,\r\n        date: bookingType === 'instant' ? new Date().toISOString() : date,\r\n        time: bookingType === 'instant' ? new Date().toISOString() : time,\r\n        pax,\r\n        vehicleType,\r\n        luggage,\r\n        specialRequirements: specialRequirements.trim(),\r\n        bookingType,\r\n        isRoundTrip,\r\n        isMultiStop,\r\n        additionalStops: isMultiStop ? additionalStops.filter(s => s.trim()) : [],\r\n        returnDate: isRoundTrip ? returnDate : null,\r\n        returnTime: isRoundTrip ? returnTime : null,\r\n        multiDayService,\r\n        serviceDays: multiDayService ? serviceDays : 1,\r\n        recurringDays: multiDayService ? recurringDays : [],\r\n        // Include selected ride details\r\n        selectedRide: {\r\n          rideId: ride.id,\r\n          driverId: ride.driver.id,\r\n          driverName: ride.driver.name,\r\n          brandId: ride.brand.id,\r\n          brandName: ride.brand.name,\r\n          vehicleModel: ride.vehicle.model,\r\n          vehiclePlate: ride.vehicle.plate,\r\n          agreedPrice: ride.price\r\n        }\r\n      };\r\n      \r\n      const res = await fetch('/api/transfers/request', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(payload)\r\n      });\r\n      \r\n      const data = await res.json();\r\n      \r\n      if (data.ok) {\r\n        setRequest(data.request);\r\n        setStatus('matched');\r\n        \r\n        // Poll for status updates\r\n        pollStatus(data.request.id);\r\n      } else {\r\n        setStatus('error');\r\n      }\r\n    } catch (e) {\r\n      console.error('[transfers] request failed', e);\r\n      setStatus('error');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n  \r\n  async function pollStatus(requestId) {\r\n    const interval = setInterval(async () => {\r\n      try {\r\n        const res = await fetch(`/api/transfers/request/${requestId}`);\r\n        const data = await res.json();\r\n        \r\n        if (data.ok && data.request) {\r\n          setRequest(data.request);\r\n          const newStatus = data.request.status;\r\n          \r\n          // Trigger notification on status change\r\n          if (newStatus !== previousStatus && newStatus !== 'searching') {\r\n            notifyTransferStatus(newStatus, data.request);\r\n            setPreviousStatus(newStatus);\r\n          }\r\n          \r\n          setStatus(newStatus);\r\n          \r\n          // Update driver location if available\r\n          if (data.request.driverLocation) {\r\n            setDriverLocation(data.request.driverLocation);\r\n          }\r\n          \r\n          if (newStatus === 'completed' || newStatus === 'cancelled') {\r\n            clearInterval(interval);\r\n          }\r\n        }\r\n      } catch (e) {\r\n        console.error('[transfers] status poll failed', e);\r\n      }\r\n    }, 3000);\r\n    \r\n    // Clear after 5 minutes\r\n    setTimeout(() => clearInterval(interval), 300000);\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-cream min-h-screen overflow-x-hidden\">\r\n      <div className=\"max-w-6xl mx-auto px-4 sm:px-6 py-8\">\r\n      <BookingNav />\r\n      {/* Hero */}\r\n      <div className=\"mb-8\">\r\n        <h1 className=\"text-3xl sm:text-4xl font-bold tracking-tight text-brand-brown\">Shuttle & Transfers</h1>\r\n        <p className=\"mt-2 text-sm sm:text-base text-brand-russty max-w-prose\">Request instant or scheduled transport, multi-stop journeys, and monitor live driver progress.</p>\r\n      </div>\r\n\r\n      {/* Booking Type Selection */}\r\n      <div className=\"bg-white rounded-xl shadow-sm border border-cream-border p-6 mb-6\">\r\n        <h2 className=\"text-lg font-bold text-brand-brown mb-4\">Booking Type</h2>\r\n        <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3\">\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => setBookingType('instant')}\r\n            className={`p-4 rounded-lg border-2 transition-all ${\r\n              bookingType === 'instant'\r\n                ? 'border-brand-orange bg-brand-orange/5 shadow-sm'\r\n                : 'border-cream-border hover:border-brand-orange/50 hover:bg-cream'\r\n            }`}\r\n          >\r\n            <div className=\"text-center\">\r\n              <div className=\"text-sm font-semibold text-brand-brown\">Instant Request</div>\r\n              <div className=\"text-xs text-brand-russty mt-1\">Book now</div>\r\n            </div>\r\n          </button>\r\n          <button\r\n            type=\"button\"\r\n            onClick={() => setBookingType('prearranged')}\r\n            className={`p-4 rounded-lg border-2 transition-all ${\r\n              bookingType === 'prearranged'\r\n                ? 'border-brand-orange bg-brand-orange/5 shadow-sm'\r\n                : 'border-cream-border hover:border-brand-orange/50 hover:bg-cream'\r\n            }`}\r\n          >\r\n            <div className=\"text-center\">\r\n              <div className=\"text-sm font-semibold text-brand-brown\">Prearranged</div>\r\n              <div className=\"text-xs text-brand-russty mt-1\">Schedule ahead</div>\r\n            </div>\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Multi-Day Service */}\r\n      {bookingType === 'prearranged' && (\r\n        <div className=\"bg-white rounded-xl shadow-sm border border-cream-border p-6 mb-6\">\r\n          <h3 className=\"text-lg font-bold text-brand-brown mb-4\">Multi-Day Service</h3>\r\n          <label className=\"flex items-center gap-3 cursor-pointer mb-6\">\r\n            <input \r\n              type=\"checkbox\" \r\n              checked={multiDayService}\r\n              onChange={e => setMultiDayService(e.target.checked)}\r\n              className=\"w-5 h-5 accent-brand-orange rounded\"\r\n            />\r\n            <div>\r\n              <span className=\"font-semibold text-brand-brown\">Enable Multi-Day Booking</span>\r\n              <p className=\"text-sm text-brand-russty\">Book recurring shuttle service for multiple days (discounts apply)</p>\r\n            </div>\r\n          </label>\r\n          \r\n          {multiDayService && (\r\n            <div className=\"space-y-5 pt-4 border-t border-cream-border\">\r\n              <div>\r\n                <label className=\"block mb-2 text-sm font-semibold text-brand-brown\">Number of Days</label>\r\n                {recurringDays.length > 0 ? (\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"px-4 py-2 rounded-lg border-2 border-brand-orange bg-brand-orange/5 text-brand-brown font-semibold w-20 text-center\">\r\n                      {serviceDays}\r\n                    </div>\r\n                    <span className=\"text-sm text-brand-russty\">auto from selected days</span>\r\n                  </div>\r\n                ) : (\r\n                  <input \r\n                    type=\"number\"\r\n                    min={2}\r\n                    max={30}\r\n                    value={serviceDays}\r\n                    onChange={e => setServiceDays(Number(e.target.value))}\r\n                    className=\"w-32 border-2 border-cream-border rounded-lg px-3 py-2 focus:border-brand-orange focus:outline-none transition-colors\"\r\n                  />\r\n                )}\r\n              </div>\r\n              <div>\r\n                <label className=\"block mb-3 text-sm font-semibold text-brand-brown\">Recurring Days <span className=\"text-brand-russty font-normal\">(Optional)</span></label>\r\n                <div className=\"flex gap-2 flex-wrap\">\r\n                  {['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'].map((day, idx) => (\r\n                    <button\r\n                      key={day}\r\n                      type=\"button\"\r\n                      onClick={() => {\r\n                        if (recurringDays.includes(idx)) {\r\n                          setRecurringDays(recurringDays.filter(d => d !== idx));\r\n                        } else {\r\n                          setRecurringDays([...recurringDays, idx]);\r\n                        }\r\n                      }}\r\n                      className={`px-4 py-2 rounded-lg text-sm font-semibold transition-all ${\r\n                        recurringDays.includes(idx)\r\n                          ? 'bg-brand-orange text-white shadow-sm'\r\n                          : 'border-2 border-cream-border text-brand-brown hover:border-brand-orange/50 hover:bg-cream'\r\n                      }`}\r\n                    >\r\n                      {day}\r\n                    </button>\r\n                  ))}\r\n                </div>\r\n                <p className=\"text-xs text-brand-russty mt-2\">Select specific days for recurring service</p>\r\n              </div>\r\n              <div className=\"p-4 bg-green-50 border-2 border-green-200 rounded-lg\">\r\n                <p className=\"text-sm text-green-800\">\r\n                  <strong>Multi-day discount:</strong> {serviceDays >= 7 ? '20%' : serviceDays >= 3 ? '15%' : '10%'} off\r\n                </p>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n      \r\n      <form className=\"space-y-6\" onSubmit={submitRequest}>\r\n        {/* Journey Details Card */}\r\n        <div className=\"bg-white rounded-xl shadow-sm border border-cream-border p-6\">\r\n          <h2 className=\"text-lg font-bold text-brand-brown mb-6\">Journey Details</h2>\r\n          \r\n          <div className=\"space-y-5\">\r\n            <div>\r\n              <label className=\"block mb-2 text-sm font-semibold text-brand-brown\">Pickup Location</label>\r\n              <input \r\n                type=\"text\" \r\n                value={pickup} \r\n                onChange={e => setPickup(e.target.value)} \r\n                required \r\n                className=\"w-full border-2 border-cream-border rounded-lg px-3 py-2 focus:border-brand-orange focus:outline-none transition-colors\" \r\n                placeholder=\"e.g. King Shaka Airport\" \r\n              />\r\n            </div>\r\n            \r\n            {/* Nearby Shuttles Map */}\r\n            {pickup && pickup.length >= 3 && !status && (\r\n              <div className=\"space-y-3\">\r\n                <h3 className=\"text-sm font-semibold text-brand-brown\">\r\n                  {loadingNearby ? 'Finding nearby shuttles...' : `${nearbyDrivers.length} shuttle${nearbyDrivers.length !== 1 ? 's' : ''} available near you`}\r\n                </h3>\r\n                <div className=\"border-2 border-cream-border rounded-lg overflow-hidden\">\r\n                  <LiveMap \r\n                    pickup={pickup}\r\n                    nearbyDrivers={nearbyDrivers}\r\n                    showRoute={false}\r\n                    height=\"300px\"\r\n                  />\r\n                </div>\r\n                {nearbyDrivers.length > 0 && (\r\n                  <div className=\"p-3 bg-green-50 border-2 border-green-200 rounded-lg\">\r\n                    <p className=\"text-green-800 text-sm\">\r\n                      <strong>Shuttles available in your area.</strong> Average ETA: {Math.min(...nearbyDrivers.map(d => d.eta || 10))} min\r\n                    </p>\r\n                  </div>\r\n                )}\r\n                {!loadingNearby && nearbyDrivers.length === 0 && (\r\n                  <div className=\"p-3 bg-yellow-50 border-2 border-yellow-200 rounded-lg\">\r\n                    <p className=\"text-yellow-800 text-sm\">\r\n                      <strong>No shuttles currently in this area.</strong> You can still submit a request and we&apos;ll notify nearby drivers.\r\n                    </p>\r\n                  </div>\r\n                )}\r\n              </div>\r\n            )}\r\n            \r\n            <div>\r\n              <label className=\"block mb-2 text-sm font-semibold text-brand-brown\">Dropoff Location</label>\r\n              <input \r\n                type=\"text\" \r\n                value={dropoff} \r\n                onChange={e => setDropoff(e.target.value)} \r\n                required \r\n                className=\"w-full border-2 border-cream-border rounded-lg px-3 py-2 focus:border-brand-orange focus:outline-none transition-colors\" \r\n                placeholder=\"e.g. Oyster Box Hotel\" \r\n              />\r\n            </div>\r\n\r\n            {/* Multi-stop Journey Checkbox - Available for all booking types */}\r\n            <div className=\"pt-2\">\r\n              <label className=\"flex items-center gap-3 cursor-pointer\">\r\n                <input \r\n                  type=\"checkbox\" \r\n                  checked={isMultiStop}\r\n                  onChange={e => {\r\n                    setIsMultiStop(e.target.checked);\r\n                    if (!e.target.checked) setAdditionalStops([]);\r\n                  }}\r\n                  className=\"w-5 h-5 accent-brand-orange rounded\"\r\n                />\r\n                <div>\r\n                  <span className=\"font-semibold text-brand-brown\">Add Multiple Stops</span>\r\n                  <p className=\"text-sm text-brand-russty\">Visit multiple locations in one trip</p>\r\n                </div>\r\n              </label>\r\n            </div>\r\n            \r\n            {/* Multi-stop Journey */}\r\n            {isMultiStop && (\r\n          <div className=\"space-y-4 pt-4 border-t border-cream-border\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <label className=\"text-sm font-semibold text-brand-brown\">Additional Stops</label>\r\n              <Button\r\n                type=\"button\"\r\n                size=\"sm\"\r\n                onClick={() => setAdditionalStops([...additionalStops, ''])}\r\n                disabled={additionalStops.length >= 5}\r\n              >Add Stop</Button>\r\n            </div>\r\n            \r\n            {additionalStops.map((stop, index) => (\r\n              <div key={index} className=\"flex gap-2 items-center\">\r\n                <span className=\"text-sm font-semibold text-brand-russty w-6\">{index + 1}.</span>\r\n                <input\r\n                  type=\"text\"\r\n                  value={stop}\r\n                  onChange={e => {\r\n                    const newStops = [...additionalStops];\r\n                    newStops[index] = e.target.value;\r\n                    setAdditionalStops(newStops);\r\n                  }}\r\n                  className=\"flex-1 border-2 border-cream-border rounded-lg px-3 py-2 focus:border-brand-orange focus:outline-none transition-colors\"\r\n                  placeholder={`Stop ${index + 1} location`}\r\n                />\r\n                <Button\r\n                  type=\"button\"\r\n                  size=\"sm\"\r\n                  variant=\"danger\"\r\n                  onClick={() => setAdditionalStops(additionalStops.filter((_, i) => i !== index))}\r\n                >‚úï</Button>\r\n              </div>\r\n            ))}\r\n            \r\n            {additionalStops.length > 0 && (\r\n              <div className=\"p-3 bg-blue-50 border-2 border-blue-200 rounded-lg\">\r\n                <p className=\"text-sm text-blue-800\">\r\n                  <strong>Total stops:</strong> {additionalStops.length + 2} (Pickup ‚Üí {additionalStops.length} stop{additionalStops.length !== 1 ? 's' : ''} ‚Üí Dropoff)\r\n                </p>\r\n              </div>\r\n            )}\r\n          </div>\r\n        )}\r\n\r\n            {/* Round Trip Checkbox - Available for all booking types */}\r\n            <div className=\"pt-2\">\r\n              <label className=\"flex items-center gap-3 cursor-pointer\">\r\n                <input \r\n                  type=\"checkbox\" \r\n                  checked={isRoundTrip}\r\n                  onChange={e => setIsRoundTrip(e.target.checked)}\r\n                  className=\"w-5 h-5 accent-brand-orange rounded\"\r\n                />\r\n                <div>\r\n                  <span className=\"font-semibold text-brand-brown\">Round Trip</span>\r\n                  <p className=\"text-sm text-brand-russty\">Add a return journey (15% discount)</p>\r\n                </div>\r\n              </label>\r\n            </div>\r\n\r\n            {/* Date & Time for Prearranged */}\r\n            {bookingType === 'prearranged' && (\r\n              <>\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-2\">\r\n                  <div>\r\n                    <label className=\"block mb-2 text-sm font-semibold text-brand-brown\">Pickup Date</label>\r\n                    <input \r\n                      type=\"date\" \r\n                      value={date} \r\n                      onChange={e => setDate(e.target.value)} \r\n                      required \r\n                      className=\"w-full border-2 border-cream-border rounded-lg px-3 py-2 focus:border-brand-orange focus:outline-none transition-colors\" \r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block mb-2 text-sm font-semibold text-brand-brown\">Pickup Time</label>\r\n                    <input \r\n                      type=\"time\" \r\n                      value={time} \r\n                      onChange={e => setTime(e.target.value)} \r\n                      required \r\n                      className=\"w-full border-2 border-cream-border rounded-lg px-3 py-2 focus:border-brand-orange focus:outline-none transition-colors\" \r\n                    />\r\n                  </div>\r\n                </div>\r\n\r\n              </>\r\n            )}\r\n\r\n            {/* Return Journey Details - Available when Round Trip is checked */}\r\n            {isRoundTrip && (\r\n              <div className=\"space-y-4 pt-4 border-t border-cream-border\">\r\n                <h3 className=\"text-sm font-bold text-brand-brown\">Return Journey</h3>\r\n                <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-4\">\r\n                  <div>\r\n                    <label className=\"block mb-2 text-sm font-semibold text-brand-brown\">Return Date</label>\r\n                    <input \r\n                      type=\"date\" \r\n                      value={returnDate} \r\n                      onChange={e => setReturnDate(e.target.value)} \r\n                      required={bookingType === 'prearranged'}\r\n                      min={date}\r\n                      className=\"w-full border-2 border-cream-border rounded-lg px-3 py-2 focus:border-brand-orange focus:outline-none transition-colors\" \r\n                    />\r\n                  </div>\r\n                  <div>\r\n                    <label className=\"block mb-2 text-sm font-semibold text-brand-brown\">Return Time</label>\r\n                    <input \r\n                      type=\"time\" \r\n                      value={returnTime} \r\n                      onChange={e => setReturnTime(e.target.value)} \r\n                      required={bookingType === 'prearranged'}\r\n                      className=\"w-full border-2 border-cream-border rounded-lg px-3 py-2 focus:border-brand-orange focus:outline-none transition-colors\" \r\n                    />\r\n                  </div>\r\n                </div>\r\n                <div className=\"p-3 bg-green-50 border-2 border-green-200 rounded-lg\">\r\n                  <p className=\"text-sm text-green-800\">\r\n                    <strong>Round trip discount:</strong> 15% off total fare\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            )}\r\n            \r\n            <div className=\"pt-2\">\r\n              <label className=\"block mb-2 text-sm font-semibold text-brand-brown\">Passengers</label>\r\n              <input \r\n                type=\"number\" \r\n                min={1} \r\n                max={12} \r\n                value={pax} \r\n                onChange={e => setPax(Number(e.target.value))} \r\n                required \r\n                className=\"w-32 border-2 border-cream-border rounded-lg px-3 py-2 focus:border-brand-orange focus:outline-none transition-colors\" \r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Vehicle Type Selection */}\r\n          <div className=\"space-y-2\">\r\n            <label className=\"block text-sm font-medium text-brand-brown\">\r\n              Vehicle Type *\r\n            </label>\r\n            <select\r\n              value={vehicleType}\r\n              onChange={e => setVehicleType(e.target.value)}\r\n              required\r\n              className=\"w-full border-2 border-cream-border rounded-lg px-3 py-2 focus:border-brand-orange focus:outline-none transition-colors\"\r\n              aria-label=\"Select vehicle type\"\r\n            >\r\n              <option value=\"sedan\">Sedan (1-4 passengers)</option>\r\n              <option value=\"suv\">SUV (1-6 passengers)</option>\r\n              <option value=\"van\">Van/Minibus (7-12 passengers)</option>\r\n              <option value=\"luxury\">Luxury Sedan (1-4 passengers)</option>\r\n            </select>\r\n          </div>\r\n\r\n          {/* Luggage Count */}\r\n          <div className=\"flex gap-4\">\r\n            <div className=\"flex-1 space-y-2\">\r\n              <label htmlFor=\"luggage\" className=\"block text-sm font-medium text-brand-brown\">\r\n                Luggage Pieces\r\n              </label>\r\n              <input \r\n                id=\"luggage\"\r\n                type=\"number\" \r\n                min={0}\r\n                max={20}\r\n                value={luggage}\r\n                onChange={e => setLuggage(Number(e.target.value))}\r\n                className=\"w-full border-2 border-cream-border rounded-lg px-3 py-2 focus:border-brand-orange focus:outline-none transition-colors\"\r\n                aria-label=\"Number of luggage pieces\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Special Requirements */}\r\n          <div className=\"space-y-2\">\r\n            <label htmlFor=\"specialRequirements\" className=\"block text-sm font-medium text-brand-brown\">\r\n              Special Requirements <span className=\"text-gray-500 text-xs\">(optional)</span>\r\n            </label>\r\n            <textarea\r\n              id=\"specialRequirements\"\r\n              value={specialRequirements}\r\n              onChange={e => setSpecialRequirements(e.target.value)}\r\n              placeholder=\"Child seat, wheelchair accessible, pet friendly, etc.\"\r\n              rows={2}\r\n              maxLength={200}\r\n              className=\"w-full border-2 border-cream-border rounded-lg px-3 py-2 focus:border-brand-orange focus:outline-none transition-colors resize-none\"\r\n              aria-label=\"Special requirements for the transfer\"\r\n            />\r\n            <p className=\"text-xs text-gray-500\">{specialRequirements.length}/200 characters</p>\r\n          </div>\r\n\r\n          {/* Price Estimate */}\r\n          {estimatedPrice && (\r\n            <div className=\"p-4 bg-cream-sand border-2 border-brand-orange rounded-lg\">\r\n              <div className=\"flex items-center justify-between\">\r\n                <div>\r\n                  <p className=\"text-sm text-brand-brown font-medium\">Estimated Price</p>\r\n                  <p className=\"text-xs text-gray-600 mt-1\">Final price may vary based on traffic and actual route</p>\r\n                </div>\r\n                <div className=\"text-right\">\r\n                  <p className=\"text-2xl font-bold text-brand-orange\">R{estimatedPrice.amount}</p>\r\n                  {estimatedPrice.distance && (\r\n                    <p className=\"text-xs text-gray-600\">{estimatedPrice.distance} km ‚Ä¢ {estimatedPrice.duration}</p>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n        \r\n        <Button \r\n          type=\"submit\" \r\n          fullWidth\r\n          disabled={loading}\r\n        >\r\n          {loading ? \"Sending Request...\" : bookingType === 'instant' ? \"Request Now\" : \"Schedule Transfer\"}\r\n        </Button>\r\n      </form>\r\n      \r\n      {/* Pending Transfer - Awaiting Ride Selection */}\r\n      {ridePending && !status && (\r\n        <div className=\"mt-10 p-6 border-2 border-brand-orange rounded-lg bg-orange-50 shadow-sm\">\r\n          <div className=\"flex items-start gap-3 mb-4\">\r\n            <div className=\"w-10 h-10 rounded-full bg-brand-orange flex items-center justify-center flex-shrink-0\">\r\n              <Clock className=\"h-5 w-5 text-white\" />\r\n            </div>\r\n            <div className=\"flex-1\">\r\n              <h2 className=\"font-bold text-lg text-brand-brown mb-1\">\r\n                Transfer Pending - Finalize Your Ride\r\n              </h2>\r\n              <p className=\"text-sm text-brand-russty\">\r\n                Your transfer details are saved. Choose your preferred ride to proceed.\r\n              </p>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Transfer Summary */}\r\n          <div className=\"bg-white rounded-lg p-4 mb-4 border border-cream-border\">\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm\">\r\n              <div>\r\n                <p className=\"text-xs text-gray-500 mb-1\">Pickup</p>\r\n                <p className=\"font-semibold text-brand-brown\">{pickup}</p>\r\n              </div>\r\n              <div>\r\n                <p className=\"text-xs text-gray-500 mb-1\">Dropoff</p>\r\n                <p className=\"font-semibold text-brand-brown\">{dropoff}</p>\r\n              </div>\r\n              <div>\r\n                <p className=\"text-xs text-gray-500 mb-1\">Passengers</p>\r\n                <p className=\"font-semibold text-brand-brown\">{pax} passenger{pax !== 1 ? 's' : ''}</p>\r\n              </div>\r\n              <div>\r\n                <p className=\"text-xs text-gray-500 mb-1\">Vehicle Type</p>\r\n                <p className=\"font-semibold text-brand-brown capitalize\">{vehicleType}</p>\r\n              </div>\r\n              {estimatedPrice && (\r\n                <div className=\"col-span-full\">\r\n                  <p className=\"text-xs text-gray-500 mb-1\">Estimated Price Range</p>\r\n                  <p className=\"font-bold text-brand-orange text-lg\">R{estimatedPrice.amount}</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Action Buttons */}\r\n          <div className=\"space-y-3\">\r\n            <Button\r\n              fullWidth\r\n              onClick={reopenRideSelector}\r\n              className=\"flex items-center justify-center gap-2\"\r\n            >\r\n              <Car className=\"h-4 w-4\" />\r\n              Pick My Ride\r\n            </Button>\r\n            \r\n            <Button\r\n              fullWidth\r\n              variant=\"outline\"\r\n              onClick={autoAssignCheapestRide}\r\n              className=\"flex items-center justify-center gap-2 border-brand-orange text-brand-orange hover:bg-orange-50\"\r\n            >\r\n              <DollarSign className=\"h-4 w-4\" />\r\n              Auto-assign Cheapest Ride\r\n            </Button>\r\n            \r\n            <p className=\"text-xs text-center text-gray-600 mt-2\">\r\n              You can also proceed with other bookings and finalize this transfer later.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      )}\r\n      \r\n      {/* Status Updates */}\r\n      {status && (\r\n        <div className=\"mt-10 p-5 border border-cream-border rounded-lg bg-white shadow-sm\">\r\n          <div className=\"flex items-center gap-3 mb-4\">\r\n            <div className={`w-3 h-3 rounded-full ${\r\n              status === 'searching' ? 'bg-yellow-500 animate-pulse' :\r\n              status === 'matched' || status === 'accepted' ? 'bg-brand-orange' :\r\n              status === 'en-route' ? 'bg-brand-gold animate-pulse' :\r\n              status === 'arrived' ? 'bg-cream-sand' :\r\n              status === 'completed' ? 'bg-brand-brown' :\r\n              'bg-brand-russty'\r\n            }`}></div>\r\n            <h2 className=\"font-bold text-lg text-brand-brown\">\r\n              {status === 'searching' && 'üîç Finding available drivers...'}\r\n              {status === 'matched' && '‚úÖ Driver matched!'}\r\n              {status === 'accepted' && '‚úÖ Driver accepted your request'}\r\n              {status === 'en-route' && 'üöó Driver is on the way'}\r\n              {status === 'arrived' && 'üìç Driver has arrived'}\r\n              {status === 'completed' && '‚úÖ Trip completed'}\r\n              {status === 'error' && '‚ùå Request failed'}\r\n            </h2>\r\n          </div>\r\n          \r\n          {request && request.driver && (\r\n            <div className=\"space-y-2 text-sm\">\r\n              <p><span className=\"font-semibold\">Driver:</span> {request.driver.name}</p>\r\n              <p><span className=\"font-semibold\">Vehicle:</span> {request.driver.vehicle} ({request.driver.plate})</p>\r\n              <p><span className=\"font-semibold\">Vehicle Type:</span> {vehicleType.charAt(0).toUpperCase() + vehicleType.slice(1)}</p>\r\n              <p><span className=\"font-semibold\">Passengers:</span> {pax} | <span className=\"font-semibold\">Luggage:</span> {luggage} pieces</p>\r\n              <p><span className=\"font-semibold\">ETA:</span> {request.driver.eta || 'Calculating...'}</p>\r\n              <p><span className=\"font-semibold\">Price:</span> R{request.price}</p>\r\n              {specialRequirements && (\r\n                <p><span className=\"font-semibold\">Special Requirements:</span> {specialRequirements}</p>\r\n              )}\r\n              \r\n              {/* Live Map */}\r\n              {(status === 'matched' || status === 'accepted' || status === 'en-route' || status === 'arrived') && (\r\n                <div className=\"mt-4\">\r\n                  <LiveMap \r\n                    pickup={request.pickup} \r\n                    dropoff={request.dropoff} \r\n                    driverLocation={driverLocation}\r\n                    waypoints={request.additionalStops || []}\r\n                    showRoute={true}\r\n                    onRouteInfo={setRouteInfo}\r\n                  />\r\n                  {routeInfo && (\r\n                    <div className=\"mt-2 p-3 bg-white border border-cream-border rounded\">\r\n                      <div className=\"text-xs text-brand-brown flex gap-4 flex-wrap\">\r\n                        <span><span className=\"font-semibold\">Distance:</span> {(routeInfo.distanceMeters/1000).toFixed(1)} km</span>\r\n                        <span><span className=\"font-semibold\">Duration:</span> {routeInfo.durationText || `${Math.round(routeInfo.durationSeconds/60)} min`}</span>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n                  {request.additionalStops && request.additionalStops.length > 0 && (\r\n                    <div className=\"mt-2 p-2 bg-cream-sand border border-cream-border rounded\">\r\n                      <p className=\"text-xs text-brand-brown\">\r\n                        üìç Multi-stop route with {request.additionalStops.length} additional stop{request.additionalStops.length !== 1 ? 's' : ''}\r\n                      </p>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n              \r\n              {/* Action Buttons */}\r\n              {(status === 'searching' || status === 'matched') && (\r\n                <div className=\"mt-4\">\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    fullWidth\r\n                    onClick={cancelRequest}\r\n                    className=\"border-red-500 text-red-600 hover:bg-red-50\"\r\n                  >\r\n                    ‚ùå Cancel Request\r\n                  </Button>\r\n                </div>\r\n              )}\r\n              \r\n              {/* Chat Button */}\r\n              {(status === 'accepted' || status === 'en-route' || status === 'arrived') && (\r\n                <div className=\"mt-4 flex gap-2\">\r\n                  <Button\r\n                    className=\"flex-1\"\r\n                    onClick={() => setShowChat(!showChat)}\r\n                  >\r\n                    üí¨ {showChat ? 'Hide Chat' : 'Chat with Driver'}\r\n                  </Button>\r\n                  <Button variant=\"outline\">üìû Call</Button>\r\n                </div>\r\n              )}\r\n              \r\n              {/* Chat Component */}\r\n              {showChat && request.id && (\r\n                <div className=\"mt-4 h-96\">\r\n                  <TransferChat requestId={request.id} role=\"customer\" />\r\n                </div>\r\n              )}\r\n              \r\n              {status === 'accepted' && (\r\n                <div className=\"mt-4 p-3 bg-cream-sand rounded border border-cream-border\">\r\n                  <p className=\"text-brand-brown text-xs\">Driver is preparing to pick you up. You&apos;ll receive updates as they approach.</p>\r\n                </div>\r\n              )}\r\n              \r\n              {status === 'en-route' && (\r\n                <div className=\"mt-4 p-3 bg-amber-100 rounded border border-brand-gold\">\r\n                  <p className=\"text-brand-brown text-xs\">Driver is en route to your pickup location. ETA: {request.driver.eta}</p>\r\n                </div>\r\n              )}\r\n              \r\n              {status === 'arrived' && (\r\n                <div className=\"mt-4 p-3 bg-cream-sand rounded border border-cream-border\">\r\n                  <p className=\"text-brand-brown text-xs font-semibold\">Driver has arrived at your pickup location!</p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n          \r\n          {status === 'searching' && (\r\n            <p className=\"text-sm text-gray-600\">We&apos;re notifying all available drivers in your area. This may take a moment...</p>\r\n          )}\r\n          \r\n          {/* Rating Component after completion */}\r\n          {status === 'completed' && request.driver && (\r\n            <div className=\"mt-4\">\r\n              <DriverRating \r\n                requestId={request.id} \r\n                driver={request.driver}\r\n                onSubmit={() => {\r\n                  // Reload or navigate to history\r\n                }}\r\n              />\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* AI-First Support Section */}\r\n      {selectedRide && (\r\n        <div className=\"bg-white rounded-xl shadow-sm border border-cream-border p-6 mt-6\">\r\n          <h2 className=\"text-lg font-bold text-brand-brown mb-4\">Transfer Terms & Conditions</h2>\r\n          <div className=\"space-y-4 mb-6\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div>\r\n                <p className=\"font-semibold text-brand-brown mb-1\">Cancellation Policy</p>\r\n                <ul className=\"list-disc list-inside space-y-1 text-xs\">\r\n                  <li>Free cancellation up to 2 hours before pickup</li>\r\n                  <li>50% refund for cancellations 30min-2 hours before pickup</li>\r\n                  <li>No refund for cancellations within 30 minutes of pickup</li>\r\n                </ul>\r\n              </div>\r\n              <div>\r\n                <p className=\"font-semibold text-brand-brown mb-1\">Payment Terms</p>\r\n                <ul className=\"list-disc list-inside space-y-1 text-xs\">\r\n                  <li>Full payment required at time of booking</li>\r\n                  <li>Loyalty discounts apply for round-trip and multi-day bookings</li>\r\n                  <li>Prices include all taxes and service fees</li>\r\n                </ul>\r\n              </div>\r\n              <div>\r\n                <p className=\"font-semibold text-brand-brown mb-1\">Transfer Provider Policies</p>\r\n                <ul className=\"list-disc list-inside space-y-1 text-xs\">\r\n                  <li>Valid ID required for all passengers</li>\r\n                  <li>Vehicle capacity limits strictly enforced</li>\r\n                  <li>Driver may refuse service if safety requirements not met</li>\r\n                  <li>Additional luggage surcharges may apply</li>\r\n                </ul>\r\n              </div>\r\n              <div>\r\n                <p className=\"font-semibold text-brand-brown mb-1\">Important Information</p>\r\n                <ul className=\"list-disc list-inside space-y-1 text-xs\">\r\n                  <li>Be ready 10 minutes before scheduled pickup</li>\r\n                  <li>Contact driver immediately if running late</li>\r\n                  <li>Multi-stop routes: Specify order and time at each stop</li>\r\n                  <li>Lost items: Report to driver immediately</li>\r\n                </ul>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Contact Information - Separated by Purpose */}\r\n          <div className=\"border-t pt-6\">\r\n            <h3 className=\"text-lg font-bold text-brand-brown mb-3\">Need Assistance?</h3>\r\n            \r\n            {/* Driver Contact - For During Transfer */}\r\n            <div className=\"mb-4 bg-green-50 border border-green-200 rounded-lg p-4\">\r\n              <div className=\"flex items-center gap-2 mb-2\">\r\n                <svg className=\"h-5 w-5 text-green-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6\" />\r\n                </svg>\r\n                <h4 className=\"font-semibold text-green-900\">During Transfer - Contact Driver Directly</h4>\r\n              </div>\r\n              <p className=\"text-sm text-green-800 mb-3\">For pickup coordination, delays, or route questions:</p>\r\n              <div className=\"text-sm\">\r\n                <p className=\"text-green-700 font-medium\">Driver: {selectedRide.driver.name}</p>\r\n                <p className=\"text-green-600\">Contact via in-app chat or phone once matched</p>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Zola - Primary Support */}\r\n            <div className=\"bg-orange-50 border-2 border-brand-orange rounded-lg p-4 mb-4\">\r\n              <div className=\"flex items-center gap-2 mb-2\">\r\n                <svg className=\"h-6 w-6 text-brand-orange\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z\" />\r\n                </svg>\r\n                <h4 className=\"font-semibold text-brand-brown text-lg\">Zola - 24/7 Instant Help</h4>\r\n              </div>\r\n              <p className=\"text-sm text-brand-brown mb-3\">\r\n                Get instant answers about your booking, changes, cancellations, refunds, payment issues, and recommendations. \r\n                Zola handles most requests immediately and routes complex issues to the right specialist.\r\n              </p>\r\n              <button \r\n                onClick={() => {\r\n                  // Trigger AIAgent to open via custom event\r\n                  window.dispatchEvent(new CustomEvent('openAIAgent'));\r\n                  // Smooth scroll to bottom-right where AIAgent is positioned\r\n                  window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });\r\n                }}\r\n                className=\"w-full bg-brand-orange text-white font-semibold py-3 px-4 rounded-lg hover:bg-orange-600 transition-colors flex items-center justify-center gap-2\"\r\n              >\r\n                <svg className=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" />\r\n                </svg>\r\n                Chat with Zola Now\r\n              </button>\r\n              <p className=\"text-xs text-gray-600 mt-2 text-center\">\r\n                Available 24/7 ‚Ä¢ Instant responses ‚Ä¢ Handles booking changes, queries & recommendations\r\n              </p>\r\n            </div>\r\n\r\n            {/* Human Support - Backup */}\r\n            <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4\">\r\n              <div className=\"flex items-center gap-2 mb-2\">\r\n                <svg className=\"h-5 w-5 text-gray-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                  <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 8h2a2 2 0 012 2v6a2 2 0 01-2 2h-2v4l-4-4H9a1.994 1.994 0 01-1.414-.586m0 0L11 14h4a2 2 0 002-2V6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2v4l.586-.586z\" />\r\n                </svg>\r\n                <h4 className=\"font-medium text-gray-700 text-sm\">Need to Speak to a Specialist?</h4>\r\n              </div>\r\n              <p className=\"text-xs text-gray-600 mb-3\">If Zola can&apos;t resolve your issue, you&apos;ll be connected to our team:</p>\r\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-3 text-xs\">\r\n                <div>\r\n                  <p className=\"text-gray-500\">Email Support</p>\r\n                  <p className=\"font-semibold text-gray-700\">support@colleco.co.za</p>\r\n                  <p className=\"text-xs text-gray-400\">Zola routes to specialist</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-gray-500\">Phone (Escalations)</p>\r\n                  <p className=\"font-semibold text-gray-700\">+27 31 123 4567</p>\r\n                  <p className=\"text-xs text-gray-400\">Mon-Fri: 9AM-5PM</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n\r\n    {/* Ride Selector Modal */}\r\n    {showRideSelector && (\r\n      <RideSelector\r\n        pickup={pickup}\r\n        dropoff={dropoff}\r\n        vehicleType={vehicleType}\r\n        passengers={pax}\r\n        onSelectRide={confirmRideSelection}\r\n        onSkip={handleSkipRideSelection}\r\n        onCancel={() => setShowRideSelector(false)}\r\n      />\r\n    )}\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":["useRef","useState","useCallback","useEffect","jsxs","jsx","Fragment","e","_log"],"mappings":"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"}