const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AIGeneratorPage-DlAnS9gz.js","assets/motion-D9fZRtSt.js","assets/react-4gMnsuNC.js","assets/WorkflowPanel-DczOhPSj.js","assets/pdf-DKpnIAzb.js","assets/icons-C4AMPM7L.js","assets/AIMetricsPage-C7EbhZyY.js","assets/About-B1xI7hqv.js","assets/AccommodationBooking-CnBd5hSB.js","assets/BookingNav-B1OTCtxJ.js","assets/Button-BvBK5int.js","assets/AdminAccommodation-DMs3tVG7.js","assets/AdminBookings-NdyFHFu3.js","assets/AdminChat-BeEbE0lO.js","assets/AdminConsole-MTHJkico.js","assets/payoutsSystem-wwSz4I24.js","assets/subscriptionPlans-rkZPWK28.js","assets/AdminConsoleEnhanced-DH_Y6AJ7.js","assets/AdminDashboard-1Z2eU-yc.js","assets/GamificationWidget-C6rM1rFK.js","assets/gamificationEngine-BquAD8q6.js","assets/AdminPackageForm-CSsPUrTd.js","assets/Analytics-DxSi1iJg.js","assets/Book-DJgWRp8R.js","assets/Bookings-BYtPTBMw.js","assets/AutoSyncBanner-CKsB_6Rd.js","assets/LiveStatCard-DJeVqhb9.js","assets/client-BwpB5jnn.js","assets/BulkInventoryUpload-CFDRIpY9.js","assets/BusinessAccountDetail-DLIYHckT.js","assets/BusinessDashboard-C2XxIfiH.js","assets/BusinessTravelerRegistration-Ctvgp8wh.js","assets/CarBooking-DygQXGKU.js","assets/CheckIn-BaqdhfOa.js","assets/Checkout-B26h3dT9.js","assets/CollabAnalytics-DDflkx5q.js","assets/Collaboration-CKxtq4Tp.js","assets/Compliance-BUv0Nl3T.js","assets/ComplianceStatusCard-HFK_OdFt.js","assets/Contact-BKAKnX_9.js","assets/DirectBooking-rW0VGL4B.js","assets/FlightBooking-ByBMVx1c.js","assets/Gamification-B8PmrtO-.js","assets/Home-CsMrKiu0.js","assets/Itinerary-Db3jaCzc.js","assets/MemoryNote-CP9Z0UOD.js","assets/useTripState-BYDoCob1.js","assets/WeatherWidget-BlfuEc2C.js","assets/useBasketState-DcL2gvap.js","assets/ItinerarySimple-DlxCSQuV.js","assets/Login-Di12DA54.js","assets/LoyaltyDashboard-CAFfjaL_.js","assets/ManageBusinessAccounts-B1LL2z1G.js","assets/MyTrips-CzyhjBFK.js","assets/NewQuote-spyZAHeU.js","assets/pdfGenerators-Dpk5CIWQ.js","assets/currency-J2bxD4Bj.js","assets/quotes-Cs8OmkV4.js","assets/NotificationSettings-B0X8EiKr.js","assets/Notifications-aUUdH5xr.js","assets/Packages-7B1gxl-z.js","assets/PartnerApplicationStatus-BlEupfZ-.js","assets/PartnerDashboard-BwUh1AKm.js","assets/Footer-ByqUfdvj.js","assets/PromotionsBalanceCard-C3qqkMzk.js","assets/PartnerEarnings-DFK0ymPL.js","assets/PartnerOnboarding-BQkAC9Hc.js","assets/PartnerSuccessDashboard-CjKpIuP4.js","assets/PartnerTemplates-DP35T7y5.js","assets/PartnerTransferDashboard-B8YkEh26.js","assets/PartnerVerification-C5xV2x3J.js","assets/Partners-sZTBUpKg.js","assets/PaymentCancel-CXp2L1pa.js","assets/PaymentFailure-BJ0l-G9q.js","assets/PaymentSuccess-Dba8cgfD.js","assets/Payouts-Df-InSL1.js","assets/PlanTrip-CHGleIan.js","assets/PrivacySettings-B_In51Te.js","assets/Profile-BqjbhayB.js","assets/Promotions-wZ_rxQ4d.js","assets/QuoteGenerator-BSNjDLC-.js","assets/Quotes-Bdqb_3aS.js","assets/Refunds-DnUNxCcC.js","assets/EnhancementStubs-DhElvIJq.js","assets/Reports-CayPqQ6I.js","assets/Safety-CveG-Ejd.js","assets/SavedItineraries-Dwa23ipc.js","assets/Settings-BxFyJ7jf.js","assets/SubscriptionTiers-Bntgf2GR.js","assets/SupplierPayouts-CJZljMFb.js","assets/Support-B_23pDAw.js","assets/SupportTickets-BOB_5nBK.js","assets/Terms-H7f5eAsd.js","assets/TermsStandalone-DdjBFTbj.js","assets/TransferAnalytics-BJ_4fNi8.js","assets/TransferHistory-CODrUibK.js","assets/Transfers-BrDFal9x.js","assets/TransportDispatch-DX-gKzwQ.js","assets/TravelerDashboard-DblsybnJ.js","assets/Trips-DJzg56vs.js","assets/Unauthorized-DXQFJVXQ.js","assets/Wishlist-51pqLmCs.js","assets/WorkspacePage-BHD0tBR-.js"])))=>i.map(i=>d[i]);
import { r as reactExports, j as jsxRuntimeExports, m as motion, R as React } from "./motion-D9fZRtSt.js";
import { a as requireReactDom, g as getDefaultExportFromCjs } from "./react-4gMnsuNC.js";
import { _ as __vitePreload } from "./pdf-DKpnIAzb.js";
import { aa as MessageSquare, O as Search, aD as BellOff, aE as Bell, s as Phone, aF as Video, S as Shield, N as Lock, ax as UserCheck, aG as Mic, aH as MicOff, aI as VideoOff, ad as Heart, aJ as ThumbsUp, aK as Laugh, aL as PartyPopper, E as Sparkles, v as Flame, aM as UserPlus, aN as UserMinus, A as AlertCircle, z as Crown, K as Gift, as as Map$1, t as Home, aO as Users2, B as BedDouble, an as Mountain, d as Plane, e as Car, a8 as Bookmark, n as CheckCircle2, Z as Zap, aP as Activity, aQ as Globe2, x as Star, aR as Camera, a0 as Megaphone, j as Briefcase, T as TrendingUp, aS as HelpCircle, aT as Clock3, aU as Tag, b as FileText, aV as CalendarCheck, c as Settings, y as ShieldCheck, aW as Wallet, M as MapPin, U as Users, k as BarChart3, aX as LayoutDashboard, w as ChevronRight, ac as ChevronLeft } from "./icons-C4AMPM7L.js";
var client = {};
var hasRequiredClient;
function requireClient() {
  if (hasRequiredClient) return client;
  hasRequiredClient = 1;
  var m = requireReactDom();
  {
    client.createRoot = m.createRoot;
    client.hydrateRoot = m.hydrateRoot;
  }
  return client;
}
var clientExports = requireClient();
const ReactDOM = /* @__PURE__ */ getDefaultExportFromCjs(clientExports);
const STORAGE_KEY = "collabThreads:v1";
const ROLES = {
  agent: "agent",
  client: "client",
  productOwner: "productOwner",
  system: "system"
};
const CHANNELS = {
  inapp: "in-app",
  whatsapp: "whatsapp",
  email: "email",
  sms: "sms",
  call: "call",
  note: "note"
};
function loadThreads() {
  try {
    const raw = localStorage.getItem(STORAGE_KEY);
    return raw ? JSON.parse(raw) : {};
  } catch (e) {
    console.error("Failed to load collab threads", e);
    return {};
  }
}
const listeners = /* @__PURE__ */ new Set();
function onCollabEvent(fn) {
  listeners.add(fn);
  return () => listeners.delete(fn);
}
function emit(event, payload) {
  try {
    listeners.forEach((l) => l({ event, payload }));
  } catch {
  }
}
function saveThreads(threads) {
  try {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(threads));
  } catch (e) {
    console.error("Failed to save collab threads", e);
  }
}
function ensureThread(booking, participants = []) {
  const threads = loadThreads();
  if (!threads[booking.id]) {
    threads[booking.id] = {
      bookingId: booking.id,
      ref: booking.ref,
      title: booking.itineraryName || "Booking",
      clientName: booking.clientName,
      status: booking.status || "Draft",
      participants,
      // [{role, name, contact?}]
      messages: [],
      attachments: [],
      // shared docs
      unread: {},
      // per role unread count
      createdAt: Date.now(),
      updatedAt: Date.now()
    };
    saveThreads(threads);
  }
  return threads[booking.id];
}
function listThreads() {
  const threads = loadThreads();
  return Object.values(threads).sort((a, b) => (b.updatedAt || 0) - (a.updatedAt || 0));
}
function postMessage(bookingId, message) {
  const threads = loadThreads();
  if (!threads[bookingId]) return;
  const msg = {
    id: crypto.randomUUID(),
    createdAt: Date.now(),
    mentions: [],
    attachments: [],
    visibility: "all",
    // all | agent-client | agent-po
    channel: CHANNELS.inapp,
    ...message
  };
  const thread = threads[bookingId];
  thread.messages.push(msg);
  thread.updatedAt = Date.now();
  for (const p of thread.participants || []) {
    if (p.role !== msg.authorRole) {
      thread.unread[p.role] = (thread.unread[p.role] || 0) + 1;
    }
  }
  saveThreads(threads);
  emit("message", { bookingId, message: msg });
  return msg;
}
function addAttachment(bookingId, fileMeta) {
  const threads = loadThreads();
  if (!threads[bookingId]) return;
  const att = {
    id: crypto.randomUUID(),
    addedAt: Date.now(),
    visibility: "all",
    ...fileMeta
    // {name, size, type, byRole, url?, visibility?}
  };
  threads[bookingId].attachments.push(att);
  threads[bookingId].updatedAt = Date.now();
  for (const p of threads[bookingId].participants || []) {
    if (p.role !== att.byRole) {
      threads[bookingId].unread[p.role] = (threads[bookingId].unread[p.role] || 0) + 1;
    }
  }
  saveThreads(threads);
  emit("attachment", { bookingId, attachment: att });
  return att;
}
function markRead(bookingId, role) {
  const threads = loadThreads();
  if (!threads[bookingId]) return;
  threads[bookingId].unread[role] = 0;
  saveThreads(threads);
}
function computeAnalytics(thread) {
  if (!thread) return { avgResponseMins: {}, channelCounts: {}, awaiting: [] };
  const msgs = [...thread.messages || []].sort((a, b) => a.createdAt - b.createdAt);
  const responseTimes = {};
  const channelCounts = {};
  let prevBy = null, prevAt = null;
  for (const m of msgs) {
    channelCounts[m.channel] = (channelCounts[m.channel] || 0) + 1;
    if (prevBy && m.authorRole !== prevBy && prevAt) {
      const diff = Math.max(0, Math.round((m.createdAt - prevAt) / 6e4));
      (responseTimes[m.authorRole] = responseTimes[m.authorRole] || []).push(diff);
    }
    prevBy = m.authorRole;
    prevAt = m.createdAt;
  }
  const avgResponseMins = Object.fromEntries(
    Object.entries(responseTimes).map(([role, diffs]) => [role, Math.round(diffs.reduce((a, b) => a + b, 0) / diffs.length)])
  );
  const awaiting = [];
  if (msgs.length) {
    const last = msgs[msgs.length - 1];
    const others = (thread.participants || []).map((p) => p.role).filter((r) => r !== last.authorRole);
    awaiting.push(...others);
  }
  return { avgResponseMins, channelCounts, awaiting };
}
function summarizeThread(thread) {
  const text = (thread?.messages || []).map((m) => m.content || "").join("\n");
  if (!text.trim()) return { summary: "No messages yet.", bullets: [] };
  const bullets = [];
  const lower = text.toLowerCase();
  if (lower.includes("pickup") || lower.includes("transfer")) bullets.push("Add airport pickup");
  if (lower.includes("upgrade")) bullets.push("Upgrade room/category");
  if (lower.includes("flight") && (lower.includes("time") || lower.includes("shift"))) bullets.push("Shift flight time");
  if (lower.includes("quote") && lower.includes("update")) bullets.push("Update quote");
  return {
    summary: bullets.length ? `Top requested changes: ${bullets.join(", ")}.` : "Conversation summarized.",
    bullets
  };
}
function seedFromBookings(bookings) {
  const threads = loadThreads();
  for (const b of bookings) {
    if (!threads[b.id]) {
      ensureThread(b, [
        { role: ROLES.agent, name: "Agent" },
        { role: ROLES.client, name: b.clientName },
        { role: ROLES.productOwner, name: "Hotel/Supplier" }
      ]);
      postMessage(b.id, {
        authorRole: ROLES.agent,
        authorName: "Agent",
        channel: CHANNELS.inapp,
        content: `Hi ${b.clientName}, your ${b.itineraryName} itinerary is ready. Would you like an airport pickup added?`
      });
      postMessage(b.id, {
        authorRole: ROLES.client,
        authorName: b.clientName,
        channel: CHANNELS.whatsapp,
        content: "Yes please, also can we upgrade the room and shift the flight time by 1 hour?"
      });
      postMessage(b.id, {
        authorRole: ROLES.productOwner,
        authorName: "Hotel/Supplier",
        channel: CHANNELS.email,
        content: "Room upgrade available at +$50/night. Awaiting confirmation."
      });
    }
  }
}
const MOCK_CONTACTS = [
  { id: "contact-1", name: "Sarah Johnson", role: ROLES.client, company: "TechCorp", avatar: "SJ", status: "online", lastSeen: null },
  { id: "contact-2", name: "Mike Chen", role: ROLES.productOwner, company: "Adventure Co", avatar: "MC", status: "online", lastSeen: null },
  { id: "contact-3", name: "Emma Davis", role: ROLES.agent, company: "Travel Partners", avatar: "ED", status: "offline", lastSeen: "2 hours ago" },
  { id: "contact-4", name: "James Wilson", role: ROLES.client, company: "Global Inc", avatar: "JW", status: "online", lastSeen: null },
  { id: "contact-5", name: "Lisa Martinez", role: ROLES.productOwner, company: "Luxury Tours", avatar: "LM", status: "offline", lastSeen: "1 day ago" }
];
function ProductOwnerChatModal({ bookingId, clientName, productOwnerName, onClose }) {
  const [open, setOpen] = reactExports.useState(false);
  const [selectedContact, setSelectedContact] = reactExports.useState(null);
  const [searchQuery, setSearchQuery] = reactExports.useState("");
  const [messages, setMessages] = reactExports.useState([]);
  const [input, setInput] = reactExports.useState("");
  const [contacts] = reactExports.useState(MOCK_CONTACTS);
  const [mutedContacts, setMutedContacts] = reactExports.useState(() => {
    const saved = localStorage.getItem("colleco.mutedContacts");
    return saved ? JSON.parse(saved) : [];
  });
  const [showCallModal, setShowCallModal] = reactExports.useState(null);
  const [callStatus, setCallStatus] = reactExports.useState("idle");
  const [callDuration, setCallDuration] = reactExports.useState(0);
  const [isVideoEnabled, setIsVideoEnabled] = reactExports.useState(true);
  const [isAudioEnabled, setIsAudioEnabled] = reactExports.useState(true);
  const [callId, setCallId] = reactExports.useState(null);
  const [callParticipants, setCallParticipants] = reactExports.useState([]);
  const [joinRequests, setJoinRequests] = reactExports.useState([]);
  const [isCallHost, setIsCallHost] = reactExports.useState(false);
  const [showParticipants, setShowParticipants] = reactExports.useState(false);
  const [showInviteModal, setShowInviteModal] = reactExports.useState(false);
  const [showReactions, setShowReactions] = reactExports.useState(false);
  const [floatingReactions, setFloatingReactions] = reactExports.useState([]);
  const [_thread, setThread] = reactExports.useState(null);
  const [receipts, setReceipts] = reactExports.useState({});
  reactExports.useEffect(() => {
    if (!selectedContact) return;
    const contactBookingId = `${bookingId}-${selectedContact.id}`;
    const threads = loadThreads();
    let t = threads[contactBookingId];
    if (!t) {
      t = ensureThread({ id: contactBookingId, clientName }, [
        { role: ROLES.client, name: clientName },
        { role: selectedContact.role, name: selectedContact.name }
      ]);
      threads[contactBookingId] = t;
      saveThreads(threads);
    }
    setThread(t);
    setMessages(t.messages || []);
  }, [selectedContact, bookingId, clientName]);
  reactExports.useEffect(() => {
    if (callStatus === "connected") {
      const interval = setInterval(() => {
        setCallDuration((d) => d + 1);
      }, 1e3);
      return () => clearInterval(interval);
    }
  }, [callStatus]);
  reactExports.useEffect(() => {
    localStorage.setItem("colleco.mutedContacts", JSON.stringify(mutedContacts));
  }, [mutedContacts]);
  function generateSecureCallId() {
    return `call-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
  }
  function initiateCall(type) {
    if (!selectedContact) return;
    const newCallId = generateSecureCallId();
    setCallId(newCallId);
    setIsCallHost(true);
    setCallParticipants([
      { id: "you", name: clientName, role: ROLES.client, isHost: true, joinedAt: Date.now() },
      { id: selectedContact.id, name: selectedContact.name, role: selectedContact.role, isHost: false, joinedAt: null }
    ]);
    setShowCallModal(type);
    setCallStatus("calling");
    setCallDuration(0);
    setIsVideoEnabled(type === "video");
    setIsAudioEnabled(true);
    setTimeout(() => {
      setCallStatus("connected");
      setCallParticipants((prev) => prev.map(
        (p) => p.id === selectedContact.id ? { ...p, joinedAt: Date.now() } : p
      ));
    }, 2e3);
  }
  function inviteToCall(contact) {
    if (!isCallHost) return;
    if (callParticipants.find((p) => p.id === contact.id)) return;
    setCallParticipants((prev) => [...prev, {
      id: contact.id,
      name: contact.name,
      role: contact.role,
      isHost: false,
      joinedAt: Date.now()
    }]);
    setShowInviteModal(false);
  }
  function removeParticipant(participantId) {
    if (!isCallHost) return;
    if (participantId === "you") return;
    setCallParticipants((prev) => prev.filter((p) => p.id !== participantId));
  }
  function endCall() {
    setCallStatus("ended");
    setTimeout(() => {
      setShowCallModal(null);
      setCallStatus("idle");
      setCallDuration(0);
      setCallId(null);
      setCallParticipants([]);
      setIsCallHost(false);
      setShowParticipants(false);
    }, 2e3);
  }
  function toggleMute(contactId) {
    setMutedContacts(
      (prev) => prev.includes(contactId) ? prev.filter((id) => id !== contactId) : [...prev, contactId]
    );
  }
  function sendMessage() {
    if (!input.trim() || !selectedContact) return;
    const ts = Date.now();
    const msg = {
      sender: clientName,
      role: ROLES.client,
      channel: CHANNELS.inapp,
      text: input.trim(),
      ts
    };
    const contactBookingId = `${bookingId}-${selectedContact.id}`;
    const threads = loadThreads();
    threads[contactBookingId].messages.push(msg);
    saveThreads(threads);
    setMessages([...threads[contactBookingId].messages]);
    setInput("");
    setReceipts((r) => ({ ...r, [ts]: "sent" }));
    setTimeout(() => setReceipts((r) => ({ ...r, [ts]: "delivered" })), 1e3);
    setTimeout(() => setReceipts((r) => ({ ...r, [ts]: "read" })), 2500);
  }
  function sendReaction(emoji, label) {
    const id = Date.now() + Math.random();
    setFloatingReactions((prev) => [...prev, { id, emoji, label }]);
    setTimeout(() => {
      setFloatingReactions((prev) => prev.filter((r) => r.id !== id));
    }, 3e3);
  }
  const filteredContacts = contacts.filter(
    (c) => c.name.toLowerCase().includes(searchQuery.toLowerCase()) || c.company.toLowerCase().includes(searchQuery.toLowerCase())
  );
  const formatCallDuration = (seconds) => {
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;
    return `${mins}:${secs.toString().padStart(2, "0")}`;
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "fixed bottom-0 right-0 z-toast pointer-events-none", children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "fixed right-6 bottom-6 sm:right-8 sm:bottom-8 pointer-events-auto", children: open ? /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white rounded-2xl shadow-2xl border border-cream-border/80 w-[95vw] sm:w-[600px] lg:w-[800px] h-[80vh] sm:h-[600px] flex relative", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-80 border-r border-cream-border flex flex-col bg-cream-sand", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "p-4 border-b border-cream-border", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between mb-3", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs("h3", { className: "text-lg font-bold text-brand-orange flex items-center gap-2", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(MessageSquare, { className: "w-5 h-5" }),
              "Contacts"
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("button", { className: "text-brand-brown hover:text-brand-orange", onClick: () => setOpen(false), children: "âœ•" })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "relative", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(Search, { className: "w-4 h-4 absolute left-2 top-2.5 text-brand-brown/50" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "input",
              {
                type: "text",
                className: "w-full pl-8 pr-3 py-2 border border-cream-border rounded text-sm",
                placeholder: "Search contacts...",
                value: searchQuery,
                onChange: (e) => setSearchQuery(e.target.value)
              }
            )
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex-1 overflow-y-auto", children: filteredContacts.map((contact) => /* @__PURE__ */ jsxRuntimeExports.jsxs(
          "button",
          {
            className: `w-full p-3 flex items-center gap-3 border-b border-cream-border hover:bg-white transition-colors ${selectedContact?.id === contact.id ? "bg-white" : ""}`,
            onClick: () => setSelectedContact(contact),
            children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-10 h-10 rounded-full bg-brand-orange text-white flex items-center justify-center font-semibold text-sm flex-shrink-0", children: contact.avatar }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1 text-left min-w-0", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-brand-brown text-sm truncate", children: contact.name }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-brand-brown/60 truncate", children: contact.company }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-brand-brown/50 flex items-center gap-1 mt-0.5", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: `w-2 h-2 rounded-full ${contact.status === "online" ? "bg-green-500" : "bg-gray-400"}` }),
                  contact.status === "online" ? "Online" : `Last seen ${contact.lastSeen}`
                ] })
              ] }),
              mutedContacts.includes(contact.id) && /* @__PURE__ */ jsxRuntimeExports.jsx(BellOff, { className: "w-4 h-4 text-brand-brown/40 flex-shrink-0" })
            ]
          },
          contact.id
        )) })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex-1 flex flex-col", children: !selectedContact ? /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex-1 flex items-center justify-center text-brand-brown/50", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-center", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(MessageSquare, { className: "w-12 h-12 mx-auto mb-2 opacity-50" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-sm", children: "Select a contact to start messaging" })
      ] }) }) : /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "p-4 border-b border-cream-border bg-white flex items-center justify-between", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-3", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-10 h-10 rounded-full bg-brand-orange text-white flex items-center justify-center font-semibold", children: selectedContact.avatar }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-brand-brown", children: selectedContact.name }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-brand-brown/60", children: selectedContact.company })
            ] })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                className: "p-2 hover:bg-cream rounded-full transition-colors",
                onClick: () => toggleMute(selectedContact.id),
                title: mutedContacts.includes(selectedContact.id) ? "Unmute" : "Mute",
                children: mutedContacts.includes(selectedContact.id) ? /* @__PURE__ */ jsxRuntimeExports.jsx(BellOff, { className: "w-5 h-5 text-brand-brown/60" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(Bell, { className: "w-5 h-5 text-brand-brown/60" })
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                className: "p-2 hover:bg-green-50 hover:text-green-600 rounded-full transition-colors",
                onClick: () => initiateCall("voice"),
                title: "Voice Call",
                children: /* @__PURE__ */ jsxRuntimeExports.jsx(Phone, { className: "w-5 h-5" })
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                className: "p-2 hover:bg-blue-50 hover:text-blue-600 rounded-full transition-colors",
                onClick: () => initiateCall("video"),
                title: "Video Call",
                children: /* @__PURE__ */ jsxRuntimeExports.jsx(Video, { className: "w-5 h-5" })
              }
            )
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex-1 overflow-y-auto p-4 bg-cream-sand", children: messages.length === 0 ? /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-brand-brown/50 text-center mt-8", children: "No messages yet. Start the conversation!" }) : messages.map((m, i) => /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: `mb-3 flex ${m.role === ROLES.client ? "justify-end" : "justify-start"}`, children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: `max-w-[70%] px-3 py-2 rounded-lg text-sm ${m.role === ROLES.client ? "bg-brand-orange text-white rounded-br-none" : "bg-white border border-cream-border text-brand-brown rounded-bl-none"}`, children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-xs mb-1 opacity-90", children: m.sender }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { children: m.text }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs opacity-70 mt-1", children: [
            new Date(m.ts).toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" }),
            m.role === ROLES.client && receipts[m.ts] && /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "ml-2", children: [
              receipts[m.ts] === "sent" && "ðŸ•‘",
              receipts[m.ts] === "delivered" && "âœ…",
              receipts[m.ts] === "read" && "ðŸ‘ï¸"
            ] })
          ] })
        ] }) }, i)) }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "p-4 border-t border-cream-border bg-white", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex gap-2 mb-2", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                className: "px-3 py-1.5 bg-cream border border-cream-border rounded text-xs text-brand-brown hover:bg-brand-orange hover:text-white transition-colors",
                onClick: () => setInput("Booking confirmed!"),
                children: "Booking confirmed"
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                className: "px-3 py-1.5 bg-cream border border-cream-border rounded text-xs text-brand-brown hover:bg-brand-orange hover:text-white transition-colors",
                onClick: () => setInput("Payment received, thank you!"),
                children: "Payment received"
              }
            )
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex gap-2", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "input",
              {
                className: "flex-1 border border-cream-border rounded px-3 py-2 text-sm",
                value: input,
                onChange: (e) => setInput(e.target.value),
                placeholder: "Type your message...",
                onKeyDown: (e) => {
                  if (e.key === "Enter") sendMessage();
                }
              }
            ),
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                className: "px-4 py-2 bg-brand-orange text-white rounded hover:bg-brand-orange/90 transition-colors",
                onClick: sendMessage,
                children: "Send"
              }
            )
          ] })
        ] })
      ] }) })
    ] }),
    showCallModal && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "fixed inset-0 z-[100] flex items-center justify-center bg-gradient-to-br from-brand-brown/95 to-brand-orange/95", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "w-full max-w-4xl p-8 text-white relative", children: [
        callStatus === "connected" && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "absolute top-4 left-1/2 -translate-x-1/2 bg-green-500/20 border border-green-400/30 backdrop-blur-sm rounded-full px-4 py-2 flex items-center gap-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(Shield, { className: "w-4 h-4 text-green-400" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(Lock, { className: "w-3 h-3 text-green-400" }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-xs text-green-100", children: [
            "Secure Call Â· ",
            callId?.slice(0, 15),
            "..."
          ] })
        ] }),
        callStatus === "connected" && isCallHost && /* @__PURE__ */ jsxRuntimeExports.jsxs(
          "button",
          {
            className: "absolute top-4 right-4 bg-white/10 backdrop-blur-sm rounded-full px-4 py-2 flex items-center gap-2 hover:bg-white/20 transition-colors",
            onClick: () => setShowParticipants(!showParticipants),
            children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(UserCheck, { className: "w-4 h-4" }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-sm", children: [
                callParticipants.length,
                " ",
                callParticipants.length === 1 ? "Participant" : "Participants"
              ] })
            ]
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-center mb-8", children: [
          callStatus === "calling" && /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-6xl mb-4", children: selectedContact?.avatar }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-2xl font-bold mb-2", children: selectedContact?.name }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-white/80", children: "Calling..." }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mt-4 flex justify-center", children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "animate-pulse", children: /* @__PURE__ */ jsxRuntimeExports.jsx(Phone, { className: "w-8 h-8" }) }) })
          ] }),
          callStatus === "connected" && /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mb-4", children: showCallModal === "video" && isVideoEnabled ? /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-full aspect-video bg-black/30 rounded-lg flex items-center justify-center mb-2", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-center", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx(Video, { className: "w-12 h-12 mx-auto mb-2 opacity-50" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-sm opacity-70", children: "Video feed placeholder" })
            ] }) }) : /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-7xl mb-4", children: selectedContact?.avatar }) }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-2xl font-bold mb-2", children: selectedContact?.name }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-white/80", children: formatCallDuration(callDuration) }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mt-2 text-sm text-white/60", children: [
              showCallModal === "video" && !isVideoEnabled && "Video disabled",
              !isAudioEnabled && " Â· Audio muted"
            ] })
          ] }),
          callStatus === "ended" && /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-6xl mb-4", children: "âœ“" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("h3", { className: "text-2xl font-bold mb-2", children: "Call Ended" }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("p", { className: "text-white/80", children: [
              "Duration: ",
              formatCallDuration(callDuration)
            ] })
          ] })
        ] }),
        callStatus === "connected" && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex justify-center gap-4", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              className: `p-4 rounded-full transition-colors ${isAudioEnabled ? "bg-white/20 hover:bg-white/30" : "bg-red-500 hover:bg-red-600"}`,
              onClick: () => setIsAudioEnabled(!isAudioEnabled),
              title: isAudioEnabled ? "Mute" : "Unmute",
              children: isAudioEnabled ? /* @__PURE__ */ jsxRuntimeExports.jsx(Mic, { className: "w-6 h-6" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(MicOff, { className: "w-6 h-6" })
            }
          ),
          showCallModal === "video" && /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              className: `p-4 rounded-full transition-colors ${isVideoEnabled ? "bg-white/20 hover:bg-white/30" : "bg-red-500 hover:bg-red-600"}`,
              onClick: () => setIsVideoEnabled(!isVideoEnabled),
              title: isVideoEnabled ? "Turn off video" : "Turn on video",
              children: isVideoEnabled ? /* @__PURE__ */ jsxRuntimeExports.jsx(Video, { className: "w-6 h-6" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(VideoOff, { className: "w-6 h-6" })
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "relative", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                className: "p-4 rounded-full bg-white/20 hover:bg-white/30 transition-colors",
                onClick: () => setShowReactions(!showReactions),
                title: "Send reaction",
                children: /* @__PURE__ */ jsxRuntimeExports.jsx(Heart, { className: "w-6 h-6" })
              }
            ),
            showReactions && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "absolute bottom-full mb-2 left-1/2 -translate-x-1/2 bg-white rounded-full px-3 py-2 flex gap-2 shadow-lg", children: [
              { emoji: "â¤ï¸", label: "Heart", icon: Heart },
              { emoji: "ðŸ‘", label: "Thumbs up", icon: ThumbsUp },
              { emoji: "ðŸ˜‚", label: "Laugh", icon: Laugh },
              { emoji: "ðŸŽ‰", label: "Party", icon: PartyPopper },
              { emoji: "âœ¨", label: "Sparkles", icon: Sparkles },
              { emoji: "ðŸ”¥", label: "Fire", icon: Flame }
            ].map(({ emoji, label }) => /* @__PURE__ */ jsxRuntimeExports.jsx(
              "button",
              {
                className: "text-2xl hover:scale-125 transition-transform",
                onClick: () => {
                  sendReaction(emoji, label);
                  setShowReactions(false);
                },
                title: label,
                children: emoji
              },
              emoji
            )) })
          ] }),
          isCallHost && /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              className: "p-4 rounded-full bg-white/20 hover:bg-white/30 transition-colors",
              onClick: () => setShowInviteModal(true),
              title: "Invite to call",
              children: /* @__PURE__ */ jsxRuntimeExports.jsx(UserPlus, { className: "w-6 h-6" })
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              className: "p-4 rounded-full bg-red-500 hover:bg-red-600 transition-colors",
              onClick: endCall,
              title: "End call",
              children: /* @__PURE__ */ jsxRuntimeExports.jsx(Phone, { className: "w-6 h-6 transform rotate-135" })
            }
          )
        ] }),
        floatingReactions.map((reaction) => /* @__PURE__ */ jsxRuntimeExports.jsx(
          "div",
          {
            className: "absolute text-4xl animate-float-up",
            style: {
              left: `${Math.random() * 80 + 10}%`,
              bottom: "20%",
              animation: "float-up 3s ease-out forwards"
            },
            children: reaction.emoji
          },
          reaction.id
        ))
      ] }),
      showParticipants && callStatus === "connected" && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "absolute right-4 top-20 w-64 bg-white/10 backdrop-blur-md rounded-lg p-4 max-h-96 overflow-y-auto", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("h4", { className: "text-white font-semibold mb-3 flex items-center gap-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(UserCheck, { className: "w-4 h-4" }),
          "Participants (",
          callParticipants.length,
          ")"
        ] }),
        callParticipants.map((participant) => /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between mb-2 p-2 bg-white/5 rounded", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-8 h-8 rounded-full bg-brand-orange text-white flex items-center justify-center text-xs font-semibold", children: participant.name.split(" ").map((n) => n[0]).join("") }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-sm text-white", children: participant.name }),
              participant.isHost && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-xs text-white/60 flex items-center gap-1", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx(Shield, { className: "w-3 h-3" }),
                "Host"
              ] })
            ] })
          ] }),
          isCallHost && !participant.isHost && /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              className: "p-1 hover:bg-red-500/20 rounded",
              onClick: () => removeParticipant(participant.id),
              title: "Remove participant",
              children: /* @__PURE__ */ jsxRuntimeExports.jsx(UserMinus, { className: "w-4 h-4 text-red-300" })
            }
          )
        ] }, participant.id))
      ] }),
      showInviteModal && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "absolute inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white rounded-lg p-6 w-96 max-h-[500px] overflow-y-auto", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between mb-4", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("h4", { className: "text-lg font-bold text-brand-brown", children: "Invite to Call" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              className: "text-brand-brown/60 hover:text-brand-brown",
              onClick: () => setShowInviteModal(false),
              children: "âœ•"
            }
          )
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded text-xs text-yellow-800", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex gap-2", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx(AlertCircle, { className: "w-4 h-4 flex-shrink-0 mt-0.5" }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("strong", { children: "Secure Call" }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mt-1", children: [
              "Only invited participants can join. Call ID: ",
              callId?.slice(0, 20),
              "..."
            ] })
          ] })
        ] }) }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "space-y-2", children: contacts.filter((c) => !callParticipants.find((p) => p.id === c.id)).map((contact) => /* @__PURE__ */ jsxRuntimeExports.jsxs(
          "button",
          {
            className: "w-full p-3 flex items-center gap-3 border border-cream-border rounded hover:bg-cream transition-colors",
            onClick: () => inviteToCall(contact),
            children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "w-10 h-10 rounded-full bg-brand-orange text-white flex items-center justify-center font-semibold text-sm", children: contact.avatar }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1 text-left", children: [
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "font-semibold text-brand-brown text-sm", children: contact.name }),
                /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-xs text-brand-brown/60", children: contact.company })
              ] }),
              /* @__PURE__ */ jsxRuntimeExports.jsx(UserPlus, { className: "w-4 h-4 text-brand-orange" })
            ]
          },
          contact.id
        )) })
      ] }) })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("style", { children: `
        @keyframes float-up {
          0% {
            opacity: 1;
            transform: translateY(0) scale(1);
          }
          100% {
            opacity: 0;
            transform: translateY(-200px) scale(1.5);
          }
        }
      ` })
  ] }) : /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col items-center gap-1", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs(
      "button",
      {
        onClick: () => setOpen(true),
        className: "relative flex h-16 w-16 items-center justify-center rounded-full border border-white/70 bg-white/90 shadow-2xl shadow-brand-brown/25 backdrop-blur hover:scale-105 transition-transform",
        "aria-label": "Open Messenger",
        title: "Open Messenger",
        children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "absolute inset-0 rounded-full bg-gradient-to-br from-brand-orange/40 via-transparent to-brand-brown/40 blur-xl", "aria-hidden": true }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(MessageSquare, { className: "relative w-8 h-8 text-brand-orange" })
        ]
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-xs font-semibold text-brand-brown bg-white/90 px-2 py-0.5 rounded-full shadow-sm", children: "Messages" })
  ] }) }) });
}
var PopStateEventType = "popstate";
function createBrowserHistory(options = {}) {
  function createBrowserLocation(window2, globalHistory) {
    let { pathname, search, hash } = window2.location;
    return createLocation(
      "",
      { pathname, search, hash },
      // state defaults to `null` because `window.history.state` does
      globalHistory.state && globalHistory.state.usr || null,
      globalHistory.state && globalHistory.state.key || "default"
    );
  }
  function createBrowserHref(window2, to) {
    return typeof to === "string" ? to : createPath(to);
  }
  return getUrlBasedHistory(
    createBrowserLocation,
    createBrowserHref,
    null,
    options
  );
}
function createHashHistory(options = {}) {
  function createHashLocation(window2, globalHistory) {
    let {
      pathname = "/",
      search = "",
      hash = ""
    } = parsePath(window2.location.hash.substring(1));
    if (!pathname.startsWith("/") && !pathname.startsWith(".")) {
      pathname = "/" + pathname;
    }
    return createLocation(
      "",
      { pathname, search, hash },
      // state defaults to `null` because `window.history.state` does
      globalHistory.state && globalHistory.state.usr || null,
      globalHistory.state && globalHistory.state.key || "default"
    );
  }
  function createHashHref(window2, to) {
    let base = window2.document.querySelector("base");
    let href = "";
    if (base && base.getAttribute("href")) {
      let url = window2.location.href;
      let hashIndex = url.indexOf("#");
      href = hashIndex === -1 ? url : url.slice(0, hashIndex);
    }
    return href + "#" + (typeof to === "string" ? to : createPath(to));
  }
  function validateHashLocation(location2, to) {
    warning(
      location2.pathname.charAt(0) === "/",
      `relative pathnames are not supported in hash history.push(${JSON.stringify(
        to
      )})`
    );
  }
  return getUrlBasedHistory(
    createHashLocation,
    createHashHref,
    validateHashLocation,
    options
  );
}
function invariant(value, message) {
  if (value === false || value === null || typeof value === "undefined") {
    throw new Error(message);
  }
}
function warning(cond, message) {
  if (!cond) {
    if (typeof console !== "undefined") console.warn(message);
    try {
      throw new Error(message);
    } catch (e) {
    }
  }
}
function createKey() {
  return Math.random().toString(36).substring(2, 10);
}
function getHistoryState(location2, index) {
  return {
    usr: location2.state,
    key: location2.key,
    idx: index
  };
}
function createLocation(current, to, state = null, key) {
  let location2 = {
    pathname: typeof current === "string" ? current : current.pathname,
    search: "",
    hash: "",
    ...typeof to === "string" ? parsePath(to) : to,
    state,
    // TODO: This could be cleaned up.  push/replace should probably just take
    // full Locations now and avoid the need to run through this flow at all
    // But that's a pretty big refactor to the current test suite so going to
    // keep as is for the time being and just let any incoming keys take precedence
    key: to && to.key || key || createKey()
  };
  return location2;
}
function createPath({
  pathname = "/",
  search = "",
  hash = ""
}) {
  if (search && search !== "?")
    pathname += search.charAt(0) === "?" ? search : "?" + search;
  if (hash && hash !== "#")
    pathname += hash.charAt(0) === "#" ? hash : "#" + hash;
  return pathname;
}
function parsePath(path) {
  let parsedPath = {};
  if (path) {
    let hashIndex = path.indexOf("#");
    if (hashIndex >= 0) {
      parsedPath.hash = path.substring(hashIndex);
      path = path.substring(0, hashIndex);
    }
    let searchIndex = path.indexOf("?");
    if (searchIndex >= 0) {
      parsedPath.search = path.substring(searchIndex);
      path = path.substring(0, searchIndex);
    }
    if (path) {
      parsedPath.pathname = path;
    }
  }
  return parsedPath;
}
function getUrlBasedHistory(getLocation, createHref2, validateLocation, options = {}) {
  let { window: window2 = document.defaultView, v5Compat = false } = options;
  let globalHistory = window2.history;
  let action = "POP";
  let listener = null;
  let index = getIndex();
  if (index == null) {
    index = 0;
    globalHistory.replaceState({ ...globalHistory.state, idx: index }, "");
  }
  function getIndex() {
    let state = globalHistory.state || { idx: null };
    return state.idx;
  }
  function handlePop() {
    action = "POP";
    let nextIndex = getIndex();
    let delta = nextIndex == null ? null : nextIndex - index;
    index = nextIndex;
    if (listener) {
      listener({ action, location: history.location, delta });
    }
  }
  function push(to, state) {
    action = "PUSH";
    let location2 = createLocation(history.location, to, state);
    if (validateLocation) validateLocation(location2, to);
    index = getIndex() + 1;
    let historyState = getHistoryState(location2, index);
    let url = history.createHref(location2);
    try {
      globalHistory.pushState(historyState, "", url);
    } catch (error) {
      if (error instanceof DOMException && error.name === "DataCloneError") {
        throw error;
      }
      window2.location.assign(url);
    }
    if (v5Compat && listener) {
      listener({ action, location: history.location, delta: 1 });
    }
  }
  function replace2(to, state) {
    action = "REPLACE";
    let location2 = createLocation(history.location, to, state);
    if (validateLocation) validateLocation(location2, to);
    index = getIndex();
    let historyState = getHistoryState(location2, index);
    let url = history.createHref(location2);
    globalHistory.replaceState(historyState, "", url);
    if (v5Compat && listener) {
      listener({ action, location: history.location, delta: 0 });
    }
  }
  function createURL(to) {
    return createBrowserURLImpl(to);
  }
  let history = {
    get action() {
      return action;
    },
    get location() {
      return getLocation(window2, globalHistory);
    },
    listen(fn) {
      if (listener) {
        throw new Error("A history only accepts one active listener");
      }
      window2.addEventListener(PopStateEventType, handlePop);
      listener = fn;
      return () => {
        window2.removeEventListener(PopStateEventType, handlePop);
        listener = null;
      };
    },
    createHref(to) {
      return createHref2(window2, to);
    },
    createURL,
    encodeLocation(to) {
      let url = createURL(to);
      return {
        pathname: url.pathname,
        search: url.search,
        hash: url.hash
      };
    },
    push,
    replace: replace2,
    go(n) {
      return globalHistory.go(n);
    }
  };
  return history;
}
function createBrowserURLImpl(to, isAbsolute = false) {
  let base = "http://localhost";
  if (typeof window !== "undefined") {
    base = window.location.origin !== "null" ? window.location.origin : window.location.href;
  }
  invariant(base, "No window.location.(origin|href) available to create URL");
  let href = typeof to === "string" ? to : createPath(to);
  href = href.replace(/ $/, "%20");
  if (!isAbsolute && href.startsWith("//")) {
    href = base + href;
  }
  return new URL(href, base);
}
function matchRoutes(routes, locationArg, basename = "/") {
  return matchRoutesImpl(routes, locationArg, basename, false);
}
function matchRoutesImpl(routes, locationArg, basename, allowPartial) {
  let location2 = typeof locationArg === "string" ? parsePath(locationArg) : locationArg;
  let pathname = stripBasename(location2.pathname || "/", basename);
  if (pathname == null) {
    return null;
  }
  let branches = flattenRoutes(routes);
  rankRouteBranches(branches);
  let matches = null;
  for (let i = 0; matches == null && i < branches.length; ++i) {
    let decoded = decodePath(pathname);
    matches = matchRouteBranch(
      branches[i],
      decoded,
      allowPartial
    );
  }
  return matches;
}
function flattenRoutes(routes, branches = [], parentsMeta = [], parentPath = "", _hasParentOptionalSegments = false) {
  let flattenRoute = (route, index, hasParentOptionalSegments = _hasParentOptionalSegments, relativePath) => {
    let meta = {
      relativePath: relativePath === void 0 ? route.path || "" : relativePath,
      caseSensitive: route.caseSensitive === true,
      childrenIndex: index,
      route
    };
    if (meta.relativePath.startsWith("/")) {
      if (!meta.relativePath.startsWith(parentPath) && hasParentOptionalSegments) {
        return;
      }
      invariant(
        meta.relativePath.startsWith(parentPath),
        `Absolute route path "${meta.relativePath}" nested under path "${parentPath}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`
      );
      meta.relativePath = meta.relativePath.slice(parentPath.length);
    }
    let path = joinPaths([parentPath, meta.relativePath]);
    let routesMeta = parentsMeta.concat(meta);
    if (route.children && route.children.length > 0) {
      invariant(
        // Our types know better, but runtime JS may not!
        // @ts-expect-error
        route.index !== true,
        `Index routes must not have child routes. Please remove all child routes from route path "${path}".`
      );
      flattenRoutes(
        route.children,
        branches,
        routesMeta,
        path,
        hasParentOptionalSegments
      );
    }
    if (route.path == null && !route.index) {
      return;
    }
    branches.push({
      path,
      score: computeScore(path, route.index),
      routesMeta
    });
  };
  routes.forEach((route, index) => {
    if (route.path === "" || !route.path?.includes("?")) {
      flattenRoute(route, index);
    } else {
      for (let exploded of explodeOptionalSegments(route.path)) {
        flattenRoute(route, index, true, exploded);
      }
    }
  });
  return branches;
}
function explodeOptionalSegments(path) {
  let segments = path.split("/");
  if (segments.length === 0) return [];
  let [first, ...rest] = segments;
  let isOptional = first.endsWith("?");
  let required = first.replace(/\?$/, "");
  if (rest.length === 0) {
    return isOptional ? [required, ""] : [required];
  }
  let restExploded = explodeOptionalSegments(rest.join("/"));
  let result = [];
  result.push(
    ...restExploded.map(
      (subpath) => subpath === "" ? required : [required, subpath].join("/")
    )
  );
  if (isOptional) {
    result.push(...restExploded);
  }
  return result.map(
    (exploded) => path.startsWith("/") && exploded === "" ? "/" : exploded
  );
}
function rankRouteBranches(branches) {
  branches.sort(
    (a, b) => a.score !== b.score ? b.score - a.score : compareIndexes(
      a.routesMeta.map((meta) => meta.childrenIndex),
      b.routesMeta.map((meta) => meta.childrenIndex)
    )
  );
}
var paramRe = /^:[\w-]+$/;
var dynamicSegmentValue = 3;
var indexRouteValue = 2;
var emptySegmentValue = 1;
var staticSegmentValue = 10;
var splatPenalty = -2;
var isSplat = (s) => s === "*";
function computeScore(path, index) {
  let segments = path.split("/");
  let initialScore = segments.length;
  if (segments.some(isSplat)) {
    initialScore += splatPenalty;
  }
  if (index) {
    initialScore += indexRouteValue;
  }
  return segments.filter((s) => !isSplat(s)).reduce(
    (score, segment) => score + (paramRe.test(segment) ? dynamicSegmentValue : segment === "" ? emptySegmentValue : staticSegmentValue),
    initialScore
  );
}
function compareIndexes(a, b) {
  let siblings = a.length === b.length && a.slice(0, -1).every((n, i) => n === b[i]);
  return siblings ? (
    // If two routes are siblings, we should try to match the earlier sibling
    // first. This allows people to have fine-grained control over the matching
    // behavior by simply putting routes with identical paths in the order they
    // want them tried.
    a[a.length - 1] - b[b.length - 1]
  ) : (
    // Otherwise, it doesn't really make sense to rank non-siblings by index,
    // so they sort equally.
    0
  );
}
function matchRouteBranch(branch, pathname, allowPartial = false) {
  let { routesMeta } = branch;
  let matchedParams = {};
  let matchedPathname = "/";
  let matches = [];
  for (let i = 0; i < routesMeta.length; ++i) {
    let meta = routesMeta[i];
    let end = i === routesMeta.length - 1;
    let remainingPathname = matchedPathname === "/" ? pathname : pathname.slice(matchedPathname.length) || "/";
    let match = matchPath(
      { path: meta.relativePath, caseSensitive: meta.caseSensitive, end },
      remainingPathname
    );
    let route = meta.route;
    if (!match && end && allowPartial && !routesMeta[routesMeta.length - 1].route.index) {
      match = matchPath(
        {
          path: meta.relativePath,
          caseSensitive: meta.caseSensitive,
          end: false
        },
        remainingPathname
      );
    }
    if (!match) {
      return null;
    }
    Object.assign(matchedParams, match.params);
    matches.push({
      // TODO: Can this as be avoided?
      params: matchedParams,
      pathname: joinPaths([matchedPathname, match.pathname]),
      pathnameBase: normalizePathname(
        joinPaths([matchedPathname, match.pathnameBase])
      ),
      route
    });
    if (match.pathnameBase !== "/") {
      matchedPathname = joinPaths([matchedPathname, match.pathnameBase]);
    }
  }
  return matches;
}
function matchPath(pattern, pathname) {
  if (typeof pattern === "string") {
    pattern = { path: pattern, caseSensitive: false, end: true };
  }
  let [matcher, compiledParams] = compilePath(
    pattern.path,
    pattern.caseSensitive,
    pattern.end
  );
  let match = pathname.match(matcher);
  if (!match) return null;
  let matchedPathname = match[0];
  let pathnameBase = matchedPathname.replace(/(.)\/+$/, "$1");
  let captureGroups = match.slice(1);
  let params = compiledParams.reduce(
    (memo2, { paramName, isOptional }, index) => {
      if (paramName === "*") {
        let splatValue = captureGroups[index] || "";
        pathnameBase = matchedPathname.slice(0, matchedPathname.length - splatValue.length).replace(/(.)\/+$/, "$1");
      }
      const value = captureGroups[index];
      if (isOptional && !value) {
        memo2[paramName] = void 0;
      } else {
        memo2[paramName] = (value || "").replace(/%2F/g, "/");
      }
      return memo2;
    },
    {}
  );
  return {
    params,
    pathname: matchedPathname,
    pathnameBase,
    pattern
  };
}
function compilePath(path, caseSensitive = false, end = true) {
  warning(
    path === "*" || !path.endsWith("*") || path.endsWith("/*"),
    `Route path "${path}" will be treated as if it were "${path.replace(/\*$/, "/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${path.replace(/\*$/, "/*")}".`
  );
  let params = [];
  let regexpSource = "^" + path.replace(/\/*\*?$/, "").replace(/^\/*/, "/").replace(/[\\.*+^${}|()[\]]/g, "\\$&").replace(
    /\/:([\w-]+)(\?)?/g,
    (_, paramName, isOptional) => {
      params.push({ paramName, isOptional: isOptional != null });
      return isOptional ? "/?([^\\/]+)?" : "/([^\\/]+)";
    }
  ).replace(/\/([\w-]+)\?(\/|$)/g, "(/$1)?$2");
  if (path.endsWith("*")) {
    params.push({ paramName: "*" });
    regexpSource += path === "*" || path === "/*" ? "(.*)$" : "(?:\\/(.+)|\\/*)$";
  } else if (end) {
    regexpSource += "\\/*$";
  } else if (path !== "" && path !== "/") {
    regexpSource += "(?:(?=\\/|$))";
  } else ;
  let matcher = new RegExp(regexpSource, caseSensitive ? void 0 : "i");
  return [matcher, params];
}
function decodePath(value) {
  try {
    return value.split("/").map((v) => decodeURIComponent(v).replace(/\//g, "%2F")).join("/");
  } catch (error) {
    warning(
      false,
      `The URL path "${value}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${error}).`
    );
    return value;
  }
}
function stripBasename(pathname, basename) {
  if (basename === "/") return pathname;
  if (!pathname.toLowerCase().startsWith(basename.toLowerCase())) {
    return null;
  }
  let startIndex = basename.endsWith("/") ? basename.length - 1 : basename.length;
  let nextChar = pathname.charAt(startIndex);
  if (nextChar && nextChar !== "/") {
    return null;
  }
  return pathname.slice(startIndex) || "/";
}
var ABSOLUTE_URL_REGEX = /^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;
var isAbsoluteUrl = (url) => ABSOLUTE_URL_REGEX.test(url);
function resolvePath(to, fromPathname = "/") {
  let {
    pathname: toPathname,
    search = "",
    hash = ""
  } = typeof to === "string" ? parsePath(to) : to;
  let pathname;
  if (toPathname) {
    if (isAbsoluteUrl(toPathname)) {
      pathname = toPathname;
    } else {
      if (toPathname.includes("//")) {
        let oldPathname = toPathname;
        toPathname = toPathname.replace(/\/\/+/g, "/");
        warning(
          false,
          `Pathnames cannot have embedded double slashes - normalizing ${oldPathname} -> ${toPathname}`
        );
      }
      if (toPathname.startsWith("/")) {
        pathname = resolvePathname(toPathname.substring(1), "/");
      } else {
        pathname = resolvePathname(toPathname, fromPathname);
      }
    }
  } else {
    pathname = fromPathname;
  }
  return {
    pathname,
    search: normalizeSearch(search),
    hash: normalizeHash(hash)
  };
}
function resolvePathname(relativePath, fromPathname) {
  let segments = fromPathname.replace(/\/+$/, "").split("/");
  let relativeSegments = relativePath.split("/");
  relativeSegments.forEach((segment) => {
    if (segment === "..") {
      if (segments.length > 1) segments.pop();
    } else if (segment !== ".") {
      segments.push(segment);
    }
  });
  return segments.length > 1 ? segments.join("/") : "/";
}
function getInvalidPathError(char, field, dest, path) {
  return `Cannot include a '${char}' character in a manually specified \`to.${field}\` field [${JSON.stringify(
    path
  )}].  Please separate it out to the \`to.${dest}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`;
}
function getPathContributingMatches(matches) {
  return matches.filter(
    (match, index) => index === 0 || match.route.path && match.route.path.length > 0
  );
}
function getResolveToMatches(matches) {
  let pathMatches = getPathContributingMatches(matches);
  return pathMatches.map(
    (match, idx) => idx === pathMatches.length - 1 ? match.pathname : match.pathnameBase
  );
}
function resolveTo(toArg, routePathnames, locationPathname, isPathRelative = false) {
  let to;
  if (typeof toArg === "string") {
    to = parsePath(toArg);
  } else {
    to = { ...toArg };
    invariant(
      !to.pathname || !to.pathname.includes("?"),
      getInvalidPathError("?", "pathname", "search", to)
    );
    invariant(
      !to.pathname || !to.pathname.includes("#"),
      getInvalidPathError("#", "pathname", "hash", to)
    );
    invariant(
      !to.search || !to.search.includes("#"),
      getInvalidPathError("#", "search", "hash", to)
    );
  }
  let isEmptyPath = toArg === "" || to.pathname === "";
  let toPathname = isEmptyPath ? "/" : to.pathname;
  let from;
  if (toPathname == null) {
    from = locationPathname;
  } else {
    let routePathnameIndex = routePathnames.length - 1;
    if (!isPathRelative && toPathname.startsWith("..")) {
      let toSegments = toPathname.split("/");
      while (toSegments[0] === "..") {
        toSegments.shift();
        routePathnameIndex -= 1;
      }
      to.pathname = toSegments.join("/");
    }
    from = routePathnameIndex >= 0 ? routePathnames[routePathnameIndex] : "/";
  }
  let path = resolvePath(to, from);
  let hasExplicitTrailingSlash = toPathname && toPathname !== "/" && toPathname.endsWith("/");
  let hasCurrentTrailingSlash = (isEmptyPath || toPathname === ".") && locationPathname.endsWith("/");
  if (!path.pathname.endsWith("/") && (hasExplicitTrailingSlash || hasCurrentTrailingSlash)) {
    path.pathname += "/";
  }
  return path;
}
var joinPaths = (paths) => paths.join("/").replace(/\/\/+/g, "/");
var normalizePathname = (pathname) => pathname.replace(/\/+$/, "").replace(/^\/*/, "/");
var normalizeSearch = (search) => !search || search === "?" ? "" : search.startsWith("?") ? search : "?" + search;
var normalizeHash = (hash) => !hash || hash === "#" ? "" : hash.startsWith("#") ? hash : "#" + hash;
function isRouteErrorResponse(error) {
  return error != null && typeof error.status === "number" && typeof error.statusText === "string" && typeof error.internal === "boolean" && "data" in error;
}
Object.getOwnPropertyNames(Object.prototype).sort().join("\0");
var validMutationMethodsArr = [
  "POST",
  "PUT",
  "PATCH",
  "DELETE"
];
new Set(
  validMutationMethodsArr
);
var validRequestMethodsArr = [
  "GET",
  ...validMutationMethodsArr
];
new Set(validRequestMethodsArr);
var DataRouterContext = reactExports.createContext(null);
DataRouterContext.displayName = "DataRouter";
var DataRouterStateContext = reactExports.createContext(null);
DataRouterStateContext.displayName = "DataRouterState";
reactExports.createContext(false);
var ViewTransitionContext = reactExports.createContext({
  isTransitioning: false
});
ViewTransitionContext.displayName = "ViewTransition";
var FetchersContext = reactExports.createContext(
  /* @__PURE__ */ new Map()
);
FetchersContext.displayName = "Fetchers";
var AwaitContext = reactExports.createContext(null);
AwaitContext.displayName = "Await";
var NavigationContext = reactExports.createContext(
  null
);
NavigationContext.displayName = "Navigation";
var LocationContext = reactExports.createContext(
  null
);
LocationContext.displayName = "Location";
var RouteContext = reactExports.createContext({
  outlet: null,
  matches: [],
  isDataRoute: false
});
RouteContext.displayName = "Route";
var RouteErrorContext = reactExports.createContext(null);
RouteErrorContext.displayName = "RouteError";
function useHref(to, { relative } = {}) {
  invariant(
    useInRouterContext(),
    // TODO: This error is probably because they somehow have 2 versions of the
    // router loaded. We can help them understand how to avoid that.
    `useHref() may be used only in the context of a <Router> component.`
  );
  let { basename, navigator: navigator2 } = reactExports.useContext(NavigationContext);
  let { hash, pathname, search } = useResolvedPath(to, { relative });
  let joinedPathname = pathname;
  if (basename !== "/") {
    joinedPathname = pathname === "/" ? basename : joinPaths([basename, pathname]);
  }
  return navigator2.createHref({ pathname: joinedPathname, search, hash });
}
function useInRouterContext() {
  return reactExports.useContext(LocationContext) != null;
}
function useLocation() {
  invariant(
    useInRouterContext(),
    // TODO: This error is probably because they somehow have 2 versions of the
    // router loaded. We can help them understand how to avoid that.
    `useLocation() may be used only in the context of a <Router> component.`
  );
  return reactExports.useContext(LocationContext).location;
}
var navigateEffectWarning = `You should call navigate() in a React.useEffect(), not when your component is first rendered.`;
function useIsomorphicLayoutEffect(cb) {
  let isStatic = reactExports.useContext(NavigationContext).static;
  if (!isStatic) {
    reactExports.useLayoutEffect(cb);
  }
}
function useNavigate() {
  let { isDataRoute } = reactExports.useContext(RouteContext);
  return isDataRoute ? useNavigateStable() : useNavigateUnstable();
}
function useNavigateUnstable() {
  invariant(
    useInRouterContext(),
    // TODO: This error is probably because they somehow have 2 versions of the
    // router loaded. We can help them understand how to avoid that.
    `useNavigate() may be used only in the context of a <Router> component.`
  );
  let dataRouterContext = reactExports.useContext(DataRouterContext);
  let { basename, navigator: navigator2 } = reactExports.useContext(NavigationContext);
  let { matches } = reactExports.useContext(RouteContext);
  let { pathname: locationPathname } = useLocation();
  let routePathnamesJson = JSON.stringify(getResolveToMatches(matches));
  let activeRef = reactExports.useRef(false);
  useIsomorphicLayoutEffect(() => {
    activeRef.current = true;
  });
  let navigate = reactExports.useCallback(
    (to, options = {}) => {
      warning(activeRef.current, navigateEffectWarning);
      if (!activeRef.current) return;
      if (typeof to === "number") {
        navigator2.go(to);
        return;
      }
      let path = resolveTo(
        to,
        JSON.parse(routePathnamesJson),
        locationPathname,
        options.relative === "path"
      );
      if (dataRouterContext == null && basename !== "/") {
        path.pathname = path.pathname === "/" ? basename : joinPaths([basename, path.pathname]);
      }
      (!!options.replace ? navigator2.replace : navigator2.push)(
        path,
        options.state,
        options
      );
    },
    [
      basename,
      navigator2,
      routePathnamesJson,
      locationPathname,
      dataRouterContext
    ]
  );
  return navigate;
}
var OutletContext = reactExports.createContext(null);
function useOutlet(context) {
  let outlet = reactExports.useContext(RouteContext).outlet;
  return reactExports.useMemo(
    () => outlet && /* @__PURE__ */ reactExports.createElement(OutletContext.Provider, { value: context }, outlet),
    [outlet, context]
  );
}
function useParams() {
  let { matches } = reactExports.useContext(RouteContext);
  let routeMatch = matches[matches.length - 1];
  return routeMatch ? routeMatch.params : {};
}
function useResolvedPath(to, { relative } = {}) {
  let { matches } = reactExports.useContext(RouteContext);
  let { pathname: locationPathname } = useLocation();
  let routePathnamesJson = JSON.stringify(getResolveToMatches(matches));
  return reactExports.useMemo(
    () => resolveTo(
      to,
      JSON.parse(routePathnamesJson),
      locationPathname,
      relative === "path"
    ),
    [to, routePathnamesJson, locationPathname, relative]
  );
}
function useRoutes(routes, locationArg) {
  return useRoutesImpl(routes, locationArg);
}
function useRoutesImpl(routes, locationArg, dataRouterState, unstable_onError, future) {
  invariant(
    useInRouterContext(),
    // TODO: This error is probably because they somehow have 2 versions of the
    // router loaded. We can help them understand how to avoid that.
    `useRoutes() may be used only in the context of a <Router> component.`
  );
  let { navigator: navigator2 } = reactExports.useContext(NavigationContext);
  let { matches: parentMatches } = reactExports.useContext(RouteContext);
  let routeMatch = parentMatches[parentMatches.length - 1];
  let parentParams = routeMatch ? routeMatch.params : {};
  let parentPathname = routeMatch ? routeMatch.pathname : "/";
  let parentPathnameBase = routeMatch ? routeMatch.pathnameBase : "/";
  let parentRoute = routeMatch && routeMatch.route;
  {
    let parentPath = parentRoute && parentRoute.path || "";
    warningOnce(
      parentPathname,
      !parentRoute || parentPath.endsWith("*") || parentPath.endsWith("*?"),
      `You rendered descendant <Routes> (or called \`useRoutes()\`) at "${parentPathname}" (under <Route path="${parentPath}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${parentPath}"> to <Route path="${parentPath === "/" ? "*" : `${parentPath}/*`}">.`
    );
  }
  let locationFromContext = useLocation();
  let location2;
  if (locationArg) {
    let parsedLocationArg = typeof locationArg === "string" ? parsePath(locationArg) : locationArg;
    invariant(
      parentPathnameBase === "/" || parsedLocationArg.pathname?.startsWith(parentPathnameBase),
      `When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${parentPathnameBase}" but pathname "${parsedLocationArg.pathname}" was given in the \`location\` prop.`
    );
    location2 = parsedLocationArg;
  } else {
    location2 = locationFromContext;
  }
  let pathname = location2.pathname || "/";
  let remainingPathname = pathname;
  if (parentPathnameBase !== "/") {
    let parentSegments = parentPathnameBase.replace(/^\//, "").split("/");
    let segments = pathname.replace(/^\//, "").split("/");
    remainingPathname = "/" + segments.slice(parentSegments.length).join("/");
  }
  let matches = matchRoutes(routes, { pathname: remainingPathname });
  {
    warning(
      parentRoute || matches != null,
      `No routes matched location "${location2.pathname}${location2.search}${location2.hash}" `
    );
    warning(
      matches == null || matches[matches.length - 1].route.element !== void 0 || matches[matches.length - 1].route.Component !== void 0 || matches[matches.length - 1].route.lazy !== void 0,
      `Matched leaf route at location "${location2.pathname}${location2.search}${location2.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`
    );
  }
  let renderedMatches = _renderMatches(
    matches && matches.map(
      (match) => Object.assign({}, match, {
        params: Object.assign({}, parentParams, match.params),
        pathname: joinPaths([
          parentPathnameBase,
          // Re-encode pathnames that were decoded inside matchRoutes.
          // Pre-encode `?` and `#` ahead of `encodeLocation` because it uses
          // `new URL()` internally and we need to prevent it from treating
          // them as separators
          navigator2.encodeLocation ? navigator2.encodeLocation(
            match.pathname.replace(/\?/g, "%3F").replace(/#/g, "%23")
          ).pathname : match.pathname
        ]),
        pathnameBase: match.pathnameBase === "/" ? parentPathnameBase : joinPaths([
          parentPathnameBase,
          // Re-encode pathnames that were decoded inside matchRoutes
          // Pre-encode `?` and `#` ahead of `encodeLocation` because it uses
          // `new URL()` internally and we need to prevent it from treating
          // them as separators
          navigator2.encodeLocation ? navigator2.encodeLocation(
            match.pathnameBase.replace(/\?/g, "%3F").replace(/#/g, "%23")
          ).pathname : match.pathnameBase
        ])
      })
    ),
    parentMatches,
    dataRouterState,
    unstable_onError,
    future
  );
  if (locationArg && renderedMatches) {
    return /* @__PURE__ */ reactExports.createElement(
      LocationContext.Provider,
      {
        value: {
          location: {
            pathname: "/",
            search: "",
            hash: "",
            state: null,
            key: "default",
            ...location2
          },
          navigationType: "POP"
          /* Pop */
        }
      },
      renderedMatches
    );
  }
  return renderedMatches;
}
function DefaultErrorComponent() {
  let error = useRouteError();
  let message = isRouteErrorResponse(error) ? `${error.status} ${error.statusText}` : error instanceof Error ? error.message : JSON.stringify(error);
  let stack = error instanceof Error ? error.stack : null;
  let lightgrey = "rgba(200,200,200, 0.5)";
  let preStyles = { padding: "0.5rem", backgroundColor: lightgrey };
  let codeStyles = { padding: "2px 4px", backgroundColor: lightgrey };
  let devInfo = null;
  {
    console.error(
      "Error handled by React Router default ErrorBoundary:",
      error
    );
    devInfo = /* @__PURE__ */ reactExports.createElement(reactExports.Fragment, null, /* @__PURE__ */ reactExports.createElement("p", null, "ðŸ’¿ Hey developer ðŸ‘‹"), /* @__PURE__ */ reactExports.createElement("p", null, "You can provide a way better UX than this when your app throws errors by providing your own ", /* @__PURE__ */ reactExports.createElement("code", { style: codeStyles }, "ErrorBoundary"), " or", " ", /* @__PURE__ */ reactExports.createElement("code", { style: codeStyles }, "errorElement"), " prop on your route."));
  }
  return /* @__PURE__ */ reactExports.createElement(reactExports.Fragment, null, /* @__PURE__ */ reactExports.createElement("h2", null, "Unexpected Application Error!"), /* @__PURE__ */ reactExports.createElement("h3", { style: { fontStyle: "italic" } }, message), stack ? /* @__PURE__ */ reactExports.createElement("pre", { style: preStyles }, stack) : null, devInfo);
}
var defaultErrorElement = /* @__PURE__ */ reactExports.createElement(DefaultErrorComponent, null);
var RenderErrorBoundary = class extends reactExports.Component {
  constructor(props) {
    super(props);
    this.state = {
      location: props.location,
      revalidation: props.revalidation,
      error: props.error
    };
  }
  static getDerivedStateFromError(error) {
    return { error };
  }
  static getDerivedStateFromProps(props, state) {
    if (state.location !== props.location || state.revalidation !== "idle" && props.revalidation === "idle") {
      return {
        error: props.error,
        location: props.location,
        revalidation: props.revalidation
      };
    }
    return {
      error: props.error !== void 0 ? props.error : state.error,
      location: state.location,
      revalidation: props.revalidation || state.revalidation
    };
  }
  componentDidCatch(error, errorInfo) {
    if (this.props.onError) {
      this.props.onError(error, errorInfo);
    } else {
      console.error(
        "React Router caught the following error during render",
        error
      );
    }
  }
  render() {
    return this.state.error !== void 0 ? /* @__PURE__ */ reactExports.createElement(RouteContext.Provider, { value: this.props.routeContext }, /* @__PURE__ */ reactExports.createElement(
      RouteErrorContext.Provider,
      {
        value: this.state.error,
        children: this.props.component
      }
    )) : this.props.children;
  }
};
function RenderedRoute({ routeContext, match, children }) {
  let dataRouterContext = reactExports.useContext(DataRouterContext);
  if (dataRouterContext && dataRouterContext.static && dataRouterContext.staticContext && (match.route.errorElement || match.route.ErrorBoundary)) {
    dataRouterContext.staticContext._deepestRenderedBoundaryId = match.route.id;
  }
  return /* @__PURE__ */ reactExports.createElement(RouteContext.Provider, { value: routeContext }, children);
}
function _renderMatches(matches, parentMatches = [], dataRouterState = null, unstable_onError = null, future = null) {
  if (matches == null) {
    if (!dataRouterState) {
      return null;
    }
    if (dataRouterState.errors) {
      matches = dataRouterState.matches;
    } else if (parentMatches.length === 0 && !dataRouterState.initialized && dataRouterState.matches.length > 0) {
      matches = dataRouterState.matches;
    } else {
      return null;
    }
  }
  let renderedMatches = matches;
  let errors = dataRouterState?.errors;
  if (errors != null) {
    let errorIndex = renderedMatches.findIndex(
      (m) => m.route.id && errors?.[m.route.id] !== void 0
    );
    invariant(
      errorIndex >= 0,
      `Could not find a matching route for errors on route IDs: ${Object.keys(
        errors
      ).join(",")}`
    );
    renderedMatches = renderedMatches.slice(
      0,
      Math.min(renderedMatches.length, errorIndex + 1)
    );
  }
  let renderFallback = false;
  let fallbackIndex = -1;
  if (dataRouterState) {
    for (let i = 0; i < renderedMatches.length; i++) {
      let match = renderedMatches[i];
      if (match.route.HydrateFallback || match.route.hydrateFallbackElement) {
        fallbackIndex = i;
      }
      if (match.route.id) {
        let { loaderData, errors: errors2 } = dataRouterState;
        let needsToRunLoader = match.route.loader && !loaderData.hasOwnProperty(match.route.id) && (!errors2 || errors2[match.route.id] === void 0);
        if (match.route.lazy || needsToRunLoader) {
          renderFallback = true;
          if (fallbackIndex >= 0) {
            renderedMatches = renderedMatches.slice(0, fallbackIndex + 1);
          } else {
            renderedMatches = [renderedMatches[0]];
          }
          break;
        }
      }
    }
  }
  let onError = dataRouterState && unstable_onError ? (error, errorInfo) => {
    unstable_onError(error, {
      location: dataRouterState.location,
      params: dataRouterState.matches?.[0]?.params ?? {},
      errorInfo
    });
  } : void 0;
  return renderedMatches.reduceRight(
    (outlet, match, index) => {
      let error;
      let shouldRenderHydrateFallback = false;
      let errorElement = null;
      let hydrateFallbackElement = null;
      if (dataRouterState) {
        error = errors && match.route.id ? errors[match.route.id] : void 0;
        errorElement = match.route.errorElement || defaultErrorElement;
        if (renderFallback) {
          if (fallbackIndex < 0 && index === 0) {
            warningOnce(
              "route-fallback",
              false,
              "No `HydrateFallback` element provided to render during initial hydration"
            );
            shouldRenderHydrateFallback = true;
            hydrateFallbackElement = null;
          } else if (fallbackIndex === index) {
            shouldRenderHydrateFallback = true;
            hydrateFallbackElement = match.route.hydrateFallbackElement || null;
          }
        }
      }
      let matches2 = parentMatches.concat(renderedMatches.slice(0, index + 1));
      let getChildren = () => {
        let children;
        if (error) {
          children = errorElement;
        } else if (shouldRenderHydrateFallback) {
          children = hydrateFallbackElement;
        } else if (match.route.Component) {
          children = /* @__PURE__ */ reactExports.createElement(match.route.Component, null);
        } else if (match.route.element) {
          children = match.route.element;
        } else {
          children = outlet;
        }
        return /* @__PURE__ */ reactExports.createElement(
          RenderedRoute,
          {
            match,
            routeContext: {
              outlet,
              matches: matches2,
              isDataRoute: dataRouterState != null
            },
            children
          }
        );
      };
      return dataRouterState && (match.route.ErrorBoundary || match.route.errorElement || index === 0) ? /* @__PURE__ */ reactExports.createElement(
        RenderErrorBoundary,
        {
          location: dataRouterState.location,
          revalidation: dataRouterState.revalidation,
          component: errorElement,
          error,
          children: getChildren(),
          routeContext: { outlet: null, matches: matches2, isDataRoute: true },
          onError
        }
      ) : getChildren();
    },
    null
  );
}
function getDataRouterConsoleError(hookName) {
  return `${hookName} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`;
}
function useDataRouterContext(hookName) {
  let ctx = reactExports.useContext(DataRouterContext);
  invariant(ctx, getDataRouterConsoleError(hookName));
  return ctx;
}
function useDataRouterState(hookName) {
  let state = reactExports.useContext(DataRouterStateContext);
  invariant(state, getDataRouterConsoleError(hookName));
  return state;
}
function useRouteContext(hookName) {
  let route = reactExports.useContext(RouteContext);
  invariant(route, getDataRouterConsoleError(hookName));
  return route;
}
function useCurrentRouteId(hookName) {
  let route = useRouteContext(hookName);
  let thisRoute = route.matches[route.matches.length - 1];
  invariant(
    thisRoute.route.id,
    `${hookName} can only be used on routes that contain a unique "id"`
  );
  return thisRoute.route.id;
}
function useRouteId() {
  return useCurrentRouteId(
    "useRouteId"
    /* UseRouteId */
  );
}
function useRouteError() {
  let error = reactExports.useContext(RouteErrorContext);
  let state = useDataRouterState(
    "useRouteError"
    /* UseRouteError */
  );
  let routeId = useCurrentRouteId(
    "useRouteError"
    /* UseRouteError */
  );
  if (error !== void 0) {
    return error;
  }
  return state.errors?.[routeId];
}
function useNavigateStable() {
  let { router } = useDataRouterContext(
    "useNavigate"
    /* UseNavigateStable */
  );
  let id = useCurrentRouteId(
    "useNavigate"
    /* UseNavigateStable */
  );
  let activeRef = reactExports.useRef(false);
  useIsomorphicLayoutEffect(() => {
    activeRef.current = true;
  });
  let navigate = reactExports.useCallback(
    async (to, options = {}) => {
      warning(activeRef.current, navigateEffectWarning);
      if (!activeRef.current) return;
      if (typeof to === "number") {
        router.navigate(to);
      } else {
        await router.navigate(to, { fromRouteId: id, ...options });
      }
    },
    [router, id]
  );
  return navigate;
}
var alreadyWarned = {};
function warningOnce(key, cond, message) {
  if (!cond && !alreadyWarned[key]) {
    alreadyWarned[key] = true;
    warning(false, message);
  }
}
reactExports.memo(DataRoutes);
function DataRoutes({
  routes,
  future,
  state,
  unstable_onError
}) {
  return useRoutesImpl(routes, void 0, state, unstable_onError, future);
}
function Navigate({
  to,
  replace: replace2,
  state,
  relative
}) {
  invariant(
    useInRouterContext(),
    // TODO: This error is probably because they somehow have 2 versions of
    // the router loaded. We can help them understand how to avoid that.
    `<Navigate> may be used only in the context of a <Router> component.`
  );
  let { static: isStatic } = reactExports.useContext(NavigationContext);
  warning(
    !isStatic,
    `<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.`
  );
  let { matches } = reactExports.useContext(RouteContext);
  let { pathname: locationPathname } = useLocation();
  let navigate = useNavigate();
  let path = resolveTo(
    to,
    getResolveToMatches(matches),
    locationPathname,
    relative === "path"
  );
  let jsonPath = JSON.stringify(path);
  reactExports.useEffect(() => {
    navigate(JSON.parse(jsonPath), { replace: replace2, state, relative });
  }, [navigate, jsonPath, relative, replace2, state]);
  return null;
}
function Outlet(props) {
  return useOutlet(props.context);
}
function Route(props) {
  invariant(
    false,
    `A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.`
  );
}
function Router({
  basename: basenameProp = "/",
  children = null,
  location: locationProp,
  navigationType = "POP",
  navigator: navigator2,
  static: staticProp = false
}) {
  invariant(
    !useInRouterContext(),
    `You cannot render a <Router> inside another <Router>. You should never have more than one in your app.`
  );
  let basename = basenameProp.replace(/^\/*/, "/");
  let navigationContext = reactExports.useMemo(
    () => ({
      basename,
      navigator: navigator2,
      static: staticProp,
      future: {}
    }),
    [basename, navigator2, staticProp]
  );
  if (typeof locationProp === "string") {
    locationProp = parsePath(locationProp);
  }
  let {
    pathname = "/",
    search = "",
    hash = "",
    state = null,
    key = "default"
  } = locationProp;
  let locationContext = reactExports.useMemo(() => {
    let trailingPathname = stripBasename(pathname, basename);
    if (trailingPathname == null) {
      return null;
    }
    return {
      location: {
        pathname: trailingPathname,
        search,
        hash,
        state,
        key
      },
      navigationType
    };
  }, [basename, pathname, search, hash, state, key, navigationType]);
  warning(
    locationContext != null,
    `<Router basename="${basename}"> is not able to match the URL "${pathname}${search}${hash}" because it does not start with the basename, so the <Router> won't render anything.`
  );
  if (locationContext == null) {
    return null;
  }
  return /* @__PURE__ */ reactExports.createElement(NavigationContext.Provider, { value: navigationContext }, /* @__PURE__ */ reactExports.createElement(LocationContext.Provider, { children, value: locationContext }));
}
function Routes({
  children,
  location: location2
}) {
  return useRoutes(createRoutesFromChildren(children), location2);
}
function createRoutesFromChildren(children, parentPath = []) {
  let routes = [];
  reactExports.Children.forEach(children, (element, index) => {
    if (!reactExports.isValidElement(element)) {
      return;
    }
    let treePath = [...parentPath, index];
    if (element.type === reactExports.Fragment) {
      routes.push.apply(
        routes,
        createRoutesFromChildren(element.props.children, treePath)
      );
      return;
    }
    invariant(
      element.type === Route,
      `[${typeof element.type === "string" ? element.type : element.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`
    );
    invariant(
      !element.props.index || !element.props.children,
      "An index route cannot have child routes."
    );
    let route = {
      id: element.props.id || treePath.join("-"),
      caseSensitive: element.props.caseSensitive,
      element: element.props.element,
      Component: element.props.Component,
      index: element.props.index,
      path: element.props.path,
      middleware: element.props.middleware,
      loader: element.props.loader,
      action: element.props.action,
      hydrateFallbackElement: element.props.hydrateFallbackElement,
      HydrateFallback: element.props.HydrateFallback,
      errorElement: element.props.errorElement,
      ErrorBoundary: element.props.ErrorBoundary,
      hasErrorBoundary: element.props.hasErrorBoundary === true || element.props.ErrorBoundary != null || element.props.errorElement != null,
      shouldRevalidate: element.props.shouldRevalidate,
      handle: element.props.handle,
      lazy: element.props.lazy
    };
    if (element.props.children) {
      route.children = createRoutesFromChildren(
        element.props.children,
        treePath
      );
    }
    routes.push(route);
  });
  return routes;
}
var defaultMethod = "get";
var defaultEncType = "application/x-www-form-urlencoded";
function isHtmlElement(object) {
  return object != null && typeof object.tagName === "string";
}
function isButtonElement(object) {
  return isHtmlElement(object) && object.tagName.toLowerCase() === "button";
}
function isFormElement(object) {
  return isHtmlElement(object) && object.tagName.toLowerCase() === "form";
}
function isInputElement(object) {
  return isHtmlElement(object) && object.tagName.toLowerCase() === "input";
}
function isModifiedEvent(event) {
  return !!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);
}
function shouldProcessLinkClick(event, target) {
  return event.button === 0 && // Ignore everything but left clicks
  (!target || target === "_self") && // Let browser handle "target=_blank" etc.
  !isModifiedEvent(event);
}
function createSearchParams(init = "") {
  return new URLSearchParams(
    typeof init === "string" || Array.isArray(init) || init instanceof URLSearchParams ? init : Object.keys(init).reduce((memo2, key) => {
      let value = init[key];
      return memo2.concat(
        Array.isArray(value) ? value.map((v) => [key, v]) : [[key, value]]
      );
    }, [])
  );
}
function getSearchParamsForLocation(locationSearch, defaultSearchParams) {
  let searchParams = createSearchParams(locationSearch);
  if (defaultSearchParams) {
    defaultSearchParams.forEach((_, key) => {
      if (!searchParams.has(key)) {
        defaultSearchParams.getAll(key).forEach((value) => {
          searchParams.append(key, value);
        });
      }
    });
  }
  return searchParams;
}
var _formDataSupportsSubmitter = null;
function isFormDataSubmitterSupported() {
  if (_formDataSupportsSubmitter === null) {
    try {
      new FormData(
        document.createElement("form"),
        // @ts-expect-error if FormData supports the submitter parameter, this will throw
        0
      );
      _formDataSupportsSubmitter = false;
    } catch (e) {
      _formDataSupportsSubmitter = true;
    }
  }
  return _formDataSupportsSubmitter;
}
var supportedFormEncTypes = /* @__PURE__ */ new Set([
  "application/x-www-form-urlencoded",
  "multipart/form-data",
  "text/plain"
]);
function getFormEncType(encType) {
  if (encType != null && !supportedFormEncTypes.has(encType)) {
    warning(
      false,
      `"${encType}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${defaultEncType}"`
    );
    return null;
  }
  return encType;
}
function getFormSubmissionInfo(target, basename) {
  let method;
  let action;
  let encType;
  let formData;
  let body;
  if (isFormElement(target)) {
    let attr = target.getAttribute("action");
    action = attr ? stripBasename(attr, basename) : null;
    method = target.getAttribute("method") || defaultMethod;
    encType = getFormEncType(target.getAttribute("enctype")) || defaultEncType;
    formData = new FormData(target);
  } else if (isButtonElement(target) || isInputElement(target) && (target.type === "submit" || target.type === "image")) {
    let form = target.form;
    if (form == null) {
      throw new Error(
        `Cannot submit a <button> or <input type="submit"> without a <form>`
      );
    }
    let attr = target.getAttribute("formaction") || form.getAttribute("action");
    action = attr ? stripBasename(attr, basename) : null;
    method = target.getAttribute("formmethod") || form.getAttribute("method") || defaultMethod;
    encType = getFormEncType(target.getAttribute("formenctype")) || getFormEncType(form.getAttribute("enctype")) || defaultEncType;
    formData = new FormData(form, target);
    if (!isFormDataSubmitterSupported()) {
      let { name, type, value } = target;
      if (type === "image") {
        let prefix = name ? `${name}.` : "";
        formData.append(`${prefix}x`, "0");
        formData.append(`${prefix}y`, "0");
      } else if (name) {
        formData.append(name, value);
      }
    }
  } else if (isHtmlElement(target)) {
    throw new Error(
      `Cannot submit element that is not <form>, <button>, or <input type="submit|image">`
    );
  } else {
    method = defaultMethod;
    action = null;
    encType = defaultEncType;
    body = target;
  }
  if (formData && encType === "text/plain") {
    body = formData;
    formData = void 0;
  }
  return { action, method: method.toLowerCase(), encType, formData, body };
}
Object.getOwnPropertyNames(Object.prototype).sort().join("\0");
function invariant2(value, message) {
  if (value === false || value === null || typeof value === "undefined") {
    throw new Error(message);
  }
}
function singleFetchUrl(reqUrl, basename, extension) {
  let url = typeof reqUrl === "string" ? new URL(
    reqUrl,
    // This can be called during the SSR flow via PrefetchPageLinksImpl so
    // don't assume window is available
    typeof window === "undefined" ? "server://singlefetch/" : window.location.origin
  ) : reqUrl;
  if (url.pathname === "/") {
    url.pathname = `_root.${extension}`;
  } else if (basename && stripBasename(url.pathname, basename) === "/") {
    url.pathname = `${basename.replace(/\/$/, "")}/_root.${extension}`;
  } else {
    url.pathname = `${url.pathname.replace(/\/$/, "")}.${extension}`;
  }
  return url;
}
async function loadRouteModule(route, routeModulesCache) {
  if (route.id in routeModulesCache) {
    return routeModulesCache[route.id];
  }
  try {
    let routeModule = await import(
      /* @vite-ignore */
      /* webpackIgnore: true */
      route.module
    );
    routeModulesCache[route.id] = routeModule;
    return routeModule;
  } catch (error) {
    console.error(
      `Error loading route module \`${route.module}\`, reloading page...`
    );
    console.error(error);
    if (window.__reactRouterContext && window.__reactRouterContext.isSpaMode && // @ts-expect-error
    void 0) ;
    window.location.reload();
    return new Promise(() => {
    });
  }
}
function isHtmlLinkDescriptor(object) {
  if (object == null) {
    return false;
  }
  if (object.href == null) {
    return object.rel === "preload" && typeof object.imageSrcSet === "string" && typeof object.imageSizes === "string";
  }
  return typeof object.rel === "string" && typeof object.href === "string";
}
async function getKeyedPrefetchLinks(matches, manifest, routeModules) {
  let links = await Promise.all(
    matches.map(async (match) => {
      let route = manifest.routes[match.route.id];
      if (route) {
        let mod = await loadRouteModule(route, routeModules);
        return mod.links ? mod.links() : [];
      }
      return [];
    })
  );
  return dedupeLinkDescriptors(
    links.flat(1).filter(isHtmlLinkDescriptor).filter((link) => link.rel === "stylesheet" || link.rel === "preload").map(
      (link) => link.rel === "stylesheet" ? { ...link, rel: "prefetch", as: "style" } : { ...link, rel: "prefetch" }
    )
  );
}
function getNewMatchesForLinks(page, nextMatches, currentMatches, manifest, location2, mode) {
  let isNew = (match, index) => {
    if (!currentMatches[index]) return true;
    return match.route.id !== currentMatches[index].route.id;
  };
  let matchPathChanged = (match, index) => {
    return (
      // param change, /users/123 -> /users/456
      currentMatches[index].pathname !== match.pathname || // splat param changed, which is not present in match.path
      // e.g. /files/images/avatar.jpg -> files/finances.xls
      currentMatches[index].route.path?.endsWith("*") && currentMatches[index].params["*"] !== match.params["*"]
    );
  };
  if (mode === "assets") {
    return nextMatches.filter(
      (match, index) => isNew(match, index) || matchPathChanged(match, index)
    );
  }
  if (mode === "data") {
    return nextMatches.filter((match, index) => {
      let manifestRoute = manifest.routes[match.route.id];
      if (!manifestRoute || !manifestRoute.hasLoader) {
        return false;
      }
      if (isNew(match, index) || matchPathChanged(match, index)) {
        return true;
      }
      if (match.route.shouldRevalidate) {
        let routeChoice = match.route.shouldRevalidate({
          currentUrl: new URL(
            location2.pathname + location2.search + location2.hash,
            window.origin
          ),
          currentParams: currentMatches[0]?.params || {},
          nextUrl: new URL(page, window.origin),
          nextParams: match.params,
          defaultShouldRevalidate: true
        });
        if (typeof routeChoice === "boolean") {
          return routeChoice;
        }
      }
      return true;
    });
  }
  return [];
}
function getModuleLinkHrefs(matches, manifest, { includeHydrateFallback } = {}) {
  return dedupeHrefs(
    matches.map((match) => {
      let route = manifest.routes[match.route.id];
      if (!route) return [];
      let hrefs = [route.module];
      if (route.clientActionModule) {
        hrefs = hrefs.concat(route.clientActionModule);
      }
      if (route.clientLoaderModule) {
        hrefs = hrefs.concat(route.clientLoaderModule);
      }
      if (includeHydrateFallback && route.hydrateFallbackModule) {
        hrefs = hrefs.concat(route.hydrateFallbackModule);
      }
      if (route.imports) {
        hrefs = hrefs.concat(route.imports);
      }
      return hrefs;
    }).flat(1)
  );
}
function dedupeHrefs(hrefs) {
  return [...new Set(hrefs)];
}
function sortKeys(obj) {
  let sorted = {};
  let keys = Object.keys(obj).sort();
  for (let key of keys) {
    sorted[key] = obj[key];
  }
  return sorted;
}
function dedupeLinkDescriptors(descriptors, preloads) {
  let set = /* @__PURE__ */ new Set();
  new Set(preloads);
  return descriptors.reduce((deduped, descriptor) => {
    let key = JSON.stringify(sortKeys(descriptor));
    if (!set.has(key)) {
      set.add(key);
      deduped.push({ key, link: descriptor });
    }
    return deduped;
  }, []);
}
function useDataRouterContext2() {
  let context = reactExports.useContext(DataRouterContext);
  invariant2(
    context,
    "You must render this element inside a <DataRouterContext.Provider> element"
  );
  return context;
}
function useDataRouterStateContext() {
  let context = reactExports.useContext(DataRouterStateContext);
  invariant2(
    context,
    "You must render this element inside a <DataRouterStateContext.Provider> element"
  );
  return context;
}
var FrameworkContext = reactExports.createContext(void 0);
FrameworkContext.displayName = "FrameworkContext";
function useFrameworkContext() {
  let context = reactExports.useContext(FrameworkContext);
  invariant2(
    context,
    "You must render this element inside a <HydratedRouter> element"
  );
  return context;
}
function usePrefetchBehavior(prefetch, theirElementProps) {
  let frameworkContext = reactExports.useContext(FrameworkContext);
  let [maybePrefetch, setMaybePrefetch] = reactExports.useState(false);
  let [shouldPrefetch, setShouldPrefetch] = reactExports.useState(false);
  let { onFocus, onBlur, onMouseEnter, onMouseLeave, onTouchStart } = theirElementProps;
  let ref = reactExports.useRef(null);
  reactExports.useEffect(() => {
    if (prefetch === "render") {
      setShouldPrefetch(true);
    }
    if (prefetch === "viewport") {
      let callback = (entries) => {
        entries.forEach((entry) => {
          setShouldPrefetch(entry.isIntersecting);
        });
      };
      let observer = new IntersectionObserver(callback, { threshold: 0.5 });
      if (ref.current) observer.observe(ref.current);
      return () => {
        observer.disconnect();
      };
    }
  }, [prefetch]);
  reactExports.useEffect(() => {
    if (maybePrefetch) {
      let id = setTimeout(() => {
        setShouldPrefetch(true);
      }, 100);
      return () => {
        clearTimeout(id);
      };
    }
  }, [maybePrefetch]);
  let setIntent = () => {
    setMaybePrefetch(true);
  };
  let cancelIntent = () => {
    setMaybePrefetch(false);
    setShouldPrefetch(false);
  };
  if (!frameworkContext) {
    return [false, ref, {}];
  }
  if (prefetch !== "intent") {
    return [shouldPrefetch, ref, {}];
  }
  return [
    shouldPrefetch,
    ref,
    {
      onFocus: composeEventHandlers(onFocus, setIntent),
      onBlur: composeEventHandlers(onBlur, cancelIntent),
      onMouseEnter: composeEventHandlers(onMouseEnter, setIntent),
      onMouseLeave: composeEventHandlers(onMouseLeave, cancelIntent),
      onTouchStart: composeEventHandlers(onTouchStart, setIntent)
    }
  ];
}
function composeEventHandlers(theirHandler, ourHandler) {
  return (event) => {
    theirHandler && theirHandler(event);
    if (!event.defaultPrevented) {
      ourHandler(event);
    }
  };
}
function PrefetchPageLinks({ page, ...linkProps }) {
  let { router } = useDataRouterContext2();
  let matches = reactExports.useMemo(
    () => matchRoutes(router.routes, page, router.basename),
    [router.routes, page, router.basename]
  );
  if (!matches) {
    return null;
  }
  return /* @__PURE__ */ reactExports.createElement(PrefetchPageLinksImpl, { page, matches, ...linkProps });
}
function useKeyedPrefetchLinks(matches) {
  let { manifest, routeModules } = useFrameworkContext();
  let [keyedPrefetchLinks, setKeyedPrefetchLinks] = reactExports.useState([]);
  reactExports.useEffect(() => {
    let interrupted = false;
    void getKeyedPrefetchLinks(matches, manifest, routeModules).then(
      (links) => {
        if (!interrupted) {
          setKeyedPrefetchLinks(links);
        }
      }
    );
    return () => {
      interrupted = true;
    };
  }, [matches, manifest, routeModules]);
  return keyedPrefetchLinks;
}
function PrefetchPageLinksImpl({
  page,
  matches: nextMatches,
  ...linkProps
}) {
  let location2 = useLocation();
  let { manifest, routeModules } = useFrameworkContext();
  let { basename } = useDataRouterContext2();
  let { loaderData, matches } = useDataRouterStateContext();
  let newMatchesForData = reactExports.useMemo(
    () => getNewMatchesForLinks(
      page,
      nextMatches,
      matches,
      manifest,
      location2,
      "data"
    ),
    [page, nextMatches, matches, manifest, location2]
  );
  let newMatchesForAssets = reactExports.useMemo(
    () => getNewMatchesForLinks(
      page,
      nextMatches,
      matches,
      manifest,
      location2,
      "assets"
    ),
    [page, nextMatches, matches, manifest, location2]
  );
  let dataHrefs = reactExports.useMemo(() => {
    if (page === location2.pathname + location2.search + location2.hash) {
      return [];
    }
    let routesParams = /* @__PURE__ */ new Set();
    let foundOptOutRoute = false;
    nextMatches.forEach((m) => {
      let manifestRoute = manifest.routes[m.route.id];
      if (!manifestRoute || !manifestRoute.hasLoader) {
        return;
      }
      if (!newMatchesForData.some((m2) => m2.route.id === m.route.id) && m.route.id in loaderData && routeModules[m.route.id]?.shouldRevalidate) {
        foundOptOutRoute = true;
      } else if (manifestRoute.hasClientLoader) {
        foundOptOutRoute = true;
      } else {
        routesParams.add(m.route.id);
      }
    });
    if (routesParams.size === 0) {
      return [];
    }
    let url = singleFetchUrl(page, basename, "data");
    if (foundOptOutRoute && routesParams.size > 0) {
      url.searchParams.set(
        "_routes",
        nextMatches.filter((m) => routesParams.has(m.route.id)).map((m) => m.route.id).join(",")
      );
    }
    return [url.pathname + url.search];
  }, [
    basename,
    loaderData,
    location2,
    manifest,
    newMatchesForData,
    nextMatches,
    page,
    routeModules
  ]);
  let moduleHrefs = reactExports.useMemo(
    () => getModuleLinkHrefs(newMatchesForAssets, manifest),
    [newMatchesForAssets, manifest]
  );
  let keyedPrefetchLinks = useKeyedPrefetchLinks(newMatchesForAssets);
  return /* @__PURE__ */ reactExports.createElement(reactExports.Fragment, null, dataHrefs.map((href) => /* @__PURE__ */ reactExports.createElement("link", { key: href, rel: "prefetch", as: "fetch", href, ...linkProps })), moduleHrefs.map((href) => /* @__PURE__ */ reactExports.createElement("link", { key: href, rel: "modulepreload", href, ...linkProps })), keyedPrefetchLinks.map(({ key, link }) => (
    // these don't spread `linkProps` because they are full link descriptors
    // already with their own props
    /* @__PURE__ */ reactExports.createElement("link", { key, nonce: linkProps.nonce, ...link })
  )));
}
function mergeRefs(...refs) {
  return (value) => {
    refs.forEach((ref) => {
      if (typeof ref === "function") {
        ref(value);
      } else if (ref != null) {
        ref.current = value;
      }
    });
  };
}
var isBrowser = typeof window !== "undefined" && typeof window.document !== "undefined" && typeof window.document.createElement !== "undefined";
try {
  if (isBrowser) {
    window.__reactRouterVersion = // @ts-expect-error
    "7.9.6";
  }
} catch (e) {
}
function BrowserRouter({
  basename,
  children,
  window: window2
}) {
  let historyRef = reactExports.useRef();
  if (historyRef.current == null) {
    historyRef.current = createBrowserHistory({ window: window2, v5Compat: true });
  }
  let history = historyRef.current;
  let [state, setStateImpl] = reactExports.useState({
    action: history.action,
    location: history.location
  });
  let setState = reactExports.useCallback(
    (newState) => {
      reactExports.startTransition(() => setStateImpl(newState));
    },
    [setStateImpl]
  );
  reactExports.useLayoutEffect(() => history.listen(setState), [history, setState]);
  return /* @__PURE__ */ reactExports.createElement(
    Router,
    {
      basename,
      children,
      location: state.location,
      navigationType: state.action,
      navigator: history
    }
  );
}
function HashRouter({ basename, children, window: window2 }) {
  let historyRef = reactExports.useRef();
  if (historyRef.current == null) {
    historyRef.current = createHashHistory({ window: window2, v5Compat: true });
  }
  let history = historyRef.current;
  let [state, setStateImpl] = reactExports.useState({
    action: history.action,
    location: history.location
  });
  let setState = reactExports.useCallback(
    (newState) => {
      reactExports.startTransition(() => setStateImpl(newState));
    },
    [setStateImpl]
  );
  reactExports.useLayoutEffect(() => history.listen(setState), [history, setState]);
  return /* @__PURE__ */ reactExports.createElement(
    Router,
    {
      basename,
      children,
      location: state.location,
      navigationType: state.action,
      navigator: history
    }
  );
}
var ABSOLUTE_URL_REGEX2 = /^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;
var Link = reactExports.forwardRef(
  function LinkWithRef({
    onClick,
    discover = "render",
    prefetch = "none",
    relative,
    reloadDocument,
    replace: replace2,
    state,
    target,
    to,
    preventScrollReset,
    viewTransition,
    ...rest
  }, forwardedRef) {
    let { basename } = reactExports.useContext(NavigationContext);
    let isAbsolute = typeof to === "string" && ABSOLUTE_URL_REGEX2.test(to);
    let absoluteHref;
    let isExternal = false;
    if (typeof to === "string" && isAbsolute) {
      absoluteHref = to;
      if (isBrowser) {
        try {
          let currentUrl = new URL(window.location.href);
          let targetUrl = to.startsWith("//") ? new URL(currentUrl.protocol + to) : new URL(to);
          let path = stripBasename(targetUrl.pathname, basename);
          if (targetUrl.origin === currentUrl.origin && path != null) {
            to = path + targetUrl.search + targetUrl.hash;
          } else {
            isExternal = true;
          }
        } catch (e) {
          warning(
            false,
            `<Link to="${to}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`
          );
        }
      }
    }
    let href = useHref(to, { relative });
    let [shouldPrefetch, prefetchRef, prefetchHandlers] = usePrefetchBehavior(
      prefetch,
      rest
    );
    let internalOnClick = useLinkClickHandler(to, {
      replace: replace2,
      state,
      target,
      preventScrollReset,
      relative,
      viewTransition
    });
    function handleClick(event) {
      if (onClick) onClick(event);
      if (!event.defaultPrevented) {
        internalOnClick(event);
      }
    }
    let link = (
      // eslint-disable-next-line jsx-a11y/anchor-has-content
      /* @__PURE__ */ reactExports.createElement(
        "a",
        {
          ...rest,
          ...prefetchHandlers,
          href: absoluteHref || href,
          onClick: isExternal || reloadDocument ? onClick : handleClick,
          ref: mergeRefs(forwardedRef, prefetchRef),
          target,
          "data-discover": !isAbsolute && discover === "render" ? "true" : void 0
        }
      )
    );
    return shouldPrefetch && !isAbsolute ? /* @__PURE__ */ reactExports.createElement(reactExports.Fragment, null, link, /* @__PURE__ */ reactExports.createElement(PrefetchPageLinks, { page: href })) : link;
  }
);
Link.displayName = "Link";
var NavLink = reactExports.forwardRef(
  function NavLinkWithRef({
    "aria-current": ariaCurrentProp = "page",
    caseSensitive = false,
    className: classNameProp = "",
    end = false,
    style: styleProp,
    to,
    viewTransition,
    children,
    ...rest
  }, ref) {
    let path = useResolvedPath(to, { relative: rest.relative });
    let location2 = useLocation();
    let routerState = reactExports.useContext(DataRouterStateContext);
    let { navigator: navigator2, basename } = reactExports.useContext(NavigationContext);
    let isTransitioning = routerState != null && // Conditional usage is OK here because the usage of a data router is static
    // eslint-disable-next-line react-hooks/rules-of-hooks
    useViewTransitionState(path) && viewTransition === true;
    let toPathname = navigator2.encodeLocation ? navigator2.encodeLocation(path).pathname : path.pathname;
    let locationPathname = location2.pathname;
    let nextLocationPathname = routerState && routerState.navigation && routerState.navigation.location ? routerState.navigation.location.pathname : null;
    if (!caseSensitive) {
      locationPathname = locationPathname.toLowerCase();
      nextLocationPathname = nextLocationPathname ? nextLocationPathname.toLowerCase() : null;
      toPathname = toPathname.toLowerCase();
    }
    if (nextLocationPathname && basename) {
      nextLocationPathname = stripBasename(nextLocationPathname, basename) || nextLocationPathname;
    }
    const endSlashPosition = toPathname !== "/" && toPathname.endsWith("/") ? toPathname.length - 1 : toPathname.length;
    let isActive = locationPathname === toPathname || !end && locationPathname.startsWith(toPathname) && locationPathname.charAt(endSlashPosition) === "/";
    let isPending = nextLocationPathname != null && (nextLocationPathname === toPathname || !end && nextLocationPathname.startsWith(toPathname) && nextLocationPathname.charAt(toPathname.length) === "/");
    let renderProps = {
      isActive,
      isPending,
      isTransitioning
    };
    let ariaCurrent = isActive ? ariaCurrentProp : void 0;
    let className;
    if (typeof classNameProp === "function") {
      className = classNameProp(renderProps);
    } else {
      className = [
        classNameProp,
        isActive ? "active" : null,
        isPending ? "pending" : null,
        isTransitioning ? "transitioning" : null
      ].filter(Boolean).join(" ");
    }
    let style = typeof styleProp === "function" ? styleProp(renderProps) : styleProp;
    return /* @__PURE__ */ reactExports.createElement(
      Link,
      {
        ...rest,
        "aria-current": ariaCurrent,
        className,
        ref,
        style,
        to,
        viewTransition
      },
      typeof children === "function" ? children(renderProps) : children
    );
  }
);
NavLink.displayName = "NavLink";
var Form = reactExports.forwardRef(
  ({
    discover = "render",
    fetcherKey,
    navigate,
    reloadDocument,
    replace: replace2,
    state,
    method = defaultMethod,
    action,
    onSubmit,
    relative,
    preventScrollReset,
    viewTransition,
    ...props
  }, forwardedRef) => {
    let submit = useSubmit();
    let formAction = useFormAction(action, { relative });
    let formMethod = method.toLowerCase() === "get" ? "get" : "post";
    let isAbsolute = typeof action === "string" && ABSOLUTE_URL_REGEX2.test(action);
    let submitHandler = (event) => {
      onSubmit && onSubmit(event);
      if (event.defaultPrevented) return;
      event.preventDefault();
      let submitter = event.nativeEvent.submitter;
      let submitMethod = submitter?.getAttribute("formmethod") || method;
      submit(submitter || event.currentTarget, {
        fetcherKey,
        method: submitMethod,
        navigate,
        replace: replace2,
        state,
        relative,
        preventScrollReset,
        viewTransition
      });
    };
    return /* @__PURE__ */ reactExports.createElement(
      "form",
      {
        ref: forwardedRef,
        method: formMethod,
        action: formAction,
        onSubmit: reloadDocument ? onSubmit : submitHandler,
        ...props,
        "data-discover": !isAbsolute && discover === "render" ? "true" : void 0
      }
    );
  }
);
Form.displayName = "Form";
function getDataRouterConsoleError2(hookName) {
  return `${hookName} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`;
}
function useDataRouterContext3(hookName) {
  let ctx = reactExports.useContext(DataRouterContext);
  invariant(ctx, getDataRouterConsoleError2(hookName));
  return ctx;
}
function useLinkClickHandler(to, {
  target,
  replace: replaceProp,
  state,
  preventScrollReset,
  relative,
  viewTransition
} = {}) {
  let navigate = useNavigate();
  let location2 = useLocation();
  let path = useResolvedPath(to, { relative });
  return reactExports.useCallback(
    (event) => {
      if (shouldProcessLinkClick(event, target)) {
        event.preventDefault();
        let replace2 = replaceProp !== void 0 ? replaceProp : createPath(location2) === createPath(path);
        navigate(to, {
          replace: replace2,
          state,
          preventScrollReset,
          relative,
          viewTransition
        });
      }
    },
    [
      location2,
      navigate,
      path,
      replaceProp,
      state,
      target,
      to,
      preventScrollReset,
      relative,
      viewTransition
    ]
  );
}
function useSearchParams(defaultInit) {
  warning(
    typeof URLSearchParams !== "undefined",
    `You cannot use the \`useSearchParams\` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.`
  );
  let defaultSearchParamsRef = reactExports.useRef(createSearchParams(defaultInit));
  let hasSetSearchParamsRef = reactExports.useRef(false);
  let location2 = useLocation();
  let searchParams = reactExports.useMemo(
    () => (
      // Only merge in the defaults if we haven't yet called setSearchParams.
      // Once we call that we want those to take precedence, otherwise you can't
      // remove a param with setSearchParams({}) if it has an initial value
      getSearchParamsForLocation(
        location2.search,
        hasSetSearchParamsRef.current ? null : defaultSearchParamsRef.current
      )
    ),
    [location2.search]
  );
  let navigate = useNavigate();
  let setSearchParams = reactExports.useCallback(
    (nextInit, navigateOptions) => {
      const newSearchParams = createSearchParams(
        typeof nextInit === "function" ? nextInit(new URLSearchParams(searchParams)) : nextInit
      );
      hasSetSearchParamsRef.current = true;
      navigate("?" + newSearchParams, navigateOptions);
    },
    [navigate, searchParams]
  );
  return [searchParams, setSearchParams];
}
var fetcherId = 0;
var getUniqueFetcherId = () => `__${String(++fetcherId)}__`;
function useSubmit() {
  let { router } = useDataRouterContext3(
    "useSubmit"
    /* UseSubmit */
  );
  let { basename } = reactExports.useContext(NavigationContext);
  let currentRouteId = useRouteId();
  return reactExports.useCallback(
    async (target, options = {}) => {
      let { action, method, encType, formData, body } = getFormSubmissionInfo(
        target,
        basename
      );
      if (options.navigate === false) {
        let key = options.fetcherKey || getUniqueFetcherId();
        await router.fetch(key, currentRouteId, options.action || action, {
          preventScrollReset: options.preventScrollReset,
          formData,
          body,
          formMethod: options.method || method,
          formEncType: options.encType || encType,
          flushSync: options.flushSync
        });
      } else {
        await router.navigate(options.action || action, {
          preventScrollReset: options.preventScrollReset,
          formData,
          body,
          formMethod: options.method || method,
          formEncType: options.encType || encType,
          replace: options.replace,
          state: options.state,
          fromRouteId: currentRouteId,
          flushSync: options.flushSync,
          viewTransition: options.viewTransition
        });
      }
    },
    [router, basename, currentRouteId]
  );
}
function useFormAction(action, { relative } = {}) {
  let { basename } = reactExports.useContext(NavigationContext);
  let routeContext = reactExports.useContext(RouteContext);
  invariant(routeContext, "useFormAction must be used inside a RouteContext");
  let [match] = routeContext.matches.slice(-1);
  let path = { ...useResolvedPath(action ? action : ".", { relative }) };
  let location2 = useLocation();
  if (action == null) {
    path.search = location2.search;
    let params = new URLSearchParams(path.search);
    let indexValues = params.getAll("index");
    let hasNakedIndexParam = indexValues.some((v) => v === "");
    if (hasNakedIndexParam) {
      params.delete("index");
      indexValues.filter((v) => v).forEach((v) => params.append("index", v));
      let qs = params.toString();
      path.search = qs ? `?${qs}` : "";
    }
  }
  if ((!action || action === ".") && match.route.index) {
    path.search = path.search ? path.search.replace(/^\?/, "?index&") : "?index";
  }
  if (basename !== "/") {
    path.pathname = path.pathname === "/" ? basename : joinPaths([basename, path.pathname]);
  }
  return createPath(path);
}
function useViewTransitionState(to, { relative } = {}) {
  let vtContext = reactExports.useContext(ViewTransitionContext);
  invariant(
    vtContext != null,
    "`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?"
  );
  let { basename } = useDataRouterContext3(
    "useViewTransitionState"
    /* useViewTransitionState */
  );
  let path = useResolvedPath(to, { relative });
  if (!vtContext.isTransitioning) {
    return false;
  }
  let currentPath = stripBasename(vtContext.currentLocation.pathname, basename) || vtContext.currentLocation.pathname;
  let nextPath = stripBasename(vtContext.nextLocation.pathname, basename) || vtContext.nextLocation.pathname;
  return matchPath(path.pathname, nextPath) != null || matchPath(path.pathname, currentPath) != null;
}
const UserContext = reactExports.createContext();
const UserProvider = ({ children }) => {
  const [user, setUser] = reactExports.useState(() => {
    try {
      if (typeof window !== "undefined" && window.__E2E__ && window.__E2E_USER__) {
        try {
          window.__E2E_PROFILE_LOADED__ = true;
        } catch (err) {
        }
        try {
          window.__E2E_LOGS__ = window.__E2E_LOGS__ || [];
          window.__E2E_LOGS__.push({ ts: Date.now(), msg: "UserContext:init used __E2E_USER__" });
        } catch (e) {
        }
        return window.__E2E_USER__;
      }
    } catch (e) {
    }
    try {
      const session = sessionStorage.getItem("user");
      if (session) return JSON.parse(session);
    } catch (e) {
    }
    try {
      const savedUser = localStorage.getItem("user");
      return savedUser ? JSON.parse(savedUser) : null;
    } catch (e) {
      return null;
    }
  });
  reactExports.useEffect(() => {
    const handleStorageChange = () => {
      const updatedUser = localStorage.getItem("user");
      setUser(updatedUser ? JSON.parse(updatedUser) : null);
    };
    window.addEventListener("storage", handleStorageChange);
    return () => window.removeEventListener("storage", handleStorageChange);
  }, []);
  reactExports.useEffect(() => {
    try {
      const persistence = localStorage.getItem("user:persistence") || "local";
      if (!user) {
        try {
          localStorage.removeItem("user");
        } catch (e) {
        }
        try {
          sessionStorage.removeItem("user");
        } catch (e) {
        }
        return;
      }
      if (persistence === "session") {
        try {
          sessionStorage.setItem("user", JSON.stringify(user));
        } catch (e) {
        }
        try {
          localStorage.removeItem("user");
        } catch (e) {
        }
      } else {
        try {
          localStorage.setItem("user", JSON.stringify(user));
        } catch (e) {
        }
        try {
          sessionStorage.removeItem("user");
        } catch (e) {
        }
      }
    } catch (e) {
      try {
        localStorage.setItem("user", JSON.stringify(user || null));
      } catch (ee) {
      }
    }
  }, [user]);
  reactExports.useEffect(() => {
    try {
      if (typeof window !== "undefined" && window.__E2E__) {
        window.__E2E_PROFILE_LOADED__ = !!user;
        try {
          window.__E2E_LOGS__ = window.__E2E_LOGS__ || [];
          window.__E2E_LOGS__.push({
            ts: Date.now(),
            msg: "__E2E_PROFILE_LOADED__",
            value: !!user
          });
        } catch (e) {
        }
      }
    } catch (e) {
    }
  }, [user]);
  const isAdmin = user?.role === "admin";
  const isPartner = user?.role === "partner";
  const isClient = user?.role === "client";
  const logout = () => {
    setUser(null);
    try {
      localStorage.removeItem("user");
      localStorage.removeItem("user:persistence");
      sessionStorage.removeItem("user");
    } catch (e) {
    }
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsx(UserContext.Provider, { value: { user, setUser, isAdmin, isPartner, isClient, logout }, children });
};
const useUser = () => reactExports.useContext(UserContext);
const logo = "/assets/colleco-logo-DW3uDFYR.png";
const PRODUCTS = [
  // Lodging
  {
    id: "p_hotel1",
    title: "Sea View Hotel",
    description: "2 nights, King Room",
    category: "Lodging",
    price: 420,
    continent: "Africa",
    country: "South Africa",
    province: "Western Cape",
    city: "Cape Town",
    area: "V&A Waterfront"
  },
  {
    id: "p_lodge1",
    title: "Savannah Safari Lodge",
    description: "3 nights, Full Board",
    category: "Lodging",
    price: 960,
    continent: "Africa",
    country: "South Africa",
    province: "Mpumalanga",
    city: "Skukuza",
    area: "Kruger National Park"
  },
  {
    id: "p_guest1",
    title: "City Boutique Guesthouse",
    description: "1 night, Breakfast included",
    category: "Lodging",
    price: 120,
    continent: "Africa",
    country: "South Africa",
    province: "Gauteng",
    city: "Johannesburg",
    area: "Sandton"
  },
  // Activities & Tours
  {
    id: "p_hike1",
    title: "Table Mountain Hike",
    description: "Guided half-day hike",
    category: "Activity",
    price: 85,
    continent: "Africa",
    country: "South Africa",
    province: "Western Cape",
    city: "Cape Town",
    area: "Table Mountain"
  },
  {
    id: "p_tour1",
    title: "Robben Island Tour",
    description: "Ferry + museum entry",
    category: "Activity",
    price: 60,
    continent: "Africa",
    country: "South Africa",
    province: "Western Cape",
    city: "Cape Town",
    area: "Robben Island"
  },
  {
    id: "p_safari1",
    title: "Kruger Park Game Drive",
    description: "Sunrise Big Five safari",
    category: "Activity",
    price: 150,
    continent: "Africa",
    country: "South Africa",
    province: "Mpumalanga",
    city: "Skukuza",
    area: "Kruger National Park"
  },
  {
    id: "p_wine1",
    title: "Winelands Tour",
    description: "Stellenbosch & Franschhoek tastings",
    category: "Tour",
    price: 110,
    continent: "Africa",
    country: "South Africa",
    province: "Western Cape",
    city: "Stellenbosch",
    area: "Winelands"
  },
  // Dining
  {
    id: "p_dinner1",
    title: "Dinner â€“ Kloof Street House",
    description: "Chef tasting menu",
    category: "Dining",
    price: 70,
    continent: "Africa",
    country: "South Africa",
    province: "Western Cape",
    city: "Cape Town",
    area: "Gardens"
  },
  {
    id: "p_dinner2",
    title: "Seafood Sunset Dinner",
    description: "Beachfront set menu",
    category: "Dining",
    price: 55,
    continent: "Africa",
    country: "Tanzania",
    province: "Zanzibar North",
    city: "Nungwi",
    area: "Nungwi Beach"
  },
  // Transport
  {
    id: "p_transfer1",
    title: "Airport Transfer",
    description: "Private vehicle arrival",
    category: "Transport",
    price: 0,
    continent: "Africa",
    country: "South Africa",
    province: "Western Cape",
    city: "Cape Town",
    area: "CPT International"
  },
  {
    id: "p_car1",
    title: "Compact Car Hire",
    description: "Unlimited km, basic insurance",
    category: "Transport",
    price: 45,
    continent: "Africa",
    country: "South Africa",
    province: "Western Cape",
    city: "Cape Town",
    area: "City Bowl"
  },
  // Experiences & Add-ons
  {
    id: "p_spa1",
    title: "Spa Package",
    description: "60-min massage + sauna",
    category: "Experience",
    price: 65,
    continent: "Africa",
    country: "South Africa",
    province: "Western Cape",
    city: "Cape Town",
    area: "City Centre"
  },
  {
    id: "p_photography1",
    title: "Travel Photography Session",
    description: "1-hour professional shoot",
    category: "Experience",
    price: 120,
    continent: "Africa",
    country: "South Africa",
    province: "Western Cape",
    city: "Cape Town",
    area: "Camps Bay"
  },
  // Europe
  {
    id: "p_hotel_paris1",
    title: "Left Bank Boutique Hotel",
    description: "2 nights, Superior Room",
    category: "Lodging",
    price: 280,
    continent: "Europe",
    country: "France",
    province: "ÃŽle-de-France",
    city: "Paris",
    area: "Saint-Germain-des-PrÃ©s"
  },
  {
    id: "p_activity_paris1",
    title: "Louvre Priority Entry",
    description: "Timed-entry museum tickets",
    category: "Activity",
    price: 35,
    continent: "Europe",
    country: "France",
    province: "ÃŽle-de-France",
    city: "Paris",
    area: "Louvre/Tuileries"
  },
  {
    id: "p_dining_paris1",
    title: "Seine River Dinner Cruise",
    description: "3-course dinner with views",
    category: "Dining",
    price: 85,
    continent: "Europe",
    country: "France",
    province: "ÃŽle-de-France",
    city: "Paris",
    area: "Port de la Bourdonnais"
  },
  {
    id: "p_tour_rome1",
    title: "Colosseum & Forum Tour",
    description: "Skip-the-line guided tour",
    category: "Tour",
    price: 70,
    continent: "Europe",
    country: "Italy",
    province: "Lazio",
    city: "Rome",
    area: "Colosseo"
  },
  {
    id: "p_transfer_paris1",
    title: "CDG Airport Transfer",
    description: "Private sedan to hotel",
    category: "Transport",
    price: 65,
    continent: "Europe",
    country: "France",
    province: "ÃŽle-de-France",
    city: "Paris",
    area: "Charles de Gaulle"
  },
  // North America
  {
    id: "p_hotel_nyc1",
    title: "Midtown Skyline Hotel",
    description: "2 nights, City View King",
    category: "Lodging",
    price: 340,
    continent: "North America",
    country: "United States",
    province: "New York",
    city: "New York",
    area: "Midtown Manhattan"
  },
  {
    id: "p_activity_nyc1",
    title: "Broadway Show",
    description: "Evening performance orchestra seats",
    category: "Activity",
    price: 120,
    continent: "North America",
    country: "United States",
    province: "New York",
    city: "New York",
    area: "Theater District"
  },
  {
    id: "p_tour_nyc1",
    title: "Statue of Liberty & Ellis Island",
    description: "Ferry + museum access",
    category: "Tour",
    price: 55,
    continent: "North America",
    country: "United States",
    province: "New York",
    city: "New York",
    area: "Battery Park"
  },
  {
    id: "p_dining_nyc1",
    title: "SoHo Tasting Walk",
    description: "Artisanal bites & desserts",
    category: "Dining",
    price: 65,
    continent: "North America",
    country: "United States",
    province: "New York",
    city: "New York",
    area: "SoHo"
  },
  {
    id: "p_transfer_nyc1",
    title: "JFK Black Car Service",
    description: "Airport pickup, meet & greet",
    category: "Transport",
    price: 85,
    continent: "North America",
    country: "United States",
    province: "New York",
    city: "New York",
    area: "JFK International"
  },
  // Asia
  {
    id: "p_hotel_tokyo1",
    title: "Shinjuku Business Hotel",
    description: "2 nights, Semi-Double",
    category: "Lodging",
    price: 220,
    continent: "Asia",
    country: "Japan",
    province: "Tokyo",
    city: "Tokyo",
    area: "Shinjuku"
  },
  {
    id: "p_activity_tokyo1",
    title: "Tsukiji Market Food Tour",
    description: "Morning sushi & snacks",
    category: "Activity",
    price: 55,
    continent: "Asia",
    country: "Japan",
    province: "Tokyo",
    city: "Tokyo",
    area: "Tsukiji"
  },
  {
    id: "p_tour_kyoto1",
    title: "Fushimi Inari & Gion Walk",
    description: "Guided cultural tour",
    category: "Tour",
    price: 60,
    continent: "Asia",
    country: "Japan",
    province: "Kyoto",
    city: "Kyoto",
    area: "Fushimi Inari"
  },
  {
    id: "p_dining_tokyo1",
    title: "Ramen Tasting Night",
    description: "Hidden shops, 3 bowls",
    category: "Dining",
    price: 48,
    continent: "Asia",
    country: "Japan",
    province: "Tokyo",
    city: "Tokyo",
    area: "Shibuya"
  },
  {
    id: "p_transfer_tokyo1",
    title: "Narita Express Tickets",
    description: "Airport rail to city",
    category: "Transport",
    price: 28,
    continent: "Asia",
    country: "Japan",
    province: "Chiba",
    city: "Narita",
    area: "NRT Airport"
  },
  // South America
  {
    id: "p_hotel_rio1",
    title: "Copacabana Beach Hotel",
    description: "2 nights, Ocean Balcony",
    category: "Lodging",
    price: 210,
    continent: "South America",
    country: "Brazil",
    province: "Rio de Janeiro",
    city: "Rio de Janeiro",
    area: "Copacabana"
  },
  {
    id: "p_activity_rio1",
    title: "Sugarloaf Cable Car",
    description: "Panoramic viewpoints",
    category: "Activity",
    price: 40,
    continent: "South America",
    country: "Brazil",
    province: "Rio de Janeiro",
    city: "Rio de Janeiro",
    area: "Urca"
  },
  {
    id: "p_tour_rio1",
    title: "Christ the Redeemer Tour",
    description: "Guided visit + transfers",
    category: "Tour",
    price: 55,
    continent: "South America",
    country: "Brazil",
    province: "Rio de Janeiro",
    city: "Rio de Janeiro",
    area: "Corcovado"
  },
  {
    id: "p_dining_rio1",
    title: "Churrascaria Dinner",
    description: "Traditional rodÃ­zio experience",
    category: "Dining",
    price: 50,
    continent: "South America",
    country: "Brazil",
    province: "Rio de Janeiro",
    city: "Rio de Janeiro",
    area: "Ipanema"
  },
  // Oceania
  {
    id: "p_hotel_sydney1",
    title: "Harbour View Hotel",
    description: "2 nights, Deluxe King",
    category: "Lodging",
    price: 260,
    continent: "Oceania",
    country: "Australia",
    province: "New South Wales",
    city: "Sydney",
    area: "Circular Quay"
  },
  {
    id: "p_activity_sydney1",
    title: "Sydney Opera House Tour",
    description: "Architecture & backstage",
    category: "Activity",
    price: 45,
    continent: "Oceania",
    country: "Australia",
    province: "New South Wales",
    city: "Sydney",
    area: "Sydney Opera House"
  },
  {
    id: "p_tour_sydney1",
    title: "Blue Mountains Day Trip",
    description: "Guided views & wildlife",
    category: "Tour",
    price: 115,
    continent: "Oceania",
    country: "Australia",
    province: "New South Wales",
    city: "Katoomba",
    area: "Echo Point"
  },
  {
    id: "p_dining_sydney1",
    title: "Fish Market Lunch",
    description: "Fresh seafood platters",
    category: "Dining",
    price: 40,
    continent: "Oceania",
    country: "Australia",
    province: "New South Wales",
    city: "Sydney",
    area: "Pyrmont"
  },
  // Middle East
  {
    id: "p_hotel_dubai1",
    title: "Downtown Luxury Stay",
    description: "2 nights, Fountain View",
    category: "Lodging",
    price: 300,
    continent: "Asia",
    country: "United Arab Emirates",
    province: "Dubai",
    city: "Dubai",
    area: "Downtown"
  },
  {
    id: "p_activity_dubai1",
    title: "Desert Safari & BBQ",
    description: "Dune bashing, camel ride",
    category: "Activity",
    price: 75,
    continent: "Asia",
    country: "United Arab Emirates",
    province: "Dubai",
    city: "Dubai",
    area: "Al Marmoom Desert"
  },
  {
    id: "p_tour_dubai1",
    title: "Burj Khalifa 124F Tickets",
    description: "At the Top admission",
    category: "Tour",
    price: 55,
    continent: "Asia",
    country: "United Arab Emirates",
    province: "Dubai",
    city: "Dubai",
    area: "Downtown"
  },
  // Additional coverage
  {
    id: "p_hotel_nairobi1",
    title: "Nairobi City Hotel",
    description: "1 night, Standard Room",
    category: "Lodging",
    price: 110,
    continent: "Africa",
    country: "Kenya",
    province: "Nairobi County",
    city: "Nairobi",
    area: "City Centre"
  },
  {
    id: "p_activity_nairobi1",
    title: "Nairobi National Park Safari",
    description: "Half-day game drive",
    category: "Activity",
    price: 90,
    continent: "Africa",
    country: "Kenya",
    province: "Nairobi County",
    city: "Nairobi",
    area: "Nairobi National Park"
  },
  {
    id: "p_hotel_cairo1",
    title: "Giza Pyramids View Inn",
    description: "1 night, Pyramid View",
    category: "Lodging",
    price: 95,
    continent: "Africa",
    country: "Egypt",
    province: "Giza Governorate",
    city: "Giza",
    area: "Al Haram"
  },
  {
    id: "p_tour_cairo1",
    title: "Pyramids & Sphinx Tour",
    description: "Guided tour with transfers",
    category: "Tour",
    price: 60,
    continent: "Africa",
    country: "Egypt",
    province: "Giza Governorate",
    city: "Giza",
    area: "Giza Plateau"
  },
  {
    id: "p_hotel_london1",
    title: "West End Boutique",
    description: "2 nights, Superior",
    category: "Lodging",
    price: 260,
    continent: "Europe",
    country: "United Kingdom",
    province: "England",
    city: "London",
    area: "Westminster"
  },
  {
    id: "p_tour_london1",
    title: "Tower of London Tickets",
    description: "Crown Jewels access",
    category: "Activity",
    price: 38,
    continent: "Europe",
    country: "United Kingdom",
    province: "England",
    city: "London",
    area: "Tower Hill"
  },
  {
    id: "p_hotel_barcelona1",
    title: "Gothic Quarter Stay",
    description: "2 nights, Balcony Room",
    category: "Lodging",
    price: 180,
    continent: "Europe",
    country: "Spain",
    province: "Catalonia",
    city: "Barcelona",
    area: "Barri GÃ²tic"
  },
  {
    id: "p_tour_barcelona1",
    title: "Sagrada FamÃ­lia Entry",
    description: "Timed ticket + audio",
    category: "Activity",
    price: 32,
    continent: "Europe",
    country: "Spain",
    province: "Catalonia",
    city: "Barcelona",
    area: "Eixample"
  },
  {
    id: "p_hotel_sf1",
    title: "Fishermanâ€™s Wharf Hotel",
    description: "2 nights, Bay View",
    category: "Lodging",
    price: 290,
    continent: "North America",
    country: "United States",
    province: "California",
    city: "San Francisco",
    area: "Fisherman's Wharf"
  },
  {
    id: "p_tour_sf1",
    title: "Alcatraz Island Tour",
    description: "Ferry + cellhouse audio tour",
    category: "Tour",
    price: 45,
    continent: "North America",
    country: "United States",
    province: "California",
    city: "San Francisco",
    area: "Alcatraz"
  },
  {
    id: "p_hotel_bangkok1",
    title: "Riverside Hotel Bangkok",
    description: "2 nights, Deluxe",
    category: "Lodging",
    price: 140,
    continent: "Asia",
    country: "Thailand",
    province: "Bangkok",
    city: "Bangkok",
    area: "Chao Phraya"
  },
  {
    id: "p_activity_bangkok1",
    title: "Street Food Night Tour",
    description: "Tuk-tuk tastings",
    category: "Activity",
    price: 35,
    continent: "Asia",
    country: "Thailand",
    province: "Bangkok",
    city: "Bangkok",
    area: "Yaowarat"
  },
  {
    id: "p_hotel_toronto1",
    title: "Downtown Toronto Hotel",
    description: "1 night, King Room",
    category: "Lodging",
    price: 170,
    continent: "North America",
    country: "Canada",
    province: "Ontario",
    city: "Toronto",
    area: "Financial District"
  },
  {
    id: "p_activity_toronto1",
    title: "CN Tower Experience",
    description: "Observation deck tickets",
    category: "Activity",
    price: 28,
    continent: "North America",
    country: "Canada",
    province: "Ontario",
    city: "Toronto",
    area: "South Core"
  },
  // Extra area coverage for popular cities
  // Cape Town
  {
    id: "p_ct_walk1",
    title: "Bo-Kaap Heritage Walk",
    description: "Colorful streets & culture tour",
    category: "Activity",
    price: 35,
    continent: "Africa",
    country: "South Africa",
    province: "Western Cape",
    city: "Cape Town",
    area: "Bo-Kaap"
  },
  {
    id: "p_ct_sea1",
    title: "Sea Point Promenade Cycle",
    description: "Sunset guided bike ride",
    category: "Activity",
    price: 25,
    continent: "Africa",
    country: "South Africa",
    province: "Western Cape",
    city: "Cape Town",
    area: "Sea Point"
  },
  {
    id: "p_ct_market1",
    title: "Neighbourgoods Market Brunch",
    description: "Local eats & crafts",
    category: "Dining",
    price: 22,
    continent: "Africa",
    country: "South Africa",
    province: "Western Cape",
    city: "Cape Town",
    area: "Woodstock"
  },
  // New York
  {
    id: "p_nyc_central1",
    title: "Central Park Rowboats",
    description: "Boat rental by the hour",
    category: "Activity",
    price: 20,
    continent: "North America",
    country: "United States",
    province: "New York",
    city: "New York",
    area: "Central Park"
  },
  {
    id: "p_nyc_ues1",
    title: "Upper East Side Museum Hop",
    description: "MET & Guggenheim combo",
    category: "Activity",
    price: 55,
    continent: "North America",
    country: "United States",
    province: "New York",
    city: "New York",
    area: "Upper East Side"
  },
  {
    id: "p_nyc_dumbo1",
    title: "DUMBO Pizza Slice Tour",
    description: "Iconic views & bites",
    category: "Dining",
    price: 30,
    continent: "North America",
    country: "United States",
    province: "New York",
    city: "New York",
    area: "DUMBO"
  },
  // Paris
  {
    id: "p_paris_mont1",
    title: "Montmartre Art Walk",
    description: "SacrÃ©-CÅ“ur & artists square",
    category: "Tour",
    price: 28,
    continent: "Europe",
    country: "France",
    province: "ÃŽle-de-France",
    city: "Paris",
    area: "Montmartre"
  },
  {
    id: "p_paris_marais1",
    title: "Le Marais Gourmet Crawl",
    description: "Pastries, falafel, and more",
    category: "Dining",
    price: 42,
    continent: "Europe",
    country: "France",
    province: "ÃŽle-de-France",
    city: "Paris",
    area: "Le Marais"
  },
  {
    id: "p_paris_champs1",
    title: "Champs-Ã‰lysÃ©es Shopping Shuttle",
    description: "Hotel pickup to boutiques",
    category: "Transport",
    price: 18,
    continent: "Europe",
    country: "France",
    province: "ÃŽle-de-France",
    city: "Paris",
    area: "Champs-Ã‰lysÃ©es"
  },
  // Tokyo
  {
    id: "p_tokyo_akiba1",
    title: "Akihabara Retro Arcade Night",
    description: "Game tokens & guide",
    category: "Experience",
    price: 32,
    continent: "Asia",
    country: "Japan",
    province: "Tokyo",
    city: "Tokyo",
    area: "Akihabara"
  },
  {
    id: "p_tokyo_asakusa1",
    title: "Asakusa Kimono Photoshoot",
    description: "Senso-ji temple stroll",
    category: "Experience",
    price: 58,
    continent: "Asia",
    country: "Japan",
    province: "Tokyo",
    city: "Tokyo",
    area: "Asakusa"
  },
  {
    id: "p_tokyo_ginza1",
    title: "Ginza Sushi Counter Lunch",
    description: "Seasonal omakase set",
    category: "Dining",
    price: 65,
    continent: "Asia",
    country: "Japan",
    province: "Tokyo",
    city: "Tokyo",
    area: "Ginza"
  },
  // London
  {
    id: "p_london_camden1",
    title: "Camden Market Street Food",
    description: "Global flavors tasting",
    category: "Dining",
    price: 28,
    continent: "Europe",
    country: "United Kingdom",
    province: "England",
    city: "London",
    area: "Camden"
  },
  {
    id: "p_london_shore1",
    title: "Shoreditch Street Art Tour",
    description: "Murals & hidden alleys",
    category: "Tour",
    price: 26,
    continent: "Europe",
    country: "United Kingdom",
    province: "England",
    city: "London",
    area: "Shoreditch"
  },
  {
    id: "p_london_south1",
    title: "South Bank River Walk",
    description: "From London Eye to Tate",
    category: "Activity",
    price: 15,
    continent: "Europe",
    country: "United Kingdom",
    province: "England",
    city: "London",
    area: "South Bank"
  },
  // South Africa â€” KwaZulu-Natal focus
  // Durban (eThekwini)
  {
    id: "kzn_durban_hotel1",
    title: "Durban Beachfront Hotel",
    description: "2 nights, Sea-facing room",
    category: "Lodging",
    price: 180,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Durban",
    area: "North Beach"
  },
  {
    id: "kzn_durban_activity1",
    title: "uShaka Marine World Combo",
    description: "Aquarium + Wet â€™n Wild access",
    category: "Activity",
    price: 45,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Durban",
    area: "Point Waterfront"
  },
  {
    id: "kzn_durban_tour1",
    title: "Golden Mile Cycle Tour",
    description: "Guided seaside promenade ride",
    category: "Tour",
    price: 25,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Durban",
    area: "Golden Mile"
  },
  {
    id: "kzn_durban_dining1",
    title: "Bunny Chow Tasting",
    description: "Curries and local favorites",
    category: "Dining",
    price: 18,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Durban",
    area: "Florida Road"
  },
  {
    id: "kzn_durban_transfer1",
    title: "King Shaka Airport Transfer",
    description: "Private transfer to hotel",
    category: "Transport",
    price: 30,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Durban",
    area: "King Shaka International"
  },
  {
    id: "kzn_durban_experience1",
    title: "Moses Mabhida SkyCar & Swing",
    description: "Panoramic views option to Big Swing",
    category: "Experience",
    price: 35,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Durban",
    area: "Moses Mabhida Stadium"
  },
  // Drakensberg
  {
    id: "kzn_berg_lodge1",
    title: "Drakensberg Mountain Lodge",
    description: "2 nights, Half-board",
    category: "Lodging",
    price: 220,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Winterton",
    area: "Central Drakensberg"
  },
  {
    id: "kzn_berg_activity1",
    title: "Amphitheatre Hike",
    description: "Guided hike to Tugela Falls viewpoints",
    category: "Activity",
    price: 60,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Royal Natal",
    area: "uKhahlamba-Drakensberg Park"
  },
  {
    id: "kzn_berg_tour1",
    title: "Sani Pass Day Trip",
    description: "4x4 adventure up to Lesotho border",
    category: "Tour",
    price: 95,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Underberg",
    area: "Sani Pass"
  },
  // Midlands Meander
  {
    id: "kzn_midlands_lodge1",
    title: "Midlands Country Stay",
    description: "Farmhouse retreat with breakfast",
    category: "Lodging",
    price: 140,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Howick",
    area: "Midlands Meander"
  },
  {
    id: "kzn_midlands_activity1",
    title: "Howick Falls Visit",
    description: "Scenic falls and craft markets",
    category: "Activity",
    price: 10,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Howick",
    area: "Howick Falls"
  },
  {
    id: "kzn_midlands_dining1",
    title: "Midlands Cheese & Chocolate Trail",
    description: "Artisan tastings along the Meander",
    category: "Dining",
    price: 22,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Howick",
    area: "Midlands Meander"
  },
  // North Coast / iSimangaliso / Hluhluwe
  {
    id: "kzn_stlucia_lodge1",
    title: "St Lucia Estuary Lodge",
    description: "2 nights, Hippo-view deck",
    category: "Lodging",
    price: 190,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "St Lucia",
    area: "iSimangaliso Wetland Park"
  },
  {
    id: "kzn_stlucia_tour1",
    title: "Hippo & Croc Boat Safari",
    description: "Estuary wildlife cruise",
    category: "Tour",
    price: 35,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "St Lucia",
    area: "St Lucia Estuary"
  },
  {
    id: "kzn_hluhluwe_activity1",
    title: "Hluhluweâ€“Imfolozi Game Drive",
    description: "Big Five sunrise safari",
    category: "Activity",
    price: 85,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Hluhluwe",
    area: "Hluhluweâ€“Imfolozi Park"
  },
  {
    id: "kzn_ballito_dining1",
    title: "Ballito Beach Seafood",
    description: "Fresh grill with ocean views",
    category: "Dining",
    price: 28,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Ballito",
    area: "Willard Beach"
  },
  // KZN South Coast â€” Port Shepstone focus
  {
    id: "kzn_ps_hotel1",
    title: "Port Shepstone Seaview Guesthouse",
    description: "2 nights, Ocean-view suite",
    category: "Lodging",
    price: 150,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Port Shepstone",
    area: "Sea Park"
  },
  {
    id: "kzn_ps_activity1",
    title: "Oribi Gorge Suspension Bridge & Zipline",
    description: "Adrenaline combo at the gorge",
    category: "Activity",
    price: 55,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Port Shepstone",
    area: "Oribi Gorge"
  },
  {
    id: "kzn_ps_tour1",
    title: "South Coast Lighthouse & Beach Hop",
    description: "Lighthouse stopovers and beach time",
    category: "Tour",
    price: 30,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Port Shepstone",
    area: "Umtentweni / Oslo Beach"
  },
  {
    id: "kzn_ps_dining1",
    title: "South Coast Seafood Platter",
    description: "Fresh catch with coastal views",
    category: "Dining",
    price: 24,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Port Shepstone",
    area: "Port Shepstone Harbour"
  },
  {
    id: "kzn_ps_transfer1",
    title: "Margate Airport Transfer",
    description: "Private transfer to Port Shepstone",
    category: "Transport",
    price: 22,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Port Shepstone",
    area: "Margate Airport"
  },
  {
    id: "kzn_ps_experience1",
    title: "South Coast Surf Lesson",
    description: "Beginner friendly lesson with wetsuit",
    category: "Experience",
    price: 20,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Port Shepstone",
    area: "Umtentweni"
  },
  // Nearby South Coast towns
  {
    id: "kzn_shelly_activity1",
    title: "Shelly Beach Protea Banks Dive",
    description: "Advanced drift dive (seasonal)",
    category: "Activity",
    price: 85,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Shelly Beach",
    area: "Protea Banks"
  },
  {
    id: "kzn_margate_dining1",
    title: "Margate Beachfront CafÃ©",
    description: "Casual brunch & coffee",
    category: "Dining",
    price: 12,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Margate",
    area: "Marine Drive"
  },
  {
    id: "kzn_ubi_tour1",
    title: "Umtamvuna Nature Reserve Walk",
    description: "Guided coastal forest trail",
    category: "Tour",
    price: 18,
    continent: "Africa",
    country: "South Africa",
    province: "KwaZulu-Natal",
    city: "Port Edward",
    area: "Umtamvuna"
  }
];
const SERVICES = [
  // Client-facing
  { id: "s_quotes", title: "Quote Generation", description: "Turn basket items into a shareable quote", path: "/quotes" },
  { id: "s_itinerary", title: "Itinerary Builder", description: "Plan day-by-day with notes and progress", path: "/itinerary" },
  { id: "s_bookings", title: "Bookings & Payments", description: "Collect securely and track confirmations", path: "/bookings" },
  { id: "s_trip_assist", title: "Trip Assist", description: "Draft ideas and refine plans", path: "/ai" },
  // Partner-facing onboarding & ops
  { id: "s_partner", title: "Partner Onboarding", description: "Upload rates, licenses, insurance", path: "/partner-dashboard" },
  { id: "s_compliance", title: "Compliance & Documents", description: "Manage certifications and status", path: "/partner-dashboard" },
  { id: "s_promotions", title: "Promotions & Packages", description: "Create offers and bundles", path: "/partner-dashboard" },
  { id: "s_payouts", title: "Payouts & Earnings", description: "Track revenue and payouts", path: "/partner-dashboard" }
];
const CATEGORY_SYNONYMS = [
  {
    cat: "Lodging",
    keys: [
      "hotel",
      "hotels",
      "lodging",
      "stay",
      "accommodation",
      "accomodation",
      "guesthouse",
      "guest house",
      "bnb",
      "b&b",
      "b and b",
      "b-and-b",
      "resort",
      "lodge",
      "lodges",
      "hostel",
      "hostels",
      "inn",
      "self-catering",
      "apartment",
      "villa"
    ]
  },
  {
    cat: "Dining",
    keys: [
      "food",
      "restaurant",
      "restaurants",
      "eat",
      "dining",
      "cafe",
      "cafes",
      "bar",
      "bars",
      "breakfast",
      "brunch",
      "lunch",
      "dinner",
      "eatery",
      "coffee"
    ]
  },
  {
    cat: "Activity",
    keys: [
      "things to do",
      "activities",
      "activity",
      "adventure",
      "attraction",
      "attractions",
      "what to do",
      "sightseeing",
      "hike",
      "hiking",
      "walk",
      "walking"
    ]
  },
  {
    cat: "Tour",
    keys: [
      "tour",
      "tours",
      "safari",
      "safaris",
      "guided tour",
      "day tour",
      "multi-day tour",
      "day trip",
      "daytrip",
      "trip",
      "guided"
    ]
  },
  { cat: "Transport", keys: ["transport", "transfer", "transfers", "shuttle", "car hire", "car rental", "taxi", "bus", "ride", "pickup", "dropoff", "airport transfer", "airport shuttle"] },
  { cat: "Experience", keys: ["experience", "experiences", "workshop", "workshops", "class", "classes", "lesson", "lessons", "course", "courses"] }
];
const LOCATION_ALIASES = new Map(Object.entries({
  // South Africa provinces
  "kzn": { province: "KwaZulu-Natal" },
  "kwazulu natal": { province: "KwaZulu-Natal" },
  "western cape": { province: "Western Cape" },
  "wc": { province: "Western Cape" },
  "eastern cape": { province: "Eastern Cape" },
  "ec": { province: "Eastern Cape" },
  "gauteng": { province: "Gauteng" },
  "gp": { province: "Gauteng" },
  "mpumalanga": { province: "Mpumalanga" },
  "mp": { province: "Mpumalanga" },
  "limpopo": { province: "Limpopo" },
  "lp": { province: "Limpopo" },
  "free state": { province: "Free State" },
  "fs": { province: "Free State" },
  "northern cape": { province: "Northern Cape" },
  "nc": { province: "Northern Cape" },
  "north west": { province: "North West" },
  "nw": { province: "North West" },
  // Cities colloquialisms & codes
  "durbs": { city: "Durban" },
  "dbn": { city: "Durban" },
  "dur": { city: "Durban" },
  "ct": { city: "Cape Town" },
  "cpt": { city: "Cape Town" },
  "mother city": { city: "Cape Town" },
  "joburg": { city: "Johannesburg" },
  "jozi": { city: "Johannesburg" },
  "jhb": { city: "Johannesburg" },
  "jnb": { city: "Johannesburg" },
  "umhlanga rocks": { city: "Umhlanga" },
  "umhlanga": { city: "Umhlanga" },
  // Regions/common phrases
  "south coast": { province: "KwaZulu-Natal" },
  // Regions/common phrases
  "north coast": { province: "KwaZulu-Natal" },
  "midlands": { province: "KwaZulu-Natal" },
  "midlands meander": { province: "KwaZulu-Natal" },
  "drakensberg": { province: "KwaZulu-Natal" },
  "zululand": { area: "Zululand" },
  "isimangaliso": { area: "iSimangaliso Wetland Park" },
  "hluhluwe": { city: "Hluhluwe" },
  "dolphin coast": { area: "Dolphin Coast" },
  "sapphire coast": { area: "Sapphire Coast" },
  "ballito": { city: "Ballito" },
  "st lucia": { city: "St Lucia" },
  "port shepstone": { city: "Port Shepstone" },
  "margate": { city: "Margate" },
  "scottburgh": { city: "Scottburgh" },
  "amanzimtoti": { city: "Amanzimtoti" },
  "pietermaritzburg": { city: "Pietermaritzburg" },
  "pmb": { city: "Pietermaritzburg" },
  // Eastern Cape regions and towns
  "garden route": { area: "Garden Route" },
  "plettenberg bay": { city: "Plettenberg Bay" },
  "plett": { city: "Plettenberg Bay" },
  "knysna": { city: "Knysna" },
  "mossel bay": { city: "Mossel Bay" },
  "tsitsikamma": { area: "Tsitsikamma" },
  "port elizabeth": { city: "Port Elizabeth" },
  "gqeberha": { city: "Port Elizabeth" },
  "pe": { city: "Port Elizabeth" },
  "summerstrand": { area: "Summerstrand" },
  "east london": { city: "East London" },
  "el": { city: "East London" },
  "jeffreys bay": { city: "Jeffreys Bay" },
  "jbay": { city: "Jeffreys Bay" },
  "hogsback": { city: "Hogsback" },
  "coffee bay": { city: "Coffee Bay" },
  "mthatha": { city: "Mthatha" },
  "umtata": { city: "Mthatha" },
  "wild coast": { area: "Wild Coast" },
  // Western Cape regions
  "cape winelands": { area: "Cape Winelands" },
  "winelands": { area: "Cape Winelands" },
  "whale coast": { area: "Whale Coast" },
  "overberg": { area: "Overberg" },
  "overstrand": { area: "Overstrand" },
  "cederberg": { area: "Cederberg" },
  "west coast": { area: "West Coast" },
  "karoo": { area: "Karoo" },
  "klein karoo": { area: "Klein Karoo" },
  "route 62": { area: "Route 62" },
  "breede river valley": { area: "Breede River Valley" },
  "breede valley": { area: "Breede River Valley" },
  "cape peninsula": { area: "Cape Peninsula" },
  "false bay": { area: "False Bay" },
  "helderberg": { area: "Helderberg" },
  "stellenbosch": { city: "Stellenbosch" },
  "franschhoek": { city: "Franschhoek" },
  "paarl": { city: "Paarl" },
  "hermanus": { city: "Hermanus" },
  "paternoster": { city: "Paternoster" },
  "langebaan": { city: "Langebaan" },
  // Additional Cape Town CBD/Atlantic Seaboard neighborhoods
  "bo-kaap": { area: "Bo-Kaap" },
  "bokaap": { area: "Bo-Kaap" },
  "de waterkant": { area: "De Waterkant" },
  "gardens": { area: "Gardens" },
  "tamboerskloof": { area: "Tamboerskloof" },
  "oranjezicht": { area: "Oranjezicht" },
  "vredehoek": { area: "Vredehoek" },
  "fresnaye": { area: "Fresnaye" },
  "bantry bay": { area: "Bantry Bay" },
  "clifton": { area: "Clifton" },
  // Cape Town suburbs & nearby
  "camps bay": { area: "Camps Bay" },
  "sea point": { area: "Sea Point" },
  "hout bay": { area: "Hout Bay" },
  "constantia": { area: "Constantia" },
  "newlands": { area: "Newlands" },
  "rondebosch": { area: "Rondebosch" },
  "green point": { area: "Green Point" },
  "somerset west": { city: "Somerset West" },
  "strand": { city: "Strand" },
  "gordon's bay": { city: "Gordon's Bay" },
  "gordons bay": { city: "Gordon's Bay" },
  "bloubergstrand": { area: "Bloubergstrand" },
  "table view": { area: "Table View" },
  "melkbosstrand": { area: "Melkbosstrand" },
  "durbanville": { city: "Durbanville" },
  "muizenberg": { area: "Muizenberg" },
  "kalk bay": { area: "Kalk Bay" },
  "fish hoek": { area: "Fish Hoek" },
  "kommetjie": { area: "Kommetjie" },
  "noordhoek": { area: "Noordhoek" },
  "simon's town": { area: "Simon's Town" },
  "simons town": { area: "Simon's Town" },
  "llandudno": { area: "Llandudno" },
  // Overberg/Whale Coast towns
  "betty's bay": { city: "Betty's Bay" },
  "bettys bay": { city: "Betty's Bay" },
  "pringle bay": { city: "Pringle Bay" },
  "rooiels": { city: "Rooiels" },
  "gansbaai": { city: "Gansbaai" },
  "de kelders": { city: "De Kelders" },
  "stanford": { city: "Stanford" },
  "cape agulhas": { city: "Agulhas" },
  "agulhas": { city: "Agulhas" },
  "arniston": { city: "Arniston" },
  "waenhuiskrans": { city: "Arniston" },
  "de hoop": { area: "De Hoop Nature Reserve" },
  // Garden Route towns
  "wilderness": { city: "Wilderness" },
  "george": { city: "George" },
  "storms river": { city: "Storms River" },
  "nature's valley": { city: "Nature's Valley" },
  "natures valley": { city: "Nature's Valley" },
  "oudtshoorn": { city: "Oudtshoorn" },
  "prince albert": { city: "Prince Albert" },
  // Eastern Cape coast towns
  "st francis bay": { city: "St Francis Bay" },
  "cape st francis": { city: "Cape St Francis" },
  "port alfred": { city: "Port Alfred" },
  "kenton-on-sea": { city: "Kenton-on-Sea" },
  "kenton on sea": { city: "Kenton-on-Sea" },
  "grahamstown": { city: "Makhanda" },
  "makhanda": { city: "Makhanda" },
  // KZN North & South coast towns
  "richards bay": { city: "Richards Bay" },
  "empangeni": { city: "Empangeni" },
  "eshowe": { city: "Eshowe" },
  "umdloti": { city: "Umdloti" },
  "la lucia": { area: "La Lucia" },
  "salt rock": { city: "Salt Rock" },
  "sheffield beach": { city: "Sheffield Beach" },
  "zinkwazi": { city: "Zinkwazi" },
  "blythedale": { city: "Blythedale" },
  "mtunzini": { city: "Mtunzini" },
  "uvongo": { city: "Uvongo" },
  "ramsgate": { city: "Ramsgate" },
  "umtentweni": { city: "Umtentweni" },
  "pennington": { city: "Pennington" },
  "hibberdene": { city: "Hibberdene" },
  "shelly beach": { city: "Shelly Beach" },
  // Southern Drakensberg & Berg resorts
  "underberg": { city: "Underberg" },
  "himeville": { city: "Himeville" },
  "bergville": { city: "Bergville" },
  "winterton": { city: "Winterton" },
  "cathedral peak": { area: "Cathedral Peak" },
  "champagne valley": { area: "Champagne Valley" },
  "giants castle": { area: "Giants Castle" },
  "royal natal": { area: "Royal Natal National Park" },
  // Midlands towns
  "howick": { city: "Howick" },
  "nottingham road": { city: "Nottingham Road" },
  "mooi river": { city: "Mooi River" },
  "balgowan": { city: "Balgowan" },
  "curry's post": { city: "Curry's Post" },
  "currys post": { city: "Curry's Post" },
  // Kruger & Lowveld towns
  "hazyview": { city: "Hazyview" },
  "sabie": { city: "Sabie" },
  "graskop": { city: "Graskop" },
  "nelspruit": { city: "Nelspruit" },
  "mbombela": { city: "Nelspruit" },
  "malelane": { city: "Malelane" },
  "komatipoort": { city: "Komatipoort" },
  "dullstroom": { city: "Dullstroom" },
  "barberton": { city: "Barberton" },
  "white river": { city: "White River" },
  "hoedspruit": { city: "Hoedspruit" },
  "phalaborwa": { city: "Phalaborwa" },
  "tzaneen": { city: "Tzaneen" },
  "polokwane": { city: "Polokwane" },
  // Limpopo bushveld
  "bela-bela": { city: "Bela-Bela" },
  "belabela": { city: "Bela-Bela" },
  "warmbaths": { city: "Bela-Bela" },
  "modimolle": { city: "Modimolle" },
  "nylstroom": { city: "Modimolle" },
  "mokopane": { city: "Mokopane" },
  "thabazimbi": { city: "Thabazimbi" },
  // North West
  "rustenburg": { city: "Rustenburg" },
  "brits": { city: "Brits" },
  // Free State & Northern Cape towns
  "clarens": { city: "Clarens" },
  "golden gate": { area: "Golden Gate Highlands National Park" },
  "parys": { city: "Parys" },
  "upington": { city: "Upington" },
  "springbok": { city: "Springbok" },
  "pofadder": { city: "Pofadder" },
  "kimberley": { city: "Kimberley" },
  "sutherland": { city: "Sutherland" },
  // Gauteng suburbs
  "centurion": { city: "Centurion" },
  "fourways": { area: "Fourways" },
  "randburg": { city: "Randburg" },
  "melrose": { area: "Melrose" },
  "sandhurst": { area: "Sandhurst" },
  "hyde park": { area: "Hyde Park" },
  "morningside": { area: "Morningside" },
  "bryanston": { area: "Bryanston" },
  "illovo": { area: "Illovo" },
  "parkhurst": { area: "Parkhurst" },
  "parktown": { area: "Parktown" },
  "parkview": { area: "Parkview" },
  "greenside": { area: "Greenside" },
  "emmarentia": { area: "Emmarentia" },
  "melville": { area: "Melville" },
  "sunninghill": { area: "Sunninghill" },
  "bedfordview": { city: "Bedfordview" },
  // Gauteng and surrounds
  "pretoria": { city: "Pretoria" },
  "pta": { city: "Pretoria" },
  "tshwane": { city: "Pretoria" },
  "sandton": { city: "Sandton" },
  "rosebank": { city: "Rosebank" },
  "soweto": { city: "Soweto" },
  "midrand": { city: "Midrand" },
  // North West & Limpopo & Mpumalanga safari regions
  "madikwe": { area: "Madikwe Game Reserve" },
  "pilanesberg": { area: "Pilanesberg" },
  "sun city": { city: "Sun City" },
  "hartbeespoort": { city: "Hartbeespoort" },
  "waterberg": { area: "Waterberg" },
  "kruger": { area: "Kruger National Park" },
  "kruger national park": { area: "Kruger National Park" },
  "sabi sand": { area: "Sabi Sand" },
  "sabi sands": { area: "Sabi Sand" },
  "timbavati": { area: "Timbavati" },
  "panorama route": { area: "Panorama Route" },
  "addo elephant park": { area: "Addo Elephant National Park" },
  "addo": { area: "Addo Elephant National Park" },
  // Northern Cape and arid parks
  "namaqualand": { area: "Namaqualand" },
  "richtersveld": { area: "Richtersveld" },
  "kgalagadi": { area: "Kgalagadi Transfrontier Park" },
  "augrabies": { area: "Augrabies Falls National Park" },
  "elephant coast": { area: "Elephant Coast" },
  // Countries
  "za": { country: "South Africa" },
  "sa": { country: "South Africa" },
  "rsa": { country: "South Africa" },
  "uk": { country: "United Kingdom" },
  "gb": { country: "United Kingdom" },
  "uae": { country: "United Arab Emirates" },
  "ksa": { country: "Saudi Arabia" },
  "saudi": { country: "Saudi Arabia" },
  "us": { country: "United States" },
  "usa": { country: "United States" },
  "america": { country: "United States" },
  "tz": { country: "Tanzania" },
  // More common country codes
  "au": { country: "Australia" },
  "aus": { country: "Australia" },
  "nz": { country: "New Zealand" },
  "de": { country: "Germany" },
  "fr": { country: "France" },
  "it": { country: "Italy" },
  "es": { country: "Spain" },
  "jp": { country: "Japan" },
  "nl": { country: "Netherlands" },
  "pt": { country: "Portugal" },
  "gr": { country: "Greece" },
  "ae": { country: "United Arab Emirates" },
  "qa": { country: "Qatar" },
  "ke": { country: "Kenya" },
  "zm": { country: "Zambia" },
  "bw": { country: "Botswana" },
  "na": { country: "Namibia" },
  "mz": { country: "Mozambique" },
  "mu": { country: "Mauritius" },
  "sc": { country: "Seychelles" },
  // Airport/city codes
  "ams": { city: "Amsterdam" },
  "lhr": { city: "London" },
  "dxb": { city: "Dubai" },
  "nyc": { city: "New York" },
  "lon": { city: "London" },
  "fra": { city: "Frankfurt" },
  "muc": { city: "Munich" },
  "cdg": { city: "Paris" },
  "lgw": { city: "London" },
  "stn": { city: "London" },
  "man": { city: "Manchester" },
  "edi": { city: "Edinburgh" },
  "gla": { city: "Glasgow" },
  "doh": { city: "Doha" },
  "auh": { city: "Abu Dhabi" },
  "hkg": { city: "Hong Kong" },
  "sin": { city: "Singapore" },
  "bkk": { city: "Bangkok" },
  "nbo": { city: "Nairobi" },
  // Provinces/Islands common names
  "zanzibar": { province: "Zanzibar North" }
}));
function loadSmartSettings() {
  try {
    const smartAliases = localStorage.getItem("smartAliases") !== "0";
    return { smartAliases };
  } catch {
    return { smartAliases: true };
  }
}
function loadCustomAliases() {
  try {
    const raw = localStorage.getItem("customLocationAliases:v1");
    const list = raw ? JSON.parse(raw) : [];
    return Array.isArray(list) ? list : [];
  } catch {
    return [];
  }
}
function saveCustomAliases(list) {
  try {
    const safe = Array.isArray(list) ? list : [];
    localStorage.setItem("customLocationAliases:v1", JSON.stringify(safe));
  } catch {
  }
}
function getAliasMap(enableAliases) {
  if (!enableAliases) return null;
  const m = new Map(LOCATION_ALIASES);
  const custom = loadCustomAliases();
  if (Array.isArray(custom)) {
    for (const it of custom) {
      if (!it || typeof it !== "object") continue;
      const key = String(it.key || "").toLowerCase().trim();
      if (!key) continue;
      const loc = it.area ? { area: it.area } : it.city ? { city: it.city } : it.province ? { province: it.province } : it.country ? { country: it.country } : it.continent ? { continent: it.continent } : null;
      if (loc) m.set(key, loc);
    }
  }
  return m;
}
function buildLocationMaps(products) {
  const uniq = (arr) => Array.from(new Set(arr.filter(Boolean)));
  const makeMap = (arr) => {
    const m = /* @__PURE__ */ new Map();
    uniq(arr).forEach((v) => m.set(String(v).toLowerCase(), v));
    return m;
  };
  const continents = makeMap(products.map((p) => p.continent));
  const countries = makeMap(products.map((p) => p.country));
  const provinces = makeMap(products.map((p) => p.province));
  const cities = makeMap(products.map((p) => p.city));
  const areas = makeMap(products.map((p) => p.area));
  const allLabels = (() => {
    const labels = uniq([
      ...products.map((p) => p.area),
      ...products.map((p) => p.city),
      ...products.map((p) => p.province),
      ...products.map((p) => p.country),
      ...products.map((p) => p.continent)
    ]);
    return labels.map((v) => ({ key: String(v).toLowerCase(), label: v }));
  })();
  return { continents, countries, provinces, cities, areas, allLabels };
}
function detectCategory(text) {
  const t = (text || "").toLowerCase();
  for (const entry of CATEGORY_SYNONYMS) {
    if (entry.keys.some((k) => t.includes(k))) return entry.cat;
  }
  return "";
}
function resolveLocationToken(token, locMaps, enableAliases = true) {
  const t = (token || "").toLowerCase().trim();
  if (!t) return {};
  const aliasMap = getAliasMap(enableAliases);
  if (aliasMap && aliasMap.has(t)) return aliasMap.get(t);
  const tryExact = (map) => map.get(t);
  const tryIncludes = (map) => {
    let found = "";
    for (const [k, v] of map.entries()) {
      if (k.includes(t)) {
        found = v;
        break;
      }
    }
    return found;
  };
  if (aliasMap) for (const [k, v] of aliasMap.entries()) {
    if (k.length < 3) continue;
    const escaped = k.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
    const re = new RegExp(`(?:^|\\b)${escaped}(?:\\b|$)`, "i");
    if (re.test(t)) return v;
  }
  const { areas, cities, provinces, countries, continents } = locMaps;
  let area = tryExact(areas) || tryIncludes(areas);
  if (area) return { area };
  let city = tryExact(cities) || tryIncludes(cities);
  if (city) return { city };
  let province = tryExact(provinces) || tryIncludes(provinces);
  if (province) return { province };
  let country = tryExact(countries) || tryIncludes(countries);
  if (country) return { country };
  let continent = tryExact(continents) || tryIncludes(continents);
  if (continent) return { continent };
  return {};
}
function longestLocationMatch(text, locMaps, enableAliases = true) {
  const t = (text || "").toLowerCase();
  let best = { label: "", len: 0 };
  for (const { key, label } of locMaps.allLabels) {
    if (!key) continue;
    const idx = t.indexOf(key);
    if (idx >= 0 && key.length > best.len) {
      best = { label, len: key.length };
    }
  }
  let bestAlias = { len: 0, loc: {} };
  const aliasMap = getAliasMap(enableAliases);
  if (aliasMap) for (const [k2, v] of aliasMap.entries()) {
    if (k2.length < 3) continue;
    const escaped = k2.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
    const re = new RegExp(`(?:^|\\b)${escaped}(?:\\b|$)`, "i");
    const m = t.match(re);
    if (m) {
      const l = k2.length;
      if (l > bestAlias.len) {
        bestAlias = { key: k2, len: l, loc: v };
      }
    }
  }
  if (bestAlias.len > best.len) {
    return bestAlias.loc;
  }
  if (!best.label) return {};
  const k = String(best.label).toLowerCase();
  const { areas, cities, provinces, countries, continents } = locMaps;
  if (areas.has(k)) return { area: best.label };
  if (cities.has(k)) return { city: best.label };
  if (provinces.has(k)) return { province: best.label };
  if (countries.has(k)) return { country: best.label };
  if (continents.has(k)) return { continent: best.label };
  return {};
}
function parseQuery(rawText, { products, myLocation, enableAliases = true } = {}) {
  const text = (rawText || "").trim();
  if (!text) return { category: "", location: {} };
  const locMaps = buildLocationMaps(products || []);
  const lower = text.toLowerCase();
  const CONNECTORS = [" in ", " near ", " around ", " at "];
  let pos = -1, usedConnector = "";
  for (const c of CONNECTORS) {
    const i = lower.lastIndexOf(c);
    if (i > pos) {
      pos = i;
      usedConnector = c.trim();
    }
  }
  let left = text, right = "";
  if (pos > 0) {
    left = text.slice(0, pos).trim();
    right = text.slice(pos + (usedConnector.length + 2)).trim();
  }
  const category = detectCategory(left || text);
  if (/near me|around me|close by|nearby/.test(lower) && myLocation && (myLocation.city || myLocation.province || myLocation.country)) {
    const location3 = myLocation.city ? { city: myLocation.city } : myLocation.province ? { province: myLocation.province } : { country: myLocation.country };
    return { category, location: location3, usedConnector: usedConnector || "near" };
  }
  let location2 = resolveLocationToken(right, locMaps, enableAliases);
  if (Object.keys(location2).length === 0) {
    location2 = longestLocationMatch(text, locMaps, enableAliases);
  }
  return { category, location: location2, usedConnector };
}
function getSuggestion(text, { products, myLocation, enableAliases = true } = {}) {
  const { category, location: location2 } = parseQuery(text, { products, myLocation, enableAliases });
  if (!category && Object.keys(location2).length === 0) return null;
  const match = (p) => {
    if (category && String(p.category || "") !== category) return false;
    if ("area" in location2) return String(p.area || "") === location2.area;
    if ("city" in location2) return String(p.city || "") === location2.city;
    if ("province" in location2) return String(p.province || "") === location2.province;
    if ("country" in location2) return String(p.country || "") === location2.country;
    if ("continent" in location2) return String(p.continent || "") === location2.continent;
    return true;
  };
  const count = Array.isArray(products) ? products.filter(match).length : 0;
  const locLabel = Object.values(location2)[0];
  const label = `Show${category ? ` ${category}` : ""}${locLabel ? ` in ${locLabel}` : ""} (${count})`;
  const params = { ...category ? { category } : {}, ...location2 };
  return { label, count, params };
}
function persistMyLocation(loc) {
  try {
    localStorage.setItem("myLocation:v1", JSON.stringify(loc || {}));
  } catch {
  }
}
function loadMyLocation() {
  try {
    const raw = localStorage.getItem("myLocation:v1");
    return raw ? JSON.parse(raw) : {};
  } catch {
    return {};
  }
}
const ISO2 = {
  "United States": "US",
  "USA": "US",
  "US": "US",
  "United Kingdom": "GB",
  "UK": "GB",
  "England": "GB",
  "South Africa": "ZA",
  "France": "FR",
  "Italy": "IT",
  "Spain": "ES",
  "Canada": "CA",
  "Brazil": "BR",
  "Australia": "AU",
  "Japan": "JP",
  "Thailand": "TH",
  "United Arab Emirates": "AE",
  "Egypt": "EG",
  "Kenya": "KE"
};
async function searchEvents({ q = "", city = "", country = "", page = 1, limit = 8, includePast = false, signal } = {}) {
  const params = new URLSearchParams();
  if (q) params.set("q", q);
  if (city) params.set("city", city);
  if (country) params.set("country", ISO2[country] || country);
  if (page) params.set("page", String(page));
  if (limit) params.set("limit", String(limit));
  if (includePast) params.set("includePast", "1");
  try {
    if (localStorage.getItem("demoEvents") === "1") params.set("demo", "1");
  } catch {
  }
  const res = await fetch(`/api/events/search?${params.toString()}`, { signal });
  if (!res.ok) {
    throw new Error(`Events search failed: ${res.status}`);
  }
  const j = await res.json();
  if (j && j.ok) {
    return {
      events: Array.isArray(j.events) ? j.events : [],
      page: j.page || 1,
      limit: j.limit || limit,
      total: j.total || 0,
      hasMore: !!j.hasMore,
      countsBySource: j.countsBySource || {}
    };
  }
  return { events: [], page: 1, limit, total: 0, hasMore: false };
}
function SearchBar({ className = "" }) {
  const navigate = useNavigate();
  const [q, setQ] = reactExports.useState("");
  const [open, setOpen] = reactExports.useState(false);
  const [activeIdx, setActiveIdx] = reactExports.useState(0);
  const wrapRef = reactExports.useRef(null);
  const activeItemRef = reactExports.useRef(null);
  const scrollContainerRef = reactExports.useRef(null);
  const [recent, setRecent] = reactExports.useState(() => {
    try {
      return JSON.parse(localStorage.getItem("recentSearches") || "[]");
    } catch {
      return [];
    }
  });
  const searchHistoryRef = reactExports.useRef([]);
  const lastSearchTimeRef = reactExports.useRef(null);
  reactExports.useEffect(() => {
    if (q.trim() && q.length >= 3) {
      const now = Date.now();
      if (!lastSearchTimeRef.current || now - lastSearchTimeRef.current > 5e3) {
        searchHistoryRef.current = [q.trim(), ...searchHistoryRef.current.slice(0, 9)];
        try {
          localStorage.setItem("searchHistory", JSON.stringify(searchHistoryRef.current));
        } catch {
        }
        lastSearchTimeRef.current = now;
      }
    }
  }, [q]);
  reactExports.useMemo(() => {
    const query = q.toLowerCase().trim();
    if (query.includes("beach") || query.includes("ocean")) {
      return { text: "Cape Town beaches", icon: "ðŸ–ï¸" };
    }
    if (query.includes("safari") || query.includes("wildlife")) {
      return { text: "Kruger National Park", icon: "ðŸ¦" };
    }
    if (query.includes("mountain") || query.includes("hik")) {
      return { text: "Table Mountain hike", icon: "â›°ï¸" };
    }
    if (query.includes("cheap") || query.includes("budget")) {
      return { text: "Budget-friendly packages", icon: "ðŸ’°" };
    }
    if (query.includes("luxury") || query.includes("premium")) {
      return { text: "Premium experiences", icon: "âœ¨" };
    }
    return null;
  }, [q]);
  reactExports.useEffect(() => {
    if (activeItemRef.current && scrollContainerRef.current && open) {
      const container = scrollContainerRef.current;
      const activeItem = activeItemRef.current;
      const containerRect = container.getBoundingClientRect();
      const itemRect = activeItem.getBoundingClientRect();
      if (itemRect.top < containerRect.top) {
        container.scrollTop -= containerRect.top - itemRect.top;
      } else if (itemRect.bottom > containerRect.bottom) {
        container.scrollTop += itemRect.bottom - containerRect.bottom;
      }
    }
  }, [activeIdx, open]);
  const navLinks = reactExports.useMemo(() => [
    { label: "Trip Planner", path: "/plan-trip", group: "Navigate" },
    { label: "Trip Assist", path: "/ai", group: "Navigate" },
    { label: "Quotes", path: "/quotes", group: "Navigate" },
    { label: "New Quote", path: "/quote/new", group: "Navigate" },
    { label: "Itinerary", path: "/itinerary", group: "Navigate" },
    { label: "Bookings", path: "/bookings", group: "Navigate" },
    { label: "Partner Dashboard", path: "/partner-dashboard", group: "Navigate" },
    { label: "Collaboration", path: "/collaboration", group: "Navigate" }
  ], []);
  const suggestions = reactExports.useMemo(() => {
    const productItems = PRODUCTS.map((p) => ({
      label: p.title,
      path: `/plan-trip?q=${encodeURIComponent(p.title)}`,
      group: "Products",
      meta: [p.category, p.city || p.country].filter(Boolean).join(" â€¢ ")
    }));
    const serviceItems = SERVICES.map((s) => ({
      label: s.title,
      path: s.path,
      group: "Services",
      meta: s.description
    }));
    const uniq = (arr) => Array.from(new Set(arr.filter(Boolean)));
    const countBy = (arr) => arr.reduce((acc, v) => {
      if (!v) return acc;
      acc[v] = (acc[v] || 0) + 1;
      return acc;
    }, {});
    const continentCounts = countBy(PRODUCTS.map((p) => p.continent));
    const countryCounts = countBy(PRODUCTS.map((p) => p.country));
    const provinceCounts = countBy(PRODUCTS.map((p) => p.province));
    const cityCounts = countBy(PRODUCTS.map((p) => p.city));
    const areaCounts = countBy(PRODUCTS.map((p) => p.area));
    const labelSort = (a, b) => a.label.localeCompare(b.label, void 0, { sensitivity: "base" });
    const continents = uniq(PRODUCTS.map((p) => p.continent)).map((v) => ({ label: v, path: `/plan-trip?continent=${encodeURIComponent(v)}`, group: "Locations", meta: `Continent â€¢ ${continentCounts[v] || 0}` })).sort(labelSort);
    const countries = uniq(PRODUCTS.map((p) => p.country)).map((v) => ({ label: v, path: `/plan-trip?country=${encodeURIComponent(v)}`, group: "Locations", meta: `Country â€¢ ${countryCounts[v] || 0}` })).sort(labelSort);
    const provinces = uniq(PRODUCTS.map((p) => p.province)).map((v) => ({ label: v, path: `/plan-trip?province=${encodeURIComponent(v)}`, group: "Locations", meta: `Province â€¢ ${provinceCounts[v] || 0}` })).sort(labelSort);
    const cities = uniq(PRODUCTS.map((p) => p.city)).map((v) => ({ label: v, path: `/plan-trip?city=${encodeURIComponent(v)}`, group: "Locations", meta: `City â€¢ ${cityCounts[v] || 0}` })).sort(labelSort);
    const areas = uniq(PRODUCTS.map((p) => p.area)).map((v) => ({ label: v, path: `/plan-trip?area=${encodeURIComponent(v)}`, group: "Locations", meta: `Area â€¢ ${areaCounts[v] || 0}` })).sort(labelSort);
    const locationItems = [...continents, ...countries, ...provinces, ...cities, ...areas];
    const popular = [
      { label: "Plan Zanzibar", path: "/plan-trip?province=Zanzibar%20North", group: "Popular" },
      { label: "Plan Cape Town", path: "/plan-trip?city=Cape%20Town", group: "Popular" },
      { label: "Plan Kruger", path: "/plan-trip?area=Kruger%20National%20Park", group: "Popular" }
    ];
    return [...productItems, ...serviceItems, ...locationItems, ...popular, ...navLinks];
  }, [navLinks]);
  function escapeRegExp(str) {
    return str.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
  }
  function highlight(text, term) {
    if (!term) return text;
    const re = new RegExp(`(${escapeRegExp(term)})`, "ig");
    const parts = String(text).split(re);
    return parts.map(
      (part, i) => re.test(part) ? /* @__PURE__ */ jsxRuntimeExports.jsx("mark", { className: "bg-yellow-100 text-inherit p-0 rounded", children: part }, i) : /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: part }, i)
    );
  }
  const groupIcon = {
    Products: "ðŸ§³",
    Services: "ðŸ› ï¸",
    Locations: "ðŸ“",
    Events: "ðŸŽ«",
    Popular: "â­",
    Navigate: "ðŸ§­",
    Action: "ðŸ”Ž",
    Recent: "ðŸ•˜"
  };
  const [events, setEvents] = reactExports.useState([]);
  reactExports.useEffect(() => {
    const term = q.trim();
    if (term.length < 3) {
      setEvents([]);
      return;
    }
    const ctrl = new AbortController();
    const t = setTimeout(async () => {
      try {
        const { events: ev = [] } = await searchEvents({ q: term, signal: ctrl.signal });
        if (!ctrl.signal.aborted) {
          setEvents(ev.slice(0, 8));
        }
      } catch {
        if (!ctrl.signal.aborted) {
          setEvents([]);
        }
      }
    }, 350);
    return () => {
      ctrl.abort();
      clearTimeout(t);
    };
  }, [q]);
  const filtered = reactExports.useMemo(() => {
    const term = q.trim().toLowerCase();
    let base = suggestions;
    const myLoc = loadMyLocation();
    const { smartAliases } = loadSmartSettings();
    const parsed = q.trim() ? getSuggestion(q.trim(), { products: PRODUCTS, myLocation: myLoc, enableAliases: smartAliases }) : null;
    if (term) {
      base = suggestions.filter(
        (s) => s.label.toLowerCase().includes(term) || (s.meta || "").toLowerCase().includes(term)
      );
    } else if (recent.length) {
      const rec = recent.map((r) => ({ label: r, path: `/plan-trip?q=${encodeURIComponent(r)}`, group: "Recent" }));
      const clear = { label: "Clear recent searches", path: "#", group: "Recent" };
      base = [clear, ...rec, ...base];
    }
    if (term) {
      const action = parsed ? { label: parsed.label, path: `/plan-trip?${new URLSearchParams(parsed.params).toString()}`, group: "Action", meta: `${parsed.count} result${parsed.count === 1 ? "" : "s"}` } : { label: `Search products for â€œ${q.trim()}â€`, path: `/plan-trip?q=${encodeURIComponent(q.trim())}`, group: "Action" };
      const nearMe = myLoc && (myLoc.city || myLoc.province || myLoc.country) ? [{ label: `Near me${myLoc.city ? ` â€¢ ${myLoc.city}` : myLoc.province ? ` â€¢ ${myLoc.province}` : myLoc.country ? ` â€¢ ${myLoc.country}` : ""}`, path: (() => {
        const params = new URLSearchParams();
        if (myLoc.city) params.set("city", myLoc.city);
        else if (myLoc.province) params.set("province", myLoc.province);
        else if (myLoc.country) params.set("country", myLoc.country);
        return `/plan-trip?${params.toString()}`;
      })(), group: "Action", meta: "Use my location" }] : /near me|around me|nearby|close by/.test(q.trim().toLowerCase()) ? [{ label: "Set my locationâ€¦", path: "/plan-trip?setLocation=1", group: "Action", meta: "Enable Near me" }] : [];
      const evGroup = events && events.length ? events.map((e) => ({
        label: e.name,
        path: e.url || "#",
        group: "Events",
        meta: [e.city, e.date && new Date(e.date).toLocaleDateString()].filter(Boolean).join(" â€¢ "),
        provider: e.source,
        isDemo: e.source === "Demo"
      })) : [];
      return [action, ...nearMe, ...evGroup, ...base];
    }
    return base;
  }, [q, suggestions, recent, events]);
  reactExports.useEffect(() => {
    function onClick(e) {
      if (wrapRef.current && !wrapRef.current.contains(e.target)) setOpen(false);
    }
    document.addEventListener("mousedown", onClick);
    return () => document.removeEventListener("mousedown", onClick);
  }, []);
  reactExports.useEffect(() => {
    function onKey(e) {
      if (e.key === "/" && !e.metaKey && !e.ctrlKey && !e.altKey) {
        const input = wrapRef.current?.querySelector("input");
        if (input) {
          e.preventDefault();
          input.focus();
          setOpen(true);
        }
      }
    }
    window.addEventListener("keydown", onKey);
    return () => window.removeEventListener("keydown", onKey);
  }, []);
  function go(item) {
    if (!item) return;
    if (item.group === "Recent" && item.label === "Clear recent searches") {
      setRecent([]);
      try {
        localStorage.removeItem("recentSearches");
      } catch {
      }
      return;
    }
    if (q.trim()) {
      const next = [q.trim(), ...recent.filter((r) => r.toLowerCase() !== q.trim().toLowerCase())].slice(0, 5);
      setRecent(next);
      try {
        localStorage.setItem("recentSearches", JSON.stringify(next));
      } catch {
      }
    }
    setOpen(false);
    setQ("");
    if (item.path && /^https?:\/\//i.test(item.path)) {
      window.open(item.path, "_blank", "noopener");
    } else {
      navigate(item.path || "/");
    }
  }
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { ref: wrapRef, className: `relative ${className}`, children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2 border border-cream-border bg-white rounded-lg px-3 py-1.5 shadow-sm focus-within:ring-1 focus-within:ring-brand-orange/40 focus-within:border-brand-orange/50 transition-all", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { "aria-hidden": true, className: "text-brand-orange/70 text-base", children: "ðŸ”Ž" }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        "input",
        {
          value: q,
          onChange: (e) => {
            setQ(e.target.value);
            setOpen(true);
            setActiveIdx(0);
          },
          onFocus: () => setOpen(true),
          title: "Press / to search",
          onKeyDown: (e) => {
            if (!open && (e.key === "ArrowDown" || e.key === "Enter")) {
              setOpen(true);
              return;
            }
            if (!filtered.length) return;
            if (e.key === "ArrowDown") {
              e.preventDefault();
              setActiveIdx((i) => Math.min(i + 1, filtered.length - 1));
            } else if (e.key === "ArrowUp") {
              e.preventDefault();
              setActiveIdx((i) => Math.max(i - 1, 0));
            } else if (e.key === "Enter") {
              e.preventDefault();
              go(filtered[activeIdx]);
            } else if (e.key === "Escape") {
              setOpen(false);
            }
          },
          placeholder: "Search: Cape Town, Safari, Hotels, Beach Resortsâ€¦ (press / to focus)",
          className: "flex-1 outline-none text-sm bg-transparent placeholder:text-brand-russty/50 text-brand-brown",
          "aria-label": "Global search"
        }
      )
    ] }),
    open && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { ref: scrollContainerRef, className: "absolute left-0 mt-2 w-full min-w-[20rem] max-w-xl bg-white border border-cream-border rounded-lg shadow-lg z-50 max-h-96 overflow-auto", children: [
      q.trim().length >= 3 && events && events.length > 0 && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "sticky top-0 z-10 backdrop-blur supports-[backdrop-filter]:bg-white/90 bg-white border-b border-brand-gold/20 px-4 py-2 text-[11px] text-brand-russty/70", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "mr-1 font-semibold", children: "Sources:" }),
        Array.from(new Set(events.map((e) => e.source || "Unknown"))).map((src) => /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "inline-flex items-center gap-1 mr-1", children: /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "px-2 py-0.5 rounded-full bg-brand-orange/10 text-brand-orange text-[10px] font-medium", children: src }) }, src))
      ] }),
      filtered.length === 0 && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "px-4 py-3 text-sm text-brand-russty/70", children: "No matches found" }),
      filtered.length > 0 && /* @__PURE__ */ jsxRuntimeExports.jsx("ul", { className: "py-2 text-sm", children: filtered.map((s, idx) => /* @__PURE__ */ jsxRuntimeExports.jsx("li", { ref: idx === activeIdx ? activeItemRef : null, children: /* @__PURE__ */ jsxRuntimeExports.jsxs(
        "button",
        {
          onMouseEnter: () => {
            setActiveIdx(idx);
            try {
              if (s.path && s.path.startsWith("/")) {
                __vitePreload(() => Promise.resolve().then(() => routePrefetch), true ? [] : void 0).then((m) => m.prefetchRouteByPath && m.prefetchRouteByPath(s.path)).catch(() => {
                });
              }
            } catch {
            }
          },
          onClick: () => go(s),
          className: `w-full text-left px-4 py-2.5 flex items-center justify-between transition-colors ${idx === activeIdx ? "bg-brand-orange/5" : "hover:bg-cream"}`,
          children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "flex items-center gap-2 min-w-0", children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { "aria-hidden": true, className: "text-brand-russty/60", children: groupIcon[s.group] || "â€¢" }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "truncate", children: highlight(s.label, q.trim()) })
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-[10px] text-brand-russty/60 ml-2 whitespace-nowrap", children: [
              s.group,
              s.provider ? /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
                " â€¢ ",
                /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "px-1 py-0.5 rounded bg-cream-sand border border-cream-border", children: [
                  s.provider,
                  s.isDemo ? " (Demo)" : ""
                ] })
              ] }) : null,
              s.meta ? /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
                " â€¢ ",
                highlight(s.meta, q.trim())
              ] }) : ""
            ] })
          ]
        }
      ) }, s.group + s.label)) })
    ] })
  ] });
}
const layout = /* @__PURE__ */ JSON.parse('{"header":{"component":"MainHeader","props":{"showLogo":true,"showNavLinks":true,"showUserMenu":true,"sticky":true}},"main":{"categories":[{"group":"Public","routes":[{"path":"/","name":"Home","component":"Home","meta":{"title":"CollEco Travel | Home","description":"Discover collaborative travel experiences and curated escapes.","requiresAuth":false,"layout":"marketing"}},{"path":"/book","name":"Book Now","component":"Book","meta":{"title":"Book Now","requiresAuth":false,"layout":"marketing"}},{"path":"/book/accommodation","name":"Book Accommodation","component":"AccommodationBooking","meta":{"title":"Book Accommodation","requiresAuth":false,"layout":"marketing"}},{"path":"/book/flight","name":"Book Flight","component":"FlightBooking","meta":{"title":"Book Flight","requiresAuth":false,"layout":"marketing"}},{"path":"/book/car","name":"Hire a Car","component":"CarBooking","meta":{"title":"Car Hire","requiresAuth":false,"layout":"marketing"}},{"path":"/plan-trip","name":"Plan a Trip","component":"PlanTrip","meta":{"title":"Plan Your Trip","description":"Build an itinerary with our travel experts and partner network.","requiresAuth":false,"layout":"marketing"}},{"path":"/packages","name":"Our Packages","component":"Packages","meta":{"title":"Our Packages","description":"Explore curated travel packages.","requiresAuth":false,"layout":"marketing"}},{"path":"/about","name":"About Us","component":"About","meta":{"title":"About CollEco Travel","description":"Learn how CollEco powers collaborative travel planning.","requiresAuth":false,"layout":"marketing"}},{"path":"/support","name":"Support","component":"Support","meta":{"title":"Support","description":"Reach our concierge team for support or partnerships.","requiresAuth":false,"layout":"marketing"}},{"path":"/support/tickets","name":"Support Tickets","component":"SupportTickets","meta":{"title":"Support Tickets","description":"Submit and track support tickets","requiresAuth":false,"layout":"marketing"}},{"path":"/supplier/payouts","name":"Supplier Payouts","component":"SupplierPayouts","meta":{"title":"Supplier Payouts","description":"Manage supplier earnings and payout requests","requiresAuth":false,"layout":"marketing"}},{"path":"/safety","name":"Safety Promise","component":"Safety","meta":{"title":"Safety & Trust","description":"Our commitment to safe, trusted travel experiences.","requiresAuth":false,"layout":"marketing"}},{"path":"/contact","name":"Contact Us","component":"Contact","meta":{"title":"Get in Touch","description":"Reach our concierge team for support or partnerships.","requiresAuth":false,"layout":"marketing"}},{"path":"/login","name":"Sign In","component":"Login","meta":{"title":"Access CollEco","description":"Securely sign in to your CollEco workspace.","requiresAuth":false,"layout":"auth"}},{"path":"/loyalty","name":"CollEco Passport","component":"LoyaltyDashboard","meta":{"title":"CollEco Passport | Loyalty Rewards","description":"Earn points, unlock badges, and get rewarded for every trip.","requiresAuth":false,"layout":"marketing"}},{"path":"/gamification","name":"Gamification Center","component":"Gamification","meta":{"title":"Gamification Center | Challenges & Achievements","description":"Complete challenges, earn badges, climb leaderboards, and unlock rewards.","requiresAuth":false,"layout":"marketing"}},{"path":"/wishlist","name":"Wishlist","component":"Wishlist","meta":{"title":"My Wishlist","description":"View and manage your saved travel items.","requiresAuth":false,"layout":"marketing"}},{"path":"/refunds","name":"Refunds","component":"Refunds","meta":{"title":"Refunds","description":"Track your refund requests and status.","requiresAuth":false,"layout":"marketing"}},{"path":"/supplier/inventory/upload","name":"Bulk Inventory Upload","component":"BulkInventoryUpload","meta":{"title":"Bulk Inventory Upload","description":"Upload inventory in bulk via CSV.","requiresAuth":false,"layout":"marketing"}},{"path":"/admin/chat","name":"Admin Chat","component":"AdminChat","meta":{"title":"Admin Chat","description":"In-app chat for admin and support.","requiresAuth":false,"layout":"marketing"}},{"path":"/notifications","name":"Notifications","component":"Notifications","meta":{"title":"Notifications","description":"View your trip alerts and notifications.","requiresAuth":false,"layout":"marketing"}},{"path":"/transfers","name":"Shuttle & Transfers","component":"Transfers","meta":{"title":"Shuttle & Transfers","description":"Book instant or pre-arranged shuttle and transfer services.","requiresAuth":false,"layout":"marketing"}},{"path":"/transfers/history","name":"Transfer History","component":"TransferHistory","meta":{"title":"Transfer History","description":"View your past transfers and receipts.","requiresAuth":false,"layout":"marketing"}}]},{"group":"Legal","routes":[{"path":"/terms","name":"Terms & Conditions","component":"TermsStandalone","meta":{"title":"Terms and Conditions","description":"Understand the agreements that govern CollEco services.","requiresAuth":false,"layout":"legal"}},{"path":"/privacy","name":"Privacy Policy","component":"PrivacyPolicy","meta":{"title":"Privacy Policy","description":"How CollEco protects your personal data (POPI Act compliant).","requiresAuth":false,"layout":"legal"}},{"path":"/sla","name":"Service Level Agreement","component":"SLAPage","meta":{"title":"Service Level Agreement","description":"CollEco service standards and partner commitments.","requiresAuth":false,"layout":"legal"}}]},{"group":"Shared Workspace","routes":[{"path":"/quotes","name":"Quote Builder","component":"QuoteGenerator","meta":{"title":"AI Quote & Invoice Generator","requiresAuth":true,"roles":["admin","partner","agent"],"layout":"workspace"}},{"path":"/partner/templates","name":"Invoice Templates","component":"PartnerTemplates","meta":{"title":"Manage Invoice Templates","requiresAuth":true,"roles":["admin","partner"],"layout":"workspace"}},{"path":"/messages","name":"Messages","component":"MessagingCenter","meta":{"title":"Messages","requiresAuth":true,"roles":["admin","partner","agent","client"],"layout":"workspace"}},{"path":"/collaborations","name":"Collaborations","component":"PartnerCollaboration","meta":{"title":"Partner Collaborations","requiresAuth":true,"roles":["admin","partner"],"layout":"workspace"}},{"path":"/quote/new","name":"Create Quote","component":"NewQuote","meta":{"title":"Create New Quote","requiresAuth":true,"roles":["admin","partner","agent"],"layout":"workspace"}},{"path":"/itinerary","name":"Itinerary Builder","component":"Itinerary","meta":{"title":"Design Trip Itineraries","requiresAuth":true,"roles":["admin","partner","agent","client"],"layout":"workspace"}},{"path":"/bookings","name":"Bookings","component":"Bookings","meta":{"title":"Manage Bookings","requiresAuth":true,"roles":["admin","partner","agent","client"],"layout":"workspace"}},{"path":"/check-in","name":"Check-In","component":"CheckIn","meta":{"title":"Self Check-In","description":"Scan QR code to check in or unlock your room","requiresAuth":true,"roles":["client"],"layout":"workspace"}},{"path":"/collaboration","name":"Collaboration Hub","component":"Collaboration","meta":{"title":"Collaboration Hub","requiresAuth":true,"roles":["admin","partner","agent"],"layout":"workspace"}},{"path":"/collab-analytics","name":"Collab Analytics","component":"CollabAnalytics","meta":{"title":"Collaboration Analytics","requiresAuth":true,"roles":["admin"],"layout":"workspace"}},{"path":"/profile","name":"Profile","component":"Profile","meta":{"title":"Your Profile","requiresAuth":true,"layout":"workspace"}},{"path":"/account","name":"Account","component":"Profile","meta":{"title":"My Account","requiresAuth":true,"layout":"workspace"}},{"path":"/settings","name":"Account Settings","component":"Settings","meta":{"title":"Account Settings","requiresAuth":true,"layout":"workspace"}},{"path":"/settings/notifications","name":"Notification Settings","component":"NotificationSettings","meta":{"title":"Notification Settings","requiresAuth":true,"layout":"workspace"}},{"path":"/settings/privacy","name":"Privacy & Data Settings","component":"PrivacySettings","meta":{"title":"Privacy & Data Settings","description":"Manage your consent and personal data (POPI Act compliant)","requiresAuth":true,"layout":"workspace"}},{"path":"/checkout","name":"Checkout","component":"Checkout","meta":{"title":"Checkout","requiresAuth":false,"layout":"marketing"}},{"path":"/pay/success","name":"Payment Success","component":"PaymentSuccess","meta":{"title":"Payment Success","requiresAuth":false,"layout":"marketing"}},{"path":"/pay/cancel","name":"Payment Cancelled","component":"PaymentCancel","meta":{"title":"Payment Cancelled","requiresAuth":false,"layout":"marketing"}},{"path":"/pay/fail","name":"Payment Failed","component":"PaymentFailure","meta":{"title":"Payment Failed","requiresAuth":false,"layout":"marketing"}},{"path":"/payment-success","name":"Payment Success (Legacy)","component":"PaymentSuccess","meta":{"title":"Payment Success","requiresAuth":false,"layout":"marketing"}},{"path":"/partner-dashboard","name":"Partner Dashboard","component":"PartnerDashboard","meta":{"title":"Partner Dashboard","requiresAuth":true,"roles":["partner"],"layout":"workspace"}},{"path":"/partner/success","name":"Partner Success Dashboard","component":"PartnerSuccessDashboard","meta":{"title":"Partner Success | Revenue Optimization","description":"Maximize partner revenue with analytics, benchmarking, and growth strategies","requiresAuth":true,"roles":["partner"],"layout":"workspace"}},{"path":"/partner/earnings","name":"Earnings & Payouts","component":"PartnerEarnings","meta":{"title":"Partner Earnings | Commission & Payouts","description":"Track commission earnings, manage payouts, and optimize your subscription plan","requiresAuth":true,"roles":["partner"],"layout":"workspace"}},{"path":"/subscription","name":"Subscription Plans","component":"SubscriptionTiers","meta":{"title":"CollEco Subscription Plans | Pay-as-You-Grow","description":"Flexible subscription tiers with ROI optimization. Start free, upgrade as your business grows.","requiresAuth":false,"layout":"marketing"}},{"path":"/subscription/manage","name":"Manage Subscription","component":"SubscriptionTiers","meta":{"title":"Manage Your Subscription","requiresAuth":true,"roles":["partner"],"layout":"workspace"}},{"path":"/partner/onboarding","name":"Partner Onboarding","component":"PartnerOnboarding","meta":{"title":"Join CollEco Partner Network","requiresAuth":false,"layout":"marketing"}},{"path":"/partner/verification","name":"Partner Verification","component":"PartnerVerification","meta":{"title":"Document Verification","requiresAuth":false,"layout":"marketing"}},{"path":"/partner/application-status","name":"Application Status","component":"PartnerApplicationStatus","meta":{"title":"Partner Application Status","requiresAuth":false,"layout":"marketing"}},{"path":"/business/register","name":"Business Traveler Registration","component":"BusinessTravelerRegistration","meta":{"title":"Register Business Travel Account","requiresAuth":false,"layout":"marketing"}},{"path":"/business-dashboard","name":"Business Dashboard","component":"BusinessDashboard","meta":{"title":"Business Travel Dashboard","requiresAuth":true,"roles":["client"],"layout":"workspace"}},{"path":"/traveler-dashboard","name":"Traveler Dashboard","component":"TravelerDashboard","meta":{"title":"My Travel Dashboard","requiresAuth":true,"roles":["client"],"layout":"workspace"}},{"path":"/my-trips","name":"My Trips","component":"MyTrips","meta":{"title":"My Trips & Bookings","requiresAuth":true,"roles":["client"],"layout":"workspace"}},{"path":"/saved-itineraries","name":"Saved Itineraries","component":"SavedItineraries","meta":{"title":"Saved Itineraries","requiresAuth":true,"roles":["client"],"layout":"workspace"}},{"path":"/admin-console","name":"Admin Console","component":"AdminConsole","meta":{"title":"Admin Console","requiresAuth":true,"roles":["admin"],"layout":"workspace"}},{"path":"/admin/bookings","name":"Admin Bookings","component":"AdminBookings","meta":{"title":"Bookings Management - Internal","description":"Full commission breakdown and supplier settlements","requiresAuth":true,"roles":["admin"],"layout":"workspace"}},{"path":"/admin/business-accounts","name":"Manage Business Accounts","component":"ManageBusinessAccounts","meta":{"title":"Manage Business Travel Accounts","requiresAuth":true,"roles":["admin","partner"],"layout":"workspace"}},{"path":"/admin/business-accounts/:accountId","name":"Business Account Detail","component":"BusinessAccountDetail","meta":{"title":"Business Account Details","requiresAuth":true,"roles":["admin","partner"],"layout":"workspace"}},{"path":"/admin/accommodation","name":"Accommodation Inventory","component":"AdminAccommodation","meta":{"title":"Accommodation Inventory","requiresAuth":true,"roles":["admin"],"layout":"workspace"}},{"path":"/admin/transfer-analytics","name":"Transfer Analytics","component":"TransferAnalytics","meta":{"title":"Transfer Analytics","requiresAuth":true,"roles":["admin"],"layout":"workspace"}},{"path":"/compliance","name":"Compliance Overview","component":"Compliance","meta":{"title":"Compliance Overview","requiresAuth":true,"roles":["admin","partner"],"layout":"workspace"}},{"path":"/reports","name":"Reports","component":"Reports","meta":{"title":"Business Intelligence Reports","requiresAuth":true,"roles":["admin"],"layout":"workspace"}},{"path":"/promotions","name":"Promotions","component":"Promotions","meta":{"title":"Promotions","requiresAuth":true,"roles":["admin","partner","agent"],"layout":"workspace"}},{"path":"/payouts","name":"Payouts","component":"Payouts","meta":{"title":"Payouts","requiresAuth":true,"roles":["admin","partner","finance"],"layout":"workspace"}}]},{"group":"Client","routes":[{"path":"/client/dashboard","name":"Client Dashboard","component":"WorkspacePage","meta":{"title":"Your Travel Hub","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/quotes","name":"My Quotes","component":"WorkspacePage","meta":{"title":"View & Manage Quotes","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/bookings","name":"My Bookings","component":"WorkspacePage","meta":{"title":"Track Your Bookings","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/itineraries","name":"My Itineraries","component":"WorkspacePage","meta":{"title":"Trip Itineraries","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/trips","name":"Upcoming Trips","component":"Trips","meta":{"title":"My Trips","requiresAuth":true,"roles":["client","admin"],"layout":"workspace"}},{"path":"/analytics","name":"Analytics","component":"Analytics","meta":{"title":"Travel Analytics","requiresAuth":true,"roles":["client","admin","partner"],"layout":"workspace"}},{"path":"/client/messages","name":"Messages & Support","component":"WorkspacePage","meta":{"title":"Get Assistance","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/safety","name":"Safety & Help","component":"WorkspacePage","meta":{"title":"Travel Safety","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/upcoming","name":"Upcoming Trips","component":"MyTrips","meta":{"title":"Upcoming Trips","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/past","name":"Past Trips","component":"MyTrips","meta":{"title":"Past Trips","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/saved","name":"Saved Itineraries","component":"SavedItineraries","meta":{"title":"Saved Itineraries","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/destinations","name":"Destinations","component":"WorkspacePage","meta":{"title":"Explore Destinations","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/packages","name":"Packages","component":"Packages","meta":{"title":"Travel Packages","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/flights","name":"Flights","component":"FlightBooking","meta":{"title":"Book Flights","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/stays","name":"Stays","component":"AccommodationBooking","meta":{"title":"Book Accommodation","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/cars","name":"Cars","component":"CarBooking","meta":{"title":"Hire a Car","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/tours","name":"Tours","component":"WorkspacePage","meta":{"title":"Book Tours","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/quotes","name":"Quote Builder","component":"QuoteBuilder","meta":{"title":"Request Quotes","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/itinerary","name":"Itinerary Viewer","component":"Itinerary","meta":{"title":"View Itinerary","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/bookings","name":"Bookings","component":"Bookings","meta":{"title":"My Bookings","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/payment","name":"Payment","component":"WorkspacePage","meta":{"title":"Payment Methods","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/notifications","name":"Notification Center","component":"Notifications","meta":{"title":"Notifications","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/reminders","name":"Trip Reminders","component":"WorkspacePage","meta":{"title":"Trip Reminders","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/chat","name":"Chat with Agents","component":"WorkspacePage","meta":{"title":"Agent Chat","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/partner-chat","name":"Partner Chat","component":"WorkspacePage","meta":{"title":"Partner Chat","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/vouchers","name":"Vouchers","component":"WorkspacePage","meta":{"title":"Travel Vouchers","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/invoices","name":"Invoices","component":"WorkspacePage","meta":{"title":"Invoices","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/confirmations","name":"Confirmations","component":"WorkspacePage","meta":{"title":"Booking Confirmations","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/reviews","name":"Reviews","component":"WorkspacePage","meta":{"title":"My Reviews","role":"client","requiresAuth":true,"layout":"workspace"}},{"path":"/client/feedback","name":"Feedback","component":"WorkspacePage","meta":{"title":"Send Feedback","role":"client","requiresAuth":true,"layout":"workspace"}}]},{"group":"Partner","routes":[{"path":"/partner/dashboard","name":"Partner Dashboard","component":"PartnerDashboard","meta":{"title":"Partner Overview","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/performance","name":"Performance Insights","component":"WorkspacePage","meta":{"title":"Performance Analytics","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/transfers","name":"Transfer Requests","component":"PartnerTransferDashboard","meta":{"title":"Transfer Requests Dashboard","role":"partner","requiresAuth":false,"layout":"workspace"}},{"path":"/partner/bookings","name":"Bookings & Availability","component":"WorkspacePage","meta":{"title":"Booking Management","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/products","name":"Products & Packages","component":"WorkspacePage","meta":{"title":"Manage Listings","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/rates","name":"Rates & Availability","component":"WorkspacePage","meta":{"title":"Yield Management","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/leads","name":"Lead Manager","component":"WorkspacePage","meta":{"title":"Lead Pipeline","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/quotes","name":"Quote Requests","component":"WorkspacePage","meta":{"title":"Incoming Quotes","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/itineraries","name":"Itinerary Builder","component":"WorkspacePage","meta":{"title":"Design Itineraries","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/finance","name":"Finance & Payouts","component":"WorkspacePage","meta":{"title":"Earnings & Payouts","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/help","name":"Partner Support","component":"WorkspacePage","meta":{"title":"Help & Assistance","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/compliance","name":"Compliance & Documents","component":"WorkspacePage","meta":{"title":"Verify & Upload Documents","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/sales","name":"Sales & Earnings","component":"PartnerEarnings","meta":{"title":"Sales Dashboard","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/hotels","name":"Hotels","component":"WorkspacePage","meta":{"title":"Hotel Listings","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/tours","name":"Tours","component":"WorkspacePage","meta":{"title":"Tour Listings","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/cars","name":"Cars","component":"WorkspacePage","meta":{"title":"Car Rental Listings","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/activities","name":"Activities","component":"WorkspacePage","meta":{"title":"Activity Listings","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/calendar","name":"Calendar","component":"WorkspacePage","meta":{"title":"Availability Calendar","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/pricing","name":"Pricing","component":"WorkspacePage","meta":{"title":"Rate Management","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/allotments","name":"Allotments","component":"WorkspacePage","meta":{"title":"Inventory Management","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/booking-actions","name":"Booking Actions","component":"WorkspacePage","meta":{"title":"Confirm/Modify/Cancel","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/payouts","name":"Payouts","component":"WorkspacePage","meta":{"title":"Payout Management","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/commissions","name":"Commissions","component":"WorkspacePage","meta":{"title":"Commission Tracking","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/invoices","name":"Invoices","component":"WorkspacePage","meta":{"title":"Invoice Management","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/featured","name":"Featured Listings","component":"WorkspacePage","meta":{"title":"Featured Products","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/chat","name":"Chat","component":"WorkspacePage","meta":{"title":"Partner Chat","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/collaboration","name":"Collaboration","component":"WorkspacePage","meta":{"title":"Team Collaboration","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/documents","name":"Documents","component":"WorkspacePage","meta":{"title":"Document Uploads","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/verification","name":"Verification","component":"PartnerVerification","meta":{"title":"Partner Verification","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/safety","name":"Safety Details","component":"WorkspacePage","meta":{"title":"Safety Information","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/views","name":"Views","component":"WorkspacePage","meta":{"title":"Views Analytics","role":"partner","requiresAuth":true,"layout":"workspace"}},{"path":"/partner/bookings-analytics","name":"Booking Analytics","component":"WorkspacePage","meta":{"title":"Booking Trends","role":"partner","requiresAuth":true,"layout":"workspace"}}]},{"group":"Agent","routes":[{"path":"/agent/dashboard","name":"Agent Dashboard","component":"WorkspacePage","meta":{"title":"Agency Overview","role":"agent","requiresAuth":true,"layout":"workspace"}},{"path":"/agent/clients","name":"My Clients","component":"WorkspacePage","meta":{"title":"Client Profiles","role":"agent","requiresAuth":true,"layout":"workspace"}},{"path":"/agent/quotes","name":"Quotes Builder","component":"WorkspacePage","meta":{"title":"Manage Quotes","role":"agent","requiresAuth":true,"layout":"workspace"}},{"path":"/agent/itineraries","name":"Itineraries","component":"WorkspacePage","meta":{"title":"Build Itineraries","role":"agent","requiresAuth":true,"layout":"workspace"}},{"path":"/agent/bookings","name":"Bookings","component":"WorkspacePage","meta":{"title":"Bookings Pipeline","role":"agent","requiresAuth":true,"layout":"workspace"}},{"path":"/agent/promotions","name":"Promotions","component":"WorkspacePage","meta":{"title":"Campaigns & Offers","role":"agent","requiresAuth":true,"layout":"workspace"}},{"path":"/agent/offers","name":"Partner Offers","component":"WorkspacePage","meta":{"title":"Exclusive Offers","role":"agent","requiresAuth":true,"layout":"workspace"}}]},{"group":"Influencer","routes":[{"path":"/influencer/dashboard","name":"Influencer Dashboard","component":"WorkspacePage","meta":{"title":"Campaign Overview","role":"influencer","requiresAuth":true,"layout":"workspace"}},{"path":"/influencer/content","name":"Content Library","component":"WorkspacePage","meta":{"title":"Manage Content","role":"influencer","requiresAuth":true,"layout":"workspace"}},{"path":"/influencer/campaigns","name":"Campaigns","component":"WorkspacePage","meta":{"title":"Campaign Management","role":"influencer","requiresAuth":true,"layout":"workspace"}},{"path":"/influencer/performance","name":"Performance","component":"WorkspacePage","meta":{"title":"Performance Analytics","role":"influencer","requiresAuth":true,"layout":"workspace"}}]},{"group":"Admin","routes":[{"path":"/admin/dashboard","name":"Admin Dashboard","component":"AdminDashboard","meta":{"title":"System Overview","role":"admin","requiresAuth":true,"layout":"workspace"}},{"path":"/admin/reports","name":"Reports & Analytics","component":"Reports","meta":{"title":"Operational Reports","role":"admin","requiresAuth":true,"layout":"workspace"}},{"path":"/admin/users","name":"User Management","component":"WorkspacePage","meta":{"title":"Manage Users & Roles","role":"admin","requiresAuth":true,"layout":"workspace"}},{"path":"/admin/partners","name":"Partner Management","component":"WorkspacePage","meta":{"title":"Approve or Review Partners","role":"admin","requiresAuth":true,"layout":"workspace"}},{"path":"/admin/listings","name":"Listings","component":"WorkspacePage","meta":{"title":"Marketplace Listings","role":"admin","requiresAuth":true,"layout":"workspace"}},{"path":"/admin/finance","name":"Finance Reports","component":"Finance","meta":{"title":"Revenue & Transactions","role":"admin","requiresAuth":true,"layout":"workspace"}},{"path":"/admin/compliance","name":"Compliance","component":"WorkspacePage","meta":{"title":"Compliance & Oversight","role":"admin","requiresAuth":true,"layout":"workspace"}},{"path":"/admin/settings","name":"System Settings","component":"WorkspacePage","meta":{"title":"Configuration","role":"admin","requiresAuth":true,"layout":"workspace"}},{"path":"/admin/promotions","name":"Promotions","component":"WorkspacePage","meta":{"title":"Marketing Campaigns","role":"admin","requiresAuth":true,"layout":"workspace"}},{"path":"/admin/content","name":"Content Hub","component":"WorkspacePage","meta":{"title":"Content Library","role":"admin","requiresAuth":true,"layout":"workspace"}},{"path":"/admin/analytics","name":"Analytics","component":"Analytics","meta":{"title":"Platform Analytics","role":"admin","requiresAuth":true,"layout":"workspace"}}]},{"group":"Growth AI","routes":[{"path":"/ai","name":"AI Content Studio","component":"AIGeneratorPage","meta":{"title":"AI Content Generator","requiresAuth":true,"roles":["admin","partner","agent"],"layout":"workspace"}},{"path":"/ai/metrics","name":"AI Metrics","component":"AIMetricsPage","meta":{"title":"AI Metrics Dashboard","requiresAuth":true,"roles":["admin"],"layout":"workspace"}}]}]},"footer":{"component":"MainFooter","props":{"showNewsletterSignup":true,"showSocialLinks":true,"showContactInfo":true},"optionalInnerFooter":{"enabled":true,"component":"SubFooter","props":{"contextualInfo":true,"partnerBranding":false,"systemVersion":"v1.0.0-beta"}}}}');
const pagesConfig = {
  layout
};
const pageModules$1 = /* @__PURE__ */ Object.assign({ "../pages/AIGeneratorPage.jsx": () => __vitePreload(() => import("./AIGeneratorPage-DlAnS9gz.js"), true ? __vite__mapDeps([0,1,2,3,4,5]) : void 0), "../pages/AIMetricsPage.jsx": () => __vitePreload(() => import("./AIMetricsPage-C7EbhZyY.js"), true ? __vite__mapDeps([6,1,2]) : void 0), "../pages/About.jsx": () => __vitePreload(() => import("./About-B1xI7hqv.js"), true ? __vite__mapDeps([7,1,2]) : void 0), "../pages/AccommodationBooking.jsx": () => __vitePreload(() => import("./AccommodationBooking-CnBd5hSB.js"), true ? __vite__mapDeps([8,1,2,9,5,10,4]) : void 0), "../pages/AdminAccommodation.jsx": () => __vitePreload(() => import("./AdminAccommodation-DMs3tVG7.js"), true ? __vite__mapDeps([11,1,2,4,5]) : void 0), "../pages/AdminBookings.jsx": () => __vitePreload(() => import("./AdminBookings-NdyFHFu3.js"), true ? __vite__mapDeps([12,1,2,10,5]) : void 0), "../pages/AdminChat.jsx": () => __vitePreload(() => import("./AdminChat-BeEbE0lO.js"), true ? __vite__mapDeps([13,1,2]) : void 0), "../pages/AdminConsole.jsx": () => __vitePreload(() => import("./AdminConsole-MTHJkico.js"), true ? __vite__mapDeps([14,1,2,15,16,5]) : void 0), "../pages/AdminConsoleEnhanced.jsx": () => __vitePreload(() => import("./AdminConsoleEnhanced-DH_Y6AJ7.js"), true ? __vite__mapDeps([17,1,2,5]) : void 0), "../pages/AdminDashboard.jsx": () => __vitePreload(() => import("./AdminDashboard-1Z2eU-yc.js"), true ? __vite__mapDeps([18,1,2,19,20,5,4]) : void 0), "../pages/AdminLayout.jsx": () => __vitePreload(() => Promise.resolve().then(() => AdminLayout), true ? void 0 : void 0), "../pages/AdminPackageEditor.jsx": () => __vitePreload(() => Promise.resolve().then(() => AdminPackageEditor), true ? void 0 : void 0), "../pages/AdminPackageForm.jsx": () => __vitePreload(() => import("./AdminPackageForm-CSsPUrTd.js"), true ? __vite__mapDeps([21,1,2]) : void 0), "../pages/AdminPackageList.jsx": () => __vitePreload(() => Promise.resolve().then(() => AdminPackageList), true ? void 0 : void 0), "../pages/Analytics.jsx": () => __vitePreload(() => import("./Analytics-DxSi1iJg.js"), true ? __vite__mapDeps([22,1,2,4,5]) : void 0), "../pages/Book.jsx": () => __vitePreload(() => import("./Book-DJgWRp8R.js"), true ? __vite__mapDeps([23,1,2,9,5,4]) : void 0), "../pages/Bookings.jsx": () => __vitePreload(() => import("./Bookings-BYtPTBMw.js"), true ? __vite__mapDeps([24,1,2,25,26,27,10,3,4,5]) : void 0), "../pages/BulkInventoryUpload.jsx": () => __vitePreload(() => import("./BulkInventoryUpload-CFDRIpY9.js"), true ? __vite__mapDeps([28,1,2]) : void 0), "../pages/BusinessAccountDetail.jsx": () => __vitePreload(() => import("./BusinessAccountDetail-DLIYHckT.js"), true ? __vite__mapDeps([29,1,2,5,4]) : void 0), "../pages/BusinessDashboard.jsx": () => __vitePreload(() => import("./BusinessDashboard-C2XxIfiH.js"), true ? __vite__mapDeps([30,1,2,5,4]) : void 0), "../pages/BusinessTravelerRegistration.jsx": () => __vitePreload(() => import("./BusinessTravelerRegistration-Ctvgp8wh.js"), true ? __vite__mapDeps([31,1,2,5,4]) : void 0), "../pages/CarBooking.jsx": () => __vitePreload(() => import("./CarBooking-DygQXGKU.js"), true ? __vite__mapDeps([32,1,2,9,5,10,4]) : void 0), "../pages/CheckIn.jsx": () => __vitePreload(() => import("./CheckIn-BaqdhfOa.js"), true ? __vite__mapDeps([33,1,2,4,5]) : void 0), "../pages/Checkout.jsx": () => __vitePreload(() => import("./Checkout-B26h3dT9.js"), true ? __vite__mapDeps([34,1,2,10,5,4]) : void 0), "../pages/CollabAnalytics.jsx": () => __vitePreload(() => import("./CollabAnalytics-DDflkx5q.js"), true ? __vite__mapDeps([35,1,2,4,5]) : void 0), "../pages/Collaboration.jsx": () => __vitePreload(() => import("./Collaboration-CKxtq4Tp.js"), true ? __vite__mapDeps([36,1,2,4,5]) : void 0), "../pages/Compliance.jsx": () => __vitePreload(() => import("./Compliance-BUv0Nl3T.js"), true ? __vite__mapDeps([37,1,2,25,38,5,4]) : void 0), "../pages/Contact.jsx": () => __vitePreload(() => import("./Contact-BKAKnX_9.js"), true ? __vite__mapDeps([39,1,2,4,5]) : void 0), "../pages/DirectBooking.jsx": () => __vitePreload(() => import("./DirectBooking-rW0VGL4B.js"), true ? __vite__mapDeps([40,1,2]) : void 0), "../pages/Finance.jsx": () => __vitePreload(() => Promise.resolve().then(() => Finance), true ? void 0 : void 0), "../pages/FlightBooking.jsx": () => __vitePreload(() => import("./FlightBooking-ByBMVx1c.js"), true ? __vite__mapDeps([41,1,2,9,5,10,4]) : void 0), "../pages/Gamification.jsx": () => __vitePreload(() => import("./Gamification-B8PmrtO-.js"), true ? __vite__mapDeps([42,1,2,20,5,4]) : void 0), "../pages/Home.jsx": () => __vitePreload(() => import("./Home-CsMrKiu0.js"), true ? __vite__mapDeps([43,1,2,10,5,4]) : void 0), "../pages/Itinerary.jsx": () => __vitePreload(() => import("./Itinerary-Db3jaCzc.js"), true ? __vite__mapDeps([44,4,1,2,45,46,47,48,3,5]) : void 0), "../pages/ItineraryPage.jsx": () => __vitePreload(() => Promise.resolve().then(() => ItineraryPage), true ? void 0 : void 0), "../pages/ItinerarySimple.jsx": () => __vitePreload(() => import("./ItinerarySimple-DlxCSQuV.js"), true ? __vite__mapDeps([49,4,1,2,45,46,48,3,10,5]) : void 0), "../pages/Login.jsx": () => __vitePreload(() => import("./Login-Di12DA54.js"), true ? __vite__mapDeps([50,1,2,10,5,4]) : void 0), "../pages/LoyaltyDashboard.jsx": () => __vitePreload(() => import("./LoyaltyDashboard-CAFfjaL_.js"), true ? __vite__mapDeps([51,1,2,5,4]) : void 0), "../pages/ManageBusinessAccounts.jsx": () => __vitePreload(() => import("./ManageBusinessAccounts-B1LL2z1G.js"), true ? __vite__mapDeps([52,1,2,5,4]) : void 0), "../pages/MyTrips.jsx": () => __vitePreload(() => import("./MyTrips-CzyhjBFK.js"), true ? __vite__mapDeps([53,1,2,5,4]) : void 0), "../pages/NewQuote.jsx": () => __vitePreload(() => import("./NewQuote-spyZAHeU.js"), true ? __vite__mapDeps([54,1,2,48,55,4,56,57,5]) : void 0), "../pages/NotificationSettings.jsx": () => __vitePreload(() => import("./NotificationSettings-B0X8EiKr.js"), true ? __vite__mapDeps([58,1,2,4,5]) : void 0), "../pages/Notifications.jsx": () => __vitePreload(() => import("./Notifications-aUUdH5xr.js"), true ? __vite__mapDeps([59,1,2]) : void 0), "../pages/Packages.jsx": () => __vitePreload(() => import("./Packages-7B1gxl-z.js"), true ? __vite__mapDeps([60,1,2]) : void 0), "../pages/PartnerApplicationStatus.jsx": () => __vitePreload(() => import("./PartnerApplicationStatus-BlEupfZ-.js"), true ? __vite__mapDeps([61,1,2,5,4]) : void 0), "../pages/PartnerDashboard.jsx": () => __vitePreload(() => import("./PartnerDashboard-BwUh1AKm.js"), true ? __vite__mapDeps([62,1,2,10,63,26,25,38,5,64,19,20,4]) : void 0), "../pages/PartnerEarnings.jsx": () => __vitePreload(() => import("./PartnerEarnings-DFK0ymPL.js"), true ? __vite__mapDeps([65,1,2,15,16,63,5,4]) : void 0), "../pages/PartnerOnboarding.jsx": () => __vitePreload(() => import("./PartnerOnboarding-BQkAC9Hc.js"), true ? __vite__mapDeps([66,1,2,63,5,4]) : void 0), "../pages/PartnerSuccessDashboard.jsx": () => __vitePreload(() => import("./PartnerSuccessDashboard-CjKpIuP4.js"), true ? __vite__mapDeps([67,1,2,63,5]) : void 0), "../pages/PartnerTemplates.jsx": () => __vitePreload(() => import("./PartnerTemplates-DP35T7y5.js"), true ? __vite__mapDeps([68,1,2,10,4,5]) : void 0), "../pages/PartnerTransferDashboard.jsx": () => __vitePreload(() => import("./PartnerTransferDashboard-B8YkEh26.js"), true ? __vite__mapDeps([69,1,2,63]) : void 0), "../pages/PartnerVerification.jsx": () => __vitePreload(() => import("./PartnerVerification-C5xV2x3J.js"), true ? __vite__mapDeps([70,1,2,63,5,4]) : void 0), "../pages/Partners.jsx": () => __vitePreload(() => import("./Partners-sZTBUpKg.js"), true ? __vite__mapDeps([71,1,2]) : void 0), "../pages/PaymentCancel.jsx": () => __vitePreload(() => import("./PaymentCancel-CXp2L1pa.js"), true ? __vite__mapDeps([72,1,2,4,5]) : void 0), "../pages/PaymentFailure.jsx": () => __vitePreload(() => import("./PaymentFailure-BJ0l-G9q.js"), true ? __vite__mapDeps([73,1,2,4,5]) : void 0), "../pages/PaymentSuccess.jsx": () => __vitePreload(() => import("./PaymentSuccess-Dba8cgfD.js"), true ? __vite__mapDeps([74,1,2,27,5,4]) : void 0), "../pages/Payouts.jsx": () => __vitePreload(() => import("./Payouts-Df-InSL1.js"), true ? __vite__mapDeps([75,1,2]) : void 0), "../pages/PlanTrip.jsx": () => __vitePreload(() => import("./PlanTrip-CHGleIan.js"), true ? __vite__mapDeps([76,1,2,10,25,46,48,56,47,3,4,5]) : void 0), "../pages/PrivacySettings.jsx": () => __vitePreload(() => import("./PrivacySettings-B_In51Te.js"), true ? __vite__mapDeps([77,1,2,5,4]) : void 0), "../pages/Profile.jsx": () => __vitePreload(() => import("./Profile-BqjbhayB.js"), true ? __vite__mapDeps([78,1,2,10,4,5]) : void 0), "../pages/Promotions.jsx": () => __vitePreload(() => import("./Promotions-wZ_rxQ4d.js"), true ? __vite__mapDeps([79,1,2,25,64,5,10,4]) : void 0), "../pages/QuoteGenerator.jsx": () => __vitePreload(() => import("./QuoteGenerator-BSNjDLC-.js"), true ? __vite__mapDeps([80,1,2,55,4,56,10,5]) : void 0), "../pages/Quotes.jsx": () => __vitePreload(() => import("./Quotes-Bdqb_3aS.js"), true ? __vite__mapDeps([81,1,2,56,55,4,3,10,57,5]) : void 0), "../pages/Refunds.jsx": () => __vitePreload(() => import("./Refunds-DnUNxCcC.js"), true ? __vite__mapDeps([82,1,2,83]) : void 0), "../pages/Reports.jsx": () => __vitePreload(() => import("./Reports-CayPqQ6I.js"), true ? __vite__mapDeps([84,1,2]) : void 0), "../pages/Safety.jsx": () => __vitePreload(() => import("./Safety-CveG-Ejd.js"), true ? __vite__mapDeps([85,1,2]) : void 0), "../pages/SavedItineraries.jsx": () => __vitePreload(() => import("./SavedItineraries-Dwa23ipc.js"), true ? __vite__mapDeps([86,1,2,5,4]) : void 0), "../pages/Settings.jsx": () => __vitePreload(() => import("./Settings-BxFyJ7jf.js"), true ? __vite__mapDeps([87,1,2,4,5]) : void 0), "../pages/SubscriptionTiers.jsx": () => __vitePreload(() => import("./SubscriptionTiers-Bntgf2GR.js"), true ? __vite__mapDeps([88,1,2,16,5]) : void 0), "../pages/SupplierPayouts.jsx": () => __vitePreload(() => import("./SupplierPayouts-CJZljMFb.js"), true ? __vite__mapDeps([89,1,2,83]) : void 0), "../pages/Support.jsx": () => __vitePreload(() => import("./Support-B_23pDAw.js"), true ? __vite__mapDeps([90,1,2]) : void 0), "../pages/SupportTickets.jsx": () => __vitePreload(() => import("./SupportTickets-BOB_5nBK.js"), true ? __vite__mapDeps([91,1,2]) : void 0), "../pages/Terms.jsx": () => __vitePreload(() => import("./Terms-H7f5eAsd.js"), true ? __vite__mapDeps([92,1,2]) : void 0), "../pages/TermsStandalone.jsx": () => __vitePreload(() => import("./TermsStandalone-DdjBFTbj.js"), true ? __vite__mapDeps([93,1,2,5]) : void 0), "../pages/TransferAnalytics.jsx": () => __vitePreload(() => import("./TransferAnalytics-BJ_4fNi8.js"), true ? __vite__mapDeps([94,1,2]) : void 0), "../pages/TransferHistory.jsx": () => __vitePreload(() => import("./TransferHistory-CODrUibK.js"), true ? __vite__mapDeps([95,1,2,4,5]) : void 0), "../pages/Transfers.jsx": () => __vitePreload(() => import("./Transfers-BrDFal9x.js"), true ? __vite__mapDeps([96,1,2,9,5,10,4]) : void 0), "../pages/TransportDispatch.jsx": () => __vitePreload(() => import("./TransportDispatch-DX-gKzwQ.js"), true ? __vite__mapDeps([97,1,2]) : void 0), "../pages/TravelerDashboard.jsx": () => __vitePreload(() => import("./TravelerDashboard-DblsybnJ.js"), true ? __vite__mapDeps([98,1,2,19,20,5,4]) : void 0), "../pages/Trips.jsx": () => __vitePreload(() => import("./Trips-DJzg56vs.js"), true ? __vite__mapDeps([99,1,2,4,5]) : void 0), "../pages/Unauthorized.jsx": () => __vitePreload(() => import("./Unauthorized-DXQFJVXQ.js"), true ? __vite__mapDeps([100,1,2,4,5]) : void 0), "../pages/Wishlist.jsx": () => __vitePreload(() => import("./Wishlist-51pqLmCs.js"), true ? __vite__mapDeps([101,1,2,4,5]) : void 0), "../pages/WorkspacePage.jsx": () => __vitePreload(() => import("./WorkspacePage-BHD0tBR-.js"), true ? __vite__mapDeps([102,1,2,5,4]) : void 0) });
const prefetched = /* @__PURE__ */ new Set();
function extractRoutesFromConfig$1(config) {
  const categories = config?.layout?.main?.categories ?? [];
  return categories.flatMap(
    ({ group, routes = [] }) => routes.filter((route) => route?.path).map((route) => ({
      ...route,
      component: route.component ?? "WorkspacePage",
      meta: { ...route.meta ?? {} },
      group
    }))
  );
}
const CONFIG_ROUTES$1 = extractRoutesFromConfig$1(pagesConfig);
const ROUTE_BY_PATH = new Map(CONFIG_ROUTES$1.map((r) => [r.path, r]));
async function prefetchRouteByPath(path) {
  try {
    if (!path) return;
    const route = ROUTE_BY_PATH.get(path);
    if (!route) return;
    const componentKey = route.component || "WorkspacePage";
    const modulePath = `../pages/${componentKey}.jsx`;
    if (prefetched.has(modulePath)) return;
    const loader = pageModules$1[modulePath];
    if (typeof loader === "function") {
      await loader();
      prefetched.add(modulePath);
    }
  } catch (e) {
  }
}
function observeAndPrefetchLinks(linkNodes = []) {
  if (typeof IntersectionObserver === "undefined") return () => {
  };
  const toUnobserve = [];
  const obs = new IntersectionObserver((entries) => {
    for (const entry of entries) {
      if (entry.isIntersecting) {
        const el = entry.target;
        const path = el?.getAttribute?.("href") || el?.dataset?.to;
        if (path) prefetchRouteByPath(path);
        obs.unobserve(el);
      }
    }
  }, { rootMargin: "120px" });
  for (const n of linkNodes) {
    if (n) {
      obs.observe(n);
      toUnobserve.push(n);
    }
  }
  return () => {
    try {
      for (const n of toUnobserve) obs.unobserve(n);
    } catch {
    }
    try {
      obs.disconnect();
    } catch {
    }
  };
}
const routePrefetch = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  observeAndPrefetchLinks,
  prefetchRouteByPath
}, Symbol.toStringTag, { value: "Module" }));
const LOYALTY_TIERS = {
  BRONZE: {
    id: "bronze",
    name: "Bronze",
    minPoints: 0,
    cashbackRate: 0.05,
    // 5% back in points
    color: "#CD7F32",
    icon: "ðŸ¥‰",
    benefits: [
      "5% back in points on every booking",
      "Member-only deals",
      "Standard support"
    ]
  },
  SILVER: {
    id: "silver",
    name: "Silver",
    minPoints: 5e3,
    cashbackRate: 0.07,
    // 7% back
    color: "#C0C0C0",
    icon: "ðŸ¥ˆ",
    benefits: [
      "7% back in points on every booking",
      "Priority customer support",
      "Early access to flash sales",
      "Free standard cancellation"
    ]
  },
  GOLD: {
    id: "gold",
    name: "Gold",
    minPoints: 15e3,
    cashbackRate: 0.1,
    // 10% back
    color: "#FFD700",
    icon: "ðŸ¥‡",
    benefits: [
      "10% back in points on every booking",
      "Free cancellation on all bookings",
      "Dedicated support line",
      "Exclusive partner perks",
      "Room upgrades when available"
    ]
  },
  PLATINUM: {
    id: "platinum",
    name: "Platinum",
    minPoints: 35e3,
    cashbackRate: 0.12,
    // 12% back
    color: "#E5E4E2",
    icon: "ðŸ’Ž",
    benefits: [
      "12% back in points on every booking",
      "Free cancellation on all bookings",
      "Dedicated concierge service",
      "Airport lounge access",
      "Guaranteed room upgrades",
      "Late checkout (when available)",
      "Welcome amenities at hotels"
    ]
  }
};
const BADGES = {
  // Travel frequency badges
  WANDERER: { id: "wanderer", name: "Wanderer", icon: "ðŸŒ", description: "Completed your first booking", points: 100 },
  EXPLORER: { id: "explorer", name: "Explorer", icon: "ðŸ§­", description: "5 bookings completed", points: 300 },
  ADVENTURER: { id: "adventurer", name: "Adventurer", icon: "â›°ï¸", description: "10 bookings completed", points: 500 },
  GLOBETROTTER: { id: "globetrotter", name: "Globetrotter", icon: "âœˆï¸", description: "25 bookings completed", points: 1e3 },
  // Category badges
  BEACH_LOVER: { id: "beach_lover", name: "Beach Lover", icon: "ðŸ–ï¸", description: "Booked 5 beach destinations", points: 250 },
  ADVENTURE_SEEKER: { id: "adventure_seeker", name: "Adventure Seeker", icon: "ðŸ”ï¸", description: "Booked 10 adventure activities", points: 400 },
  CITY_EXPLORER: { id: "city_explorer", name: "City Explorer", icon: "ðŸ™ï¸", description: "Visited 5 different cities", points: 300 },
  LUXURY_TRAVELER: { id: "luxury_traveler", name: "Luxury Traveler", icon: "ðŸ‘‘", description: "Booked 3 luxury stays", points: 500 },
  // Behavior badges
  EARLY_BIRD: { id: "early_bird", name: "Early Bird", icon: "ðŸ¦", description: "Book 60+ days in advance (3 times)", points: 200 },
  SPONTANEOUS: { id: "spontaneous", name: "Spontaneous", icon: "âš¡", description: "Booked 5 last-minute trips", points: 200 },
  SOCIAL_BUTTERFLY: { id: "social_butterfly", name: "Social Butterfly", icon: "ðŸ¦‹", description: "Referred 5 friends who booked", points: 500 },
  REVIEWER: { id: "reviewer", name: "Certified Reviewer", icon: "â­", description: "Written 10 verified reviews", points: 300 },
  // Milestone badges
  FIRST_CLASS: { id: "first_class", name: "First Class", icon: "ðŸŽ–ï¸", description: "Spent R50,000+ on bookings", points: 800 },
  WEEKEND_WARRIOR: { id: "weekend_warrior", name: "Weekend Warrior", icon: "ðŸƒ", description: "10 weekend getaways", points: 400 },
  LONG_HAULER: { id: "long_hauler", name: "Long Hauler", icon: "ðŸŒ", description: "Booked trips over 7 days (5 times)", points: 350 }
};
function getUserTier(totalPoints) {
  const tiers = Object.values(LOYALTY_TIERS).sort((a, b) => b.minPoints - a.minPoints);
  return tiers.find((tier) => totalPoints >= tier.minPoints) || LOYALTY_TIERS.BRONZE;
}
function calculatePointsFromBooking(bookingAmount, userId = null) {
  const tier = userId ? getUserTier(getLoyaltyData(userId).totalPoints) : LOYALTY_TIERS.BRONZE;
  const basePoints = Math.floor(bookingAmount);
  const bonusPoints = Math.floor(basePoints * tier.cashbackRate);
  return {
    basePoints,
    bonusPoints,
    totalPoints: basePoints + bonusPoints,
    cashbackRate: tier.cashbackRate,
    tier: tier.name
  };
}
function getLoyaltyData(userId = "current") {
  const key = `loyalty:v1:${userId}`;
  const defaultData = {
    userId,
    totalPoints: 0,
    availablePoints: 0,
    // Points not yet redeemed
    tier: "bronze",
    tierProgress: 0,
    // % to next tier
    earnedBadges: [],
    completedChallenges: [],
    streaks: {
      bookingStreak: 0,
      lastBookingDate: null
    },
    history: [],
    // Point transactions
    referralCode: generateReferralCode(userId),
    referrals: {
      pending: [],
      // Referred but not booked
      converted: [],
      // Referred and booked
      totalEarned: 0
    },
    createdAt: (/* @__PURE__ */ new Date()).toISOString(),
    updatedAt: (/* @__PURE__ */ new Date()).toISOString()
  };
  try {
    const stored = localStorage.getItem(key);
    return stored ? { ...defaultData, ...JSON.parse(stored) } : defaultData;
  } catch (e) {
    console.error("Failed to load loyalty data", e);
    return defaultData;
  }
}
function saveLoyaltyData(data, userId = "current") {
  const key = `loyalty:v1:${userId}`;
  try {
    localStorage.setItem(key, JSON.stringify({
      ...data,
      updatedAt: (/* @__PURE__ */ new Date()).toISOString()
    }));
    return true;
  } catch (e) {
    console.error("Failed to save loyalty data", e);
    return false;
  }
}
function awardPoints(amount, reason, metadata = {}, userId = "current") {
  const data = getLoyaltyData(userId);
  const transaction = {
    id: `txn-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
    type: "earn",
    amount,
    reason,
    metadata,
    timestamp: (/* @__PURE__ */ new Date()).toISOString()
  };
  data.totalPoints += amount;
  data.availablePoints += amount;
  data.history.unshift(transaction);
  const newTier = getUserTier(data.totalPoints);
  const oldTierId = data.tier;
  data.tier = newTier.id;
  const tiers = Object.values(LOYALTY_TIERS).sort((a, b) => a.minPoints - b.minPoints);
  const currentTierIndex = tiers.findIndex((t) => t.id === newTier.id);
  const nextTier = tiers[currentTierIndex + 1];
  if (nextTier) {
    const pointsInCurrentTier = data.totalPoints - newTier.minPoints;
    const pointsNeededForNext = nextTier.minPoints - newTier.minPoints;
    data.tierProgress = Math.min(100, pointsInCurrentTier / pointsNeededForNext * 100);
  } else {
    data.tierProgress = 100;
  }
  saveLoyaltyData(data, userId);
  return {
    success: true,
    newBalance: data.availablePoints,
    totalPoints: data.totalPoints,
    tierUpgrade: oldTierId !== newTier.id ? { from: oldTierId, to: newTier.id } : null,
    transaction
  };
}
function redeemPoints(amount, purpose, metadata = {}, userId = "current") {
  const data = getLoyaltyData(userId);
  if (data.availablePoints < amount) {
    return { success: false, error: "Insufficient points" };
  }
  const transaction = {
    id: `txn-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`,
    type: "redeem",
    amount: -amount,
    reason: purpose,
    metadata,
    timestamp: (/* @__PURE__ */ new Date()).toISOString()
  };
  data.availablePoints -= amount;
  data.history.unshift(transaction);
  saveLoyaltyData(data, userId);
  return {
    success: true,
    newBalance: data.availablePoints,
    redemptionValue: amount * 0.01,
    // 100 points = R1
    transaction
  };
}
function awardBadge(badgeId, userId = "current") {
  const data = getLoyaltyData(userId);
  const badge = BADGES[badgeId];
  if (!badge) return { success: false, error: "Badge not found" };
  if (data.earnedBadges.includes(badgeId)) return { success: false, error: "Badge already earned" };
  data.earnedBadges.push(badgeId);
  const pointsResult = awardPoints(badge.points, `Badge: ${badge.name}`, { badgeId }, userId);
  saveLoyaltyData(data, userId);
  return {
    success: true,
    badge,
    pointsAwarded: badge.points,
    newBalance: pointsResult.newBalance
  };
}
function checkBadgeEligibility(activityType, activityData, userId = "current") {
  const awarded = [];
  if (activityType === "booking_completed") {
    const bookingCount = activityData.totalBookings || 0;
    if (bookingCount === 1 && !hasEarnedBadge("wanderer", userId)) {
      awarded.push(awardBadge("WANDERER", userId));
    } else if (bookingCount === 5 && !hasEarnedBadge("explorer", userId)) {
      awarded.push(awardBadge("EXPLORER", userId));
    } else if (bookingCount === 10 && !hasEarnedBadge("adventurer", userId)) {
      awarded.push(awardBadge("ADVENTURER", userId));
    } else if (bookingCount === 25 && !hasEarnedBadge("globetrotter", userId)) {
      awarded.push(awardBadge("GLOBETROTTER", userId));
    }
  }
  return awarded.filter((r) => r.success);
}
function hasEarnedBadge(badgeId, userId = "current") {
  const data = getLoyaltyData(userId);
  return data.earnedBadges.includes(badgeId.toUpperCase());
}
function generateReferralCode(userId) {
  const prefix = "CE";
  const uniquePart = userId.toString().slice(0, 4).toUpperCase() + Math.random().toString(36).substr(2, 4).toUpperCase();
  return `${prefix}${uniquePart}`;
}
function pointsToCurrency(points, currency = "ZAR") {
  const value = points / 100;
  return {
    value,
    currency,
    formatted: formatCurrency(value, currency)
  };
}
function formatCurrency(amount, currency = "ZAR") {
  const symbols = { ZAR: "R", USD: "$", EUR: "â‚¬", GBP: "Â£" };
  return `${symbols[currency] || currency}${amount.toLocaleString("en-ZA", { minimumFractionDigits: 2, maximumFractionDigits: 2 })}`;
}
function getTierBenefits(tierId) {
  const tier = Object.values(LOYALTY_TIERS).find((t) => t.id === tierId);
  return tier ? tier.benefits : [];
}
function getNextTierInfo(currentPoints) {
  const currentTier = getUserTier(currentPoints);
  const tiers = Object.values(LOYALTY_TIERS).sort((a, b) => a.minPoints - b.minPoints);
  const currentIndex = tiers.findIndex((t) => t.id === currentTier.id);
  const nextTier = tiers[currentIndex + 1];
  if (!nextTier) {
    return {
      isMaxTier: true,
      message: "You're at the highest tier!"
    };
  }
  const pointsNeeded = nextTier.minPoints - currentPoints;
  const progress = (currentPoints - currentTier.minPoints) / (nextTier.minPoints - currentTier.minPoints) * 100;
  return {
    isMaxTier: false,
    nextTier,
    pointsNeeded,
    progress: Math.min(100, Math.max(0, progress)),
    currentTier
  };
}
function notify(role, title, body) {
  try {
    if ("Notification" in window) {
      if (Notification.permission === "granted") {
        new Notification(title, { body });
      } else if (Notification.permission !== "denied") {
        Notification.requestPermission();
      }
    }
  } catch {
  }
}
function processBookingRewards(booking) {
  const { id, amount, type, userId, checkInDate } = booking;
  if (!userId || !amount) {
    console.error("[Booking Integration] Missing required fields:", { userId, amount });
    return { success: false, error: "Missing required fields" };
  }
  try {
    const pointsCalc = calculatePointsFromBooking(amount, userId);
    const awardResult = awardPoints(
      pointsCalc.totalPoints,
      `Booking completed: ${type}`,
      {
        bookingId: id,
        bookingType: type,
        bookingAmount: amount,
        basePoints: pointsCalc.basePoints,
        bonusPoints: pointsCalc.bonusPoints,
        cashbackRate: pointsCalc.cashbackRate
      },
      userId
    );
    const loyaltyData = getLoyaltyData(userId);
    const totalBookings = loyaltyData.history.filter(
      (t) => t.type === "earn" && t.metadata?.bookingType
    ).length;
    checkBadgeEligibility("booking_completed", {
      totalBookings,
      bookingType: type,
      bookingAmount: amount,
      checkInDate,
      userId
    });
    notify({
      title: "ðŸŽ‰ Points Earned!",
      body: `You earned ${pointsCalc.totalPoints.toLocaleString()} points from your ${type} booking.${awardResult.tierUpgrade ? ` Congratulations! You've been upgraded to ${awardResult.tierUpgrade.to}!` : ""}`,
      icon: "/assets/icons/icon-192x192.png",
      tag: "loyalty-points",
      requireInteraction: false,
      data: {
        type: "loyalty_points_earned",
        bookingId: id,
        points: pointsCalc.totalPoints,
        tierUpgrade: awardResult.tierUpgrade
      }
    });
    if (awardResult.tierUpgrade) {
      notify({
        title: "ðŸŽŠ Tier Upgrade!",
        body: `You've been promoted to ${awardResult.tierUpgrade.to}! Enjoy ${getTierBenefitsText(awardResult.tierUpgrade.to)}`,
        icon: "/assets/icons/icon-192x192.png",
        tag: "tier-upgrade",
        requireInteraction: true,
        data: {
          type: "tier_upgrade",
          from: awardResult.tierUpgrade.from,
          to: awardResult.tierUpgrade.to
        }
      });
    }
    return {
      success: true,
      pointsEarned: pointsCalc.totalPoints,
      tierUpgrade: awardResult.tierUpgrade,
      newBalance: awardResult.newBalance
    };
  } catch (error) {
    console.error("[Booking Integration] Error processing rewards:", error);
    return { success: false, error: error.message };
  }
}
function getTierBenefitsText(tierId) {
  const benefits = {
    bronze: "5% cashback on bookings",
    silver: "7% cashback + priority support",
    gold: "10% cashback + exclusive deals + early access",
    platinum: "12% cashback + VIP concierge + special privileges"
  };
  return benefits[tierId.toLowerCase()] || "enhanced benefits";
}
function getLoyaltySummary(userId) {
  try {
    const loyaltyData = getLoyaltyData(userId);
    return {
      tier: loyaltyData.tier,
      availablePoints: loyaltyData.availablePoints,
      totalPoints: loyaltyData.totalPoints,
      tierProgress: loyaltyData.tierProgress,
      badges: loyaltyData.earnedBadges.length,
      referralCode: loyaltyData.referralCode
    };
  } catch (error) {
    console.error("[Booking Integration] Error getting loyalty summary:", error);
    return null;
  }
}
function Navbar() {
  const location2 = useLocation();
  const { user, isPartner, isAdmin } = useUser();
  const [showMobileSearch, setShowMobileSearch] = reactExports.useState(false);
  const [loyaltyInfo, setLoyaltyInfo] = reactExports.useState(null);
  const mobileSearchRef = reactExports.useRef(null);
  const toggleSidebar = () => {
    try {
      if (window && window.sidebarOpen) {
        window.dispatchEvent(new CustomEvent("close-sidebar"));
      } else {
        window.dispatchEvent(new CustomEvent("open-sidebar"));
      }
    } catch (e) {
      window.dispatchEvent(new Event("toggle-sidebar"));
    }
  };
  reactExports.useEffect(() => {
    const userId = user?.id || localStorage.getItem("colleco.user.id") || "guest_" + Date.now();
    const info = getLoyaltySummary(userId);
    setLoyaltyInfo(info);
  }, [user]);
  reactExports.useEffect(() => {
    setShowMobileSearch(false);
  }, [location2.pathname]);
  reactExports.useEffect(() => {
    const onKey = (e) => {
      if (e.key === "Escape") {
        setShowMobileSearch(false);
      }
    };
    window.addEventListener("keydown", onKey);
    return () => window.removeEventListener("keydown", onKey);
  }, []);
  reactExports.useEffect(() => {
    if (!showMobileSearch) return void 0;
    const onDown = (e) => {
      const node = mobileSearchRef.current;
      if (!node) return;
      if (!node.contains(e.target)) setShowMobileSearch(false);
    };
    document.addEventListener("mousedown", onDown);
    document.addEventListener("touchstart", onDown, { passive: true });
    return () => {
      document.removeEventListener("mousedown", onDown);
      document.removeEventListener("touchstart", onDown);
    };
  }, [showMobileSearch]);
  const primaryLinks = [
    { to: "/plan-trip", label: "Plan" },
    { to: "/itinerary", label: "Itinerary" },
    { to: "/ai", label: "Trip Assist" },
    { to: "/bookings", label: "Bookings" }
  ];
  return /* @__PURE__ */ jsxRuntimeExports.jsx("nav", { className: "fixed top-0 left-0 right-0 z-50 bg-cream/95 backdrop-blur-sm shadow-md border-b border-brand-gold/20", "data-testid": "navbar-primary", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "max-w-7xl mx-auto px-4 sm:px-6", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between h-16", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs(Link, { to: "/", className: "flex items-center gap-2.5 shrink-0", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          "img",
          {
            src: logo,
            alt: "CollEco Travel",
            className: "h-12 sm:h-14 w-12 sm:w-14 object-contain transition-transform duration-300 hover:scale-105",
            width: "56",
            height: "56"
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "hidden sm:flex flex-col leading-tight", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-base font-bold text-brand-orange", children: "CollEco Travel" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-[10px] text-brand-brown italic", style: { fontFamily: "cursive, Inter, sans-serif" }, children: "The Odyssey of Adventure" })
        ] })
      ] }),
      "					",
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "hidden md:block flex-1 max-w-lg mx-6", children: /* @__PURE__ */ jsxRuntimeExports.jsx(SearchBar, { integrated: true }) }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "hidden lg:flex items-center gap-4 ml-4", children: primaryLinks.map((l) => {
        const active = location2.pathname.startsWith(l.to);
        return /* @__PURE__ */ jsxRuntimeExports.jsx(
          Link,
          {
            to: l.to,
            className: `text-sm font-medium px-3 py-2 rounded-md transition-colors ${active ? "bg-brand-orange text-white shadow-sm" : "text-brand-brown hover:bg-cream-hover"}`,
            onMouseEnter: () => {
              try {
                prefetchRouteByPath(l.to);
              } catch {
              }
            },
            onFocus: () => {
              try {
                prefetchRouteByPath(l.to);
              } catch {
              }
            },
            children: l.label
          },
          l.to
        );
      }) }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-3 ml-auto", children: [
        loyaltyInfo && /* @__PURE__ */ jsxRuntimeExports.jsxs(
          Link,
          {
            to: "/loyalty",
            className: "hidden sm:flex items-center gap-2 px-3 py-1.5 bg-gradient-to-r from-brand-orange/10 to-orange-100 hover:from-brand-orange/20 hover:to-orange-200 rounded-full border border-brand-orange/20 hover:border-brand-orange/40 transition-all group",
            title: "View loyalty rewards",
            children: [
              loyaltyInfo.tier === "Platinum" ? /* @__PURE__ */ jsxRuntimeExports.jsx(Crown, { className: "w-4 h-4 text-yellow-600 group-hover:scale-110 transition-transform" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(Gift, { className: "w-4 h-4 text-brand-orange group-hover:scale-110 transition-transform" }),
              /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-xs font-semibold text-brand-brown", children: [
                loyaltyInfo.availablePoints,
                " pts"
              ] }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-[10px] text-brand-orange font-medium", children: loyaltyInfo.tier })
            ]
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          "button",
          {
            type: "button",
            onClick: () => setShowMobileSearch(!showMobileSearch),
            className: "md:hidden p-2 text-brand-brown hover:text-brand-orange hover:bg-cream-hover rounded-md transition-colors",
            "aria-label": showMobileSearch ? "Close search" : "Open search",
            children: /* @__PURE__ */ jsxRuntimeExports.jsx("svg", { className: "w-5 h-5", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: /* @__PURE__ */ jsxRuntimeExports.jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" }) })
          }
        ),
        user ? /* @__PURE__ */ jsxRuntimeExports.jsxs(
          Link,
          {
            to: isPartner ? "/partner/dashboard" : isAdmin ? "/admin/dashboard" : "/profile",
            className: "inline-flex items-center gap-2 px-4 py-2 text-sm font-semibold bg-brand-orange text-white hover:bg-brand-highlight rounded-md shadow-sm transition-colors",
            children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("svg", { className: "w-4 h-4", fill: "currentColor", viewBox: "0 0 20 20", children: /* @__PURE__ */ jsxRuntimeExports.jsx("path", { fillRule: "evenodd", d: "M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z", clipRule: "evenodd" }) }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "hidden sm:inline", children: isPartner ? "Partner Hub" : isAdmin ? "Admin Hub" : user.name || "My Account" })
            ]
          }
        ) : /* @__PURE__ */ jsxRuntimeExports.jsx(
          Link,
          {
            to: "/login",
            className: "px-4 py-2 text-sm font-semibold text-white bg-brand-orange hover:bg-brand-highlight active:opacity-100 rounded-md shadow-sm transition-colors",
            children: "Start Living"
          }
        ),
        "						",
        /* @__PURE__ */ jsxRuntimeExports.jsx(
          "button",
          {
            type: "button",
            onClick: toggleSidebar,
            className: "p-2 text-brand-brown hover:text-brand-orange hover:bg-cream-hover rounded-md transition-colors",
            "aria-label": "Menu",
            children: /* @__PURE__ */ jsxRuntimeExports.jsx("svg", { className: "w-6 h-6", fill: "none", stroke: "currentColor", viewBox: "0 0 24 24", children: /* @__PURE__ */ jsxRuntimeExports.jsx("path", { strokeLinecap: "round", strokeLinejoin: "round", strokeWidth: 2, d: "M4 6h16M4 12h16M4 18h16" }) })
          }
        )
      ] })
    ] }),
    showMobileSearch && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { ref: mobileSearchRef, className: "md:hidden border-t border-brand-gold/20 pb-3 px-2", children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "pt-3", children: /* @__PURE__ */ jsxRuntimeExports.jsx(SearchBar, { integrated: true }) }) })
  ] }) });
}
function useLocalStorageState(key, defaultValue) {
  const [state, setState] = reactExports.useState(() => {
    try {
      const storedValue = localStorage.getItem(key);
      return storedValue ? JSON.parse(storedValue) : defaultValue;
    } catch (error) {
      console.error("Error reading from localStorage", error);
      return defaultValue;
    }
  });
  reactExports.useEffect(() => {
    try {
      localStorage.setItem(key, JSON.stringify(state));
    } catch (error) {
      console.error("Error writing to localStorage", error);
    }
  }, [key, state]);
  return [state, setState];
}
const sidebar_config = {
  roles: {
    admin: {
      label: "Admin (CollEco)",
      sections: [
        {
          title: "Dashboard & Analytics",
          items: [
            { name: "Dashboard", icon: "LayoutDashboard", route: "/admin/dashboard" },
            { name: "Analytics", icon: "TrendingUp", route: "/admin/analytics" },
            { name: "Reports", icon: "BarChart3", route: "/admin/reports" }
          ]
        },
        {
          title: "User Management",
          items: [
            { name: "Users", icon: "Users", route: "/admin/users" },
            { name: "Partners", icon: "Briefcase", route: "/admin/partners" },
            { name: "Verification", icon: "ShieldCheck", route: "/admin/partners" }
          ]
        },
        {
          title: "Operations",
          items: [
            { name: "Bookings", icon: "CalendarCheck", route: "/admin/bookings" },
            { name: "Listings", icon: "Tag", route: "/admin/listings" },
            { name: "Compliance", icon: "Shield", route: "/admin/compliance" }
          ]
        },
        {
          title: "Finance & Growth",
          items: [
            { name: "Finance", icon: "Wallet", route: "/admin/finance" },
            { name: "Promotions", icon: "Megaphone", route: "/admin/promotions" },
            { name: "Content Hub", icon: "FileText", route: "/admin/content" }
          ]
        }
      ]
    },
    partner: {
      label: "Partner (Supplier)",
      sections: [
        {
          title: "Dashboard & Performance",
          items: [
            { name: "Dashboard", icon: "LayoutDashboard", route: "/partner/dashboard" },
            { name: "Performance", icon: "TrendingUp", route: "/partner/performance" },
            { name: "Views", icon: "BarChart3", route: "/partner/views" }
          ]
        },
        {
          title: "Inventory & Products",
          items: [
            { name: "Hotels", icon: "BedDouble", route: "/partner/hotels" },
            { name: "Tours", icon: "Mountain", route: "/partner/tours" },
            { name: "Cars", icon: "Car", route: "/partner/cars" },
            { name: "Activities", icon: "Camera", route: "/partner/activities" },
            { name: "Featured", icon: "Gift", route: "/partner/featured" }
          ]
        },
        {
          title: "Bookings & Availability",
          items: [
            { name: "Bookings", icon: "CalendarCheck", route: "/partner/bookings" },
            { name: "Calendar", icon: "CalendarCheck", route: "/partner/calendar" },
            { name: "Pricing", icon: "Tag", route: "/partner/pricing" },
            { name: "Allotments", icon: "LayoutDashboard", route: "/partner/allotments" },
            { name: "Transfers", icon: "MapPin", route: "/partner/transfers" }
          ]
        },
        {
          title: "Revenue & Finance",
          items: [
            { name: "Sales", icon: "TrendingUp", route: "/partner/sales" },
            { name: "Earnings", icon: "Wallet", route: "/partner/earnings" },
            { name: "Payouts", icon: "Wallet", route: "/partner/payouts" },
            { name: "Commissions", icon: "TrendingUp", route: "/partner/commissions" },
            { name: "Invoices", icon: "FileText", route: "/partner/invoices" }
          ]
        },
        {
          title: "Collaboration & Leads",
          items: [
            { name: "Quotes", icon: "FileText", route: "/partner/quotes" },
            { name: "Leads", icon: "Users", route: "/partner/leads" },
            { name: "Chat", icon: "MessageSquare", route: "/partner/chat" },
            { name: "Collaboration", icon: "Users2", route: "/partner/collaboration" }
          ]
        },
        {
          title: "Compliance & Support",
          items: [
            { name: "Verification", icon: "ShieldCheck", route: "/partner/verification" },
            { name: "Documents", icon: "FileText", route: "/partner/documents" },
            { name: "Safety", icon: "Shield", route: "/partner/safety" },
            { name: "Help", icon: "HelpCircle", route: "/partner/help" }
          ]
        }
      ]
    },
    client: {
      label: "Client (Traveler)",
      sections: [
        {
          title: "My Trips",
          items: [
            { name: "Upcoming", icon: "CalendarCheck", route: "/client/upcoming" },
            { name: "Past Trips", icon: "Map", route: "/client/past" },
            { name: "Saved Plans", icon: "Bookmark", route: "/client/saved" }
          ]
        },
        {
          title: "Plan & Book",
          items: [
            { name: "Destinations", icon: "MapPin", route: "/client/destinations" },
            { name: "Packages", icon: "Gift", route: "/client/packages" },
            { name: "Flights", icon: "Plane", route: "/client/flights" },
            { name: "Stays", icon: "BedDouble", route: "/client/stays" },
            { name: "Cars", icon: "Car", route: "/client/cars" },
            { name: "Tours", icon: "Mountain", route: "/client/tours" }
          ]
        },
        {
          title: "Collaborate & Quote",
          items: [
            { name: "Quote Builder", icon: "FileText", route: "/client/quotes" },
            { name: "Itinerary", icon: "Map", route: "/client/itinerary" },
            { name: "Chat", icon: "MessageSquare", route: "/client/chat" },
            { name: "Partner Chat", icon: "Users2", route: "/client/partner-chat" }
          ]
        },
        {
          title: "Manage Bookings",
          items: [
            { name: "Bookings", icon: "CalendarCheck", route: "/client/bookings" },
            { name: "Payment", icon: "Wallet", route: "/client/payment" },
            { name: "Vouchers", icon: "Tag", route: "/client/vouchers" },
            { name: "Invoices", icon: "FileText", route: "/client/invoices" },
            { name: "Confirmations", icon: "CheckCircle2", route: "/client/confirmations" }
          ]
        },
        {
          title: "Notifications & Help",
          items: [
            { name: "Notifications", icon: "MessageSquare", route: "/client/notifications" },
            { name: "Reminders", icon: "Clock3", route: "/client/reminders" },
            { name: "Messages", icon: "MessageSquare", route: "/client/messages" },
            { name: "Safety", icon: "Shield", route: "/client/safety" }
          ]
        },
        {
          title: "Reviews & Feedback",
          items: [
            { name: "Reviews", icon: "MessageSquare", route: "/client/reviews" },
            { name: "Feedback", icon: "MessageSquare", route: "/client/feedback" }
          ]
        }
      ]
    }
  }
};
const EXTERNAL_SIDEBAR_MODULE = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  default: sidebar_config
}, Symbol.toStringTag, { value: "Module" }));
const EXTERNAL_SIDEBAR_CONFIG = EXTERNAL_SIDEBAR_MODULE && (sidebar_config ?? EXTERNAL_SIDEBAR_MODULE) || null;
const SIDEBAR_CONFIG = {
  roles: {
    admin: {
      label: "Admin (CollEco)",
      sections: [
        {
          title: "Dashboard & Analytics",
          items: [
            { name: "Dashboard", icon: "LayoutDashboard", route: "/admin/dashboard" },
            { name: "Reports", icon: "BarChart3", route: "/admin/reports" },
            { name: "Analytics", icon: "TrendingUp", route: "/admin/analytics" }
          ]
        },
        {
          title: "Partner Management",
          items: [
            { name: "Partners", icon: "Users2", route: "/admin/partners" },
            { name: "Approval & Documents", icon: "FileText", route: "/admin/partner-approval" },
            { name: "Profiles", icon: "MapPin", route: "/admin/partner-profiles" }
          ]
        },
        {
          title: "Client Management",
          items: [
            { name: "Clients", icon: "Users", route: "/admin/clients" },
            { name: "Bookings Oversight", icon: "CalendarCheck", route: "/admin/bookings" },
            { name: "Refunds & Adjustments", icon: "Wallet", route: "/admin/refunds" }
          ]
        },
        {
          title: "Finance & Revenue",
          items: [
            { name: "Service Fees", icon: "Wallet", route: "/admin/fees" },
            { name: "Payouts & Commissions", icon: "Gift", route: "/admin/payouts" },
            { name: "Revenue Tracking", icon: "BarChart3", route: "/admin/revenue" }
          ]
        },
        {
          title: "Marketing & Promotions",
          items: [
            { name: "Promotions", icon: "Tag", route: "/admin/promotions" },
            { name: "Visibility Control", icon: "Sparkles", route: "/admin/visibility" }
          ]
        },
        {
          title: "Compliance & Safety",
          items: [
            { name: "Compliance Monitoring", icon: "ShieldCheck", route: "/admin/compliance" },
            { name: "Safety Monitoring", icon: "Shield", route: "/admin/safety" }
          ]
        },
        {
          title: "System Settings & API",
          items: [
            { name: "System Settings", icon: "Settings", route: "/admin/settings" },
            { name: "Notifications", icon: "Megaphone", route: "/settings/notifications" },
            { name: "API Integration", icon: "Globe2", route: "/admin/api" }
          ]
        }
      ]
    },
    partner: {
      label: "Partner (Supplier)",
      sections: [
        {
          title: "Dashboard & Performance",
          items: [
            { name: "Dashboard", icon: "LayoutDashboard", route: "/partner/dashboard" },
            { name: "Sales & Earnings", icon: "BarChart3", route: "/partner/sales" },
            { name: "Performance Trends", icon: "TrendingUp", route: "/partner/performance" }
          ]
        },
        {
          title: "Product Listings",
          items: [
            { name: "Hotels", icon: "Briefcase", route: "/partner/hotels" },
            { name: "Tours", icon: "Map", route: "/partner/tours" },
            { name: "Cars", icon: "Car", route: "/partner/cars" },
            { name: "Packages", icon: "Gift", route: "/partner/packages" },
            { name: "Activities", icon: "Sparkles", route: "/partner/activities" }
          ]
        },
        {
          title: "Availability & Rates",
          items: [
            { name: "Calendar", icon: "CalendarCheck", route: "/partner/calendar" },
            { name: "Pricing", icon: "Tag", route: "/partner/pricing" },
            { name: "Allotments", icon: "Clock3", route: "/partner/allotments" }
          ]
        },
        {
          title: "Booking Management",
          items: [
            { name: "Bookings", icon: "CalendarCheck", route: "/partner/bookings" },
            { name: "Confirm/Modify/Cancel", icon: "ShieldCheck", route: "/partner/booking-actions" }
          ]
        },
        {
          title: "Finance",
          items: [
            { name: "Payouts", icon: "Wallet", route: "/partner/payouts" },
            { name: "Commissions", icon: "Gift", route: "/partner/commissions" },
            { name: "Invoices", icon: "FileText", route: "/partner/invoices" }
          ]
        },
        {
          title: "Marketing Tools",
          items: [
            { name: "Promotions", icon: "Tag", route: "/partner/promotions" },
            { name: "Featured Listings", icon: "Sparkles", route: "/partner/featured" },
            { name: "Packages", icon: "Gift", route: "/partner/packages" }
          ]
        },
        {
          title: "Communication & Collaboration",
          items: [
            { name: "Chat", icon: "MessageSquare", route: "/partner/chat" },
            { name: "Collaboration", icon: "Users", route: "/partner/collaboration" }
          ]
        },
        {
          title: "Compliance",
          items: [
            { name: "Document Uploads", icon: "FileText", route: "/partner/documents" },
            { name: "Verification", icon: "ShieldCheck", route: "/partner/verification" },
            { name: "Safety Details", icon: "Shield", route: "/partner/safety" }
          ]
        },
        {
          title: "Analytics",
          items: [
            { name: "Views", icon: "BarChart3", route: "/partner/views" },
            { name: "Bookings", icon: "CalendarCheck", route: "/partner/bookings-analytics" },
            { name: "Performance Trends", icon: "TrendingUp", route: "/partner/performance" }
          ]
        },
        {
          title: "Settings",
          items: [
            { name: "Notifications", icon: "Megaphone", route: "/settings/notifications" },
            { name: "Account Settings", icon: "Settings", route: "/settings" }
          ]
        }
      ]
    },
    client: {
      label: "Client (Traveler)",
      sections: [
        {
          title: "Dashboard",
          items: [
            { name: "Upcoming Trips", icon: "CalendarCheck", route: "/client/upcoming" },
            { name: "Past Trips", icon: "Clock3", route: "/client/past" },
            { name: "Saved Itineraries", icon: "Map", route: "/client/saved" }
          ]
        },
        {
          title: "Search & Discovery",
          items: [
            { name: "Destinations", icon: "Globe2", route: "/client/destinations" },
            { name: "Packages", icon: "Gift", route: "/client/packages" },
            { name: "Flights", icon: "Plane", route: "/client/flights" },
            { name: "Stays", icon: "Briefcase", route: "/client/stays" },
            { name: "Cars", icon: "Car", route: "/client/cars" },
            { name: "Tours", icon: "Map", route: "/client/tours" }
          ]
        },
        {
          title: "Quote & Itinerary",
          items: [
            { name: "Quote Builder", icon: "FileText", route: "/client/quotes" },
            { name: "Itinerary Viewer", icon: "Map", route: "/client/itinerary" }
          ]
        },
        {
          title: "Booking & Payment",
          items: [
            { name: "Bookings", icon: "CalendarCheck", route: "/client/bookings" },
            { name: "Self Check-In", icon: "Camera", route: "/check-in" },
            { name: "Payment", icon: "Wallet", route: "/client/payment" },
            // Quick booking links moved from Navbar
            { name: "Book Stay", icon: "Briefcase", route: "/book/accommodation" },
            { name: "Book Flight", icon: "BarChart3", route: "/book/flight" },
            { name: "Car Hire", icon: "Map", route: "/book/car" }
          ]
        },
        {
          title: "Notifications & Settings",
          items: [
            { name: "Notification Center", icon: "Megaphone", route: "/client/notifications" },
            { name: "Notification Settings", icon: "Settings", route: "/settings/notifications" },
            { name: "Trip Reminders", icon: "Clock3", route: "/client/reminders" }
          ]
        },
        {
          title: "Collaboration",
          items: [
            { name: "Chat with Agents", icon: "MessageSquare", route: "/client/chat" },
            { name: "Partner Chat", icon: "Users2", route: "/client/partner-chat" }
          ]
        },
        {
          title: "Travel Documents",
          items: [
            { name: "Vouchers", icon: "FileText", route: "/client/vouchers" },
            { name: "Invoices", icon: "FileText", route: "/client/invoices" },
            { name: "Confirmations", icon: "ShieldCheck", route: "/client/confirmations" }
          ]
        },
        {
          title: "Reviews & Feedback",
          items: [
            { name: "Reviews", icon: "Star", route: "/client/reviews" },
            { name: "Feedback", icon: "MessageSquare", route: "/client/feedback" }
          ]
        },
        {
          title: "Safety & Emergency",
          items: [
            { name: "Safety & Emergency Support", icon: "Shield", route: "/client/safety" }
          ]
        }
      ]
    }
  }
};
function buildToolConfig(cfg) {
  const out = {};
  for (const [roleKey, roleCfg] of Object.entries(cfg.roles || {})) {
    const list = [];
    for (const section of roleCfg.sections || []) {
      for (const item of section.items || []) {
        list.push({ label: item.name || item.title || item.label, to: item.route || item.to || item.path || item.href || item.to });
      }
    }
    out[roleKey] = list;
  }
  return out;
}
const DEFAULT_TOOL_CONFIG = buildToolConfig(EXTERNAL_SIDEBAR_CONFIG || SIDEBAR_CONFIG);
const TOOL_CONFIG = DEFAULT_TOOL_CONFIG;
const ICON_COMPONENTS = {
  LayoutDashboard,
  BarChart3,
  Users,
  Users2,
  MapPin,
  Wallet,
  ShieldCheck,
  Settings,
  CalendarCheck,
  FileText,
  Tag,
  Sparkles,
  MessageSquare,
  Clock3,
  Shield,
  HelpCircle,
  TrendingUp,
  Briefcase,
  Map: Map$1,
  Megaphone,
  Camera,
  Gift,
  Star,
  Video,
  Globe2,
  Home,
  Bell,
  Activity,
  Zap,
  CheckCircle2,
  AlertCircle,
  Bookmark,
  Car,
  Plane,
  Mountain,
  BedDouble
};
const ROLE_OPTIONS = Object.entries((EXTERNAL_SIDEBAR_CONFIG || SIDEBAR_CONFIG).roles).map(
  ([value, config]) => ({
    value,
    label: config.label
  })
);
const MENU_TRANSITION = { duration: 0.45, ease: [0.4, 0, 0.2, 1] };
const DESKTOP_SIDEBAR_DEFAULT_WIDTH = 320;
const POINTER_SCROLL_SENSITIVITY = 1.35;
const POINTER_SCROLL_DEADBAND = 2;
function Sidebar() {
  const location2 = useLocation();
  const navigate = useNavigate();
  const [role, setRole] = useLocalStorageState("colleco.sidebar.role", "admin");
  const userCtx = useUser();
  reactExports.useEffect(() => {
    if (!userCtx) return;
    try {
      if (userCtx.user && userCtx.user.role && userCtx.user.role !== role) setRole(userCtx.user.role);
      else if (userCtx.isAdmin && role !== "admin") setRole("admin");
      else if (userCtx.isPartner && role !== "partner") setRole("partner");
      else if (userCtx.isClient && role !== "client") setRole("client");
    } catch (e) {
    }
  }, [userCtx, role, setRole]);
  const [isMobile, setIsMobile] = reactExports.useState(false);
  const [open, setOpen] = reactExports.useState(false);
  const [roleMenuOpen, setRoleMenuOpen] = reactExports.useState(false);
  const [language, setLanguage] = reactExports.useState("en");
  const [lastSync, setLastSync] = reactExports.useState(() => /* @__PURE__ */ new Date());
  const [expandedSections, setExpandedSections] = reactExports.useState(/* @__PURE__ */ new Set());
  const [sidebarWidth, setSidebarWidth] = reactExports.useState(DESKTOP_SIDEBAR_DEFAULT_WIDTH);
  const [isPinned, setIsPinned] = reactExports.useState(false);
  const asideRef = reactExports.useRef(null);
  const roleMenuRef = reactExports.useRef(null);
  const hoverTimeoutRef = reactExports.useRef(null);
  const pointerInsideRef = reactExports.useRef(false);
  const lastPointerYRef = reactExports.useRef(null);
  const linkRefs = reactExports.useRef(new Map$1());
  const roleFromCtx = userCtx && userCtx.user && userCtx.user.role ? userCtx.user.role : null;
  const activeRoleConfig = reactExports.useMemo(() => {
    const cfg = EXTERNAL_SIDEBAR_CONFIG || SIDEBAR_CONFIG;
    const effectiveRole = roleFromCtx || role;
    if (cfg.roles[effectiveRole]) return cfg.roles[effectiveRole];
    try {
      setRole("admin");
    } catch {
    }
    return cfg.roles.admin;
  }, [role, setRole, roleFromCtx]);
  const roleSections = reactExports.useMemo(() => activeRoleConfig.sections ?? [], [activeRoleConfig]);
  const renderSections = reactExports.useMemo(() => {
    return roleSections;
  }, [role, roleSections]);
  const firstExpandableSection = reactExports.useMemo(() => {
    for (const section of roleSections) {
      const sectionItems = (section.items || []).filter(
        (item) => !item.roles || item.roles.includes(role)
      );
      if (sectionItems.length > 0) return section.title;
    }
    return void 0;
  }, [roleSections, role]);
  reactExports.useEffect(() => {
    if (!firstExpandableSection) {
      setExpandedSections(/* @__PURE__ */ new Set());
      return;
    }
    setExpandedSections(/* @__PURE__ */ new Set([firstExpandableSection]));
  }, [firstExpandableSection]);
  reactExports.useEffect(() => {
    const nodes = [];
    try {
      for (const el of linkRefs.current.values()) if (el) nodes.push(el);
      const cleanup = observeAndPrefetchLinks(nodes);
      return () => {
        try {
          cleanup && cleanup();
        } catch {
        }
      };
    } catch {
      return void 0;
    }
  }, [renderSections, role, open, expandedSections]);
  reactExports.useEffect(() => () => {
    if (hoverTimeoutRef.current && typeof window !== "undefined") {
      window.clearTimeout(hoverTimeoutRef.current);
      hoverTimeoutRef.current = null;
    }
    pointerInsideRef.current = false;
    lastPointerYRef.current = null;
  }, []);
  reactExports.useEffect(() => {
    if (!asideRef.current) return void 0;
    const updateWidth = () => {
      if (asideRef.current) setSidebarWidth(asideRef.current.offsetWidth);
    };
    updateWidth();
    let resizeObserver;
    if (typeof ResizeObserver === "function") {
      resizeObserver = new ResizeObserver(updateWidth);
      resizeObserver.observe(asideRef.current);
    } else if (typeof window !== "undefined") {
      window.addEventListener("resize", updateWidth);
    }
    return () => {
      if (resizeObserver) resizeObserver.disconnect();
      else if (typeof window !== "undefined") window.removeEventListener("resize", updateWidth);
    };
  }, []);
  reactExports.useEffect(() => {
    if (typeof window === "undefined") return void 0;
    const query = window.matchMedia("(max-width: 1023px)");
    const update = () => setIsMobile(query.matches);
    update();
    query.addEventListener("change", update);
    return () => query.removeEventListener("change", update);
  }, []);
  reactExports.useEffect(() => {
    setOpen(!isMobile ? true : false);
    setIsPinned(false);
  }, [isMobile]);
  reactExports.useEffect(() => {
    const handler = () => {
      if (hoverTimeoutRef.current && typeof window !== "undefined") {
        window.clearTimeout(hoverTimeoutRef.current);
        hoverTimeoutRef.current = null;
      }
      pointerInsideRef.current = false;
      lastPointerYRef.current = null;
      setOpen((prev) => !prev);
      setIsPinned(false);
    };
    window.addEventListener("toggle-sidebar", handler);
    const onOpen = () => {
      setOpen(true);
      setIsPinned(false);
    };
    const onClose = () => {
      setOpen(false);
      setIsPinned(false);
    };
    window.addEventListener("open-sidebar", onOpen);
    window.addEventListener("close-sidebar", onClose);
    return () => window.removeEventListener("toggle-sidebar", handler);
  }, []);
  reactExports.useEffect(() => {
    if (!isMobile) return void 0;
    let startX = null;
    const onTouchStart = (e) => {
      startX = e.touches ? e.touches[0].clientX : e.clientX;
    };
    const onTouchMove = (e) => {
      if (startX === null) return;
      const currentX = e.touches ? e.touches[0].clientX : e.clientX;
      const delta = currentX - startX;
      if (delta > 60 && open) {
        startX = null;
        pointerInsideRef.current = false;
        lastPointerYRef.current = null;
        setIsPinned(false);
        setOpen(false);
      }
    };
    const onTouchEnd = () => {
      startX = null;
    };
    document.addEventListener("touchstart", onTouchStart, { passive: true });
    document.addEventListener("touchmove", onTouchMove, { passive: true });
    document.addEventListener("touchend", onTouchEnd);
    return () => {
      document.removeEventListener("touchstart", onTouchStart);
      document.removeEventListener("touchmove", onTouchMove);
      document.removeEventListener("touchend", onTouchEnd);
    };
  }, [isMobile, open]);
  reactExports.useEffect(() => {
    if (!open) return void 0;
    const handleOutside = (event) => {
      const target = event.target;
      const asideNode = asideRef.current;
      if (!asideNode) return;
      if (asideNode.contains(target)) return;
      if (roleMenuRef.current && roleMenuRef.current.contains(target)) return;
      pointerInsideRef.current = false;
      lastPointerYRef.current = null;
      setIsPinned(false);
      setOpen(false);
    };
    document.addEventListener("mousedown", handleOutside);
    document.addEventListener("touchstart", handleOutside);
    return () => {
      document.removeEventListener("mousedown", handleOutside);
      document.removeEventListener("touchstart", handleOutside);
    };
  }, [open]);
  reactExports.useEffect(() => {
    try {
      window.sidebarOpen = !!open;
      window.dispatchEvent(new CustomEvent("sidebar-open", { detail: { open: !!open } }));
    } catch (e) {
    }
  }, [open]);
  reactExports.useEffect(() => {
    if (!roleMenuOpen) return void 0;
    const handler = (event) => {
      if (roleMenuRef.current && !roleMenuRef.current.contains(event.target)) {
        setRoleMenuOpen(false);
      }
    };
    document.addEventListener("mousedown", handler);
    document.addEventListener("touchstart", handler);
    return () => {
      document.removeEventListener("mousedown", handler);
      document.removeEventListener("touchstart", handler);
    };
  }, [roleMenuOpen]);
  reactExports.useEffect(() => {
    if (isMobile) {
      pointerInsideRef.current = false;
      lastPointerYRef.current = null;
      setIsPinned(false);
      setOpen(false);
    }
    setRoleMenuOpen(false);
  }, [isMobile, location2.pathname]);
  reactExports.useEffect(() => {
    if (!open) setRoleMenuOpen(false);
  }, [open]);
  reactExports.useEffect(() => {
    const onKey = (event) => {
      if (event.key !== "Escape") return;
      if (roleMenuOpen) {
        setRoleMenuOpen(false);
      } else if (isMobile && open) {
        pointerInsideRef.current = false;
        lastPointerYRef.current = null;
        setIsPinned(false);
        setOpen(false);
      }
    };
    window.addEventListener("keydown", onKey);
    return () => window.removeEventListener("keydown", onKey);
  }, [isMobile, open, roleMenuOpen]);
  reactExports.useEffect(() => {
    if (typeof window === "undefined") return void 0;
    const timer = window.setInterval(() => {
      setLastSync(/* @__PURE__ */ new Date());
    }, 60 * 1e3);
    return () => window.clearInterval(timer);
  }, []);
  const containerClass = [
    "sidebar-scroll overflow-y-auto backdrop-blur-xl bg-white/95 border-l border-cream-border text-brand-brown",
    "px-4 py-6 sm:px-5 lg:px-6 transition-transform duration-300 ease-out will-change-transform",
    `fixed top-[calc(var(--header-h)+var(--banner-h))] right-0 bottom-[calc(var(--footer-h)+0.75rem)] z-40 shadow-xl`,
    isMobile ? `w-full max-w-xs ${open ? "translate-x-0" : "translate-x-full"} sm:w-80` : `w-80 xl:w-[22rem] ${open ? "translate-x-0" : "translate-x-full"}`
  ].join(" ");
  const linkClass = ({ isActive }) => [
    "flex w-full items-center gap-2 px-3 py-2 rounded-md text-sm font-medium transition-colors",
    isActive ? "bg-cream-sand border border-brand-orange/60 text-brand-brown shadow-[0_0_0_1px_rgba(243,148,72,0.25)]" : "text-brand-brown/85 hover:bg-cream-hover focus-visible:bg-cream-hover focus-visible:outline-none"
  ].join(" ");
  const toggleSection = (id) => {
    setExpandedSections((prev) => {
      const next = new Set(prev);
      if (next.has(id)) {
        next.delete(id);
      } else {
        next.add(id);
      }
      return next;
    });
  };
  const clearHoverTimeout = () => {
    if (!hoverTimeoutRef.current || typeof window === "undefined") return;
    window.clearTimeout(hoverTimeoutRef.current);
    hoverTimeoutRef.current = null;
  };
  const handleSidebarMouseEnter = () => {
    if (isMobile) return;
    clearHoverTimeout();
    pointerInsideRef.current = true;
    lastPointerYRef.current = null;
    if (!open) {
      setIsPinned(false);
      setOpen(true);
    }
  };
  const handleSidebarMouseLeave = (event) => {
    if (isMobile || roleMenuOpen || isPinned) return;
    const nextTarget = event?.relatedTarget;
    if (nextTarget && asideRef.current && asideRef.current.contains(nextTarget)) return;
    clearHoverTimeout();
    pointerInsideRef.current = false;
    lastPointerYRef.current = null;
    if (!open) return;
    if (typeof window === "undefined") {
      setOpen(false);
      setIsPinned(false);
      return;
    }
    hoverTimeoutRef.current = window.setTimeout(() => {
      setOpen(false);
      setIsPinned(false);
    }, 220);
  };
  const handleSidebarMouseMove = (event) => {
    if (isMobile || !pointerInsideRef.current || !open) return;
    const container = asideRef.current;
    if (!container) return;
    const currentY = event.clientY;
    if (lastPointerYRef.current !== null) {
      const delta = currentY - lastPointerYRef.current;
      if (Math.abs(delta) > POINTER_SCROLL_DEADBAND) {
        container.scrollBy({ top: delta * POINTER_SCROLL_SENSITIVITY, behavior: "auto" });
      }
    }
    lastPointerYRef.current = currentY;
  };
  const handleToggleMouseEnter = () => {
    if (isMobile) return;
    clearHoverTimeout();
    pointerInsideRef.current = false;
    lastPointerYRef.current = null;
    if (!open) {
      setIsPinned(false);
      setOpen(true);
    }
  };
  const handleToggleMouseLeave = () => {
    if (isMobile || roleMenuOpen || isPinned) return;
    clearHoverTimeout();
    pointerInsideRef.current = false;
    lastPointerYRef.current = null;
    if (!open) return;
    if (typeof window === "undefined") {
      setOpen(false);
      setIsPinned(false);
      return;
    }
    hoverTimeoutRef.current = window.setTimeout(() => {
      setOpen(false);
      setIsPinned(false);
    }, 220);
  };
  const handleLogout = () => {
    try {
      window.localStorage.removeItem("authToken");
      window.localStorage.removeItem("user");
    } catch {
    }
    navigate("/login");
    pointerInsideRef.current = false;
    lastPointerYRef.current = null;
    setIsPinned(false);
    setOpen(false);
  };
  const handleManualSync = () => setLastSync(/* @__PURE__ */ new Date());
  const cycleLanguage = () => setLanguage((prev) => prev === "en" ? "fr" : "en");
  const handleGoHome = () => {
    navigate("/");
    if (isMobile || !isPinned) {
      pointerInsideRef.current = false;
      lastPointerYRef.current = null;
      setIsPinned(false);
      setOpen(false);
    }
  };
  const humanisedSync = reactExports.useMemo(() => {
    const diffMs = Date.now() - lastSync.getTime();
    const diffMinutes = Math.max(0, Math.round(diffMs / 6e4));
    if (diffMinutes === 0) return "Just synced";
    if (diffMinutes === 1) return "Synced a minute ago";
    return `Synced ${diffMinutes} min ago`;
  }, [lastSync]);
  const activeRoleLabel = activeRoleConfig.label;
  const languageLabel = language === "en" ? "English" : "FranÃ§ais";
  const togglePositionStyle = isMobile ? void 0 : { right: `${Math.max(12, open ? sidebarWidth - 24 : 12)}px` };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
    isMobile && open && /* @__PURE__ */ jsxRuntimeExports.jsx(
      "button",
      {
        type: "button",
        "aria-label": "Close sidebar",
        onClick: () => {
          pointerInsideRef.current = false;
          lastPointerYRef.current = null;
          setIsPinned(false);
          setOpen(false);
        },
        className: "fixed inset-0 z-30 bg-black/35 backdrop-blur-sm lg:hidden"
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "aside",
      {
        className: containerClass,
        role: isMobile ? "dialog" : "complementary",
        "aria-modal": isMobile ? "true" : void 0,
        "aria-label": "Primary navigation",
        ref: asideRef,
        onMouseEnter: handleSidebarMouseEnter,
        onMouseLeave: handleSidebarMouseLeave,
        onMouseMove: handleSidebarMouseMove,
        onFocus: () => {
          if (!isMobile) {
            clearHoverTimeout();
            setOpen(true);
          }
        },
        tabIndex: open ? -1 : 0,
        style: isMobile ? { maxWidth: "100vw", width: open ? "100vw" : "0" } : void 0,
        children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex h-full flex-col gap-6", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs(
            motion.header,
            {
              className: "rounded-xl border border-cream-border bg-white/80 p-4 shadow-sm",
              initial: { opacity: 0, y: -18 },
              animate: { opacity: 1, y: 0 },
              transition: MENU_TRANSITION,
              children: [
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-3", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx(
                    "img",
                    {
                      src: logo,
                      alt: "CollEco",
                      className: "h-11 w-11 rounded-full border border-cream-border shadow-sm"
                    }
                  ),
                  /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col", children: [
                    /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-[11px] font-semibold uppercase tracking-[0.3em] text-brand-brown/70", children: "CollEco Console" }),
                    /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-lg font-bold leading-snug text-brand-brown", children: "Navigation Control" })
                  ] }),
                  /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "ml-auto flex items-center gap-2", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
                    "button",
                    {
                      type: "button",
                      onClick: handleGoHome,
                      className: "inline-flex h-8 w-8 items-center justify-center rounded-md border border-cream-border text-brand-brown transition-colors hover:bg-cream-hover",
                      "aria-label": "Go to home page",
                      children: /* @__PURE__ */ jsxRuntimeExports.jsx(Home, { className: "h-4 w-4", "aria-hidden": "true" })
                    }
                  ) })
                ] }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs(
                  "div",
                  {
                    className: "relative mt-4 rounded-lg border border-cream-border bg-cream-hover/60 px-3 py-2",
                    ref: roleMenuRef,
                    children: [
                      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-[11px] font-semibold uppercase tracking-wide text-brand-brown/70", children: "Active role" }),
                      /* @__PURE__ */ jsxRuntimeExports.jsxs(
                        "button",
                        {
                          type: "button",
                          className: "mt-2 inline-flex w-full items-center gap-2 rounded-md bg-white px-3 py-2 text-sm font-semibold text-brand-brown shadow-sm hover:bg-cream-hover",
                          onClick: () => setRoleMenuOpen((prev) => !prev),
                          "aria-haspopup": "listbox",
                          "aria-expanded": roleMenuOpen,
                          "aria-controls": "sidebar-role-menu",
                          children: [
                            /* @__PURE__ */ jsxRuntimeExports.jsx(Sparkles, { className: "h-4 w-4 text-brand-orange", "aria-hidden": "true" }),
                            /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: activeRoleLabel }),
                            /* @__PURE__ */ jsxRuntimeExports.jsx(
                              motion.span,
                              {
                                animate: { rotate: roleMenuOpen ? 180 : 0 },
                                transition: { duration: 0.2 },
                                className: "ml-auto text-brand-brown/70",
                                children: "â–¾"
                              }
                            )
                          ]
                        }
                      ),
                      roleMenuOpen && /* @__PURE__ */ jsxRuntimeExports.jsx(
                        motion.ul,
                        {
                          id: "sidebar-role-menu",
                          className: "absolute left-0 right-0 top-full z-40 mt-2 w-full overflow-hidden rounded-lg border border-cream-border bg-white shadow-lg",
                          role: "listbox",
                          initial: { opacity: 0, y: -8 },
                          animate: { opacity: 1, y: 0 },
                          transition: MENU_TRANSITION,
                          children: ROLE_OPTIONS.map((option) => /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: /* @__PURE__ */ jsxRuntimeExports.jsxs(
                            "button",
                            {
                              type: "button",
                              className: "flex w-full items-center gap-2 px-3 py-2 text-sm text-brand-brown hover:bg-brand-orange/10",
                              onClick: () => {
                                setRole(option.value);
                                setRoleMenuOpen(false);
                              },
                              role: "option",
                              "aria-selected": role === option.value,
                              children: [
                                /* @__PURE__ */ jsxRuntimeExports.jsx(Users2, { className: "h-4 w-4 text-brand-orange", "aria-hidden": "true" }),
                                /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: option.label }),
                                role === option.value && /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "ml-auto text-[11px] font-semibold uppercase text-brand-orange", children: "Active" })
                              ]
                            }
                          ) }, option.value))
                        }
                      )
                    ]
                  }
                )
              ]
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsx("nav", { className: "space-y-4", role: "navigation", "aria-label": "Sidebar sections", children: renderSections.map((section) => {
            const sectionId = section.title;
            const sectionItems = (section.items || []).filter(
              (item) => !item.roles || item.roles.includes(role)
            );
            if (sectionItems.length === 0) return null;
            const isExpanded = expandedSections.has(sectionId);
            const SectionIcon = ICON_COMPONENTS[section.icon] || ICON_COMPONENTS[sectionItems[0]?.icon] || LayoutDashboard;
            return /* @__PURE__ */ jsxRuntimeExports.jsxs(
              motion.section,
              {
                className: "overflow-hidden rounded-xl border border-cream-border/80 bg-white/80 shadow-sm",
                initial: { opacity: 0, y: 10 },
                animate: { opacity: 1, y: 0 },
                transition: MENU_TRANSITION,
                children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsxs(
                    "button",
                    {
                      type: "button",
                      className: "flex w-full items-start gap-3 px-4 py-3 text-left",
                      onClick: () => toggleSection(sectionId),
                      "aria-expanded": isExpanded,
                      children: [
                        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "mt-1 inline-flex h-9 w-9 items-center justify-center rounded-full bg-cream-hover text-brand-orange", children: /* @__PURE__ */ jsxRuntimeExports.jsx(SectionIcon, { className: "h-4 w-4", "aria-hidden": "true" }) }),
                        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex-1", children: [
                          /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-sm font-semibold text-brand-brown", children: section.title }),
                          section.description ? /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-xs text-brand-brown/70", children: section.description }) : null
                        ] }),
                        /* @__PURE__ */ jsxRuntimeExports.jsx(
                          motion.span,
                          {
                            className: "mt-1 text-brand-brown/60",
                            animate: { rotate: isExpanded ? 180 : 0 },
                            transition: { duration: 0.2 },
                            children: "â–¾"
                          }
                        )
                      ]
                    }
                  ),
                  /* @__PURE__ */ jsxRuntimeExports.jsx(
                    motion.div,
                    {
                      initial: false,
                      animate: { height: isExpanded ? "auto" : 0, opacity: isExpanded ? 1 : 0 },
                      transition: { duration: 0.25, ease: [0.4, 0, 0.2, 1] },
                      className: "overflow-hidden",
                      children: /* @__PURE__ */ jsxRuntimeExports.jsx("ul", { className: "space-y-1 px-4 pb-4", children: sectionItems.map((item) => {
                        const ItemIcon = ICON_COMPONENTS[item.icon] || LayoutDashboard;
                        let displayLabel = item.name;
                        let linkTo = item.route;
                        try {
                          const tools = TOOL_CONFIG && TOOL_CONFIG[role];
                          if (tools) {
                            const match = tools.find(
                              (t) => t.to === item.route || t.label && item.name && t.label.includes(item.name)
                            );
                            if (match) {
                              displayLabel = match.label || displayLabel;
                              linkTo = match.to || linkTo;
                            }
                          }
                        } catch (e) {
                        }
                        return /* @__PURE__ */ jsxRuntimeExports.jsx("li", { children: /* @__PURE__ */ jsxRuntimeExports.jsxs(
                          NavLink,
                          {
                            to: linkTo,
                            className: linkClass,
                            ref: (el) => {
                              try {
                                linkRefs.current.set(linkTo, el);
                              } catch {
                              }
                            },
                            onMouseEnter: () => {
                              try {
                                prefetchRouteByPath(linkTo);
                              } catch {
                              }
                            },
                            onFocus: () => {
                              try {
                                prefetchRouteByPath(linkTo);
                              } catch {
                              }
                            },
                            onClick: () => {
                              if (isMobile || !isPinned) {
                                pointerInsideRef.current = false;
                                lastPointerYRef.current = null;
                                setIsPinned(false);
                                setOpen(false);
                              }
                            },
                            children: [
                              ItemIcon && /* @__PURE__ */ jsxRuntimeExports.jsx(ItemIcon, { className: "h-4 w-4 text-brand-orange", "aria-hidden": "true" }),
                              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "flex-1", children: displayLabel })
                            ]
                          }
                        ) }, item.route);
                      }) })
                    }
                  )
                ]
              },
              sectionId
            );
          }) }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs(
            motion.footer,
            {
              className: "mt-auto space-y-4 rounded-xl border border-cream-border bg-white/75 p-4 shadow-sm",
              initial: { opacity: 0, y: 18 },
              animate: { opacity: 1, y: 0 },
              transition: MENU_TRANSITION,
              children: [
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between gap-2", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsxs(
                    "button",
                    {
                      type: "button",
                      onClick: cycleLanguage,
                      className: "inline-flex items-center gap-2 rounded-md border border-cream-border bg-white px-3 py-2 text-xs font-semibold uppercase tracking-wide text-brand-brown hover:bg-cream-hover",
                      children: [
                        /* @__PURE__ */ jsxRuntimeExports.jsx(Globe2, { className: "h-4 w-4 text-brand-orange", "aria-hidden": "true" }),
                        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: languageLabel })
                      ]
                    }
                  ),
                  /* @__PURE__ */ jsxRuntimeExports.jsxs(
                    "button",
                    {
                      type: "button",
                      onClick: handleManualSync,
                      className: "inline-flex items-center gap-2 rounded-md border border-brand-orange/20 bg-brand-orange/10 px-3 py-2 text-xs font-semibold uppercase tracking-wide text-brand-brown hover:bg-brand-orange/15",
                      children: [
                        /* @__PURE__ */ jsxRuntimeExports.jsx(Clock3, { className: "h-4 w-4 text-brand-orange", "aria-hidden": "true" }),
                        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: "Sync now" })
                      ]
                    }
                  )
                ] }),
                /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between text-xs text-brand-brown/70", children: [
                  /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: humanisedSync }),
                  /* @__PURE__ */ jsxRuntimeExports.jsxs(
                    "button",
                    {
                      type: "button",
                      onClick: handleLogout,
                      className: "inline-flex items-center gap-2 rounded-md px-2 py-1 text-xs font-semibold text-brand-orange hover:bg-brand-orange/10",
                      children: [
                        /* @__PURE__ */ jsxRuntimeExports.jsx(ShieldCheck, { className: "h-3.5 w-3.5", "aria-hidden": "true" }),
                        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: "Sign out" })
                      ]
                    }
                  )
                ] })
              ]
            }
          )
        ] })
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "button",
      {
        type: "button",
        "aria-label": open ? "Collapse sidebar" : "Expand sidebar",
        onClick: () => {
          clearHoverTimeout();
          pointerInsideRef.current = false;
          lastPointerYRef.current = null;
          setOpen((prev) => {
            const next = !prev;
            setIsPinned(next);
            return next;
          });
        },
        onMouseEnter: handleToggleMouseEnter,
        onMouseLeave: handleToggleMouseLeave,
        className: "fixed top-[calc(var(--header-h)+var(--banner-h)+1.5rem)] z-30 inline-flex h-8 w-8 items-center justify-center rounded-full border border-cream-border bg-white text-brand-brown shadow-sm transition-all duration-200 hover:bg-cream-hover",
        style: togglePositionStyle,
        children: open ? /* @__PURE__ */ jsxRuntimeExports.jsx(ChevronRight, { className: "h-4 w-4" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(ChevronLeft, { className: "h-4 w-4" })
      }
    )
  ] });
}
function MobileNav() {
  const location2 = useLocation();
  const navItems = [
    { path: "/", icon: "ðŸ ", label: "Home", iconColor: null },
    { path: "/packages", icon: "ðŸŽ’", label: "Packages", iconColor: "text-brand-orange" },
    { path: "/bookings", icon: "ðŸ“‹", label: "Bookings", iconColor: null },
    { path: "/notifications", icon: "ðŸ””", label: "Alerts", iconColor: "text-brand-gold" },
    { path: "/account", icon: "ðŸ‘¤", label: "Account", iconColor: "text-brand-orange" }
  ];
  return /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-cream-border shadow-lg z-50", children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex justify-around items-center h-16 px-2", children: navItems.map((item) => {
    const isActive = location2.pathname === item.path;
    return /* @__PURE__ */ jsxRuntimeExports.jsxs(
      Link,
      {
        to: item.path,
        className: `flex flex-col items-center justify-center flex-1 h-full transition-all rounded-lg relative ${isActive ? "bg-cream-sand/40 shadow-inner after:absolute after:bottom-1 after:h-1 after:left-2 after:right-2 after:rounded-full after:bg-brand-orange/70" : "hover:bg-cream-hover/30"}`,
        children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: `text-2xl mb-0.5 ${item.iconColor || (isActive ? "text-brand-orange" : "text-brand-brown")}`, children: item.icon }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: `text-[10px] font-semibold tracking-wide ${isActive ? "text-brand-orange" : "text-brand-brown hover:text-brand-orange"}`, children: item.label })
        ]
      },
      item.path
    );
  }) }) });
}
const routeLabels = {
  "/": "Home",
  "/plan-trip": "Plan Trip",
  "/itinerary": "Itinerary",
  "/ai": "Trip Assist",
  "/bookings": "Bookings",
  "/packages": "Packages",
  "/transfers": "Transfers",
  "/collaboration": "Collaboration",
  "/partner": "Partner Hub",
  "/settings": "Settings",
  "/profile": "Profile",
  "/account": "Account",
  "/notifications": "Notifications",
  "/contact": "Contact",
  "/about": "About",
  "/quotes": "Quotes",
  "/compliance": "Compliance",
  "/admin": "Admin"
};
function Breadcrumbs() {
  const location2 = useLocation();
  const paths = location2.pathname.split("/").filter(Boolean);
  if (paths.length === 0) return null;
  const crumbs = [{ path: "/", label: "Home" }];
  let currentPath = "";
  paths.forEach((segment) => {
    currentPath += `/${segment}`;
    const label = routeLabels[currentPath] || segment.charAt(0).toUpperCase() + segment.slice(1).replace(/-/g, " ");
    crumbs.push({ path: currentPath, label });
  });
  return /* @__PURE__ */ jsxRuntimeExports.jsx("nav", { "aria-label": "Breadcrumb", className: "mb-4", children: /* @__PURE__ */ jsxRuntimeExports.jsx("ol", { className: "flex items-center gap-2 text-sm text-brand-brown/70", children: crumbs.map((crumb, idx) => {
    const isLast = idx === crumbs.length - 1;
    return /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { className: "flex items-center gap-2", children: [
      idx > 0 && /* @__PURE__ */ jsxRuntimeExports.jsx("span", { "aria-hidden": "true", children: "/" }),
      isLast ? /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "font-semibold text-brand-brown", "aria-current": "page", children: crumb.label }) : /* @__PURE__ */ jsxRuntimeExports.jsx(
        Link,
        {
          to: crumb.path,
          className: "hover:text-brand-orange hover:underline transition-colors",
          children: crumb.label
        }
      )
    ] }, crumb.path);
  }) }) });
}
function AutoFocus() {
  const location2 = useLocation();
  const previousPath = reactExports.useRef(location2.pathname);
  reactExports.useEffect(() => {
    if (previousPath.current !== location2.pathname) {
      previousPath.current = location2.pathname;
      setTimeout(() => {
        const h1 = document.querySelector("main h1, #main-content h1, h1");
        if (h1 && typeof h1.focus === "function") {
          h1.setAttribute("tabindex", "-1");
          h1.focus({ preventScroll: false });
        } else {
          const main = document.querySelector("#main-content, main");
          if (main && typeof main.focus === "function") {
            main.focus({ preventScroll: false });
          }
        }
      }, 100);
    }
  }, [location2.pathname]);
  return null;
}
class VoiceBookingAgent {
  constructor() {
    this.recognition = null;
    this.synthesis = window.speechSynthesis;
    this.isListening = false;
    this.debug = false;
    this.conversationContext = {};
    this.currentBooking = {};
    this.conversationHistory = [];
    this.wakePhrases = ["hey colleco", "hello colleco", "hi colleco"];
    this.onTranscript = null;
    this.initializeSpeechRecognition();
  }
  // Internal debug logger â€” respects `this.debug` and avoids ESLint no-console warnings
  _log(level, ...args) {
    if (!this.debug) return;
    if (level === "warn") console.warn(...args);
    else if (level === "error") console.error(...args);
    else console.log(...args);
  }
  // Initialize speech recognition
  initializeSpeechRecognition() {
    if (!("webkitSpeechRecognition" in window) && !("SpeechRecognition" in window)) {
      this._log("warn", "Speech recognition not supported in this browser");
      return;
    }
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    this.recognition = new SpeechRecognition();
    this.recognition.continuous = false;
    this.recognition.interimResults = false;
    this.recognition.lang = "en-ZA";
    this.recognition.maxAlternatives = 3;
    this.recognition.onresult = (event) => this.handleSpeechResult(event);
    this.recognition.onerror = (event) => this.handleSpeechError(event);
    this.recognition.onend = () => {
    };
  }
  // Start listening
  startListening() {
    if (!this.recognition) {
      this.speak("Sorry, voice commands are not supported in your browser.");
      return false;
    }
    try {
      this.recognition.start();
      this.isListening = true;
      if (!this.onTranscript) {
        this.speak("Hi I'm Zola, I'm here to assist you. How can I help you today?");
      }
      return true;
    } catch (error) {
      this._log("error", "Failed to start speech recognition:", error);
      return false;
    }
  }
  // Stop listening
  stopListening() {
    if (this.recognition) {
      this.recognition.stop();
      this.isListening = false;
    }
  }
  // Handle speech recognition results
  handleSpeechResult(event) {
    const results = event.results;
    const lastResult = results[results.length - 1];
    if (lastResult.isFinal) {
      const transcript = lastResult[0].transcript.trim();
      this._log("log", "User said:", transcript);
      this.conversationHistory.push({
        speaker: "user",
        text: transcript,
        timestamp: (/* @__PURE__ */ new Date()).toISOString()
      });
      if (this.onTranscript) {
        this.onTranscript(transcript);
      } else {
        this.processCommand(transcript);
      }
    }
  }
  // Handle speech recognition errors
  handleSpeechError(event) {
    this._log("error", "Speech recognition error:", event.error);
    if (event.error === "no-speech") {
      this.speak("I didn't catch that. Could you please repeat?");
    } else if (event.error === "not-allowed") {
      this.speak("Please enable microphone permissions to use voice commands.");
    }
  }
  // Clean text for natural speech synthesis
  cleanTextForSpeech(text) {
    if (!text) return "";
    let cleaned = text;
    cleaned = cleaned.replace(/[\u{1F300}-\u{1F9FF}]/gu, "");
    cleaned = cleaned.replace(/[ðŸ”âœ…âŒðŸ“ðŸ’¬ðŸ“žðŸš—]/gu, "");
    cleaned = cleaned.replace(/:\)/g, "");
    cleaned = cleaned.replace(/;\)/g, "");
    cleaned = cleaned.replace(/:\(/g, "");
    cleaned = cleaned.replace(/&apos;/g, "'");
    cleaned = cleaned.replace(/&quot;/g, '"');
    cleaned = cleaned.replace(/&/g, " and ");
    cleaned = cleaned.replace(/\.{2,}/g, ".");
    cleaned = cleaned.replace(/!{2,}/g, "!");
    cleaned = cleaned.replace(/\?{2,}/g, "?");
    cleaned = cleaned.replace(/\*\*/g, "");
    cleaned = cleaned.replace(/\*/g, "");
    cleaned = cleaned.replace(/_/g, "");
    cleaned = cleaned.replace(/`/g, "");
    cleaned = cleaned.replace(/^[-â€¢â—â—‹â—†â—‡â– â–¡â–ªâ–«]\s*/gm, "");
    cleaned = cleaned.replace(/\s+/g, " ").trim();
    return cleaned;
  }
  // Text-to-speech
  speak(text, options = { skipHistory: false }) {
    const cleanedText = this.cleanTextForSpeech(text);
    if (!cleanedText) return;
    const utterance = new SpeechSynthesisUtterance(cleanedText);
    utterance.lang = "en-ZA";
    utterance.rate = options.rate || 1;
    utterance.pitch = options.pitch || 1;
    utterance.volume = options.volume || 1;
    if (!options.skipHistory) {
      this.conversationHistory.push({
        speaker: "assistant",
        text,
        // Store original with formatting
        timestamp: (/* @__PURE__ */ new Date()).toISOString()
      });
      window.dispatchEvent(new CustomEvent("colleco:voice-response", {
        detail: { text, timestamp: (/* @__PURE__ */ new Date()).toISOString() }
      }));
    }
    this.synthesis.speak(utterance);
    utterance.onend = () => {
      if (this.isListening) {
        setTimeout(() => {
          try {
            this.recognition.start();
          } catch (e) {
            this._log("log", "[VoiceAgent] Recognition already started");
          }
        }, 500);
      }
    };
  }
  // Process voice command
  async processCommand(transcript) {
    const intent = this.detectIntent(transcript);
    switch (intent.type) {
      case "BOOK_SHUTTLE":
        await this.handleShuttleBooking(intent, transcript);
        break;
      case "BOOK_ACCOMMODATION":
        await this.handleAccommodationBooking(intent, transcript);
        break;
      case "BOOK_FLIGHT":
        await this.handleFlightBooking(intent, transcript);
        break;
      case "CHECK_STATUS":
        await this.handleStatusCheck(intent, transcript);
        break;
      case "CANCEL_BOOKING":
        await this.handleCancellation(intent, transcript);
        break;
      case "GET_HELP":
        this.handleHelp();
        break;
      case "CONFIRM":
        await this.handleConfirmation();
        break;
      case "MODIFY":
        await this.handleModification(transcript);
        break;
      default:
        this.handleUnknownIntent(transcript);
    }
  }
  // Detect user intent using NLP
  detectIntent(transcript) {
    const lower = transcript.toLowerCase();
    if (this.matchesPattern(lower, ["shuttle", "transfer", "ride", "transport", "drive"])) {
      return {
        type: "BOOK_SHUTTLE",
        entities: this.extractShuttleEntities(transcript)
      };
    }
    if (this.matchesPattern(lower, ["hotel", "accommodation", "room", "stay", "lodge"])) {
      return {
        type: "BOOK_ACCOMMODATION",
        entities: this.extractAccommodationEntities(transcript)
      };
    }
    if (this.matchesPattern(lower, ["flight", "fly", "plane", "airline"])) {
      return {
        type: "BOOK_FLIGHT",
        entities: this.extractFlightEntities(transcript)
      };
    }
    if (this.matchesPattern(lower, ["status", "check", "where is", "what is"])) {
      return { type: "CHECK_STATUS" };
    }
    if (this.matchesPattern(lower, ["cancel", "delete", "remove"])) {
      return { type: "CANCEL_BOOKING" };
    }
    if (this.matchesPattern(lower, ["help", "what can you do", "how do"])) {
      return { type: "GET_HELP" };
    }
    if (this.matchesPattern(lower, ["yes", "correct", "confirm", "proceed", "continue", "okay", "sure"])) {
      return { type: "CONFIRM" };
    }
    if (this.matchesPattern(lower, ["change", "modify", "update", "different", "instead"])) {
      return { type: "MODIFY" };
    }
    return { type: "UNKNOWN" };
  }
  // Pattern matching helper
  matchesPattern(text, keywords) {
    return keywords.some((keyword) => text.includes(keyword));
  }
  // Extract shuttle booking entities
  extractShuttleEntities(transcript) {
    const entities = {
      from: null,
      to: null,
      date: null,
      time: null,
      passengers: 1,
      vehicleType: "sedan"
    };
    const fromToPattern = /from\s+([a-z\s]+?)\s+to\s+([a-z\s]+?)(?:\s+on|\s+at|$)/i;
    const match = transcript.match(fromToPattern);
    if (match) {
      entities.from = this.cleanLocation(match[1]);
      entities.to = this.cleanLocation(match[2]);
    }
    entities.date = this.extractDate(transcript);
    entities.time = this.extractTime(transcript);
    const passengersPattern = /(\d+)\s+(passenger|person|people)/i;
    const passengersMatch = transcript.match(passengersPattern);
    if (passengersMatch) {
      entities.passengers = parseInt(passengersMatch[1]);
    }
    if (transcript.includes("suv")) entities.vehicleType = "suv";
    else if (transcript.includes("van") || transcript.includes("minibus")) entities.vehicleType = "van";
    else if (transcript.includes("luxury")) entities.vehicleType = "luxury";
    return entities;
  }
  // Extract accommodation entities
  extractAccommodationEntities(transcript) {
    return {
      location: this.extractLocation(transcript),
      checkIn: this.extractDate(transcript),
      checkOut: this.extractCheckoutDate(transcript),
      guests: this.extractGuestCount(transcript),
      roomType: this.extractRoomType(transcript)
    };
  }
  // Extract flight entities
  extractFlightEntities(transcript) {
    return {
      from: this.extractDepartureCity(transcript),
      to: this.extractArrivalCity(transcript),
      date: this.extractDate(transcript),
      passengers: this.extractGuestCount(transcript),
      class: this.extractFlightClass(transcript)
    };
  }
  // Date extraction with natural language support
  extractDate(text) {
    const today = /* @__PURE__ */ new Date();
    if (text.includes("today")) {
      return today.toISOString().split("T")[0];
    }
    if (text.includes("tomorrow")) {
      const tomorrow = new Date(today);
      tomorrow.setDate(tomorrow.getDate() + 1);
      return tomorrow.toISOString().split("T")[0];
    }
    const datePatterns = [
      /(\d{1,2})\/(\d{1,2})\/(\d{4})/,
      // DD/MM/YYYY or MM/DD/YYYY
      /(\d{4})-(\d{2})-(\d{2})/,
      // YYYY-MM-DD
      /(january|february|march|april|may|june|july|august|september|october|november|december)\s+(\d{1,2})/i
    ];
    for (const pattern of datePatterns) {
      const match = text.match(pattern);
      if (match) {
        if (pattern.source.includes("january")) {
          const months = {
            january: 0,
            february: 1,
            march: 2,
            april: 3,
            may: 4,
            june: 5,
            july: 6,
            august: 7,
            september: 8,
            october: 9,
            november: 10,
            december: 11
          };
          const month = months[match[1].toLowerCase()];
          const day = parseInt(match[2]);
          const date = new Date(today.getFullYear(), month, day);
          return date.toISOString().split("T")[0];
        } else if (match[0].includes("-")) {
          return match[0];
        } else {
          const day = match[1];
          const month = match[2];
          const year = match[3];
          return `${year}-${month.padStart(2, "0")}-${day.padStart(2, "0")}`;
        }
      }
    }
    return null;
  }
  // Time extraction
  extractTime(text) {
    const timePatterns = [
      /(\d{1,2}):(\d{2})\s*(am|pm)?/i,
      /(\d{1,2})\s*(am|pm)/i
    ];
    for (const pattern of timePatterns) {
      const match = text.match(pattern);
      if (match) {
        let hours = parseInt(match[1]);
        const minutes = match[2] ? match[2] : "00";
        const meridiem = match[3] || match[2];
        if (meridiem && meridiem.toLowerCase() === "pm" && hours !== 12) {
          hours += 12;
        } else if (meridiem && meridiem.toLowerCase() === "am" && hours === 12) {
          hours = 0;
        }
        return `${String(hours).padStart(2, "0")}:${minutes}`;
      }
    }
    return null;
  }
  // Clean location name
  cleanLocation(location2) {
    return location2.trim().split(" ").map((word) => word.charAt(0).toUpperCase() + word.slice(1)).join(" ");
  }
  // Extract general location
  extractLocation(text) {
    const inPattern = /in\s+([a-z\s]+?)(?:\s+on|\s+from|$)/i;
    const match = text.match(inPattern);
    return match ? this.cleanLocation(match[1]) : null;
  }
  extractCheckoutDate(text) {
    const checkoutPattern = /checkout\s+on\s+([^,]+)/i;
    const match = text.match(checkoutPattern);
    return match ? this.extractDate(match[1]) : null;
  }
  extractGuestCount(text) {
    const guestPattern = /(\d+)\s+(guest|person|people|passenger)/i;
    const match = text.match(guestPattern);
    return match ? parseInt(match[1]) : 1;
  }
  extractRoomType(text) {
    if (text.includes("suite")) return "suite";
    if (text.includes("deluxe")) return "deluxe";
    if (text.includes("family")) return "family";
    return "standard";
  }
  extractDepartureCity(text) {
    const fromPattern = /from\s+([a-z\s]+?)\s+to/i;
    const match = text.match(fromPattern);
    return match ? this.cleanLocation(match[1]) : null;
  }
  extractArrivalCity(text) {
    const toPattern = /to\s+([a-z\s]+?)(?:\s+on|$)/i;
    const match = text.match(toPattern);
    return match ? this.cleanLocation(match[1]) : null;
  }
  extractFlightClass(text) {
    if (text.includes("business")) return "business";
    if (text.includes("first")) return "first";
    return "economy";
  }
  // Handle shuttle booking conversation
  async handleShuttleBooking(intent, _transcript) {
    const entities = intent.entities;
    if (!this.currentBooking.type) {
      this.currentBooking = {
        type: "shuttle",
        from: entities.from,
        to: entities.to,
        date: entities.date,
        time: entities.time,
        passengers: entities.passengers,
        vehicleType: entities.vehicleType,
        step: "collecting"
      };
    }
    const missing = this.getMissingFields();
    if (missing.length === 0) {
      await this.confirmShuttleBooking();
    } else {
      this.askForMissingInfo(missing[0]);
    }
  }
  // Get missing required fields
  getMissingFields() {
    const required = ["from", "to", "date", "time"];
    const missing = [];
    for (const field of required) {
      if (!this.currentBooking[field]) {
        missing.push(field);
      }
    }
    return missing;
  }
  // Ask for missing information
  askForMissingInfo(field) {
    const questions = {
      from: "Where would you like to be picked up from?",
      to: "And where are you heading to?",
      date: "What date would you like to travel? You can say today, tomorrow, or a specific date.",
      time: "What time would you like to be picked up?",
      passengers: "How many passengers will be traveling?",
      vehicleType: "What type of vehicle would you prefer? We have sedans, SUVs, vans, and luxury vehicles."
    };
    this.currentBooking.step = `waiting_for_${field}`;
    this.speak(questions[field]);
  }
  // Confirm shuttle booking
  async confirmShuttleBooking() {
    const { from, to, date, time, passengers, vehicleType } = this.currentBooking;
    const confirmation = `Great! Let me confirm your shuttle booking. 
      You want to travel from ${from} to ${to} on ${this.formatDate(date)} at ${time}.
      ${passengers > 1 ? `${passengers} passengers` : "1 passenger"}, using a ${vehicleType}.
      The estimated cost will be calculated shortly. Should I proceed with this booking?`;
    this.speak(confirmation);
    this.currentBooking.step = "awaiting_confirmation";
    try {
      const estimate = await this.getShuttleEstimate(this.currentBooking);
      this.currentBooking.estimate = estimate;
      setTimeout(() => {
        this.speak(`The estimated cost for this trip is ${this.formatCurrency(estimate.totalPrice)}. Would you like to confirm?`);
      }, 3e3);
    } catch (error) {
      this._log("error", "Failed to get estimate:", error);
    }
  }
  // Handle confirmation
  async handleConfirmation() {
    if (this.currentBooking.step === "awaiting_confirmation") {
      this.speak("Perfect! I'm processing your booking now. Please wait a moment.");
      try {
        const result = await this.submitShuttleBooking(this.currentBooking);
        this.speak(`Your booking has been confirmed! Your reference number is ${result.bookingRef}. 
          You'll receive a confirmation email shortly. Is there anything else I can help you with?`);
        this.resetConversation();
      } catch (error) {
        this.speak("I'm sorry, there was an issue processing your booking. Please try again or contact support.");
      }
    } else {
      this.speak("I'm not sure what you'd like me to confirm. Could you please clarify?");
    }
  }
  // Handle modification
  async handleModification(transcript) {
    if (!this.currentBooking.type) {
      this.speak("There's no active booking to modify. Would you like to make a new booking?");
      return;
    }
    if (transcript.includes("time")) {
      const newTime = this.extractTime(transcript);
      if (newTime) {
        this.currentBooking.time = newTime;
        this.speak(`Okay, I've changed the time to ${newTime}. Let me recalculate the estimate.`);
        await this.confirmShuttleBooking();
      } else {
        this.speak("What time would you like instead?");
      }
    } else if (transcript.includes("date")) {
      const newDate = this.extractDate(transcript);
      if (newDate) {
        this.currentBooking.date = newDate;
        this.speak(`Okay, I've changed the date to ${this.formatDate(newDate)}. Let me recalculate.`);
        await this.confirmShuttleBooking();
      } else {
        this.speak("What date would you prefer?");
      }
    } else {
      this.speak("What would you like to change? You can modify the time, date, pickup location, or destination.");
    }
  }
  // Handle help request
  handleHelp() {
    this.speak(`I can help you with:
      Booking shuttles and transfers between cities,
      Booking hotels and accommodation,
      Booking flights,
      Checking your booking status,
      Or canceling bookings.
      Just tell me what you'd like to do!`);
  }
  // Handle unknown intent
  handleUnknownIntent(_transcript) {
    this.speak("I didn't quite understand that. Could you please rephrase, or say 'help' to hear what I can do?");
  }
  // Handle status check
  async handleStatusCheck() {
    this.speak("To check your booking status, please provide your booking reference number.");
  }
  // Handle cancellation
  async handleCancellation() {
    this.speak("To cancel a booking, please provide your booking reference number.");
  }
  // Get shuttle price estimate
  async getShuttleEstimate(booking) {
    const response = await fetch("/api/transfers/estimate", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        pickup: booking.from,
        dropoff: booking.to,
        vehicleType: booking.vehicleType,
        pax: booking.passengers,
        luggage: booking.passengers,
        isRoundTrip: false,
        additionalStops: []
      })
    });
    return await response.json();
  }
  // Submit shuttle booking
  async submitShuttleBooking(booking) {
    const response = await fetch("/api/transfers/request", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        pickup: booking.from,
        dropoff: booking.to,
        pax: booking.passengers,
        vehicleType: booking.vehicleType,
        luggage: booking.passengers,
        bookingType: "instant",
        isRoundTrip: false,
        isMultiStop: false,
        additionalStops: [],
        scheduledDate: booking.date,
        scheduledTime: booking.time
      })
    });
    return await response.json();
  }
  // Format date for speech
  formatDate(dateString) {
    const date = new Date(dateString);
    const options = { weekday: "long", year: "numeric", month: "long", day: "numeric" };
    return date.toLocaleDateString("en-ZA", options);
  }
  // Format currency
  formatCurrency(amount) {
    return new Intl.NumberFormat("en-ZA", {
      style: "currency",
      currency: "ZAR",
      minimumFractionDigits: 0
    }).format(amount);
  }
  // Reset conversation
  resetConversation() {
    this.currentBooking = {};
    this.conversationContext = {};
  }
  // Get conversation history
  getConversationHistory() {
    return this.conversationHistory;
  }
  // Clear conversation history
  clearHistory() {
    this.conversationHistory = [];
  }
}
const voiceAgent = new VoiceBookingAgent();
function getZolaResponse(userMessage) {
  userMessage.toLowerCase();
  if (/^(hi|hello|hey|howdy|good morning|good afternoon|good evening|what's up|sup|sawubona|sanibonani)\b/i.test(userMessage)) {
    return "Hi I'm Zola, I'm here to assist you. What can I help you with today?";
  }
  if (/who are you|what are you|tell me about yourself|your name/i.test(userMessage)) {
    return "I'm Zola, your travel assistant. I help with flights, accommodation, transfers, safaris, tours, events, and packages throughout KZN and beyond. I specialize in the Durban area and know it well. What are you planning?";
  }
  if (/what (can you do|do you offer|services)|how (does this|can you help)|features|help me/i.test(userMessage)) {
    return "I can help with:\nâ€¢ Flights & accommodation\nâ€¢ Shuttles & transfers (Pick My Ride)\nâ€¢ Safari & tours\nâ€¢ Events & packages\nâ€¢ Travel advice & budgeting\n\nWhat specific service interests you?";
  }
  if (/where (should|can) (i|we) go|recommend (a )?destination|suggest (a )?place|best place/i.test(userMessage)) {
    if (/beach|coast|ocean|sea/i.test(userMessage)) {
      return "Top coastal spots:\nâ€¢ **Ballito** - family-friendly, tidal pools, safe\nâ€¢ **Umhlanga** - upscale, great dining & promenade\nâ€¢ **Salt Rock** - quiet, natural pools\nâ€¢ **South Coast** - budget-friendly, warm waters\nâ€¢ **Sodwana** - diving & snorkeling paradise\n\nWhat's your priority: family safety, romance, budget, or adventure?";
    }
    if (/safari|wildlife|game|animal/i.test(userMessage)) {
      return "Safari options:\nâ€¢ **Hluhluwe-iMfolozi** - Big Five, R320+ entry, May-Sep best\nâ€¢ **iSimangaliso** - hippos, crocs, boat safaris, turtle tours\nâ€¢ **Phinda Private** - luxury, intimate sightings\n\nWhat's your budget range?";
    }
    if (/mountain|hike|drakensberg|berg/i.test(userMessage)) {
      return "Drakensberg highlights:\nâ€¢ **Cathedral Peak** - varied trails, San rock art\nâ€¢ **Royal Natal** - Amphitheatre, Tugela Falls\nâ€¢ **Sani Pass** - 4x4 to Lesotho, highest pub in Africa\n\nWhat's your fitness level and main interest?";
    }
    return "What type of destination interests you?\nðŸ–ï¸ Beach & coast\nðŸ¦ Safari & wildlife\nâ›°ï¸ Mountains & hiking\nðŸŽ­ Culture & heritage\nðŸŒƒ City life\nðŸ· Food & wine\n\nWhich appeals to you?";
  }
  if (/how much|cost|price|budget|afford|cheap|expensive|what.*pay/i.test(userMessage)) {
    if (/durban|umhlanga|ballito/i.test(userMessage)) {
      return "Durban/KZN pricing (Nov 2025):\n**Accommodation/night:** Budget R650-1,200 | Mid R1,500-2,800 | Luxury R3,000+\n**Transfers:** Airportâ†’Durban R250-400 | â†’Umhlanga R180-300\n**Activities:** uShaka R195 | Safari R320+ | Cultural tour R450-850\n**Daily budget:** Backpacker R800-1,500 | Mid R2,500-4,500 | Luxury R6,000+\n\nWhat's your comfortable budget?";
    }
    return "General pricing:\n**Weekend (2 nights):** Budget R2,500-4,000pp | Mid R5,000-8,000pp | Luxury R12,000+pp\n**Week-long:** Beach R8,000-15,000pp | Safari R15,000-35,000pp | International R18,000-45,000pp\n\n**Save money:** Book 6-8 weeks ahead, travel midweek, use packages (15-25% savings), visit Apr-May or Sep-Oct.\n\nWhat's your budget range?";
  }
  if (/when (should|to|is best)|best time|season|weather|climate/i.test(userMessage)) {
    return "**Summer (Dec-Feb):** Hot, humid, beach perfect, avoid safaris\n**Autumn (Apr-May):** Best overall - mild, dry, great prices\n**Winter (Jun-Aug):** Best for safari, still warm ocean, crisp mornings\n**Spring (Sep-Nov):** Warming, wildflowers, whale watching\n\nWhen are you thinking of traveling?";
  }
  if (/shuttle|transfer|airport|pickup|transport|taxi|uber|ride/i.test(userMessage)) {
    return "Our **Pick My Ride** service:\nâ€¢ Verified drivers with ratings\nâ€¢ See vehicle type, price, reviews upfront\nâ€¢ GPS tracking & 24/7 support\nâ€¢ No hidden fees\n\n**Sample routes:** King Shakaâ†’Durban R250-400 | â†’Umhlanga R180-300 | â†’Ballito R350-550\n\nWhere do you need to go? (pickup, destination, date, passengers)";
  }
  if (/hotel|accommodation|stay|lodging|guesthouse|resort|where to stay|place to sleep/i.test(userMessage)) {
    return "To find your perfect stay, I need:\nðŸ“ Destination\nðŸ“… Check-in & check-out dates\nðŸ‘¥ Number of guests\nðŸ’° Budget per night\nâ­ Preferences (hotel, guesthouse, resort, self-catering, lodge)\n\nWhat are your details?";
  }
  if (/what to do|things to do|activities|fun|experience|adventure|bored/i.test(userMessage)) {
    return "Popular activities:\n**Water:** Surfing, snorkeling, whale watching, kayaking\n**Wildlife:** Game drives, boat safaris, turtle tours\n**Culture:** Zulu villages, craft markets, heritage tours\n**Adventure:** Hiking, ziplining, abseiling, mountain biking\n**Food:** Curry classes, Midlands Meander, bunny chow tours\n**Relax:** Spa, beach walks, botanical gardens\n\nWhat type of experience interests you?";
  }
  if (/package|deal|special|combo|all.?inclusive|value/i.test(userMessage)) {
    return "Package options:\n**Weekend (2-3 nights):** R2,800-5,500pp\n**Safari (3-4 nights):** R12,000-18,000pp\n**Beach+Safari combo:** R18,000-35,000pp\n**Family packages:** From R15,000 (family of 4)\n**International:** Mozambique R8,500+ | Mauritius R18,000+ | Zanzibar R15,000+\n\n**Packages save 15-25%** vs booking separately. Current special: 3+ nights = free airport transfer.\n\nWhat's your dream trip? Budget? Number of people?";
  }
  if (/event|concert|festival|show|exhibition|live music|performance/i.test(userMessage)) {
    return "We book events via Ticketmaster & partners:\nâ€¢ Music & concerts (local & international)\nâ€¢ Cultural festivals (Durban July, Poetry Africa)\nâ€¢ Sports (Sharks rugby, Comrades Marathon, Midmar Mile)\nâ€¢ Food & wine festivals\nâ€¢ Family events\n\nI can find events, book tickets, arrange transport, and create event+stay packages.\n\nWhat kind of events interest you? When are you visiting?";
  }
  if (/family|kids|children|baby|toddler|child/i.test(userMessage)) {
    return "Family-friendly options:\n**Destinations:** Ballito/Umhlanga (safe beaches, tidal pools) | uShaka Marine World | Wildlife (Croc World, Hluhluwe) | Midlands (farm activities)\n\n**Age tips:** 0-3: self-catering, beaches, short trips | 4-8: uShaka, farms, easy trails | 9-17: adventure sports, full safari\n\n**Pricing (family of 4):** Budget weekend R8,000-12,000 | Week R25,000-45,000 | Safari R40,000-80,000\n\nHow old are your children? Any special interests?";
  }
  if (/romantic|honeymoon|anniversary|couple|valentine|proposal|date|special occasion/i.test(userMessage)) {
    return "Romantic getaways:\n**Oyster Box (Umhlanga):** Lighthouse views, spa, R4,500-8,000/night\n**Mozambique:** Beach villas, private pools, dhow cruises\n**Drakensberg:** Mountain lodges, fireplaces, spa, privacy\n**Midlands:** Boutique hotels, wine tasting, farm dining\n\nSpecial touches: Proposals, room decorations, private dining, couples spa, photography.\n\n**Budget (3-4 nights for 2):** Beautiful R15,000-25,000 | Luxury R30,000-50,000 | Special R60,000+\n\nWhat's the occasion? Your style?";
  }
  if (/safe|safety|secure|dangerous|crime|worry|scared|tip|advice/i.test(userMessage)) {
    return "**Key safety tips:**\nâœ… Use our vetted transfers, never street taxis\nâœ… Umhlanga, Ballito, Durban beachfront are safe tourist areas\nâœ… Use cards, carry minimal cash (R500-1,000)\nâœ… Swim only at lifeguarded beaches\nâœ… Keep phone & bags secure in busy areas\nâŒ Avoid Durban CBD at night, walking alone after dark\n\n**Emergency:** 10177 or 112\n**Medical:** Excellent private hospitals everywhere\n**Malaria:** Low risk (far north summer only)\n\nWhere will you be staying? I'll give specific local advice.";
  }
  if (/voice|speak|talk|microphone|mic|listen/i.test(userMessage)) {
    return "Yes! Click the microphone (top right) and speak naturally. I understand locations, dates, times, numbers, and even isiZulu greetings. Microphone turns orange when ready, red when listening. Much faster than typing!";
  }
  if (/thank|thanks|appreciate|grateful|helpful|great|awesome|perfect|love (it|this|you)|you're (the best|amazing|great)/i.test(userMessage)) {
    return "You're welcome! What else can I help you with?";
  }
  if (/durban|dbn|ethekwini/i.test(userMessage) && !/transfer|shuttle|airport/i.test(userMessage)) {
    return "**Durban highlights:**\nðŸ–ï¸ Golden Mile - 6km beachfront promenade\nðŸ›ï¸ Moses Mabhida Stadium - SkyCar, Big Swing, views\nðŸ¦ˆ uShaka Marine World - aquarium & water park, R195\nðŸ› Bunny chow - iconic curry dish (try Goundens)\nðŸŒº Botanic Gardens - Africa's oldest, free entry\nðŸŽ­ Florida Road - restaurants & nightlife\n\n**Day trips:** Valley of 1000 Hills, Umhlanga, Ballito, Shakaland\n\n**Best beaches:** North Beach, Bay of Plenty (lifeguards)\n\nWhat specifically interests you about Durban?";
  }
  if (/problem|issue|complaint|wrong|bad|terrible|awful|disappointed|unhappy|cancel/i.test(userMessage)) {
    return "I'm sorry something's wrong. Please tell me exactly what happened - I'm here to fix this, not defend it. What's the issue?";
  }
  if (/wheelchair|disabled|disability|accessible|accessibility|special needs|mobility/i.test(userMessage)) {
    return "Accessibility services:\nâœ… Moses Mabhida, uShaka, Gateway, modern hotels, Umhlanga promenade - all accessible\nâœ… Wheelchair-accessible vehicles (must pre-book)\nâœ… Some safari lodges have accessible rooms & vehicles\n\nI'll personally verify accessibility before confirming anything.\n\nWhat's your mobility level and specific requirements?";
  }
  return "What can I help you with? (destination, dates, budget, activities, accommodation, transfers, etc.)";
}
function AIAgent() {
  const [open, setOpen] = reactExports.useState(false);
  const [role, setRole] = reactExports.useState(null);
  const [messages, setMessages] = reactExports.useState([
    { from: "system", text: "Hi I'm Zola, I'm here to assist you. What can I help you with today?" }
  ]);
  const [progress, setProgress] = reactExports.useState({ badge: "Bronze", readiness: 40 });
  const [isListening, setIsListening] = reactExports.useState(false);
  const dragScopeRef = reactExports.useRef(null);
  const messagesRef = reactExports.useRef(null);
  reactExports.useEffect(() => {
    const handleOpenAIAgent = () => {
      setOpen(true);
    };
    window.addEventListener("openAIAgent", handleOpenAIAgent);
    return () => {
      window.removeEventListener("openAIAgent", handleOpenAIAgent);
    };
  }, []);
  reactExports.useEffect(() => {
    const handleVoiceResponse = (event) => {
      setMessages((prev) => [...prev, {
        from: "system",
        text: event.detail.text
      }]);
    };
    window.addEventListener("colleco:voice-response", handleVoiceResponse);
    return () => {
      window.removeEventListener("colleco:voice-response", handleVoiceResponse);
    };
  }, []);
  const toggleVoice = () => {
    if (isListening) {
      voiceAgent.stopListening();
      setIsListening(false);
    } else {
      const started = voiceAgent.startListening();
      if (started) {
        setIsListening(true);
        if (!open) setOpen(true);
        voiceAgent.onTranscript = (text) => {
          setMessages((m) => [...m, { from: "user", text }]);
          setTimeout(() => {
            const reply = getZolaResponse(text);
            setMessages((m) => [...m, { from: "agent", text: reply }]);
            voiceAgent.speak(reply, { skipHistory: true });
          }, 300);
        };
      }
    }
  };
  const handleDragEnd = (event, info) => {
    if (typeof window === "undefined") return;
    const isMobile = window.innerWidth < 640;
    if (!isMobile) return;
    const safeZone = 96;
    const viewportHeight = window.innerHeight;
    const elementBottom = viewportHeight - (info.point.y + 64);
    if (elementBottom < safeZone) {
      event.target.style.transform = "";
    }
  };
  const send = (text) => {
    setMessages((m) => [...m, { from: "user", text }]);
    setTimeout(() => {
      const reply = getZolaResponse(text);
      setMessages((m) => [...m, { from: "agent", text: reply }]);
    }, 600);
  };
  reactExports.useEffect(() => {
    if (messagesRef.current) {
      messagesRef.current.scrollTop = messagesRef.current.scrollHeight;
    }
  }, [messages]);
  return /* @__PURE__ */ jsxRuntimeExports.jsx("div", { ref: dragScopeRef, className: "fixed inset-0 z-toast pointer-events-none", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
    motion.div,
    {
      className: "absolute right-4 sm:right-6 bottom-24 sm:bottom-16 lg:bottom-6 pointer-events-auto",
      initial: { opacity: 0, y: 30 },
      animate: { opacity: 1, y: 0 },
      transition: { duration: 0.5 },
      drag: true,
      dragElastic: 0.2,
      dragMomentum: false,
      dragConstraints: dragScopeRef,
      onDragEnd: handleDragEnd,
      children: open ? /* @__PURE__ */ jsxRuntimeExports.jsxs(motion.div, { className: "w-80 bg-surface rounded-2xl shadow-2xl border border-cream-border/80 overflow-hidden", initial: { scale: 0.98 }, animate: { scale: 1 }, children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-3 bg-white px-4 py-2.5 font-bold border-b border-cream-border", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "relative flex h-9 w-9 items-center justify-center rounded-full bg-brand-orange/10", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsx("img", { src: logo, alt: "CollEco", className: "h-6 w-6" }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "absolute -left-3 top-0 h-full w-1 bg-brand-orange rounded-full", "aria-hidden": true })
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-brand-russty", children: "Zola Â· AI Concierge" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx(
            "button",
            {
              onClick: toggleVoice,
              className: `rounded-full px-2 py-1 text-sm font-semibold transition-colors ${isListening ? "bg-red-500 text-white hover:bg-red-600 animate-pulse" : "bg-brand-orange text-white hover:bg-orange-600"}`,
              "aria-label": isListening ? "Stop listening" : "Start voice input",
              title: isListening ? "Stop voice" : "Voice input",
              children: isListening ? /* @__PURE__ */ jsxRuntimeExports.jsx(MicOff, { className: "h-4 w-4" }) : /* @__PURE__ */ jsxRuntimeExports.jsx(Mic, { className: "h-4 w-4" })
            }
          ),
          /* @__PURE__ */ jsxRuntimeExports.jsx("button", { onClick: () => setOpen(false), className: "rounded-full bg-brand-orange text-white px-2 py-1 text-sm font-semibold hover:bg-brand-brown", "aria-label": "Close chat", children: "âœ•" })
        ] }),
        role === "client" && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center gap-2 px-4 pt-2 pb-1", children: [
          /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-xs bg-brand-highlight/20 text-brand-brown rounded px-2 py-0.5 font-bold", children: [
            progress.badge,
            " Badge"
          ] }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "flex-1 h-2 bg-cream-border rounded-full overflow-hidden", children: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "bg-brand-orange h-2", style: { width: `${progress.readiness}%` } }) }),
          /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-xs text-brand-brown/70", children: [
            progress.readiness,
            "% ready"
          ] })
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { ref: messagesRef, className: "p-4 h-48 overflow-y-auto text-sm", style: { fontFamily: "Inter, sans-serif" }, children: messages.map((m, i) => /* @__PURE__ */ jsxRuntimeExports.jsx(
          "div",
          {
            className: `mb-2 inline-block max-w-[90%] rounded-lg px-2 py-1 ${m.from === "agent" ? "bg-white text-brand-russty border border-amber-100" : m.from === "user" ? "bg-cream-sand text-brand-russty" : "bg-transparent text-brand-orange font-semibold"} ${m.from === "user" ? "text-right" : ""}`,
            children: m.text
          },
          i
        )) }),
        /* @__PURE__ */ jsxRuntimeExports.jsx(AIAgentInput, { onSend: send })
      ] }) : /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col items-center gap-1", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs(
          motion.button,
          {
            whileHover: { scale: 1.05 },
            whileTap: { scale: 0.95 },
            onClick: () => setOpen(true),
            className: "relative flex h-16 w-16 items-center justify-center rounded-full border border-white/70 bg-white/90 shadow-2xl shadow-brand-brown/25 backdrop-blur",
            "aria-label": "Open Zola AI chat",
            title: "Chat with Zola",
            children: [
              /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "absolute inset-0 rounded-full bg-gradient-to-br from-brand-orange/40 via-transparent to-brand-brown/40 blur-xl", "aria-hidden": true }),
              /* @__PURE__ */ jsxRuntimeExports.jsx("img", { src: logo, alt: "Zola", className: "relative h-8 w-8 object-contain" })
            ]
          }
        ),
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-xs font-semibold text-brand-brown bg-white/90 px-2 py-0.5 rounded-full shadow-sm", children: "Zola" })
      ] })
    }
  ) });
}
function AIAgentInput({ onSend }) {
  const [v, setV] = reactExports.useState("");
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex gap-2 border-t border-cream-border p-2 bg-white rounded-b-xl", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "input",
      {
        value: v,
        onChange: (e) => setV(e.target.value),
        className: "border border-cream-border rounded px-2 py-1 flex-1 bg-white text-brand-russty placeholder-brand-brown/50",
        placeholder: "Ask me anything... (e.g., Plan a 5-day Cape Town trip)",
        onKeyDown: (e) => e.key === "Enter" && v.trim() && (onSend(v), setV("")),
        "aria-label": "Type your message"
      }
    ),
    /* @__PURE__ */ jsxRuntimeExports.jsx(
      "button",
      {
        onClick: () => {
          if (v.trim()) {
            onSend(v);
            setV("");
          }
        },
        className: "bg-brand-orange text-white px-3 py-1 rounded hover:bg-brand-brown",
        "aria-label": "Send message",
        children: "Send"
      }
    )
  ] });
}
const __vite_import_meta_env__$1 = { "BASE_URL": "/", "DEV": false, "MODE": "production", "PROD": true, "SSR": false };
function RootLayout() {
  const hasBackend = typeof import.meta !== "undefined" && __vite_import_meta_env__$1 && false;
  const [showBackTop, setShowBackTop] = reactExports.useState(false);
  const [apiOk, setApiOk] = reactExports.useState(true);
  const [offline, setOffline] = reactExports.useState(false);
  const [lastPingMs, setLastPingMs] = reactExports.useState(0);
  const [toastDraft, setToastDraft] = reactExports.useState(false);
  reactExports.useEffect(() => {
    const onDraftPricing = () => {
      setToastDraft(true);
      const t = setTimeout(() => setToastDraft(false), 12e3);
      return () => clearTimeout(t);
    };
    window.addEventListener("colleco:draftPricing", onDraftPricing);
    return () => window.removeEventListener("colleco:draftPricing", onDraftPricing);
  }, []);
  reactExports.useEffect(() => {
    const onScroll = () => {
      setShowBackTop(window.scrollY > 300);
    };
    onScroll();
    window.addEventListener("scroll", onScroll, { passive: true });
    return () => window.removeEventListener("scroll", onScroll);
  }, []);
  reactExports.useEffect(() => {
    let timer;
    const ping = async () => {
      performance.now();
      const on = navigator.onLine;
      setOffline(!on);
      {
        setLastPingMs(0);
        setApiOk(true);
      }
      timer = setTimeout(ping, 8e3);
    };
    ping();
    return () => {
      if (timer) clearTimeout(timer);
    };
  }, [hasBackend]);
  const scrollToTop = () => {
    const prefersReduced = typeof window !== "undefined" && window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches || false;
    if (typeof window !== "undefined" && typeof window.scrollTo === "function") {
      window.scrollTo({ top: 0, behavior: prefersReduced ? "auto" : "smooth" });
    }
  };
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "min-h-screen bg-cream overflow-x-hidden", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(AutoFocus, {}),
    false,
    /* @__PURE__ */ jsxRuntimeExports.jsx("a", { href: "#main-content", className: "sr-only focus:not-sr-only fixed top-2 left-2 z-[60] px-3 py-2 bg-white border border-cream-border shadow text-brand-brown rounded", children: "Skip to content" }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(Navbar, {}),
    /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "pb-24", style: { paddingTop: "calc(var(--header-h) + var(--banner-h))" }, children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-row-reverse", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(Sidebar, {}),
      /* @__PURE__ */ jsxRuntimeExports.jsx("main", { id: "main-content", className: "flex-1 min-w-0 focus:outline-none focus:ring-0 overflow-x-hidden", tabIndex: "-1", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("section", { className: "px-3 sm:px-6 py-6", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx(Breadcrumbs, {}),
        /* @__PURE__ */ jsxRuntimeExports.jsx(Outlet, {})
      ] }) })
    ] }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("footer", { className: "hidden sm:block fixed bottom-0 left-0 right-0 bg-brand-brown text-white text-center py-4 text-sm border-t border-cream-border font-semibold tracking-wide z-40", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex flex-col items-center gap-1", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: "Â© 2025 CollEco Travel â€” All rights reserved." }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "flex items-center gap-2 text-white text-sm font-normal", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "inline-flex h-5 w-5 rounded-full overflow-hidden mr-1 align-text-bottom ring-[0.5px] ring-white/40 shrink-0 bg-white/10", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("picture", { children: [
          /* @__PURE__ */ jsxRuntimeExports.jsx("source", { srcSet: "/assets/Globeicon-64.webp", type: "image/webp" }),
          /* @__PURE__ */ jsxRuntimeExports.jsx("img", { src: "/assets/Globeicon.png", alt: "CollEco globe", className: "w-full h-full object-cover", width: "20", height: "20", loading: "lazy", decoding: "async" })
        ] }) }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("a", { href: "https://www.travelcolleco.com", target: "_blank", rel: "noopener noreferrer", className: "underline hover:text-brand-gold transition", children: "www.travelcolleco.com" })
      ] })
    ] }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(AIAgent, {}),
    /* @__PURE__ */ jsxRuntimeExports.jsx(MobileNav, {}),
    showBackTop && /* @__PURE__ */ jsxRuntimeExports.jsx(
      "button",
      {
        type: "button",
        onClick: scrollToTop,
        className: "hidden sm:inline-flex fixed bottom-[calc(var(--footer-h)+0.5rem)] right-4 z-50 px-3 py-2 rounded-full bg-brand-brown text-white shadow-lg border border-cream-border text-sm hover:bg-brand-brown/90 focus:outline-none focus:ring-2 focus:ring-brand-brown/40 focus:ring-offset-2 focus:ring-offset-cream",
        "aria-label": "Back to top",
        children: "â†‘ Top"
      }
    ),
    toastDraft && /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "fixed bottom-[calc(var(--footer-h)+4.5rem)] right-4 z-[95] bg-white border border-brand-orange/30 shadow-lg rounded-md px-4 py-3 w-64 animate-fade-in", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-sm font-semibold text-brand-brown mb-1 flex items-center gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "text-brand-orange", children: "âœ¨" }),
        " Draft Ready"
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-[11px] text-brand-brown/70 mb-3", children: "Pricing phase received. Import or refine itinerary now." }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("a", { href: "/itinerary", className: "flex-1 text-center px-2 py-1 rounded bg-brand-orange text-white text-xs font-semibold hover:bg-brand-highlight", children: "Import" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("a", { href: "/plan-trip", className: "flex-1 text-center px-2 py-1 rounded border border-brand-brown text-brand-brown text-xs font-semibold hover:bg-cream-hover", children: "Planner" })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("button", { onClick: () => setToastDraft(false), className: "absolute top-1 right-1 text-[10px] text-brand-brown/60 hover:text-brand-brown", children: "âœ•" })
    ] })
  ] });
}
const pageTemplate = { "meta": { "title": "Page Title", "description": "Short description of what the page does", "role": "admin", "requiresAuth": true, "showInSidebar": true, "featureFlag": null }, "layout": { "header": { "showBreadcrumbs": true, "breadcrumbs": [{ "label": "Dashboard", "path": "/dashboard" }, { "label": "Current Page", "path": "/current" }], "showActionBar": true, "actionButtons": [{ "label": "New", "icon": "PlusCircle", "actionType": "modal", "target": "/create" }, { "label": "Export", "icon": "Download", "actionType": "export", "target": "pdf" }] }, "main": { "sections": [{ "id": "overview-section", "title": "Overview", "component": "InfoCard", "dataSource": "api/endpoint", "layout": "grid", "columns": 3, "contentStyle": "card", "theme": { "background": "white", "border": "sand", "textColor": "brandBrown" } }, { "id": "details-section", "title": "Detailed View", "component": "DataTable", "dataSource": "api/endpoint", "sortable": true, "filterable": true, "pagination": true }, { "id": "insights-section", "title": "Insights or Summary", "component": "ChartCard", "chartType": "bar", "dataSource": "api/metrics", "visibleRoles": ["admin", "partner", "finance"] }] }, "sidebarTools": { "collapsible": true, "tools": [{ "label": "Help Guide", "icon": "BookOpen", "actionType": "open", "target": "/support/knowledge-base" }, { "label": "Chat Support", "icon": "MessageCircle", "actionType": "chat", "target": "support-channel" }, { "label": "Feedback", "icon": "MessageSquare", "actionType": "modal", "target": "/feedback" }] }, "footer": { "show": true, "content": "Â© CollEco Travel â€“ The Odyssey of Adventure", "links": [{ "label": "Privacy Policy", "path": "/legal/privacy" }, { "label": "Terms", "path": "/legal/terms" }] } }, "theme": { "background": "cream", "primaryText": "brandBrown", "accent": "brandOrange", "border": "sand", "card": "white", "fontFamily": "Inter, sans-serif", "headingStyle": "bold", "taglineStyle": "italic" }, "accessibility": { "contrastMode": "auto", "keyboardNavigation": true, "screenReaderSupport": true, "focusHighlight": true } };
const examples = { "partnerFinance": { "extends": "pageTemplate", "meta": { "title": "Earnings & Payouts", "description": "Track partner earnings, payouts, and transaction history", "role": "partner" }, "layout": { "header": { "breadcrumbs": [{ "label": "Partner Dashboard", "path": "/partner/dashboard" }, { "label": "Earnings & Payouts", "path": "/partner/finance" }], "actionButtons": [{ "label": "Request Payout", "icon": "Wallet", "actionType": "modal", "target": "/partner/finance/request" }, { "label": "Export", "icon": "Download", "actionType": "export", "target": "xlsx" }] }, "main": { "sections": [{ "id": "earnings-overview", "title": "Earnings Summary", "component": "InfoCard", "dataSource": "api/partner/earnings" }, { "id": "payout-history", "title": "Payout History", "component": "DataTable", "dataSource": "api/partner/payouts" }, { "id": "finance-insights", "title": "Financial Insights", "component": "ChartCard", "chartType": "line", "dataSource": "api/partner/finance-insights" }] } } } };
const pageTemplateConfig = {
  pageTemplate,
  examples
};
const DEFAULT_TEMPLATE_KEY = "pageTemplate";
const RAW_TEMPLATES = {
  [DEFAULT_TEMPLATE_KEY]: pageTemplateConfig.pageTemplate,
  ...pageTemplateConfig.examples || {}
};
function isPlainObject(value) {
  return typeof value === "object" && value !== null && !Array.isArray(value);
}
function clone(value) {
  if (value === void 0 || value === null) {
    return value;
  }
  if (typeof value !== "object") {
    return value;
  }
  if (typeof structuredClone === "function") {
    try {
      return structuredClone(value);
    } catch (error) {
    }
  }
  return JSON.parse(JSON.stringify(value));
}
function deepMerge(baseValue, overrideValue) {
  if (overrideValue === void 0) {
    return clone(baseValue);
  }
  if (baseValue === void 0) {
    return clone(overrideValue);
  }
  if (Array.isArray(overrideValue)) {
    return overrideValue.map((item) => clone(item));
  }
  if (Array.isArray(baseValue)) {
    return clone(overrideValue);
  }
  if (isPlainObject(baseValue) && isPlainObject(overrideValue)) {
    const result = clone(baseValue) || {};
    Object.keys(overrideValue).forEach((key) => {
      const value = overrideValue[key];
      if (value === void 0) return;
      result[key] = deepMerge(baseValue[key], value);
    });
    return result;
  }
  return clone(overrideValue);
}
function resolveTemplateDefinition(definition) {
  if (!definition) {
    return clone(RAW_TEMPLATES[DEFAULT_TEMPLATE_KEY]);
  }
  if (typeof definition === "string") {
    const referenced = RAW_TEMPLATES[definition];
    if (!referenced) {
      throw new Error(`[template] Unknown template reference: ${definition}`);
    }
    return resolveTemplateDefinition(referenced);
  }
  if (Array.isArray(definition)) {
    throw new Error("[template] Array definitions are not supported for templates.");
  }
  if (isPlainObject(definition)) {
    const workingCopy = clone(definition);
    if (workingCopy.extends) {
      const base = resolveTemplateDefinition(workingCopy.extends);
      delete workingCopy.extends;
      return deepMerge(base, workingCopy);
    }
    return workingCopy;
  }
  throw new Error(`[template] Unsupported template definition: ${String(definition)}`);
}
function resolveTemplate(definition, overrides) {
  const template = resolveTemplateDefinition(definition);
  if (overrides) {
    return deepMerge(template, overrides);
  }
  return template;
}
function resolveTemplateForRoute(route) {
  if (!route) return resolveTemplate();
  const metaOverrides = route.meta ? { meta: route.meta } : void 0;
  return resolveTemplate(route.template, metaOverrides);
}
const PUBLIC_SITE_URL = "https://www.travelcolleco.com";
const CONTACT_EMAIL = "collecotravel@gmail.com";
const API_BASE_URL = "http://localhost:4000";
reactExports.createContext();
class PushNotificationService {
  static async requestPermission() {
    if (!("Notification" in window)) {
      return false;
    }
    if (Notification.permission === "granted") {
      return true;
    }
    if (Notification.permission !== "denied") {
      const permission = await Notification.requestPermission();
      return permission === "granted";
    }
    return false;
  }
  /**
   * Check if device is mobile
   */
  static isMobileDevice() {
    return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
  }
  /**
   * Check if app is installed as PWA
   */
  static isInstalledPWA() {
    return window.matchMedia("(display-mode: standalone)").matches || window.navigator.standalone === true || document.referrer.includes("android-app://");
  }
  /**
   * Send push notification with mobile optimization
   */
  static async sendPushNotification(title, options = {}) {
    const hasPermission = await this.requestPermission();
    if (!hasPermission) {
      return null;
    }
    if (!("serviceWorker" in navigator)) {
      return null;
    }
    const registration = await navigator.serviceWorker.ready;
    const defaultOptions = {
      icon: "/assets/icons/colleco-logo-192.png",
      badge: "/assets/icons/colleco-logo-72.png",
      vibrate: [200, 100, 200],
      // Default vibration pattern
      requireInteraction: false,
      silent: false,
      tag: "colleco-notification",
      renotify: true,
      timestamp: Date.now(),
      ...options
    };
    const vibrationPatterns = {
      message: [200, 100, 200],
      booking: [300, 100, 300, 100, 300],
      payment: [500, 200, 500],
      alert: [100, 50, 100, 50, 100, 50, 100],
      system: [200]
    };
    if (options.type && vibrationPatterns[options.type]) {
      defaultOptions.vibrate = vibrationPatterns[options.type];
    }
    if (options.type === "message" && !defaultOptions.actions) {
      defaultOptions.actions = [
        { action: "reply", title: "ðŸ’¬ Reply" },
        { action: "view", title: "ðŸ‘ï¸ View" }
      ];
    } else if (options.type === "booking" && !defaultOptions.actions) {
      defaultOptions.actions = [
        { action: "view", title: "ðŸ“‹ View Booking" },
        { action: "dismiss", title: "âœ“ OK" }
      ];
    } else if (options.type === "quote" && !defaultOptions.actions) {
      defaultOptions.actions = [
        { action: "view", title: "ðŸ“„ View Quote" },
        { action: "dismiss", title: "âœ“ OK" }
      ];
    }
    if ("setAppBadge" in navigator) {
      try {
        await navigator.setAppBadge(options.unreadCount || 1);
      } catch (e) {
      }
    }
    try {
      await registration.showNotification(title, defaultOptions);
      return { success: true, title, options: defaultOptions };
    } catch (error) {
      return { success: false, error: error.message };
    }
  }
  /**
   * Clear app badge (called when notifications are read)
   */
  static async clearBadge() {
    if ("clearAppBadge" in navigator) {
      try {
        await navigator.clearAppBadge();
      } catch (e) {
      }
    }
  }
  /**
   * Update app badge count
   */
  static async updateBadge(count) {
    if ("setAppBadge" in navigator) {
      try {
        if (count > 0) {
          await navigator.setAppBadge(count);
        } else {
          await navigator.clearAppBadge();
        }
      } catch (e) {
      }
    }
  }
  /**
   * Subscribe to push notifications (requires backend)
   */
  static async subscribeToNotifications(userId) {
    const registration = await navigator.serviceWorker.ready;
    let subscription = await registration.pushManager.getSubscription();
    if (!subscription) {
      const vapidPublicKey = "BEl62iUYgUivxIkv69yViEuiBIa-Ib37gp2ENSg1CYQ2vUJ6_4L7pj_b9O8z6rKrC2xkx-z7xXOsqJQSk4JC_2Y";
      subscription = await registration.pushManager.subscribe({
        userVisibleOnly: true,
        applicationServerKey: this.urlBase64ToUint8Array(vapidPublicKey)
      });
    }
    await fetch(`${API_BASE_URL}/api/notifications/subscribe`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${localStorage.getItem("token")}`
      },
      body: JSON.stringify({
        userId,
        subscription,
        deviceType: this.isMobileDevice() ? "mobile" : "desktop",
        isPWA: this.isInstalledPWA()
      })
    });
    return subscription;
  }
  /**
   * Unsubscribe from push notifications
   */
  static async unsubscribeFromNotifications(userId) {
    const registration = await navigator.serviceWorker.ready;
    const subscription = await registration.pushManager.getSubscription();
    if (subscription) {
      await subscription.unsubscribe();
      await fetch(`${API_BASE_URL}/api/notifications/unsubscribe`, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${localStorage.getItem("token")}`
        },
        body: JSON.stringify({
          userId,
          endpoint: subscription.endpoint
        })
      });
    }
  }
  /**
   * Helper: Convert VAPID key to Uint8Array
   */
  static urlBase64ToUint8Array(base64String) {
    const padding = "=".repeat((4 - base64String.length % 4) % 4);
    const base64 = (base64String + padding).replace(/-/g, "+").replace(/_/g, "/");
    const rawData = window.atob(base64);
    const outputArray = new Uint8Array(rawData.length);
    for (let i = 0; i < rawData.length; ++i) {
      outputArray[i] = rawData.charCodeAt(i);
    }
    return outputArray;
  }
  /**
   * Test notification (for setup verification)
   */
  static async sendTestNotification() {
    return await this.sendPushNotification("CollEco Test", {
      body: "Push notifications are working! ðŸŽ‰",
      type: "system",
      icon: "/assets/icons/colleco-logo-192.png",
      badge: "/assets/icons/colleco-logo-72.png",
      vibrate: [200, 100, 200],
      tag: "test-notification",
      requireInteraction: false
    });
  }
  /**
   * Prompt user to install PWA (for mobile notifications)
   */
  static async promptInstallPWA() {
    if (window.deferredPrompt) {
      window.deferredPrompt.prompt();
      const { outcome: _outcome } = await window.deferredPrompt.userChoice;
      window.deferredPrompt = null;
    }
  }
}
const OnboardingPermissions = ({ onComplete }) => {
  const { user } = reactExports.useContext(UserContext);
  const [currentStep, setCurrentStep] = reactExports.useState(0);
  const [permissions, setPermissions] = reactExports.useState({
    location: "prompt",
    // 'prompt', 'granted', 'denied'
    notifications: "prompt",
    camera: "prompt",
    storage: "granted"
    // Always available in browsers
  });
  const [skipped, setSkipped] = reactExports.useState([]);
  const [loading, setLoading] = reactExports.useState(false);
  const checkExistingPermissions = reactExports.useCallback(async () => {
    const newPermissions = { ...permissions };
    if ("Notification" in window) newPermissions.notifications = Notification.permission;
    if ("permissions" in navigator) {
      try {
        const locationPerm = await navigator.permissions.query({ name: "geolocation" });
        newPermissions.location = locationPerm.state;
      } catch (e) {
      }
    }
    setPermissions(newPermissions);
  }, [permissions]);
  reactExports.useEffect(() => {
    checkExistingPermissions();
  }, [checkExistingPermissions]);
  const requestLocationPermission = async () => {
    setLoading(true);
    try {
      const position = await new Promise((resolve, reject) => {
        navigator.geolocation.getCurrentPosition(resolve, reject, {
          timeout: 1e4,
          enableHighAccuracy: false
        });
      });
      localStorage.setItem("colleco.location", JSON.stringify({
        latitude: position.coords.latitude,
        longitude: position.coords.longitude,
        timestamp: Date.now()
      }));
      setPermissions((prev) => ({ ...prev, location: "granted" }));
      setCurrentStep(1);
    } catch (error) {
      console.error("Location permission denied:", error);
      setPermissions((prev) => ({ ...prev, location: "denied" }));
      setSkipped((prev) => [...prev, "location"]);
      setCurrentStep(1);
    } finally {
      setLoading(false);
    }
  };
  const requestNotificationPermission = async () => {
    setLoading(true);
    try {
      const granted = await PushNotificationService.requestPermission();
      if (granted && user?.id) {
        await PushNotificationService.subscribeToNotifications(user.id);
        setPermissions((prev) => ({ ...prev, notifications: "granted" }));
        await PushNotificationService.sendTestNotification();
      } else {
        setPermissions((prev) => ({ ...prev, notifications: "denied" }));
        setSkipped((prev) => [...prev, "notifications"]);
      }
      setCurrentStep(2);
    } catch (error) {
      console.error("Notification permission error:", error);
      setPermissions((prev) => ({ ...prev, notifications: "denied" }));
      setSkipped((prev) => [...prev, "notifications"]);
      setCurrentStep(2);
    } finally {
      setLoading(false);
    }
  };
  const requestCameraPermission = async () => {
    setLoading(true);
    try {
      const stream = await navigator.mediaDevices.getUserMedia({
        video: true,
        audio: false
      });
      stream.getTracks().forEach((track) => track.stop());
      setPermissions((prev) => ({ ...prev, camera: "granted" }));
      setCurrentStep(3);
    } catch (error) {
      console.error("Camera permission denied:", error);
      setPermissions((prev) => ({ ...prev, camera: "denied" }));
      setSkipped((prev) => [...prev, "camera"]);
      setCurrentStep(3);
    } finally {
      setLoading(false);
    }
  };
  const handleSkip = () => {
    const permissionTypes = ["location", "notifications", "camera"];
    setSkipped((prev) => [...prev, permissionTypes[currentStep]]);
    setCurrentStep(currentStep + 1);
  };
  const handleComplete = () => {
    localStorage.setItem("colleco.onboarding.completed", "true");
    localStorage.setItem("colleco.onboarding.permissions", JSON.stringify(permissions));
    localStorage.setItem("colleco.onboarding.skipped", JSON.stringify(skipped));
    if (onComplete) {
      onComplete(permissions, skipped);
    }
  };
  const steps = [
    {
      id: "location",
      icon: "ðŸ“",
      title: "Enable Location Access",
      description: "Get personalized travel recommendations based on your location",
      benefits: [
        "ðŸ—ºï¸ Find nearby experiences and attractions",
        "ðŸŒ¤ï¸ Local weather updates for your trips",
        "ðŸš— Accurate directions and navigation",
        "âœˆï¸ Airport proximity and flight updates"
      ],
      action: requestLocationPermission,
      buttonText: "Enable Location",
      required: false
    },
    {
      id: "notifications",
      icon: "ðŸ””",
      title: "Enable Push Notifications",
      description: "Never miss booking confirmations, payments, or important updates",
      benefits: [
        "ðŸ“‹ Instant booking confirmations",
        "ðŸ’° Payment alerts and receipts",
        "ðŸ’¬ Messages from partners and clients",
        "âš ï¸ Flight delays and travel alerts"
      ],
      action: requestNotificationPermission,
      buttonText: "Enable Notifications",
      required: false
    },
    {
      id: "camera",
      icon: "ðŸ“·",
      title: "Allow Camera Access",
      description: "Quickly upload profile photos, documents, and check-in selfies",
      benefits: [
        "ðŸ‘¤ Take profile photos instantly",
        "ðŸ“„ Scan and upload travel documents",
        "âœ… Self check-in with photo verification",
        "ðŸ“¸ Capture memorable travel moments"
      ],
      action: requestCameraPermission,
      buttonText: "Allow Camera",
      required: false
    }
  ];
  const currentStepData = steps[currentStep];
  if (currentStep >= steps.length) {
    return /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white rounded-2xl max-w-md w-full p-8 text-center", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-6xl mb-4", children: "ðŸŽ‰" }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("h2", { className: "text-2xl font-bold text-gray-900 mb-2", children: "You're All Set!" }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-gray-600 mb-6", children: "Welcome to CollEco! Your office in your pocket." }),
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-gray-50 rounded-lg p-4 mb-6 text-left", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-sm font-semibold text-gray-900 mb-3", children: "Permissions Summary:" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "space-y-2", children: steps.map((step) => {
          const status = permissions[step.id];
          return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between", children: [
            /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-sm text-gray-700", children: [
              step.icon,
              " ",
              step.title.replace("Enable ", "").replace("Allow ", "")
            ] }),
            /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: `text-xs font-medium ${status === "granted" ? "text-green-600" : status === "denied" ? "text-red-600" : "text-yellow-600"}`, children: status === "granted" ? "âœ… Enabled" : status === "denied" ? "âŒ Denied" : "â­ï¸ Skipped" })
          ] }, step.id);
        }) })
      ] }),
      skipped.length > 0 && /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-xs text-gray-500 mb-6", children: "You can enable skipped permissions anytime from Settings â†’ Notifications" }),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        "button",
        {
          onClick: handleComplete,
          className: "w-full bg-[#D2691E] text-white px-6 py-3 rounded-lg hover:bg-[#B8591A] transition-colors font-medium",
          children: "Start Using CollEco"
        }
      )
    ] }) });
  }
  if (!currentStepData) return null;
  return /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4", children: /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-white rounded-2xl max-w-md w-full p-6", children: [
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "mb-6", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "flex items-center justify-between mb-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-xs font-medium text-gray-600", children: [
          "Step ",
          currentStep + 1,
          " of ",
          steps.length
        ] }),
        /* @__PURE__ */ jsxRuntimeExports.jsxs("span", { className: "text-xs text-gray-500", children: [
          Math.round((currentStep + 1) / steps.length * 100),
          "%"
        ] })
      ] }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "h-2 bg-gray-200 rounded-full overflow-hidden", children: /* @__PURE__ */ jsxRuntimeExports.jsx(
        "div",
        {
          className: "h-full bg-[#D2691E] transition-all duration-300",
          style: { width: `${(currentStep + 1) / steps.length * 100}%` }
        }
      ) })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "text-center mb-4", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "text-6xl mb-3", children: currentStepData.icon }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("h2", { className: "text-2xl font-bold text-gray-900 mb-2", children: currentStepData.title }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-gray-600 text-sm", children: currentStepData.description })
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "bg-[#FFF8F1] border border-[#D2691E] rounded-lg p-4 mb-6", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-xs font-semibold text-gray-900 mb-3", children: "Why enable this?" }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("ul", { className: "space-y-2", children: currentStepData.benefits.map((benefit, index) => /* @__PURE__ */ jsxRuntimeExports.jsxs("li", { className: "text-sm text-gray-700 flex items-start gap-2", children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { className: "flex-shrink-0", children: "â€¢" }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("span", { children: benefit })
      ] }, index)) })
    ] }),
    permissions[currentStepData.id] === "denied" && /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "bg-red-50 border border-red-200 rounded-lg p-3 mb-4", children: /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-xs text-red-800", children: "âš ï¸ This permission was previously denied. To enable it, please update your browser/device settings." }) }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { className: "space-y-3", children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        "button",
        {
          onClick: currentStepData.action,
          disabled: loading || permissions[currentStepData.id] === "granted",
          className: "w-full bg-[#D2691E] text-white px-6 py-3 rounded-lg hover:bg-[#B8591A] disabled:bg-gray-300 disabled:text-gray-500 disabled:cursor-not-allowed transition-colors font-medium",
          children: loading ? "â³ Processing..." : permissions[currentStepData.id] === "granted" ? "âœ… Enabled" : currentStepData.buttonText
        }
      ),
      /* @__PURE__ */ jsxRuntimeExports.jsx(
        "button",
        {
          onClick: handleSkip,
          disabled: loading,
          className: "w-full bg-gray-100 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-200 transition-colors font-medium",
          children: "Skip for Now"
        }
      )
    ] }),
    /* @__PURE__ */ jsxRuntimeExports.jsx("p", { className: "text-xs text-gray-500 text-center mt-4", children: "ðŸ”’ Your privacy matters. You can change these permissions anytime in settings." })
  ] }) });
};
const __vite_import_meta_env__ = { "BASE_URL": "/", "DEV": false, "MODE": "production", "PROD": true, "SSR": false };
const fallbackComponentKey = "WorkspacePage";
const pageModules = /* @__PURE__ */ Object.assign({ "./pages/AIGeneratorPage.jsx": () => __vitePreload(() => import("./AIGeneratorPage-DlAnS9gz.js"), true ? __vite__mapDeps([0,1,2,3,4,5]) : void 0), "./pages/AIMetricsPage.jsx": () => __vitePreload(() => import("./AIMetricsPage-C7EbhZyY.js"), true ? __vite__mapDeps([6,1,2]) : void 0), "./pages/About.jsx": () => __vitePreload(() => import("./About-B1xI7hqv.js"), true ? __vite__mapDeps([7,1,2]) : void 0), "./pages/AccommodationBooking.jsx": () => __vitePreload(() => import("./AccommodationBooking-CnBd5hSB.js"), true ? __vite__mapDeps([8,1,2,9,5,10,4]) : void 0), "./pages/AdminAccommodation.jsx": () => __vitePreload(() => import("./AdminAccommodation-DMs3tVG7.js"), true ? __vite__mapDeps([11,1,2,4,5]) : void 0), "./pages/AdminBookings.jsx": () => __vitePreload(() => import("./AdminBookings-NdyFHFu3.js"), true ? __vite__mapDeps([12,1,2,10,5]) : void 0), "./pages/AdminChat.jsx": () => __vitePreload(() => import("./AdminChat-BeEbE0lO.js"), true ? __vite__mapDeps([13,1,2]) : void 0), "./pages/AdminConsole.jsx": () => __vitePreload(() => import("./AdminConsole-MTHJkico.js"), true ? __vite__mapDeps([14,1,2,15,16,5]) : void 0), "./pages/AdminConsoleEnhanced.jsx": () => __vitePreload(() => import("./AdminConsoleEnhanced-DH_Y6AJ7.js"), true ? __vite__mapDeps([17,1,2,5]) : void 0), "./pages/AdminDashboard.jsx": () => __vitePreload(() => import("./AdminDashboard-1Z2eU-yc.js"), true ? __vite__mapDeps([18,1,2,19,20,5,4]) : void 0), "./pages/AdminLayout.jsx": () => __vitePreload(() => Promise.resolve().then(() => AdminLayout), true ? void 0 : void 0), "./pages/AdminPackageEditor.jsx": () => __vitePreload(() => Promise.resolve().then(() => AdminPackageEditor), true ? void 0 : void 0), "./pages/AdminPackageForm.jsx": () => __vitePreload(() => import("./AdminPackageForm-CSsPUrTd.js"), true ? __vite__mapDeps([21,1,2]) : void 0), "./pages/AdminPackageList.jsx": () => __vitePreload(() => Promise.resolve().then(() => AdminPackageList), true ? void 0 : void 0), "./pages/Analytics.jsx": () => __vitePreload(() => import("./Analytics-DxSi1iJg.js"), true ? __vite__mapDeps([22,1,2,4,5]) : void 0), "./pages/Book.jsx": () => __vitePreload(() => import("./Book-DJgWRp8R.js"), true ? __vite__mapDeps([23,1,2,9,5,4]) : void 0), "./pages/Bookings.jsx": () => __vitePreload(() => import("./Bookings-BYtPTBMw.js"), true ? __vite__mapDeps([24,1,2,25,26,27,10,3,4,5]) : void 0), "./pages/BulkInventoryUpload.jsx": () => __vitePreload(() => import("./BulkInventoryUpload-CFDRIpY9.js"), true ? __vite__mapDeps([28,1,2]) : void 0), "./pages/BusinessAccountDetail.jsx": () => __vitePreload(() => import("./BusinessAccountDetail-DLIYHckT.js"), true ? __vite__mapDeps([29,1,2,5,4]) : void 0), "./pages/BusinessDashboard.jsx": () => __vitePreload(() => import("./BusinessDashboard-C2XxIfiH.js"), true ? __vite__mapDeps([30,1,2,5,4]) : void 0), "./pages/BusinessTravelerRegistration.jsx": () => __vitePreload(() => import("./BusinessTravelerRegistration-Ctvgp8wh.js"), true ? __vite__mapDeps([31,1,2,5,4]) : void 0), "./pages/CarBooking.jsx": () => __vitePreload(() => import("./CarBooking-DygQXGKU.js"), true ? __vite__mapDeps([32,1,2,9,5,10,4]) : void 0), "./pages/CheckIn.jsx": () => __vitePreload(() => import("./CheckIn-BaqdhfOa.js"), true ? __vite__mapDeps([33,1,2,4,5]) : void 0), "./pages/Checkout.jsx": () => __vitePreload(() => import("./Checkout-B26h3dT9.js"), true ? __vite__mapDeps([34,1,2,10,5,4]) : void 0), "./pages/CollabAnalytics.jsx": () => __vitePreload(() => import("./CollabAnalytics-DDflkx5q.js"), true ? __vite__mapDeps([35,1,2,4,5]) : void 0), "./pages/Collaboration.jsx": () => __vitePreload(() => import("./Collaboration-CKxtq4Tp.js"), true ? __vite__mapDeps([36,1,2,4,5]) : void 0), "./pages/Compliance.jsx": () => __vitePreload(() => import("./Compliance-BUv0Nl3T.js"), true ? __vite__mapDeps([37,1,2,25,38,5,4]) : void 0), "./pages/Contact.jsx": () => __vitePreload(() => import("./Contact-BKAKnX_9.js"), true ? __vite__mapDeps([39,1,2,4,5]) : void 0), "./pages/DirectBooking.jsx": () => __vitePreload(() => import("./DirectBooking-rW0VGL4B.js"), true ? __vite__mapDeps([40,1,2]) : void 0), "./pages/Finance.jsx": () => __vitePreload(() => Promise.resolve().then(() => Finance), true ? void 0 : void 0), "./pages/FlightBooking.jsx": () => __vitePreload(() => import("./FlightBooking-ByBMVx1c.js"), true ? __vite__mapDeps([41,1,2,9,5,10,4]) : void 0), "./pages/Gamification.jsx": () => __vitePreload(() => import("./Gamification-B8PmrtO-.js"), true ? __vite__mapDeps([42,1,2,20,5,4]) : void 0), "./pages/Home.jsx": () => __vitePreload(() => import("./Home-CsMrKiu0.js"), true ? __vite__mapDeps([43,1,2,10,5,4]) : void 0), "./pages/Itinerary.jsx": () => __vitePreload(() => import("./Itinerary-Db3jaCzc.js"), true ? __vite__mapDeps([44,4,1,2,45,46,47,48,3,5]) : void 0), "./pages/ItineraryPage.jsx": () => __vitePreload(() => Promise.resolve().then(() => ItineraryPage), true ? void 0 : void 0), "./pages/ItinerarySimple.jsx": () => __vitePreload(() => import("./ItinerarySimple-DlxCSQuV.js"), true ? __vite__mapDeps([49,4,1,2,45,46,48,3,10,5]) : void 0), "./pages/Login.jsx": () => __vitePreload(() => import("./Login-Di12DA54.js"), true ? __vite__mapDeps([50,1,2,10,5,4]) : void 0), "./pages/LoyaltyDashboard.jsx": () => __vitePreload(() => import("./LoyaltyDashboard-CAFfjaL_.js"), true ? __vite__mapDeps([51,1,2,5,4]) : void 0), "./pages/ManageBusinessAccounts.jsx": () => __vitePreload(() => import("./ManageBusinessAccounts-B1LL2z1G.js"), true ? __vite__mapDeps([52,1,2,5,4]) : void 0), "./pages/MyTrips.jsx": () => __vitePreload(() => import("./MyTrips-CzyhjBFK.js"), true ? __vite__mapDeps([53,1,2,5,4]) : void 0), "./pages/NewQuote.jsx": () => __vitePreload(() => import("./NewQuote-spyZAHeU.js"), true ? __vite__mapDeps([54,1,2,48,55,4,56,57,5]) : void 0), "./pages/NotificationSettings.jsx": () => __vitePreload(() => import("./NotificationSettings-B0X8EiKr.js"), true ? __vite__mapDeps([58,1,2,4,5]) : void 0), "./pages/Notifications.jsx": () => __vitePreload(() => import("./Notifications-aUUdH5xr.js"), true ? __vite__mapDeps([59,1,2]) : void 0), "./pages/Packages.jsx": () => __vitePreload(() => import("./Packages-7B1gxl-z.js"), true ? __vite__mapDeps([60,1,2]) : void 0), "./pages/PartnerApplicationStatus.jsx": () => __vitePreload(() => import("./PartnerApplicationStatus-BlEupfZ-.js"), true ? __vite__mapDeps([61,1,2,5,4]) : void 0), "./pages/PartnerDashboard.jsx": () => __vitePreload(() => import("./PartnerDashboard-BwUh1AKm.js"), true ? __vite__mapDeps([62,1,2,10,63,26,25,38,5,64,19,20,4]) : void 0), "./pages/PartnerEarnings.jsx": () => __vitePreload(() => import("./PartnerEarnings-DFK0ymPL.js"), true ? __vite__mapDeps([65,1,2,15,16,63,5,4]) : void 0), "./pages/PartnerOnboarding.jsx": () => __vitePreload(() => import("./PartnerOnboarding-BQkAC9Hc.js"), true ? __vite__mapDeps([66,1,2,63,5,4]) : void 0), "./pages/PartnerSuccessDashboard.jsx": () => __vitePreload(() => import("./PartnerSuccessDashboard-CjKpIuP4.js"), true ? __vite__mapDeps([67,1,2,63,5]) : void 0), "./pages/PartnerTemplates.jsx": () => __vitePreload(() => import("./PartnerTemplates-DP35T7y5.js"), true ? __vite__mapDeps([68,1,2,10,4,5]) : void 0), "./pages/PartnerTransferDashboard.jsx": () => __vitePreload(() => import("./PartnerTransferDashboard-B8YkEh26.js"), true ? __vite__mapDeps([69,1,2,63]) : void 0), "./pages/PartnerVerification.jsx": () => __vitePreload(() => import("./PartnerVerification-C5xV2x3J.js"), true ? __vite__mapDeps([70,1,2,63,5,4]) : void 0), "./pages/Partners.jsx": () => __vitePreload(() => import("./Partners-sZTBUpKg.js"), true ? __vite__mapDeps([71,1,2]) : void 0), "./pages/PaymentCancel.jsx": () => __vitePreload(() => import("./PaymentCancel-CXp2L1pa.js"), true ? __vite__mapDeps([72,1,2,4,5]) : void 0), "./pages/PaymentFailure.jsx": () => __vitePreload(() => import("./PaymentFailure-BJ0l-G9q.js"), true ? __vite__mapDeps([73,1,2,4,5]) : void 0), "./pages/PaymentSuccess.jsx": () => __vitePreload(() => import("./PaymentSuccess-Dba8cgfD.js"), true ? __vite__mapDeps([74,1,2,27,5,4]) : void 0), "./pages/Payouts.jsx": () => __vitePreload(() => import("./Payouts-Df-InSL1.js"), true ? __vite__mapDeps([75,1,2]) : void 0), "./pages/PlanTrip.jsx": () => __vitePreload(() => import("./PlanTrip-CHGleIan.js"), true ? __vite__mapDeps([76,1,2,10,25,46,48,56,47,3,4,5]) : void 0), "./pages/PrivacySettings.jsx": () => __vitePreload(() => import("./PrivacySettings-B_In51Te.js"), true ? __vite__mapDeps([77,1,2,5,4]) : void 0), "./pages/Profile.jsx": () => __vitePreload(() => import("./Profile-BqjbhayB.js"), true ? __vite__mapDeps([78,1,2,10,4,5]) : void 0), "./pages/Promotions.jsx": () => __vitePreload(() => import("./Promotions-wZ_rxQ4d.js"), true ? __vite__mapDeps([79,1,2,25,64,5,10,4]) : void 0), "./pages/QuoteGenerator.jsx": () => __vitePreload(() => import("./QuoteGenerator-BSNjDLC-.js"), true ? __vite__mapDeps([80,1,2,55,4,56,10,5]) : void 0), "./pages/Quotes.jsx": () => __vitePreload(() => import("./Quotes-Bdqb_3aS.js"), true ? __vite__mapDeps([81,1,2,56,55,4,3,10,57,5]) : void 0), "./pages/Refunds.jsx": () => __vitePreload(() => import("./Refunds-DnUNxCcC.js"), true ? __vite__mapDeps([82,1,2,83]) : void 0), "./pages/Reports.jsx": () => __vitePreload(() => import("./Reports-CayPqQ6I.js"), true ? __vite__mapDeps([84,1,2]) : void 0), "./pages/Safety.jsx": () => __vitePreload(() => import("./Safety-CveG-Ejd.js"), true ? __vite__mapDeps([85,1,2]) : void 0), "./pages/SavedItineraries.jsx": () => __vitePreload(() => import("./SavedItineraries-Dwa23ipc.js"), true ? __vite__mapDeps([86,1,2,5,4]) : void 0), "./pages/Settings.jsx": () => __vitePreload(() => import("./Settings-BxFyJ7jf.js"), true ? __vite__mapDeps([87,1,2,4,5]) : void 0), "./pages/SubscriptionTiers.jsx": () => __vitePreload(() => import("./SubscriptionTiers-Bntgf2GR.js"), true ? __vite__mapDeps([88,1,2,16,5]) : void 0), "./pages/SupplierPayouts.jsx": () => __vitePreload(() => import("./SupplierPayouts-CJZljMFb.js"), true ? __vite__mapDeps([89,1,2,83]) : void 0), "./pages/Support.jsx": () => __vitePreload(() => import("./Support-B_23pDAw.js"), true ? __vite__mapDeps([90,1,2]) : void 0), "./pages/SupportTickets.jsx": () => __vitePreload(() => import("./SupportTickets-BOB_5nBK.js"), true ? __vite__mapDeps([91,1,2]) : void 0), "./pages/Terms.jsx": () => __vitePreload(() => import("./Terms-H7f5eAsd.js"), true ? __vite__mapDeps([92,1,2]) : void 0), "./pages/TermsStandalone.jsx": () => __vitePreload(() => import("./TermsStandalone-DdjBFTbj.js"), true ? __vite__mapDeps([93,1,2,5]) : void 0), "./pages/TransferAnalytics.jsx": () => __vitePreload(() => import("./TransferAnalytics-BJ_4fNi8.js"), true ? __vite__mapDeps([94,1,2]) : void 0), "./pages/TransferHistory.jsx": () => __vitePreload(() => import("./TransferHistory-CODrUibK.js"), true ? __vite__mapDeps([95,1,2,4,5]) : void 0), "./pages/Transfers.jsx": () => __vitePreload(() => import("./Transfers-BrDFal9x.js"), true ? __vite__mapDeps([96,1,2,9,5,10,4]) : void 0), "./pages/TransportDispatch.jsx": () => __vitePreload(() => import("./TransportDispatch-DX-gKzwQ.js"), true ? __vite__mapDeps([97,1,2]) : void 0), "./pages/TravelerDashboard.jsx": () => __vitePreload(() => import("./TravelerDashboard-DblsybnJ.js"), true ? __vite__mapDeps([98,1,2,19,20,5,4]) : void 0), "./pages/Trips.jsx": () => __vitePreload(() => import("./Trips-DJzg56vs.js"), true ? __vite__mapDeps([99,1,2,4,5]) : void 0), "./pages/Unauthorized.jsx": () => __vitePreload(() => import("./Unauthorized-DXQFJVXQ.js"), true ? __vite__mapDeps([100,1,2,4,5]) : void 0), "./pages/Wishlist.jsx": () => __vitePreload(() => import("./Wishlist-51pqLmCs.js"), true ? __vite__mapDeps([101,1,2,4,5]) : void 0), "./pages/WorkspacePage.jsx": () => __vitePreload(() => import("./WorkspacePage-BHD0tBR-.js"), true ? __vite__mapDeps([102,1,2,5,4]) : void 0) });
const componentRegistry = Object.entries(pageModules).reduce(
  (acc, [path, loader]) => {
    const componentName = path.replace("./pages/", "").replace(".jsx", "");
    acc[componentName] = reactExports.lazy(loader);
    return acc;
  },
  {}
);
const fallbackComponent = componentRegistry[fallbackComponentKey];
if (!fallbackComponent) {
  throw new Error(
    `[router] Unable to locate ${fallbackComponentKey}. Ensure pages/${fallbackComponentKey}.jsx exists.`
  );
}
function extractRoutesFromConfig(config) {
  const categories = config?.layout?.main?.categories ?? [];
  return categories.flatMap(
    ({ group, routes = [] }) => routes.filter((route) => route?.path).map((route) => ({
      ...route,
      component: route.component ?? fallbackComponentKey,
      meta: { ...route.meta ?? {} },
      group
    }))
  );
}
const CONFIG_ROUTES = extractRoutesFromConfig(pagesConfig);
const ROUTE_LOOKUP = new Map(CONFIG_ROUTES.map((route) => [route.path, route]));
const HOME_ROUTE = ROUTE_LOOKUP.get("/") ?? null;
const ROUTES_EXCLUDING_HOME = CONFIG_ROUTES.filter((route) => route.path !== "/");
function createRouteElement(route) {
  const componentKey = route.component ?? fallbackComponentKey;
  const Component = componentRegistry[componentKey] ?? fallbackComponent;
  const templateConfig = resolveTemplateForRoute(route);
  if (!componentRegistry[componentKey]) {
    console.warn(
      `[router] Component "${componentKey}" missing; defaulting to ${fallbackComponentKey} for path "${route.path}".`
    );
  }
  try {
    if (typeof window !== "undefined" && window.__E2E__) {
      if (!window.__E2E_ACTIVE_ROUTE_COMPONENT__) window.__E2E_ACTIVE_ROUTE_COMPONENT__ = {};
      window.__E2E_ACTIVE_ROUTE_COMPONENT__[route.path] = componentKey;
    }
  } catch (e) {
  }
  const isWorkspaceView = componentKey === fallbackComponentKey || Component === fallbackComponent;
  const elementProps = isWorkspaceView ? { pageKey: route.path, template: templateConfig, route } : { template: templateConfig, route };
  return /* @__PURE__ */ jsxRuntimeExports.jsx(Component, { ...elementProps });
}
function GuardedRoute({ route }) {
  const [activeRole] = useLocalStorageState("colleco.sidebar.role", null);
  let effectiveRole = activeRole;
  if (!effectiveRole && typeof window !== "undefined" && window.__E2E__) {
    try {
      const raw = localStorage.getItem("colleco.sidebar.role");
      if (raw) effectiveRole = JSON.parse(raw);
    } catch (e) {
    }
    try {
      if (!effectiveRole && window.__E2E_USER__ && window.__E2E_USER__.role) {
        effectiveRole = window.__E2E_USER__.role;
      }
    } catch (e) {
    }
  }
  const isAuthenticated = Boolean(effectiveRole);
  const meta = route.meta ?? {};
  const requiredRoles = Array.isArray(meta.roles) ? meta.roles : meta.role ? [meta.role] : [];
  if (meta.requiresAuth && !isAuthenticated) {
    return /* @__PURE__ */ jsxRuntimeExports.jsx(Navigate, { to: "/login", replace: true, state: { from: route.path } });
  }
  if (requiredRoles.length > 0 && (!effectiveRole || !requiredRoles.includes(effectiveRole))) {
    const fallback = meta.redirectFallback ?? "/";
    return /* @__PURE__ */ jsxRuntimeExports.jsx(Navigate, { to: fallback, replace: true });
  }
  return createRouteElement(route);
}
function RouteMetadataSync() {
  const location2 = useLocation();
  reactExports.useEffect(() => {
    const currentRoute = ROUTE_LOOKUP.get(location2.pathname);
    if (currentRoute?.meta?.title) {
      document.title = currentRoute.meta.title;
    }
    window.scrollTo(0, 0);
  }, [location2.pathname]);
  return null;
}
const NotFoundElement = /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "p-6 text-brand-brown", children: "We couldn't find the page you were looking for." });
function App() {
  const [showOnboarding, setShowOnboarding] = reactExports.useState(false);
  const [activeRole] = useLocalStorageState("colleco.sidebar.role", "admin");
  reactExports.useEffect(() => {
    const idle = (cb) => "requestIdleCallback" in window ? requestIdleCallback(cb, { timeout: 2e3 }) : setTimeout(cb, 800);
    idle(() => {
      try {
        ["/plan-trip", "/itinerary", "/ai", "/bookings"].forEach((p) => prefetchRouteByPath(p));
      } catch {
      }
      __vitePreload(() => import("./Bookings-BYtPTBMw.js"), true ? __vite__mapDeps([24,1,2,25,26,27,10,3,4,5]) : void 0);
      __vitePreload(() => import("./Itinerary-Db3jaCzc.js"), true ? __vite__mapDeps([44,4,1,2,45,46,47,48,3,5]) : void 0);
    });
  }, []);
  reactExports.useEffect(() => {
    const onboardingCompleted = localStorage.getItem("colleco.onboarding.completed");
    const isPWA = window.matchMedia("(display-mode: standalone)").matches || window.navigator.standalone === true;
    if (activeRole && !onboardingCompleted && isPWA) {
      setTimeout(() => setShowOnboarding(true), 1e3);
    }
  }, [activeRole]);
  const handleOnboardingComplete = () => {
    setShowOnboarding(false);
  };
  reactExports.useEffect(() => {
    try {
      if (typeof window !== "undefined" && window.__E2E__) {
        const mark = () => {
          try {
            window.__E2E_MOUNTED__ = true;
          } catch (e) {
          }
          try {
            document && document.body && document.body.setAttribute && document.body.setAttribute("data-e2e-ready", "true");
          } catch (e) {
          }
        };
        if (typeof requestAnimationFrame !== "undefined") requestAnimationFrame(mark);
        else setTimeout(mark, 0);
      }
    } catch (e) {
    }
  }, []);
  const useHash = (() => {
    try {
      const env = __vite_import_meta_env__ || {};
      if (env.VITE_USE_HASH === "1") return true;
      const baseUrl = env.BASE_URL || env.VITE_BASE_PATH || "/";
      if (typeof baseUrl === "string" && baseUrl !== "/" && baseUrl !== "") return true;
    } catch (e) {
    }
    return false;
  })();
  const RouterComponent = useHash ? HashRouter : BrowserRouter;
  const basename = !useHash && typeof import.meta !== "undefined" && __vite_import_meta_env__ && "/" ? "/" : void 0;
  return /* @__PURE__ */ jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment, { children: [
    showOnboarding && /* @__PURE__ */ jsxRuntimeExports.jsx(OnboardingPermissions, { onComplete: handleOnboardingComplete }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(ProductOwnerChatModal, {}),
    /* @__PURE__ */ jsxRuntimeExports.jsxs(RouterComponent, { basename, children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx(RouteMetadataSync, {}),
      /* @__PURE__ */ jsxRuntimeExports.jsx(reactExports.Suspense, { fallback: /* @__PURE__ */ jsxRuntimeExports.jsx("div", { className: "p-6 text-brand-brown", children: "Loadingâ€¦" }), children: /* @__PURE__ */ jsxRuntimeExports.jsx(Routes, { children: /* @__PURE__ */ jsxRuntimeExports.jsxs(Route, { element: /* @__PURE__ */ jsxRuntimeExports.jsx(RootLayout, {}), children: [
        HOME_ROUTE && /* @__PURE__ */ jsxRuntimeExports.jsx(Route, { index: true, element: /* @__PURE__ */ jsxRuntimeExports.jsx(GuardedRoute, { route: HOME_ROUTE }) }),
        HOME_ROUTE && /* @__PURE__ */ jsxRuntimeExports.jsx(Route, { path: "/", element: /* @__PURE__ */ jsxRuntimeExports.jsx(GuardedRoute, { route: HOME_ROUTE }) }),
        ROUTES_EXCLUDING_HOME.map((route) => /* @__PURE__ */ jsxRuntimeExports.jsx(
          Route,
          {
            path: route.path,
            element: /* @__PURE__ */ jsxRuntimeExports.jsx(GuardedRoute, { route })
          },
          route.path
        )),
        /* @__PURE__ */ jsxRuntimeExports.jsx(Route, { path: "*", element: NotFoundElement })
      ] }) }) })
    ] })
  ] });
}
class ErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false, error: null };
  }
  static getDerivedStateFromError(error) {
    return { hasError: true, error };
  }
  componentDidCatch(_error, _info) {
  }
  render() {
    if (this.state.hasError) {
      return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { style: { padding: "1rem", color: "#6b3f22" }, children: [
        /* @__PURE__ */ jsxRuntimeExports.jsx("h2", { style: { fontWeight: 700 }, children: "Something went wrong." }),
        /* @__PURE__ */ jsxRuntimeExports.jsx("pre", { style: { whiteSpace: "pre-wrap" }, children: String(this.state.error) })
      ] });
    }
    return this.props.children;
  }
}
function ensureLink(rel, attrs) {
  let link = document.querySelector(`link[rel="${rel}"]${attrs.sizes ? `[sizes="${attrs.sizes}"]` : ""}${attrs.type ? `[type="${attrs.type}"]` : ""}`);
  if (!link) {
    link = document.createElement("link");
    link.rel = rel;
    if (attrs.type) link.type = attrs.type;
    if (attrs.sizes) link.sizes = attrs.sizes;
    document.head.appendChild(link);
  }
  link.href = attrs.href;
}
function InstallBanner() {
  const [deferred, setDeferred] = reactExports.useState(null);
  const [show, setShow] = reactExports.useState(false);
  reactExports.useEffect(() => {
    const onPrompt = (e) => {
      e.preventDefault();
      setDeferred(e);
      setShow(true);
    };
    window.addEventListener("beforeinstallprompt", onPrompt);
    return () => window.removeEventListener("beforeinstallprompt", onPrompt);
  }, []);
  if (!show) return null;
  return /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { style: { position: "fixed", left: 12, right: 12, bottom: 12, background: "#fff7ee", border: "1px solid #eadfd2", borderRadius: 10, padding: 12, display: "flex", gap: 8, alignItems: "center", boxShadow: "0 1px 6px rgba(0,0,0,.06)", zIndex: 50 }, children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx("span", { style: { color: "#4a3a2a" }, children: "Install CollEco for a faster app experience." }),
    /* @__PURE__ */ jsxRuntimeExports.jsxs("div", { style: { marginLeft: "auto", display: "flex", gap: 8 }, children: [
      /* @__PURE__ */ jsxRuntimeExports.jsx("button", { onClick: () => setShow(false), style: { padding: "6px 10px", borderRadius: 8, border: "1px solid #eadfd2", background: "#fff", color: "#4a3a2a" }, children: "Not now" }),
      /* @__PURE__ */ jsxRuntimeExports.jsx("button", { onClick: async () => {
        if (!deferred) return;
        deferred.prompt();
        const { outcome: _outcome } = await deferred.userChoice;
        setDeferred(null);
        setShow(false);
      }, style: { padding: "6px 10px", borderRadius: 8, border: "none", background: "#ff7a00", color: "#fff" }, children: "Install" })
    ] })
  ] });
}
ReactDOM.createRoot(document.getElementById("root")).render(
  /* @__PURE__ */ jsxRuntimeExports.jsx(React.StrictMode, { children: /* @__PURE__ */ jsxRuntimeExports.jsxs(UserProvider, { children: [
    /* @__PURE__ */ jsxRuntimeExports.jsx(ErrorBoundary, { children: /* @__PURE__ */ jsxRuntimeExports.jsx(App, {}) }),
    /* @__PURE__ */ jsxRuntimeExports.jsx(InstallBanner, {})
  ] }) })
);
try {
  if (window && window.__E2E__) {
    try {
      window.__E2E_MOUNTED__ = true;
    } catch (e) {
    }
  }
} catch (e) {
}
if ("serviceWorker" in navigator && true && !window.Cypress) {
  window.addEventListener("load", () => {
    navigator.serviceWorker.register("/sw.js").then(async (reg) => {
      try {
        const send = (sw) => {
          try {
            sw.postMessage({ type: "CHECK_FOR_UPDATE" });
          } catch {
          }
        };
        if (reg.active) send(reg.active);
        reg.addEventListener("updatefound", () => {
          const nw = reg.installing;
          if (!nw) return;
          nw.addEventListener("statechange", () => {
            if (nw.state === "activated") send(nw);
          });
        });
        navigator.serviceWorker.addEventListener("controllerchange", () => {
          try {
            if (!sessionStorage.getItem("reloadedAfterSW")) {
              sessionStorage.setItem("reloadedAfterSW", "1");
              location.reload();
            }
          } catch {
          }
        });
      } catch {
      }
    }).catch(() => {
    });
  });
}
try {
  ensureLink("icon", { type: "image/png", href: logo });
  ensureLink("apple-touch-icon", { href: logo });
} catch {
}
try {
  if (window && window.__E2E__) {
    const s = document.createElement("style");
    s.setAttribute("data-e2e-disable-animations", "true");
    s.textContent = `
      *, *::before, *::after { transition: none !important; animation: none !important; }
      [data-modal-root] { opacity: 1 !important; transform: none !important; }
    `;
    document.head.appendChild(s);
    try {
      let mr = document.querySelector("[data-modal-root]");
      if (!mr) {
        mr = document.createElement("div");
        mr.setAttribute("data-modal-root", "true");
        mr.style.position = "fixed";
        mr.style.top = "0";
        mr.style.left = "0";
        mr.style.width = "100%";
        mr.style.height = "100%";
        mr.style.minHeight = "100vh";
        mr.style.display = "block";
        mr.style.pointerEvents = "none";
        mr.style.zIndex = String(2147483646);
        document.body.appendChild(mr);
      } else {
        mr.style.display = mr.style.display || "block";
        mr.style.minHeight = mr.style.minHeight || "100vh";
      }
      mr.setAttribute("data-e2e-ready", "true");
    } catch (ee) {
    }
  }
} catch (e) {
}
const AdminLayout = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null
}, Symbol.toStringTag, { value: "Module" }));
const AdminPackageEditor = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null
}, Symbol.toStringTag, { value: "Module" }));
const AdminPackageList = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null
}, Symbol.toStringTag, { value: "Module" }));
const Finance = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null
}, Symbol.toStringTag, { value: "Module" }));
const ItineraryPage = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null
}, Symbol.toStringTag, { value: "Module" }));
export {
  markRead as A,
  BADGES as B,
  CONTACT_EMAIL as C,
  onCollabEvent as D,
  ErrorBoundary as E,
  addAttachment as F,
  notify as G,
  logo as H,
  PRODUCTS as I,
  searchEvents as J,
  buildLocationMaps as K,
  Link as L,
  loadMyLocation as M,
  NavLink as N,
  loadSmartSettings as O,
  PUBLIC_SITE_URL as P,
  getSuggestion as Q,
  ROLES as R,
  persistMyLocation as S,
  detectCategory as T,
  UserContext as U,
  resolveLocationToken as V,
  longestLocationMatch as W,
  useParams as a,
  useLocation as b,
  useUser as c,
  useSearchParams as d,
  computeAnalytics as e,
  useLocalStorageState as f,
  getLoyaltyData as g,
  getUserTier as h,
  getNextTierInfo as i,
  getTierBenefits as j,
  LOYALTY_TIERS as k,
  listThreads as l,
  PushNotificationService as m,
  Breadcrumbs as n,
  processBookingRewards as o,
  pointsToCurrency as p,
  resolveTemplate as q,
  redeemPoints as r,
  loadCustomAliases as s,
  saveCustomAliases as t,
  useNavigate as u,
  postMessage as v,
  CHANNELS as w,
  loadThreads as x,
  seedFromBookings as y,
  summarizeThread as z
};
//# sourceMappingURL=index-DlOecmR0.js.map
