{"version":3,"mappings":";;AAgCA,MAAM,YAAY;AAGlB,MAAM,eAAe;AAAA,EACnB,MAAM;AAAA,EACN,SAAS;AAAA,EACT,WAAW;AAAA,EACX,cAAc;AAAA,EACd,WAAW;AAAA,EACX,KAAK;AAAA;AAAA,EAEL,OAAO;AAAA,EACP,OAAO;AAAA,EACP,SAAS;AAAA,EACT,SAAS;AAAA;AAAA,EAET,SAAS;AAAA,IACP,UAAU;AAAA,IACV,YAAY;AAAA,IACZ,aAAa;AAAA,IACb,eAAe;AAAA,IACf,YAAY;AAAA,EAChB;AAAA;AAAA,EAEE,OAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EACJ;AAAA;AAAA,EAEE,QAAQ;AAAA,IACN,QAAQ;AAAA,IACR,OAAO;AAAA,IACP,MAAM;AAAA,IACN,OAAO;AAAA,EACX;AACA;AAGA,eAAe,kBAAkB,KAAK;AACpC,MAAI;AACF,UAAM,MAAM,MAAM,MAAM,GAAG;AAC3B,QAAI,CAAC,IAAI,GAAI,QAAO;AACpB,UAAM,MAAM,MAAM,IAAI;AAEtB,QAAI,SAAS;AACb,UAAM,QAAQ,IAAI,WAAW,GAAG;AAChC,UAAM,YAAY;AAClB,aAAS,IAAI,GAAG,IAAI,MAAM,QAAQ,KAAK,WAAW;AAChD,gBAAU,OAAO,aAAa,MAAM,MAAM,MAAM,SAAS,GAAG,IAAI,SAAS,CAAC;AAAA,IAC5E;AACA,UAAM,MAAM,KAAK,MAAM;AACvB,UAAM,OAAO,IAAI,QAAQ,IAAI,cAAc,KAAK;AAChD,WAAO,QAAQ,IAAI,WAAW,GAAG;AAAA,EACnC,SAAS,GAAG;AACV,WAAO;AAAA,EACT;AACF;AAiBY,MAAC,mBAAmB,OAAO,GAAG,GAAG,GAAG,MAAM;AACpD,QAAM,CAAC,EAAE,SAAS,SAAS,EAAE,SAAS,WAAW,IAAI,MAAM,QAAQ,IAAI;AAAA,IACtE,oBAAC,OAAO,mBAAO;AAAA,IACf,oBAAC,OAAO,sCAAiB;AAAA,EAC5B,CAAG;AAED,QAAM,MAAM,IAAI;AAGhB,QAAM,aAAa,OAAO,MAAM,YAAY,KAAK,MAAM,QAAQ,EAAE,KAAK,MAAM,EAAE,YAAY,EAAE,YAAY;AAExG,MAAI;AACJ,MAAI;AACJ,MAAI;AACJ,MAAI;AACJ,MAAI,WAAW;AACf,MAAI,UAAU;AACd,MAAI,UAAU;AAEd,MAAI;AAIJ,MAAI,YAAY;AACd,gBAAY,EAAE,cAAc,UAAU,KAAI;AAC1C,YAAQ,EAAE,SAAS;AACnB,UAAM,EAAE,MAAM,EAAE,aAAa;AAC7B,qBAAiB;AACjB,eAAW,EAAE,YAAY;AACzB,cAAU,OAAO,EAAE,YAAY,WAAW,EAAE,UAAU;AACtD,cAAU,EAAE,UAAU;AACb,MAAE,SAAS;AACpB,gBAAY,EAAE;AACD,MAAE;AAGf,QAAI,gBAAgB,EAAE,iBAAiB,EAAE,eAAe,EAAE,mBAAmB;AAC7E,QAAI,cAAc,EAAE,eAAe;AACnC,QAAI,gBAAgB,EAAE,iBAAiB;AACvC,QAAI,YAAY,EAAE,aAAa;AAC/B,QAAI,cAAc,EAAE,eAAe,EAAE,SAAS;AAC9C,QAAI,cAAc,EAAE,eAAe;AACf,MAAE,gBAAgB;AACtB,MAAE,cAAc,EAAE,YAAY;AAG9C,QAAI,cAAc,EAAE,eAAe;AACnC,QAAI,UAAU,EAAE,WAAW,YAAY;AACvC,QAAI,QAAQ,EAAE,SAAS,YAAY;AAAA,EACrC,OAAO;AACL,eAAY,GAAG,OAAI,KAAQ;AAC3B,YAAa;AACb,UAAM;AACN,qBAAiB;AACjB,kBAAc;AACd,cAAU,aAAa;AACvB,YAAQ,aAAa;AAAA,EACvB;AAGA,QAAM,aAAa,MAAM,IAAI,QAAM;AACjC,WAAO;AAAA,MACL,MAAM,GAAG,SAAS,GAAG,QAAQ;AAAA,MAC7B,aAAa,GAAG,eAAe,GAAG,YAAY;AAAA,MAC9C,MAAM,GAAG,aAAa,SAAY,GAAG,WAAY,GAAG,QAAQ,SAAY,GAAG,MAAM,MAAO;AAAA,MACxF,OAAO,GAAG,cAAc,SAAY,GAAG,YAAa,GAAG,UAAU,SAAY,GAAG,QAAQ,MAAO;AAAA,IACrG;AAAA,EACE,CAAC;AAED,QAAM,WAAW,iBAAiB,aAAa,WAAW,OAAO,OAAK,EAAE,IAAI;AAG5E,QAAM,YAAY,IAAI,SAAS,SAAS,SAAS;AACjD,QAAM,aAAa,IAAI,SAAS,SAAS,UAAU;AACnD,QAAM,aAAa;AACnB,QAAM,cAAc;AAGC,QAAM,kBAAkB,SAAS;AAGtD,QAAM,iBAAiB,EAAE,cAAc;AAGvC,QAAM,YAAY,MAAM;AAEtB,QAAI,gBAAgB;AAClB,UAAI;AACF,cAAM,QAAQ;AACd,cAAM,QAAQ;AACd,cAAM,QAAQ,YAAY,cAAc;AACxC,YAAI,SAAS,gBAAgB,OAAO,OAAO,GAAG,OAAO,KAAK;AAAA,MAC5D,SAAS,GAAG;AACV,gBAAQ,KAAK,2BAA2B,CAAC;AAAA,MAC3C;AAAA,IACF;AAGA,QAAI,YAAY,EAAE;AAClB,QAAI,QAAQ,QAAW,MAAM;AAC7B,UAAM,cAAc,YAAY,QAAQ;AACxC,UAAM,eAAe,IAAI,aAAa,WAAW;AACjD,QAAI,KAAK,cAAc,YAAY,gBAAgB,GAAG,EAAE;AAGxD,QAAI,YAAY,EAAE;AAClB,UAAM,OAAO;AACb,QAAI,YAAY,EAAE;AAClB,QAAI,QAAQ,QAAW,QAAQ;AAC/B,UAAM,aAAa,YAAY,WAAW;AAC1C,UAAM,cAAc,IAAI,aAAa,UAAU;AAC/C,QAAI,YAAY,EAAE;AAClB,UAAM,QAAQ;AAGd,QAAI,YAAY,EAAE;AAClB,UAAM,YAAY,IAAI,aAAa,IAAI;AACvC,QAAI,YAAY,EAAE;AAClB,UAAM,aAAa,IAAI,aAAa,KAAK;AACzC,UAAM,UAAU;AAChB,UAAM,aAAa,YAAY,UAAU,cAAc,UAAU;AACjE,UAAM,UAAU,YAAY,cAAc;AAG1C,QAAI,YAAY,EAAE;AAClB,QAAI,KAAK,MAAM,QAAQ,EAAE;AAEzB,QAAI,YAAY,EAAE;AAClB,QAAI,QAAQ,QAAW,QAAQ;AAC/B,QAAI,KAAK,YAAY,SAAS,YAAY,SAAS,EAAE;AAErD,QAAI,YAAY,EAAE;AAClB,QAAI,KAAK,OAAO,SAAS,YAAY,UAAU,cAAc,SAAS,EAAE;AAGxE,QAAI,aAAa,KAAK,KAAK,CAAC;AAC5B,QAAI,aAAa,GAAG;AACpB,QAAI,KAAK,IAAI,IAAI,YAAY,IAAI,EAAE;AAEnC,QAAI,aAAa,GAAG,GAAG,CAAC;AAAA,EAC1B;AAGA,QAAM,YAAY,MAAM;AACtB,QAAI,YAAY,EAAE;AAClB,QAAI,QAAQ,QAAW,MAAM;AAC7B,QAAI,aAAa,KAAK,KAAK,CAAC;AAC5B,UAAM,cAAc,YAAY,WAAW;AAC3C,UAAM,eAAe,IAAI,aAAa,WAAW;AACjD,UAAM,YAAY,YAAY,gBAAgB;AAC9C,QAAI,KAAK,aAAa,UAAU,aAAa,EAAE;AAG/C,QAAI,aAAa,KAAK,KAAK,CAAC;AAC5B,QAAI,aAAa,GAAG;AACpB,QAAI,KAAK,UAAU,aAAa,GAAG,WAAW,cAAc,aAAa,CAAC;AAE1E,QAAI,aAAa,GAAG,GAAG,CAAC;AAAA,EAC1B;AAGA;AAGA,QAAM,eAAe,EAAE,gBAAgB;AACvC,QAAM,YAAY,EAAE,YAAY,IAAI,KAAK,EAAE,SAAS,IAAK,YAAY,IAAI,KAAK,SAAS,IAAI,oBAAI,KAAI;AACnG,QAAM,UAAU,EAAE,UAAU,IAAI,KAAK,EAAE,OAAO,IAAI;AAGlD,MAAI,YAAY,CAAC;AACjB,MAAI,QAAQ,QAAW,QAAQ;AAC/B,MAAI,aAAa,KAAK,KAAK,GAAG;AAC9B,QAAM,WAAW,GAAG,YAAY,iBAAiB,UAAU,mBAAmB,OAAO,CAAC;AACtF,MAAI,KAAK,UAAU,IAAI,EAAE;AACzB,MAAI,aAAa,GAAG,GAAG,CAAC;AAGxB,MAAI,OAAO;AACX,MAAI,YAAY,EAAE;AAClB,MAAI,aAAa,KAAK,KAAK,EAAE;AAC7B,MAAI,QAAQ,QAAW,MAAM;AAC7B,MAAI,KAAK,aAAa,YAAW,GAAI,IAAI,IAAI;AAC7C,MAAI,aAAa,GAAG,GAAG,CAAC;AACxB,MAAI,QAAQ,QAAW,QAAQ;AAE/B,UAAQ;AACR,MAAI,YAAY,CAAC;AACjB,MAAI,YAAY,WAAW;AAAE,QAAI,KAAK,YAAY,WAAW,IAAI,IAAI;AAAG,YAAQ;AAAA,EAAG;AACnF,MAAI,YAAY,cAAc;AAAE,QAAI,KAAK,YAAY,cAAc,IAAI,IAAI;AAAG,YAAQ;AAAA,EAAG;AACzF,MAAI,YAAY,WAAW;AAAE,QAAI,KAAK,YAAY,WAAW,IAAI,IAAI;AAAG,YAAQ;AAAA,EAAG;AACnF,MAAI,YAAY,KAAK;AAAE,QAAI,KAAK,YAAY,KAAK,IAAI,IAAI;AAAG,YAAQ;AAAA,EAAG;AACvE,MAAI,YAAY,OAAO;AAAE,QAAI,KAAK,YAAY,OAAO,IAAI,IAAI;AAAG,YAAQ;AAAA,EAAG;AAC3E,MAAI,YAAY,OAAO;AACrB,QAAI,aAAa,GAAG,GAAG,GAAG;AAC1B,QAAI,aAAa,YAAY,OAAO,IAAI,MAAM,EAAE,KAAK,UAAU,YAAY,KAAK,GAAE,CAAE;AACpF,QAAI,aAAa,GAAG,GAAG,CAAC;AACxB,YAAQ;AAAA,EACV;AAGA,UAAQ;AACR,MAAI,YAAY,EAAE;AAClB,MAAI,QAAQ,QAAW,MAAM;AAC7B,QAAM,WAAW,iBAAiB,cAAc,aAAa;AAC7D,MAAI,KAAK,UAAU,IAAI,IAAI;AAC3B,MAAI,QAAQ,QAAW,QAAQ;AAC/B,MAAI,KAAK,iBAAiB,OAAO,OAAO,KAAK,IAAI,IAAI;AAErD,UAAQ;AACR,MAAI,QAAQ,QAAW,MAAM;AAC7B,MAAI,KAAK,YAAY,IAAI,IAAI;AAC7B,MAAI,QAAQ,QAAW,QAAQ;AAC/B,MAAI,KAAK,eAAe,KAAK,KAAK,IAAI,IAAI;AAE1C,UAAQ;AACR,MAAI,QAAQ,QAAW,MAAM;AAC7B,MAAI,KAAK,cAAc,IAAI,IAAI;AAC/B,MAAI,QAAQ,QAAW,QAAQ;AAC/B,MAAI,KAAK,UAAU,mBAAmB,OAAO,GAAG,KAAK,IAAI,IAAI;AAE7D,MAAI,WAAW,iBAAiB,WAAW;AACzC,YAAQ;AACR,QAAI,QAAQ,QAAW,MAAM;AAC7B,QAAI,KAAK,YAAY,IAAI,IAAI;AAC7B,QAAI,QAAQ,QAAW,QAAQ;AAC/B,QAAI,KAAK,QAAQ,mBAAmB,OAAO,GAAG,KAAK,IAAI,IAAI;AAAA,EAC7D;AAGA,UAAQ;AACR,MAAI,YAAY,EAAE;AAClB,MAAI,QAAQ,QAAW,MAAM;AAC7B,QAAM,cAAc,iBAAiB,cAAc,cAAc;AACjE,MAAI,KAAK,aAAa,IAAI,IAAI;AAC9B,MAAI,QAAQ,QAAW,QAAQ;AAC/B,MAAI,YAAY,CAAC;AAEjB,UAAQ;AACR,MAAI,KAAK,UAAU,IAAI,IAAI;AAE3B,MAAI,eAAe;AACjB,YAAQ;AACR,UAAM,eAAe,IAAI,gBAAgB,eAAe,EAAE;AAC1D,QAAI,KAAK,cAAc,IAAI,IAAI;AAC/B,YAAQ,aAAa,SAAS;AAAA,EAChC;AAEA,MAAI,aAAa;AACf,YAAQ;AACR,QAAI,KAAK,UAAU,WAAW,IAAI,IAAI,IAAI;AAAA,EAC5C;AAEA,MAAI,aAAa;AACf,YAAQ;AACR,QAAI,KAAK,UAAU,WAAW,IAAI,IAAI,IAAI;AAAA,EAC5C;AAEA,MAAI,WAAW;AACb,YAAQ;AACR,QAAI,KAAK,QAAQ,SAAS,IAAI,IAAI,IAAI;AAAA,EACxC;AAGA,QAAM,cAAc,KAAK,IAAI,OAAO,IAAI,GAAG;AAE3C,QAAM,OAAO,SAAS,IAAI,CAAC,MAAM,QAAQ;AACvC,UAAM,WAAW,KAAK,QAAQ,KAAK,cAAc,OAAO,KAAK,cAAc;AAC3E,WAAO;AAAA,MACL,MAAM;AAAA,MACN;AAAA,MACA,KAAK;AAAA,MACL,eAAe,KAAK,MAAM,QAAQ;AAAA,MAClC,eAAe,KAAK,OAAO,KAAK,KAAK,QAAQ;AAAA,IACnD;AAAA,EACE,CAAC;AAED,YAAU,KAAK;AAAA,IACb,QAAQ;AAAA,IACR,MAAM,CAAC,CAAC,eAAe,eAAe,OAAO,cAAc,aAAa,CAAC;AAAA,IACzE,MAAM;AAAA,IACN,OAAO;AAAA,IACP,QAAQ,EAAE,MAAM,IAAI,OAAO,GAAE;AAAA;AAAA,IAC7B,YAAY;AAAA,MACV,WAAW,CAAC,KAAK,KAAK,GAAG;AAAA,MACzB,WAAW,CAAC,GAAG,GAAG,CAAC;AAAA,MACnB,UAAU;AAAA,MACV,WAAW;AAAA,MACX,WAAW;AAAA,MACX,WAAW,CAAC,GAAG,GAAG,CAAC;AAAA,IACzB;AAAA,IACI,YAAY;AAAA,MACV,UAAU;AAAA,MACV,WAAW;AAAA,MACX,WAAW,CAAC,GAAG,GAAG,CAAC;AAAA,IACzB;AAAA,IACI,cAAc;AAAA,MACZ,GAAG,EAAE,WAAW,IAAI,QAAQ,SAAQ;AAAA,MACpC,GAAG,EAAE,WAAW,OAAM;AAAA,MACtB,GAAG,EAAE,WAAW,IAAI,QAAQ,SAAQ;AAAA,MACpC,GAAG,EAAE,WAAW,IAAI,QAAQ,QAAO;AAAA,MACnC,GAAG,EAAE,WAAW,IAAI,QAAQ,QAAO;AAAA,IACzC;AAAA,IACI,aAAa,CAAC,SAAS;AAErB,UAAI,KAAK,aAAa,GAAG;AACvB;MACF;AAAA,IACF;AAAA,EACJ,CAAG;AAGD,MAAI,SAAS,IAAI,cAAc,SAAS;AACxC,QAAM,UAAU,YAAY;AAE5B,QAAM,WAAW,SAAS,OAAO,CAAC,GAAG,MAAM,IAAK,EAAE,OAAO,EAAE,KAAM,CAAC;AAClE,QAAM,YAAa,WAAW,UAAW;AACzC,QAAM,aAAa,WAAW;AAE9B,MAAI,YAAY,EAAE;AAClB,MAAI,QAAQ,QAAW,MAAM;AAG7B,MAAI,KAAK,cAAc,UAAU,IAAI,MAAM;AAC3C,MAAI,KAAK,SAAS,SAAS,GAAG,IAAI,CAAC;AACnC,MAAI,KAAK,eAAe,UAAU,QAAQ,GAAG,UAAU,IAAI,QAAQ,EAAE,OAAO,QAAO,CAAE;AAGrF,YAAU;AACV,MAAI,KAAK,QAAQ,OAAO,MAAM,UAAU,IAAI,MAAM;AAClD,MAAI,KAAK,SAAS,SAAS,GAAG,IAAI,CAAC;AACnC,MAAI,KAAK,eAAe,WAAW,QAAQ,GAAG,UAAU,IAAI,QAAQ,EAAE,OAAO,QAAO,CAAE;AAGtF,YAAU;AACV,MAAI,KAAK,cAAc,UAAU,IAAI,MAAM;AAC3C,MAAI,KAAK,SAAS,SAAS,GAAG,IAAI,CAAC;AACnC,MAAI,KAAK,eAAe,YAAY,QAAQ,GAAG,UAAU,IAAI,QAAQ,EAAE,OAAO,QAAO,CAAE;AAGvF,YAAU;AACV,MAAI,YAAY,EAAE;AAClB,MAAI,QAAQ,QAAW,MAAM;AAC7B,MAAI,KAAK,oBAAoB,YAAY,MAAM;AAC/C,MAAI,QAAQ,QAAW,QAAQ;AAC/B,MAAI,YAAY,CAAC;AAEjB,YAAU;AACV,MAAI,KAAK,cAAc,QAAQ,QAAQ,IAAI,YAAY,MAAM;AAC7D,YAAU;AACV,MAAI,KAAK,gBAAgB,QAAQ,UAAU,IAAI,YAAY,MAAM;AACjE,YAAU;AACV,MAAI,KAAK,iBAAiB,QAAQ,WAAW,IAAI,YAAY,MAAM;AACnE,YAAU;AACV,MAAI,KAAK,mBAAmB,QAAQ,aAAa,IAAI,YAAY,MAAM;AACvE,YAAU;AACV,MAAI,KAAK,gBAAgB,QAAQ,UAAU,IAAI,YAAY,MAAM;AAGjE,YAAU;AACV,MAAI,YAAY,EAAE;AAClB,MAAI,QAAQ,QAAW,MAAM;AAC7B,MAAI,KAAK,yBAAyB,YAAY,MAAM;AACpD,MAAI,QAAQ,QAAW,QAAQ;AAC/B,MAAI,YAAY,CAAC;AAEjB,YAAU;AACV,QAAM,QAAQ,UAAQ;AACpB,UAAM,QAAQ,IAAI,gBAAgB,MAAM,YAAY,aAAa,cAAc,EAAE;AACjF,QAAI,KAAK,OAAO,YAAY,MAAM;AAClC,cAAU,MAAM,SAAS;AAAA,EAC3B,CAAC;AAGD,QAAM,YAAY,IAAI,SAAS,iBAAgB;AAC/C,WAAS,IAAI,GAAG,KAAK,WAAW,KAAK;AACnC,QAAI,QAAQ,CAAC;AACb;EACF;AAGA,QAAM,WAAW,gBAAgB,WAAW,aAAa,SAAS,GAAG,SAAS,QAAQ,SAAS,GAAG,CAAC;AACnG,MAAI,KAAK,QAAQ;AACnB","names":[],"ignoreList":[],"sources":["../../src/utils/pdfGenerators.js"],"sourcesContent":["// --- Sample Quote PDF Generator ---\r\nexport async function generateTestPDF() {\r\n  const { default: jsPDF } = await import(\"jspdf\");\r\n  const { default: autoTable } = await import(\"jspdf-autotable\");\r\n  \r\n  const doc = new jsPDF();\r\n\r\n  doc.setFontSize(18);\r\n  doc.text(\"CollEco Travel - Quote\", 14, 20);\r\n\r\n  doc.setFontSize(12);\r\n  doc.text(\"Client: John Doe\", 14, 35);\r\n  doc.text(\"Destination: Durban, South Africa\", 14, 45);\r\n\r\n  autoTable(doc, {\r\n    startY: 60,\r\n    head: [[\"Item\", \"Details\", \"Price\"]],\r\n    body: [\r\n      [\"Hotel\", \"2 nights at Seaside Resort\", \"$200\"],\r\n      [\"Car Hire\", \"Compact vehicle, 3 days\", \"$90\"],\r\n      [\"Tour\", \"Guided city tour\", \"$50\"],\r\n    ],\r\n  });\r\n\r\n  doc.text(\"Total: $340\", 14, doc.lastAutoTable.finalY + 10);\r\n\r\n  doc.save(\"quote.pdf\");\r\n}\r\n// (keep minimal and exported functions used by pages) // src/utils/pdfGenerators.js\r\nimport { formatCurrency } from './currency';\r\n\r\n// Public path to the logo in the `public/assets` folder  \r\nconst LOGO_PATH = '/src/assets/colleco-logo.png';\r\n\r\n// CollEco Travel Company Details - FULLY EDITABLE\r\nconst COMPANY_INFO = {\r\n  name: 'CollEco Travel',\r\n  tagline: 'The Odyssey of Adventure',\r\n  legalName: 'COLLECO SUPPLY & PROJECTS (PTY) Ltd',\r\n  registration: 'Reg: 2013/147893/07',\r\n  taxNumber: 'Tax: 9055225222',\r\n  csd: 'CSD: MAAA07802746',\r\n  // Contact details\r\n  email: 'collecokzn@gmail.com',\r\n  phone: 'Cell: 073 3994 708',\r\n  address: '6 Avenue Umtenweni 4234',\r\n  website: 'www.collecotravel.com',\r\n  // Banking details\r\n  banking: {\r\n    bankName: 'Capitec Business',\r\n    branchName: 'Relationship Suite',\r\n    accountType: 'Capitec Business Account',\r\n    accountNumber: '1052106919',\r\n    branchCode: '450105'\r\n  },\r\n  // Terms and conditions\r\n  terms: [\r\n    'All payments to be done electronically into provided account.',\r\n    'All bookings are subjected to availability.',\r\n    'All bookings are subjected to a non-refund cancelation policy once confirmed by the client.',\r\n    'All flight bookings are standard and if any changes are required there will be an additional cost. Upfront arrangements must be done for flexible bookings.',\r\n    'All car rentals are subject to a returnable deposit payment upon collection.',\r\n    'All damages and extra costs accumulated during the car hire, the driver will be liable for them.'\r\n  ],\r\n  // Brand colors\r\n  colors: {\r\n    orange: '#F47C20',\r\n    brown: '#3A2C1A',\r\n    gold: '#E6B422',\r\n    cream: '#FFF8F1'\r\n  }\r\n};\r\n\r\n// Helper: fetch an image and return a data URL (browser-friendly)\r\nasync function fetchImageDataUrl(url) {\r\n  try {\r\n    const res = await fetch(url);\r\n    if (!res.ok) return null;\r\n    const buf = await res.arrayBuffer();\r\n    // convert to base64\r\n    let binary = '';\r\n    const bytes = new Uint8Array(buf);\r\n    const chunkSize = 0x8000;\r\n    for (let i = 0; i < bytes.length; i += chunkSize) {\r\n      binary += String.fromCharCode.apply(null, bytes.subarray(i, i + chunkSize));\r\n    }\r\n    const b64 = btoa(binary);\r\n    const mime = res.headers.get('content-type') || 'image/png';\r\n    return `data:${mime};base64,${b64}`;\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport function generateMarketingFlyer(pkg = {}) {\r\n  return import(\"jspdf\").then(({ default: jsPDF }) => {\r\n    const doc = new jsPDF();\r\n    doc.setFontSize(18);\r\n    doc.text(pkg.title || \"CollEco Package\", 20, 30);\r\n    doc.setFontSize(12);\r\n    doc.text(`Price: R${pkg.price || 0}`, 20, 45);\r\n    doc.text(`Ref: ${pkg.id || \"\"}`, 20, 55);\r\n    doc.save(`${(pkg.title || \"package\").replace(/\\s+/g, \"_\")}_flyer.pdf`);\r\n  });\r\n}\r\n\r\n// Enhanced Quote PDF generator matching CollEco invoice template\r\n// Supports both legacy and structured formats\r\n// All fields are editable through the quote object\r\nexport const generateQuotePdf = async (a, b, c, d) => {\r\n  const [{ default: jsPDF }, { default: autoTable }] = await Promise.all([\r\n    import(\"jspdf\"),\r\n    import(\"jspdf-autotable\")\r\n  ]);\r\n  \r\n  const doc = new jsPDF();\r\n\r\n  // Detect structured object form\r\n  const structured = typeof a === 'object' && a && Array.isArray(a.items) && (a.currency || a.taxRate !== undefined);\r\n\r\n  let safeName;\r\n  let items;\r\n  let ref;\r\n  let showAllInQuote;\r\n  let currency = 'R'; // default Rand\r\n  let taxRate = 15; // default 15% VAT\r\n  let _status = 'Draft';\r\n  let _notes = '';\r\n  let createdAt;\r\n  let _updatedAt;\r\n\r\n  // Parse parameters\r\n  if (structured) {\r\n    safeName = (a.clientName || 'Client').trim();\r\n    items = a.items || [];\r\n    ref = a.id || a.reference || '';\r\n    showAllInQuote = true;\r\n    currency = a.currency || currency;\r\n    taxRate = typeof a.taxRate === 'number' ? a.taxRate : taxRate;\r\n    _status = a.status || _status;\r\n    _notes = a.notes || '';\r\n    createdAt = a.createdAt;\r\n    _updatedAt = a.updatedAt;\r\n    \r\n    // Additional editable fields\r\n    var invoiceNumber = a.invoiceNumber || a.quoteNumber || a.referenceNumber || '';\r\n    var orderNumber = a.orderNumber || '';\r\n    var clientAddress = a.clientAddress || '';\r\n    var clientVAT = a.clientVAT || '';\r\n    var clientPhone = a.clientPhone || a.phone || '';\r\n    var clientEmail = a.clientEmail || '';\r\n    var _paymentTerms = a.paymentTerms || '';\r\n    var _validity = a.validUntil || a.validity || '';\r\n    \r\n    // Editable company info override\r\n    var companyInfo = a.companyInfo || COMPANY_INFO;\r\n    var banking = a.banking || companyInfo.banking;\r\n    var terms = a.terms || companyInfo.terms;\r\n  } else {\r\n    safeName = (a?.trim?.() || 'Client');\r\n    items = b || [];\r\n    ref = c;\r\n    showAllInQuote = d;\r\n    companyInfo = COMPANY_INFO;\r\n    banking = COMPANY_INFO.banking;\r\n    terms = COMPANY_INFO.terms;\r\n  }\r\n\r\n  // Normalize items\r\n  const normalized = items.map(it => {\r\n    return {\r\n      name: it.title || it.name || 'Item',\r\n      description: it.description || it.subtitle || '',\r\n      qty: (it.quantity !== undefined ? it.quantity : (it.qty !== undefined ? it.qty : 1)) || 1,\r\n      unit: (it.unitPrice !== undefined ? it.unitPrice : (it.price !== undefined ? it.price : 0)) || 0,\r\n    };\r\n  });\r\n\r\n  const filtered = showAllInQuote ? normalized : normalized.filter(i => i.unit);\r\n\r\n  // Page setup\r\n  const pageWidth = doc.internal.pageSize.width || 210;\r\n  const pageHeight = doc.internal.pageSize.height || 297;\r\n  const marginLeft = 10;\r\n  const marginRight = 10;\r\n  \r\n  // Load logo (for optional use)\r\n  const _logoDataUrl = await fetchImageDataUrl(LOGO_PATH);\r\n  \r\n  // Use custom logo if provided\r\n  const customLogoData = a.customLogo || null;\r\n  \r\n  // Helper function to add CollEco header\r\n  const addHeader = () => {\r\n    // Add custom logo if available (top right corner)\r\n    if (customLogoData) {\r\n      try {\r\n        const logoW = 45;\r\n        const logoH = 20;\r\n        const logoX = pageWidth - marginRight - logoW;\r\n        doc.addImage(customLogoData, 'PNG', logoX, 8, logoW, logoH);\r\n      } catch (e) {\r\n        console.warn('Custom logo add failed:', e);\r\n      }\r\n    }\r\n    \r\n    // Company name at top - centered\r\n    doc.setFontSize(16);\r\n    doc.setFont(undefined, \"bold\");\r\n    const companyName = companyInfo.name || \"CollEco Travel\";\r\n    const companyWidth = doc.getTextWidth(companyName);\r\n    doc.text(companyName, (pageWidth - companyWidth) / 2, 16);\r\n    \r\n    // Letterhead: Bird logo - \"The Odyssey of Adventure\" - Globe (centered)\r\n    doc.setFontSize(24);\r\n    const bird = \"ðŸ¦œ\";\r\n    doc.setFontSize(11);\r\n    doc.setFont(undefined, \"italic\");\r\n    const payoffLine = companyInfo.tagline || \"The Odyssey of Adventure\";\r\n    const payoffWidth = doc.getTextWidth(payoffLine);\r\n    doc.setFontSize(14);\r\n    const globe = \"ðŸŒ\";\r\n    \r\n    // Calculate total width of bird + payoff + globe\r\n    doc.setFontSize(24);\r\n    const birdWidth = doc.getTextWidth(bird);\r\n    doc.setFontSize(14);\r\n    const globeWidth = doc.getTextWidth(globe);\r\n    const spacing = 2;\r\n    const totalWidth = birdWidth + spacing + payoffWidth + spacing + globeWidth;\r\n    const startX = (pageWidth - totalWidth) / 2;\r\n    \r\n    // Draw centered elements\r\n    doc.setFontSize(24);\r\n    doc.text(bird, startX, 26);\r\n    \r\n    doc.setFontSize(11);\r\n    doc.setFont(undefined, \"italic\");\r\n    doc.text(payoffLine, startX + birdWidth + spacing, 26);\r\n    \r\n    doc.setFontSize(14);\r\n    doc.text(globe, startX + birdWidth + spacing + payoffWidth + spacing, 26);\r\n    \r\n    // Decorative line\r\n    doc.setDrawColor(255, 140, 0); // Orange color\r\n    doc.setLineWidth(0.5);\r\n    doc.line(14, 36, pageWidth - 14, 36);\r\n    \r\n    doc.setTextColor(0, 0, 0);\r\n  };\r\n  \r\n  // Helper function to add footer\r\n  const addFooter = () => {\r\n    doc.setFontSize(10);\r\n    doc.setFont(undefined, \"bold\");\r\n    doc.setTextColor(255, 140, 0); // Orange color\r\n    const websiteText = companyInfo.website || \"www.travelcolleco.com\";\r\n    const websiteWidth = doc.getTextWidth(websiteText);\r\n    const websiteX = (pageWidth - websiteWidth) / 2;\r\n    doc.text(websiteText, websiteX, pageHeight - 10);\r\n    \r\n    // Underline the website\r\n    doc.setDrawColor(255, 140, 0);\r\n    doc.setLineWidth(0.5);\r\n    doc.line(websiteX, pageHeight - 9, websiteX + websiteWidth, pageHeight - 9);\r\n    \r\n    doc.setTextColor(0, 0, 0);\r\n  };\r\n  \r\n  // Add header to first page\r\n  addHeader();\r\n  \r\n  // Get document type\r\n  const documentType = a.documentType || 'Invoice';\r\n  const issueDate = a.issueDate ? new Date(a.issueDate) : (createdAt ? new Date(createdAt) : new Date());\r\n  const dueDate = a.dueDate ? new Date(a.dueDate) : null;\r\n  \r\n  // Date section (below header)\r\n  doc.setFontSize(9);\r\n  doc.setFont(undefined, 'normal');\r\n  doc.setTextColor(100, 100, 100);\r\n  const dateText = `${documentType} generated on ${issueDate.toLocaleDateString('en-GB')}`;\r\n  doc.text(dateText, 14, 42); // Left margin 14\r\n  doc.setTextColor(0, 0, 0);\r\n  \r\n  // Document details section\r\n  let yPos = 48;\r\n  doc.setFontSize(14);\r\n  doc.setTextColor(244, 124, 32); // Orange\r\n  doc.setFont(undefined, 'bold');\r\n  doc.text(documentType.toUpperCase(), 14, yPos); // Left margin 14\r\n  doc.setTextColor(0, 0, 0);\r\n  doc.setFont(undefined, 'normal');\r\n  \r\n  yPos += 6;\r\n  doc.setFontSize(9);\r\n  if (companyInfo.legalName) { doc.text(companyInfo.legalName, 14, yPos); yPos += 4; }\r\n  if (companyInfo.registration) { doc.text(companyInfo.registration, 14, yPos); yPos += 4; }\r\n  if (companyInfo.taxNumber) { doc.text(companyInfo.taxNumber, 14, yPos); yPos += 4; }\r\n  if (companyInfo.csd) { doc.text(companyInfo.csd, 14, yPos); yPos += 4; }\r\n  if (companyInfo.phone) { doc.text(companyInfo.phone, 14, yPos); yPos += 4; }\r\n  if (companyInfo.email) {\r\n    doc.setTextColor(0, 0, 255);\r\n    doc.textWithLink(companyInfo.email, 14, yPos, { url: `mailto:${companyInfo.email}` });\r\n    doc.setTextColor(0, 0, 0);\r\n    yPos += 4;\r\n  }\r\n  \r\n  // Document and Order numbers\r\n  yPos += 2;\r\n  doc.setFontSize(10);\r\n  doc.setFont(undefined, 'bold');\r\n  const docLabel = documentType === 'Quotation' ? 'QUOTE NO' : 'INVOICE NO';\r\n  doc.text(docLabel, 14, yPos);\r\n  doc.setFont(undefined, 'normal');\r\n  doc.text(invoiceNumber || ref || '001', 14 + 30, yPos);\r\n  \r\n  yPos += 5;\r\n  doc.setFont(undefined, 'bold');\r\n  doc.text('ORDER NO', 14, yPos);\r\n  doc.setFont(undefined, 'normal');\r\n  doc.text(orderNumber || '-', 14 + 30, yPos);\r\n  \r\n  yPos += 5;\r\n  doc.setFont(undefined, 'bold');\r\n  doc.text('ISSUE DATE', 14, yPos);\r\n  doc.setFont(undefined, 'normal');\r\n  doc.text(issueDate.toLocaleDateString('en-GB'), 14 + 30, yPos);\r\n  \r\n  if (dueDate && documentType === 'Invoice') {\r\n    yPos += 5;\r\n    doc.setFont(undefined, 'bold');\r\n    doc.text('DUE DATE', 14, yPos);\r\n    doc.setFont(undefined, 'normal');\r\n    doc.text(dueDate.toLocaleDateString('en-GB'), 14 + 30, yPos);\r\n  }\r\n  \r\n  // INVOICE TO / QUOTE FOR section\r\n  yPos += 8;\r\n  doc.setFontSize(11);\r\n  doc.setFont(undefined, 'bold');\r\n  const clientLabel = documentType === 'Quotation' ? 'QUOTE FOR' : 'INVOICE TO';\r\n  doc.text(clientLabel, 14, yPos);\r\n  doc.setFont(undefined, 'normal');\r\n  doc.setFontSize(9);\r\n  \r\n  yPos += 5;\r\n  doc.text(safeName, 14, yPos);\r\n  \r\n  if (clientAddress) {\r\n    yPos += 4;\r\n    const addressLines = doc.splitTextToSize(clientAddress, 90);\r\n    doc.text(addressLines, 14, yPos);\r\n    yPos += addressLines.length * 4;\r\n  }\r\n  \r\n  if (clientPhone) {\r\n    yPos += 4;\r\n    doc.text(`Phone: ${clientPhone}`, 14, yPos);\r\n  }\r\n  \r\n  if (clientEmail) {\r\n    yPos += 4;\r\n    doc.text(`Email: ${clientEmail}`, 14, yPos);\r\n  }\r\n  \r\n  if (clientVAT) {\r\n    yPos += 4;\r\n    doc.text(`VAT: ${clientVAT}`, 14, yPos);\r\n  }\r\n  \r\n  // Items table\r\n  const tableStartY = Math.max(yPos + 10, 110);\r\n  \r\n  const rows = filtered.map((item, idx) => {\r\n    const itemDesc = item.name + (item.description ? '\\n' + item.description : '');\r\n    return [\r\n      idx + 1,\r\n      itemDesc,\r\n      item.qty,\r\n      formatCurrency(item.unit, currency),\r\n      formatCurrency(item.unit * item.qty, currency)\r\n    ];\r\n  });\r\n\r\n  autoTable(doc, {\r\n    startY: tableStartY,\r\n    head: [['ITEM NUMBER', 'DESCRIPTION', 'QTY', 'UNIT PRICE', 'TOTAL PRICE']],\r\n    body: rows,\r\n    theme: 'grid',\r\n    margin: { left: 14, right: 14 }, // Consistent margins\r\n    headStyles: {\r\n      fillColor: [255, 255, 255],\r\n      textColor: [0, 0, 0],\r\n      fontSize: 9,\r\n      fontStyle: 'bold',\r\n      lineWidth: 0.5,\r\n      lineColor: [0, 0, 0]\r\n    },\r\n    bodyStyles: {\r\n      fontSize: 9,\r\n      lineWidth: 0.5,\r\n      lineColor: [0, 0, 0]\r\n    },\r\n    columnStyles: {\r\n      0: { cellWidth: 25, halign: 'center' },\r\n      1: { cellWidth: 'auto' },\r\n      2: { cellWidth: 20, halign: 'center' },\r\n      3: { cellWidth: 30, halign: 'right' },\r\n      4: { cellWidth: 30, halign: 'right' }\r\n    },\r\n    didDrawPage: (data) => {\r\n      // Add header on each new page\r\n      if (data.pageNumber > 1) {\r\n        addHeader();\r\n      }\r\n    }\r\n  });\r\n  \r\n  // Totals section (right-aligned)\r\n  let totalY = doc.lastAutoTable.finalY + 10;\r\n  const totalsX = pageWidth - 70;\r\n  \r\n  const subtotal = filtered.reduce((s, i) => s + (i.unit * i.qty), 0);\r\n  const vatAmount = (subtotal * taxRate) / 100;\r\n  const grandTotal = subtotal + vatAmount;\r\n  \r\n  doc.setFontSize(10);\r\n  doc.setFont(undefined, 'bold');\r\n  \r\n  // Cost price row\r\n  doc.text('COST PRICE', totalsX - 40, totalY);\r\n  doc.rect(totalsX, totalY - 4, 60, 7);\r\n  doc.text(formatCurrency(subtotal, currency), totalsX + 55, totalY, { align: 'right' });\r\n  \r\n  // VAT row\r\n  totalY += 7;\r\n  doc.text(`VAT (${taxRate}%)`, totalsX - 40, totalY);\r\n  doc.rect(totalsX, totalY - 4, 60, 7);\r\n  doc.text(formatCurrency(vatAmount, currency), totalsX + 55, totalY, { align: 'right' });\r\n  \r\n  // Total row\r\n  totalY += 7;\r\n  doc.text('TOTAL COST', totalsX - 40, totalY);\r\n  doc.rect(totalsX, totalY - 4, 60, 7);\r\n  doc.text(formatCurrency(grandTotal, currency), totalsX + 55, totalY, { align: 'right' });\r\n  \r\n  // Banking details section\r\n  totalY += 15;\r\n  doc.setFontSize(10);\r\n  doc.setFont(undefined, 'bold');\r\n  doc.text('BANKING DETAILS:', marginLeft, totalY);\r\n  doc.setFont(undefined, 'normal');\r\n  doc.setFontSize(9);\r\n  \r\n  totalY += 5;\r\n  doc.text(`Bank Name: ${banking.bankName}`, marginLeft, totalY);\r\n  totalY += 4;\r\n  doc.text(`Branch Name: ${banking.branchName}`, marginLeft, totalY);\r\n  totalY += 4;\r\n  doc.text(`Account Type: ${banking.accountType}`, marginLeft, totalY);\r\n  totalY += 4;\r\n  doc.text(`Account Number: ${banking.accountNumber}`, marginLeft, totalY);\r\n  totalY += 4;\r\n  doc.text(`Branch Code: ${banking.branchCode}`, marginLeft, totalY);\r\n  \r\n  // Terms and conditions\r\n  totalY += 10;\r\n  doc.setFontSize(10);\r\n  doc.setFont(undefined, 'bold');\r\n  doc.text('TERMS AND CONDITIONS:', marginLeft, totalY);\r\n  doc.setFont(undefined, 'normal');\r\n  doc.setFontSize(8);\r\n  \r\n  totalY += 5;\r\n  terms.forEach(term => {\r\n    const lines = doc.splitTextToSize(term, pageWidth - marginLeft - marginRight - 10);\r\n    doc.text(lines, marginLeft, totalY);\r\n    totalY += lines.length * 3.5;\r\n  });\r\n  \r\n  // Add footer to all pages\r\n  const pageCount = doc.internal.getNumberOfPages();\r\n  for (let i = 1; i <= pageCount; i++) {\r\n    doc.setPage(i);\r\n    addFooter();\r\n  }\r\n  \r\n  // Save the PDF\r\n  const filename = invoiceNumber ? `Invoice_${invoiceNumber}.pdf` : `${safeName.replace(/\\\\s+/g, '_')}_Quote.pdf`;\r\n  doc.save(filename);\r\n};\r\n\r\n// Export a quote as a data URI (async) suitable for emailing. Returns\r\n// a string like 'data:application/pdf;base64,...' or null on failure.\r\nexport async function exportQuotePdfData(a) {\r\n  try {\r\n    const [{ default: jsPDF }, { default: autoTable }] = await Promise.all([\r\n      import(\"jspdf\"),\r\n      import(\"jspdf-autotable\")\r\n    ]);\r\n    const doc = new jsPDF();\r\n    const structured = typeof a === 'object' && a && Array.isArray(a.items);\r\n\r\n    const safeName = (structured ? (a.clientName || 'Quote') : (a?.trim?.() || 'Quote'));\r\n    const items = structured ? (a.items || []) : (Array.isArray(a) ? a : []);\r\n    const currency = structured ? (a.currency || 'R') : 'R';\r\n    const taxRate = structured ? (typeof a.taxRate === 'number' ? a.taxRate : 0) : 0;\r\n  // notes variable referenced in generateQuotePdf; not required here\r\n    const paymentTerms = structured ? (a.paymentTerms || '') : '';\r\n\r\n    doc.setFontSize(18);\r\n    doc.text('CollEco Travel', 10, 18);\r\n    doc.setFontSize(9);\r\n    doc.text('hello@colleco.travel | +27 31 000 0000', 10, 24);\r\n    doc.text('www.colleco.travel', 10, 28);\r\n    doc.setFontSize(16);\r\n    doc.text('ðŸ§¾ Quotation', 150, 18, { align: 'right' });\r\n\r\n    doc.setFontSize(12);\r\n    doc.text(`Quote For: ${safeName}`, 10, 40);\r\n    if (structured && a.clientEmail) doc.text(`Email: ${a.clientEmail}`, 10, 46);\r\n    if (structured && a.clientPhone) doc.text(`Phone: ${a.clientPhone}`, 10, 52);\r\n\r\n    const normalized = items.map(it => ({\r\n      name: it.title || it.name || 'Item',\r\n      description: it.description || it.subtitle || '',\r\n      qty: (it.quantity !== undefined ? it.quantity : (it.qty !== undefined ? it.qty : 1)) || 1,\r\n      unit: Number(it.unitPrice ?? it.price ?? 0) || 0,\r\n    }));\r\n\r\n    const rows = normalized.map((item, idx) => [idx + 1, `${item.name}${item.description ? '\\n' + item.description : ''}`, item.qty, formatCurrency(item.unit, currency), formatCurrency(item.unit * item.qty, currency)]);\r\n\r\n    autoTable(doc, { startY: 60, head: [['#', 'Item', 'Qty', 'Unit', 'Total']], body: rows });\r\n\r\n    const subtotal = normalized.reduce((s, i) => s + (i.unit * i.qty), 0);\r\n    const tax = taxRate ? (subtotal * (taxRate / 100)) : 0;\r\n    const grandTotal = subtotal + tax;\r\n\r\n    let y = doc.lastAutoTable.finalY + 8;\r\n    doc.setFontSize(12);\r\n    doc.text(`Subtotal: ${formatCurrency(subtotal, currency)}`, 10, y); y += 6;\r\n    if (taxRate) { doc.text(`Tax (${taxRate.toFixed(2)}%): ${formatCurrency(tax, currency)}`, 10, y); y += 6; }\r\n    doc.setFontSize(13);\r\n    doc.text(`Grand Total: ${formatCurrency(grandTotal, currency)}`, 10, y); y += 8;\r\n\r\n    if (paymentTerms) {\r\n      const p = doc.splitTextToSize(`Payment Terms: ${paymentTerms}`, 190);\r\n      doc.setFontSize(10);\r\n      doc.text(p, 10, y);\r\n      y += p.length * 6;\r\n    }\r\n\r\n    // try add logo\r\n    try {\r\n      const dataUrl = await fetchImageDataUrl(LOGO_PATH);\r\n      if (dataUrl) {\r\n        try { doc.addImage(dataUrl, 'PNG', 150, 6, 36, 18); } catch (e) {}\r\n      }\r\n    } catch (e) {}\r\n\r\n    // return data URI\r\n    try {\r\n      const dataUri = doc.output('datauristring');\r\n      return dataUri;\r\n    } catch (e) {\r\n      // fallback to blob->base64\r\n      try {\r\n        const blob = doc.output('blob');\r\n        const arrayBuffer = await blob.arrayBuffer();\r\n        let binary = '';\r\n        const bytes = new Uint8Array(arrayBuffer);\r\n        const chunkSize = 0x8000;\r\n        for (let i = 0; i < bytes.length; i += chunkSize) {\r\n          binary += String.fromCharCode.apply(null, bytes.subarray(i, i + chunkSize));\r\n        }\r\n        const b64 = btoa(binary);\r\n        return 'data:application/pdf;base64,' + b64;\r\n      } catch (e2) {\r\n        return null;\r\n      }\r\n    }\r\n  } catch (e) {\r\n    return null;\r\n  }\r\n}\r\n\r\nexport const generateItineraryPdf = async (name, items, ref) => {\r\n  const [{ default: jsPDF }, { default: autoTable }] = await Promise.all([\r\n    import(\"jspdf\"),\r\n    import(\"jspdf-autotable\")\r\n  ]);\r\n  const doc = new jsPDF();\r\n  const safeName = name?.trim() || \"Itinerary\";\r\n  \r\n  // Get page dimensions\r\n  const pageWidth = doc.internal.pageSize.width || 210;\r\n  const marginRight = 14;\r\n  \r\n  // Try to load logo\r\n  const _logoDataUrl = await fetchImageDataUrl(LOGO_PATH);\r\n\r\n  // Header with CollEco branding\r\n  doc.setFontSize(20);\r\n  doc.setTextColor(244, 124, 32); // CollEco Orange\r\n  doc.text(COMPANY_INFO.name, 10, 18);\r\n  doc.setTextColor(0, 0, 0);\r\n  \r\n  doc.setFontSize(8);\r\n  doc.setFont(undefined, 'italic');\r\n  doc.text(COMPANY_INFO.tagline, 10, 23);\r\n  doc.setFont(undefined, 'normal');\r\n  \r\n  doc.setFontSize(9);\r\n  doc.text(`${COMPANY_INFO.email} | ${COMPANY_INFO.phone}`, 10, 28);\r\n  doc.text(COMPANY_INFO.website, 10, 32);\r\n  \r\n  // Add logo if available\r\n  if (_logoDataUrl) {\r\n    try {\r\n      const logoW = 40;\r\n      const logoH = 40;\r\n      const logoX = pageWidth - marginRight - logoW;\r\n      doc.addImage(_logoDataUrl, 'PNG', logoX, 6, logoW, logoH);\r\n    } catch (e) {\r\n      /* logo add failed */\r\n    }\r\n  }\r\n  \r\n  // Itinerary title\r\n  doc.setFontSize(18);\r\n  doc.setTextColor(244, 124, 32);\r\n  doc.text('TRAVEL ITINERARY', pageWidth - marginRight, 18, { align: 'right' });\r\n  doc.setTextColor(0, 0, 0);\r\n  \r\n  // Client info box\r\n  const clientBoxY = 45;\r\n  doc.setDrawColor(244, 124, 32);\r\n  doc.setLineWidth(0.5);\r\n  doc.rect(10, clientBoxY, 90, 20);\r\n  \r\n  doc.setFontSize(10);\r\n  doc.setFont(undefined, 'bold');\r\n  doc.text('TRAVELER:', 12, clientBoxY + 5);\r\n  doc.setFont(undefined, 'normal');\r\n  doc.setFontSize(11);\r\n  doc.text(safeName, 12, clientBoxY + 10);\r\n  if (ref) doc.text(`Reference: ${ref}`, 12, clientBoxY + 15);\r\n  \r\n  // Date and reference info (right side)\r\n  doc.setFontSize(10);\r\n  doc.text(`Date: ${new Date().toLocaleDateString()}`, pageWidth - marginRight, clientBoxY + 5, { align: 'right' });\r\n  \r\n  // Itinerary table\r\n  const rows = items.map((item, idx) => {\r\n    const dayInfo = item.day ? `Day ${item.day}` : '';\r\n    const timeInfo = item.startTime || item.time || '';\r\n    const location = item.location || item.destination || '';\r\n    \r\n    return [\r\n      idx + 1,\r\n      dayInfo,\r\n      timeInfo,\r\n      item.name || item.title || 'Activity',\r\n      location,\r\n      item.description || ''\r\n    ];\r\n  });\r\n\r\n  autoTable(doc, {\r\n    startY: clientBoxY + 25,\r\n    head: [[\"#\", \"Day\", \"Time\", \"Activity\", \"Location\", \"Details\"]],\r\n    body: rows,\r\n    headStyles: {\r\n      fillColor: [244, 124, 32], // CollEco Orange\r\n      textColor: [255, 255, 255],\r\n      fontSize: 10,\r\n      fontStyle: 'bold'\r\n    },\r\n    bodyStyles: {\r\n      fontSize: 9\r\n    },\r\n    alternateRowStyles: {\r\n      fillColor: [255, 248, 241] // Cream\r\n    },\r\n    columnStyles: {\r\n      0: { cellWidth: 8 },\r\n      1: { cellWidth: 15 },\r\n      2: { cellWidth: 20 },\r\n      3: { cellWidth: 40 },\r\n      4: { cellWidth: 30 },\r\n      5: { cellWidth: 'auto', cellPadding: 2 }\r\n    },\r\n    didParseCell: function (data) {\r\n      if (data.column.index === 5) {\r\n        data.cell.styles.cellWidth = \"wrap\";\r\n      }\r\n    },\r\n  });\r\n  \r\n  // Footer\r\n  let y = doc.lastAutoTable.finalY + 10;\r\n  doc.setDrawColor(230, 180, 34); // Gold\r\n  doc.setLineWidth(0.3);\r\n  doc.line(10, y, pageWidth - marginRight, y);\r\n  \r\n  y += 6;\r\n  doc.setFontSize(9);\r\n  doc.setFont(undefined, 'bold');\r\n  doc.text('IMPORTANT INFORMATION:', 10, y);\r\n  doc.setFont(undefined, 'normal');\r\n  y += 4;\r\n  doc.text('â€¢ Please arrive 15 minutes before scheduled activities', 10, y); y += 4;\r\n  doc.text('â€¢ Bring confirmation email and valid ID', 10, y); y += 4;\r\n  doc.text('â€¢ Contact us for any changes or assistance', 10, y); y += 6;\r\n  \r\n  doc.setFont(undefined, 'bold');\r\n  doc.text('CONTACT US:', 10, y);\r\n  doc.setFont(undefined, 'normal');\r\n  y += 4;\r\n  doc.text(`Email: ${COMPANY_INFO.email} | Phone: ${COMPANY_INFO.phone}`, 10, y);\r\n  \r\n  // Timestamp\r\n  y += 6;\r\n  doc.setFontSize(7);\r\n  doc.setTextColor(128, 128, 128);\r\n  doc.text(`Generated: ${new Date().toLocaleString()}`, 10, y);\r\n  doc.setTextColor(0, 0, 0);\r\n\r\n  doc.save(`${safeName.replace(/\\s+/g, \"_\")}_Itinerary.pdf`);\r\n};\r\n\r\n// Invoice PDF generator\r\n// Accepts either structured invoice object or (name, items, ref)\r\nexport const generateInvoicePdf = async (a, b, c) => {\r\n  const [{ default: jsPDF }, { default: autoTable }] = await Promise.all([\r\n    import(\"jspdf\"),\r\n    import(\"jspdf-autotable\")\r\n  ]);\r\n  const doc = new jsPDF();\r\n  const structured = typeof a === 'object' && a && Array.isArray(a.items);\r\n\r\n  let invoiceNum = '';\r\n  let safeName = 'Invoice';\r\n  let items = [];\r\n  let ref = c || '';\r\n  let currency = 'R';\r\n  let taxRate = 0;\r\n  let notes = '';\r\n  let dueDate;\r\n\r\n  if (structured) {\r\n    invoiceNum = a.invoiceNumber || a.number || '';\r\n    safeName = (a.clientName || 'Client').trim();\r\n    items = a.items || [];\r\n    ref = a.id || a.reference || ref;\r\n    currency = a.currency || currency;\r\n    taxRate = typeof a.taxRate === 'number' ? a.taxRate : 0;\r\n    notes = a.notes || '';\r\n    dueDate = a.dueDate;\r\n  } else {\r\n    safeName = (a?.trim?.() || 'Client');\r\n    items = b || [];\r\n    ref = c || '';\r\n  }\r\n\r\n  const normalized = items.map(it => ({\r\n    name: it.title || it.name || 'Item',\r\n    desc: it.description || it.subtitle || '',\r\n    qty: Number(it.quantity ?? it.qty ?? 1) || 1,\r\n    unit: Number(it.unitPrice ?? it.price ?? it.amount ?? 0) || 0,\r\n  }));\r\n\r\n  doc.setFontSize(20);\r\n  doc.text('ðŸ’³ CollEco Travel â€“ Invoice', 10, 18);\r\n  doc.setFontSize(12);\r\n  doc.text(`Invoice To: ${safeName}`, 10, 28);\r\n  if (invoiceNum) doc.text(`Invoice #: ${invoiceNum}`, 10, 34);\r\n  if (ref) doc.text(`Ref: ${ref}`, 10, 40);\r\n  if (dueDate) doc.text(`Due: ${new Date(dueDate).toLocaleDateString()}`, 10, 46);\r\n\r\n  const rows = normalized.map((it, idx) => [idx + 1, it.name, it.qty, formatCurrency(it.unit, currency), formatCurrency(it.unit * it.qty, currency)]);\r\n\r\n  autoTable(doc, {\r\n    startY: 54,\r\n    head: [['#', 'Item', 'Qty', 'Unit', 'Total']],\r\n    body: rows,\r\n  });\r\n\r\n  const subtotal = normalized.reduce((s, i) => s + (i.unit * i.qty), 0);\r\n  const tax = taxRate ? (subtotal * (taxRate / 100)) : 0;\r\n  const grandTotal = subtotal + tax;\r\n\r\n  let y = doc.lastAutoTable.finalY + 8;\r\n  doc.setFontSize(11);\r\n  doc.text(`Subtotal: ${formatCurrency(subtotal, currency)}`, 10, y); y += 6;\r\n  if (taxRate) { doc.text(`Tax (${taxRate.toFixed(2)}%): ${formatCurrency(tax, currency)}`, 10, y); y += 6; }\r\n  doc.setFontSize(13);\r\n  doc.text(`Amount Due: ${formatCurrency(grandTotal, currency)}`, 10, y); y += 8;\r\n\r\n  if (notes) {\r\n    const split = doc.splitTextToSize(`Notes: ${notes}`, 190);\r\n    doc.setFontSize(10);\r\n    doc.text(split, 10, y);\r\n  }\r\n\r\n  // Add logo (if available) and then save asynchronously\r\n  (async () => {\r\n    try {\r\n      const dataUrl = await fetchImageDataUrl(LOGO_PATH);\r\n      if (dataUrl) {\r\n        try { doc.addImage(dataUrl, 'PNG', 150, 6, 36, 18); } catch (e) { /* ignore */ }\r\n      }\r\n    } catch (e) {}\r\n    doc.save(`${(invoiceNum || safeName).toString().replace(/\\s+/g, '_')}_Invoice.pdf`);\r\n  })();\r\n};\r\n"],"file":"pdfGenerators-Dpk5CIWQ.js"}