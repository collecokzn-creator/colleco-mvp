{"version":3,"file":"quotes-Cs8OmkV4.js","sources":["../../src/api/quotes.js"],"sourcesContent":["// Lightweight quotes API client with graceful fallback to localStorage-backed hooks\r\nconst API_BASE = (typeof import.meta !== 'undefined' && import.meta.env && import.meta.env.VITE_API_BASE) ? import.meta.env.VITE_API_BASE : '/api';\r\n\r\nexport async function getQuotes() {\r\n  try {\r\n    const res = await fetch(`${API_BASE}/quotes`);\r\n    if (!res.ok) throw new Error('fetch_failed');\r\n    const j = await res.json();\r\n    return j.quotes || [];\r\n  } catch (e) {\r\n    // fallback: return empty to allow UI to use local state instead\r\n    return [];\r\n  }\r\n}\r\n\r\nexport async function createQuote(payload) {\r\n  try {\r\n    const res = await fetch(`${API_BASE}/quotes`, { method: 'POST', headers: { 'content-type': 'application/json' }, body: JSON.stringify(payload) });\r\n    const j = await res.json().catch(()=>null);\r\n    if (!res.ok) {\r\n      const err = new Error('create_failed'); err.status = res.status; err.body = j; throw err;\r\n    }\r\n    return j.quote || j || null;\r\n  } catch (e) {\r\n    // If validation error (body present), rethrow for caller to handle\r\n    if (e && e.body) throw e;\r\n    // fallback: return the payload with a temporary id on network error\r\n    const tmp = { ...payload, id: 'tmp_' + Math.random().toString(36).slice(2,8), createdAt: new Date().toISOString(), updatedAt: new Date().toISOString() };\r\n    return tmp;\r\n  }\r\n}\r\n\r\nexport async function deleteQuote(id) {\r\n  try {\r\n    const res = await fetch(`${API_BASE}/quotes/${id}`, { method: 'DELETE' });\r\n    if (!res.ok) throw new Error('delete_failed');\r\n    return true;\r\n  } catch (e) {\r\n    return false;\r\n  }\r\n}\r\n\r\nexport async function updateQuote(id, patch) {\r\n  try {\r\n    const res = await fetch(`${API_BASE}/quotes/${id}`, { method: 'PUT', headers: { 'content-type': 'application/json' }, body: JSON.stringify(patch) });\r\n    const j = await res.json().catch(()=>null);\r\n    if (!res.ok) { const err = new Error('update_failed'); err.status = res.status; err.body = j; throw err; }\r\n    return j.quote || null;\r\n  } catch (e) {\r\n    if (e && e.body) throw e;\r\n    return null;\r\n  }\r\n}\r\n\r\nexport async function patchQuote(id, patch) {\r\n  try {\r\n    const res = await fetch(`${API_BASE}/quotes/${id}`, { method: 'PATCH', headers: { 'content-type': 'application/json' }, body: JSON.stringify(patch) });\r\n    const j = await res.json().catch(()=>null);\r\n    if (!res.ok) { const err = new Error('patch_failed'); err.status = res.status; err.body = j; throw err; }\r\n    return j.quote || null;\r\n  } catch (e) {\r\n    if (e && e.body) throw e;\r\n    return null;\r\n  }\r\n}\r\n\r\nexport default { getQuotes, createQuote, deleteQuote, updateQuote, patchQuote };\r\n"],"names":[],"mappings":"AACA,MAAM,WAAsI;AAE5I,eAAsB,YAAY;AAChC,MAAI;AACF,UAAM,MAAM,MAAM,MAAM,GAAG,QAAQ,SAAS;AAC5C,QAAI,CAAC,IAAI,GAAI,OAAM,IAAI,MAAM,cAAc;AAC3C,UAAM,IAAI,MAAM,IAAI,KAAA;AACpB,WAAO,EAAE,UAAU,CAAA;AAAA,EACrB,SAAS,GAAG;AAEV,WAAO,CAAA;AAAA,EACT;AACF;AAEA,eAAsB,YAAY,SAAS;AACzC,MAAI;AACF,UAAM,MAAM,MAAM,MAAM,GAAG,QAAQ,WAAW,EAAE,QAAQ,QAAQ,SAAS,EAAE,gBAAgB,sBAAsB,MAAM,KAAK,UAAU,OAAO,GAAG;AAChJ,UAAM,IAAI,MAAM,IAAI,OAAO,MAAM,MAAI,IAAI;AACzC,QAAI,CAAC,IAAI,IAAI;AACX,YAAM,MAAM,IAAI,MAAM,eAAe;AAAG,UAAI,SAAS,IAAI;AAAQ,UAAI,OAAO;AAAG,YAAM;AAAA,IACvF;AACA,WAAO,EAAE,SAAS,KAAK;AAAA,EACzB,SAAS,GAAG;AAEV,QAAI,KAAK,EAAE,KAAM,OAAM;AAEvB,UAAM,MAAM,EAAE,GAAG,SAAS,IAAI,SAAS,KAAK,OAAA,EAAS,SAAS,EAAE,EAAE,MAAM,GAAE,CAAC,GAAG,YAAW,oBAAI,KAAA,GAAO,eAAe,YAAW,oBAAI,KAAA,GAAO,YAAA,EAAY;AACrJ,WAAO;AAAA,EACT;AACF;AAEA,eAAsB,YAAY,IAAI;AACpC,MAAI;AACF,UAAM,MAAM,MAAM,MAAM,GAAG,QAAQ,WAAW,EAAE,IAAI,EAAE,QAAQ,SAAA,CAAU;AACxE,QAAI,CAAC,IAAI,GAAI,OAAM,IAAI,MAAM,eAAe;AAC5C,WAAO;AAAA,EACT,SAAS,GAAG;AACV,WAAO;AAAA,EACT;AACF;AAEA,eAAsB,YAAY,IAAI,OAAO;AAC3C,MAAI;AACF,UAAM,MAAM,MAAM,MAAM,GAAG,QAAQ,WAAW,EAAE,IAAI,EAAE,QAAQ,OAAO,SAAS,EAAE,gBAAgB,mBAAA,GAAsB,MAAM,KAAK,UAAU,KAAK,GAAG;AACnJ,UAAM,IAAI,MAAM,IAAI,OAAO,MAAM,MAAI,IAAI;AACzC,QAAI,CAAC,IAAI,IAAI;AAAE,YAAM,MAAM,IAAI,MAAM,eAAe;AAAG,UAAI,SAAS,IAAI;AAAQ,UAAI,OAAO;AAAG,YAAM;AAAA,IAAK;AACzG,WAAO,EAAE,SAAS;AAAA,EACpB,SAAS,GAAG;AACV,QAAI,KAAK,EAAE,KAAM,OAAM;AACvB,WAAO;AAAA,EACT;AACF;"}