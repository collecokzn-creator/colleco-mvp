import{r as x}from"./index-E_l07fEO.js";import{E as dt}from"./jspdf.es.min-GZClMTNp.js";import{f as H}from"./currency-SRo7-frQ.js";const O="quotes:v1",Y=()=>"q_"+Math.random().toString(36).slice(2,10),$=()=>"qi_"+Math.random().toString(36).slice(2,10);function ee(){const[e,t]=x.useState(()=>{try{const f=localStorage.getItem(O);return f?JSON.parse(f):[]}catch{return[]}});x.useEffect(()=>{try{localStorage.setItem(O,JSON.stringify(e))}catch{}},[e]);const r=x.useCallback((f={})=>{const u={id:Y(),clientName:f.clientName||"",clientEmail:f.clientEmail||"",quoteNumber:f.quoteNumber||(()=>{const d=new Date().getFullYear(),p=Math.floor(Math.random()*9e3)+1e3;return`Q-${d}-${p}`})(),dueDate:f.dueDate||"",currency:f.currency||"USD",items:[],taxRate:f.taxRate||0,discountRate:f.discountRate||0,notes:f.notes||"",status:"Draft",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return t(g=>[...g,u]),u.id},[]),n=x.useCallback((f,u)=>{t(g=>g.map(d=>d.id===f?{...d,...u,updatedAt:new Date().toISOString()}:d))},[]),i=x.useCallback(f=>{t(u=>u.filter(g=>g.id!==f))},[]);x.useCallback(f=>{t(u=>{const g=u.find(p=>p.id===f);if(!g)return u;const d={...g,id:Y(),status:"Draft",createdAt:new Date().toISOString(),updatedAt:new Date().toISOString(),items:g.items.map(p=>({...p,id:$()}))};return[...u,d]})},[]);const a=x.useCallback((f,u)=>{t(g=>g.map(d=>{if(d.id!==f)return d;const p={id:$(),title:"",unitPrice:0,quantity:1,...u};return{...d,items:[...d.items,p],updatedAt:new Date().toISOString()}}))},[]),s=x.useCallback((f,u,g)=>{t(d=>d.map(p=>p.id!==f?p:{...p,items:p.items.map(y=>y.id===u?{...y,...g}:y),updatedAt:new Date().toISOString()}))},[]),h=x.useCallback((f,u)=>{t(g=>g.map(d=>d.id===f?{...d,items:d.items.filter(p=>p.id!==u),updatedAt:new Date().toISOString()}:d))},[]),l=x.useCallback(f=>{if(!f)return{subtotal:0,discount:0,tax:0,total:0};const u=(f.items||[]).reduce((w,S)=>w+Number(S.unitPrice||0)*Number(S.quantity||1),0),g=Math.max(0,Math.min(100,Number(f.discountRate||0))),d=g?u*(g/100):0,p=u-d,y=Math.max(0,Number(f.taxRate||0)),v=y?p*(y/100):0,m=p+v;return{subtotal:p,discount:d,tax:v,total:m}},[]),o=x.useCallback((f,u)=>{["Draft","Sent","Accepted","Declined"].includes(u)&&n(f,{status:u})},[n]);return{quotes:e,createQuote:r,updateQuote:n,deleteQuote:i,addItem:a,updateItem:s,removeItem:h,computeTotals:l,setStatus:o}}function X(e,t,r,n,i){n=n||{};var a=1.15,s=i.internal.scaleFactor,h=i.internal.getFontSize()/s,l=i.getLineHeightFactor?i.getLineHeightFactor():a,o=h*l,f=/\r\n|\r|\n/g,u="",g=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(u=typeof e=="string"?e.split(f):e,g=u.length||1),r+=h*(2-a),n.valign==="middle"?r-=g/2*o:n.valign==="bottom"&&(r-=g*o),n.halign==="center"||n.halign==="right"){var d=h;if(n.halign==="center"&&(d*=.5),u&&g>=1){for(var p=0;p<u.length;p++)i.text(u[p],t-i.getStringUnitWidth(u[p])*d,r),r+=o;return i}t-=i.getStringUnitWidth(e)*d}return n.halign==="justify"?i.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):i.text(e,t,r),i}var Q={},F=(function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:Q=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,i,a;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var s=this.jsPDFDocument.internal.getFont(),h=s.fontStyle,l=s.fontName;if(t.font&&(l=t.font),t.fontStyle){h=t.fontStyle;var o=this.getFontList()[l];o&&o.indexOf(h)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(o[0]),h=o[0])}if(this.jsPDFDocument.setFont(l,h),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var f=e.unifyColor(t.fillColor);f&&(n=this.jsPDFDocument).setFillColor.apply(n,f),f=e.unifyColor(t.textColor),f&&(i=this.jsPDFDocument).setTextColor.apply(i,f),f=e.unifyColor(t.lineColor),f&&(a=this.jsPDFDocument).setDrawColor.apply(a,f),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,i,a){return this.jsPDFDocument.rect(t,r,n,i,a)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return Q||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e})(),M=function(e,t){return M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},M(e,t)};function Z(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");M(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var V=(function(e){Z(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t})(Array);function pt(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function vt(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function T(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],i=n.map(function(a){return r.getTextWidth(a)}).reduce(function(a,s){return Math.max(a,s)},0);return i}function tt(e,t,r,n){var i=t.settings.tableLineWidth,a=t.settings.tableLineColor;e.applyStyles({lineWidth:i,lineColor:a});var s=et(i,!1);s&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,s)}function et(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function z(e,t){var r,n,i,a;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(i=e.right)!==null&&i!==void 0?i:t,bottom:(a=e.bottom)!==null&&a!==void 0?a:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function nt(e,t){var r=z(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function yt(e,t,r,n,i){var a={},s=1.3333333333333333,h=j(t,function(S){return i.getComputedStyle(S).backgroundColor});h!=null&&(a.fillColor=h);var l=j(t,function(S){return i.getComputedStyle(S).color});l!=null&&(a.textColor=l);var o=mt(n,r);o&&(a.cellPadding=o);var f="borderTopColor",u=s*r,g=n.borderTopWidth;if(n.borderBottomWidth===g&&n.borderRightWidth===g&&n.borderLeftWidth===g){var d=(parseFloat(g)||0)/u;d&&(a.lineWidth=d)}else a.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/u,right:(parseFloat(n.borderRightWidth)||0)/u,bottom:(parseFloat(n.borderBottomWidth)||0)/u,left:(parseFloat(n.borderLeftWidth)||0)/u},a.lineWidth.top||(a.lineWidth.right?f="borderRightColor":a.lineWidth.bottom?f="borderBottomColor":a.lineWidth.left&&(f="borderLeftColor"));var p=j(t,function(S){return i.getComputedStyle(S)[f]});p!=null&&(a.lineColor=p);var y=["left","right","center","justify"];y.indexOf(n.textAlign)!==-1&&(a.halign=n.textAlign),y=["middle","bottom","top"],y.indexOf(n.verticalAlign)!==-1&&(a.valign=n.verticalAlign);var v=parseInt(n.fontSize||"");isNaN(v)||(a.fontSize=v/s);var m=ct(n);m&&(a.fontStyle=m);var w=(n.fontFamily||"").toLowerCase();return e.indexOf(w)!==-1&&(a.font=w),a}function ct(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function j(e,t){var r=rt(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var i=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],a=parseInt(n[4]);return a===0||isNaN(i[0])||isNaN(i[1])||isNaN(i[2])?null:i}function rt(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:rt(e.parentElement,t):r}function mt(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),i=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,a=r.map(function(h){return parseInt(h||"0")/n}),s=z(a,0);return i>s.top&&(s.top=i),i>s.bottom&&(s.bottom=i),s}function it(e,t,r,n,i){var a,s;n===void 0&&(n=!1),i===void 0&&(i=!1);var h;typeof t=="string"?h=r.document.querySelector(t):h=t;var l=Object.keys(e.getFontList()),o=e.scaleFactor(),f=[],u=[],g=[];if(!h)return console.error("Html table could not be found with input: ",t),{head:f,body:u,foot:g};for(var d=0;d<h.rows.length;d++){var p=h.rows[d],y=(s=(a=p?.parentElement)===null||a===void 0?void 0:a.tagName)===null||s===void 0?void 0:s.toLowerCase(),v=St(l,o,r,p,n,i);v&&(y==="thead"?f.push(v):y==="tfoot"?g.push(v):u.push(v))}return{head:f,body:u,foot:g}}function St(e,t,r,n,i,a){for(var s=new V(n),h=0;h<n.cells.length;h++){var l=n.cells[h],o=r.getComputedStyle(l);if(i||o.display!=="none"){var f=void 0;a&&(f=yt(e,l,t,o,r)),s.push({rowSpan:l.rowSpan,colSpan:l.colSpan,styles:f,_element:l,content:wt(l)})}}var u=r.getComputedStyle(n);if(s.length>0&&(i||u.display!=="none"))return s}function wt(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function xt(e,t,r){for(var n=0,i=[e,t,r];n<i.length;n++){var a=i[n];a&&typeof a!="object"&&console.error("The options parameter should be of type object, is: "+typeof a),a.startY&&typeof a.startY!="number"&&(console.error("Invalid value for startY option",a.startY),delete a.startY)}}function P(e,t,r,n,i){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(e),s=1;s<arguments.length;s++){var h=arguments[s];if(h!=null)for(var l in h)Object.prototype.hasOwnProperty.call(h,l)&&(a[l]=h[l])}return a}function at(e,t){var r=new F(e),n=r.getDocumentOptions(),i=r.getGlobalOptions();xt(i,n,t);var a=P({},i,n,t),s;typeof window<"u"&&(s=window);var h=Ct(i,n,t),l=Pt(i,n,t),o=Dt(r,a),f=Ft(r,a,s);return{id:t.tableId,content:f,hooks:l,styles:h,settings:o}}function Ct(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},i=function(l){if(l==="columnStyles"){var o=e[l],f=t[l],u=r[l];n.columnStyles=P({},o,f,u)}else{var g=[e,t,r],d=g.map(function(p){return p[l]||{}});n[l]=P({},d[0],d[1],d[2])}},a=0,s=Object.keys(n);a<s.length;a++){var h=s[a];i(h)}return n}function Pt(e,t,r){for(var n=[e,t,r],i={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,s=n;a<s.length;a++){var h=s[a];h.didParseCell&&i.didParseCell.push(h.didParseCell),h.willDrawCell&&i.willDrawCell.push(h.willDrawCell),h.didDrawCell&&i.didDrawCell.push(h.didDrawCell),h.willDrawPage&&i.willDrawPage.push(h.willDrawPage),h.didDrawPage&&i.didDrawPage.push(h.didDrawPage)}return i}function Dt(e,t){var r,n,i,a,s,h,l,o,f,u,g,d,p=z(t.margin,40/e.scaleFactor()),y=(r=bt(e,t.startY))!==null&&r!==void 0?r:p.top,v;t.showFoot===!0?v="everyPage":t.showFoot===!1?v="never":v=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var m;t.showHead===!0?m="everyPage":t.showHead===!1?m="never":m=(i=t.showHead)!==null&&i!==void 0?i:"everyPage";var w=(a=t.useCss)!==null&&a!==void 0?a:!1,S=t.theme||(w?"plain":"striped"),C=!!t.horizontalPageBreak,k=(s=t.horizontalPageBreakRepeat)!==null&&s!==void 0?s:null;return{includeHiddenHtml:(h=t.includeHiddenHtml)!==null&&h!==void 0?h:!1,useCss:w,theme:S,startY:y,margin:p,pageBreak:(l=t.pageBreak)!==null&&l!==void 0?l:"auto",rowPageBreak:(o=t.rowPageBreak)!==null&&o!==void 0?o:"auto",tableWidth:(f=t.tableWidth)!==null&&f!==void 0?f:"auto",showHead:m,showFoot:v,tableLineWidth:(u=t.tableLineWidth)!==null&&u!==void 0?u:0,tableLineColor:(g=t.tableLineColor)!==null&&g!==void 0?g:200,horizontalPageBreak:C,horizontalPageBreakRepeat:k,horizontalPageBreakBehaviour:(d=t.horizontalPageBreakBehaviour)!==null&&d!==void 0?d:"afterAllRows"}}function bt(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),i=e.pageNumber(),a=!1;if(r&&r.startPageNumber){var s=r.startPageNumber+r.pageNumber-1;a=s===i}return typeof t=="number"?t:(t==null||t===!1)&&a&&r?.finalY!=null?r.finalY+20/n:null}function Ft(e,t,r){var n=t.head||[],i=t.body||[],a=t.foot||[];if(t.html){var s=t.includeHiddenHtml;if(r){var h=it(e,t.html,r,s,t.useCss)||{};n=h.head||n,i=h.body||n,a=h.foot||n}else console.error("Cannot parse html in non browser environment")}var l=t.columns||Ht(n,i,a);return{columns:l,head:n,body:i,foot:a}}function Ht(e,t,r){var n=e[0]||t[0]||r[0]||[],i=[];return Object.keys(n).filter(function(a){return a!=="_element"}).forEach(function(a){var s=1,h;Array.isArray(n)?h=n[parseInt(a)]:h=n[a],typeof h=="object"&&!Array.isArray(h)&&(s=h?.colSpan||1);for(var l=0;l<s;l++){var o=void 0;Array.isArray(n)?o=i.length:o=a+(l>0?"_".concat(l):"");var f={dataKey:o};i.push(f)}}),i}var N=(function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e})(),Wt=(function(e){Z(t,e);function t(r,n,i,a,s,h){var l=e.call(this,r,n,h)||this;return l.cell=i,l.row=a,l.column=s,l.section=a.section,l}return t})(N),kt=(function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,i,a,s){for(var h=0,l=r;h<l.length;h++){var o=l[h],f=new Wt(t,this,n,i,a,s),u=o(f)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],u)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,i=this.hooks.didDrawPage;n<i.length;n++){var a=i[n];a(new N(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,i=this.hooks.willDrawPage;n<i.length;n++){var a=i[n];a(new N(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(i,a){return i+a.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e})(),ot=(function(){function e(t,r,n,i,a){a===void 0&&(a=!1),this.height=0,this.raw=t,t instanceof V&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=i,this.spansMultiplePages=a}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,i){var a;return Math.max(n,((a=r.cells[i.index])===null||a===void 0?void 0:a.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var i=r.cells[n.index];return i?i.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(i,a){var s=n.cells[a.index];if(!s)return 0;var h=r.getLineHeight(s.styles.fontSize),l=s.padding("vertical"),o=l+h;return o>i?o:i},0)},e})(),st=(function(){function e(t,r,n){var i;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var a=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,a=(i=t.content)!==null&&i!==void 0?i:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var s=a!=null?""+a:"",h=/\r\n|\r|\n/g;this.text=s.split(h)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var i=this.width-this.padding("horizontal");n=this.x+i/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,i=this.styles.fontSize/t*r,a=n*i+this.padding("vertical");return Math.max(a,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=z(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e})(),Rt=(function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,i=t.allRows();n<i.length;n++){var a=i[n],s=a.cells[this.index];s&&typeof s.styles.cellWidth=="number"&&(r=Math.max(r,s.styles.cellWidth))}return r},e})();function Tt(e,t){At(e,t);var r=[],n=0;t.columns.forEach(function(a){var s=a.getMaxCustomCellWidth(t);s?a.width=s:(a.width=a.wrappedWidth,r.push(a)),n+=a.width});var i=t.getWidth(e.pageSize().width)-n;i&&(i=I(r,i,function(a){return Math.max(a.minReadableWidth,a.minWidth)})),i&&(i=I(r,i,function(a){return a.minWidth})),i=Math.abs(i),!t.settings.horizontalPageBreak&&i>.1/e.scaleFactor()&&(i=i<1?i:Math.round(i),console.warn("Of the table content, ".concat(i," units width could not fit page"))),jt(t),Bt(t,e),zt(t)}function At(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,i=nt(e,t);t.allRows().forEach(function(a){for(var s=0,h=t.columns;s<h.length;s++){var l=h[s],o=a.cells[l.index];if(o){var f=t.hooks.didParseCell;t.callCellHooks(e,f,o,a,l,null);var u=o.padding("horizontal");o.contentWidth=T(o.text,o.styles,e)+u;var g=T(o.text.join(" ").split(/[^\S\u00A0]+/),o.styles,e);if(o.minReadableWidth=g+o.padding("horizontal"),typeof o.styles.cellWidth=="number")o.minWidth=o.styles.cellWidth,o.wrappedWidth=o.styles.cellWidth;else if(o.styles.cellWidth==="wrap"||n===!0)o.contentWidth>i?(o.minWidth=i,o.wrappedWidth=i):(o.minWidth=o.contentWidth,o.wrappedWidth=o.contentWidth);else{var d=10/r;o.minWidth=o.styles.minCellWidth||d,o.wrappedWidth=o.contentWidth,o.minWidth>o.wrappedWidth&&(o.wrappedWidth=o.minWidth)}}}}),t.allRows().forEach(function(a){for(var s=0,h=t.columns;s<h.length;s++){var l=h[s],o=a.cells[l.index];if(o&&o.colSpan===1)l.wrappedWidth=Math.max(l.wrappedWidth,o.wrappedWidth),l.minWidth=Math.max(l.minWidth,o.minWidth),l.minReadableWidth=Math.max(l.minReadableWidth,o.minReadableWidth);else{var f=t.styles.columnStyles[l.dataKey]||t.styles.columnStyles[l.index]||{},u=f.cellWidth||f.minCellWidth;u&&typeof u=="number"&&(l.minWidth=u,l.wrappedWidth=u)}o&&(o.colSpan>1&&!l.minWidth&&(l.minWidth=o.minWidth),o.colSpan>1&&!l.wrappedWidth&&(l.wrappedWidth=o.minWidth))}})}function I(e,t,r){for(var n=t,i=e.reduce(function(d,p){return d+p.wrappedWidth},0),a=0;a<e.length;a++){var s=e[a],h=s.wrappedWidth/i,l=n*h,o=s.width+l,f=r(s),u=o<f?f:o;t-=u-s.width,s.width=u}if(t=Math.round(t*1e10)/1e10,t){var g=e.filter(function(d){return t<0?d.width>r(d):!0});g.length&&(t=I(g,t,r))}return t}function zt(e){for(var t={},r=1,n=e.allRows(),i=0;i<n.length;i++)for(var a=n[i],s=0,h=e.columns;s<h.length;s++){var l=h[s],o=t[l.index];if(r>1)r--,delete a.cells[l.index];else if(o)o.cell.height+=a.height,r=o.cell.colSpan,delete a.cells[l.index],o.left--,o.left<=1&&delete t[l.index];else{var f=a.cells[l.index];if(!f)continue;if(f.height=a.height,f.rowSpan>1){var u=n.length-i,g=f.rowSpan>u?u:f.rowSpan;t[l.index]={cell:f,left:g,row:a}}}}}function jt(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],i=null,a=0,s=0,h=0;h<e.columns.length;h++){var l=e.columns[h];if(s-=1,s>1&&e.columns[h+1])a+=l.width,delete n.cells[l.index];else if(i){var o=i;delete n.cells[l.index],i=null,o.width=l.width+a}else{var o=n.cells[l.index];if(!o)continue;if(s=o.colSpan,a=0,o.colSpan>1){i=o,a+=l.width;continue}o.width=l.width+a}}}function Bt(e,t){for(var r={count:0,height:0},n=0,i=e.allRows();n<i.length;n++){for(var a=i[n],s=0,h=e.columns;s<h.length;s++){var l=h[s],o=a.cells[l.index];if(o){t.applyStyles(o.styles,!0);var f=o.width-o.padding("horizontal");if(o.styles.overflow==="linebreak")o.text=t.splitTextToSize(o.text,f+1/t.scaleFactor(),{fontSize:o.styles.fontSize});else if(o.styles.overflow==="ellipsize")o.text=K(o.text,f,o.styles,t,"...");else if(o.styles.overflow==="hidden")o.text=K(o.text,f,o.styles,t,"");else if(typeof o.styles.overflow=="function"){var u=o.styles.overflow(o.text,f);typeof u=="string"?o.text=[u]:o.text=u}o.contentHeight=o.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var g=o.contentHeight/o.rowSpan;o.rowSpan>1&&r.count*r.height<g*o.rowSpan?r={height:g,count:o.rowSpan}:r&&r.count>0&&r.height>g&&(g=r.height),g>a.height&&(a.height=g)}}r.count--}}function K(e,t,r,n,i){return e.map(function(a){return Et(a,t,r,n,i)})}function Et(e,t,r,n,i){var a=1e4*n.scaleFactor();if(t=Math.ceil(t*a)/a,t>=T(e,r,n))return e;for(;t<T(e+i,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+i}function ft(e,t){var r=new F(e),n=Lt(t,r.scaleFactor()),i=new kt(t,n);return Tt(r,i),r.applyStyles(r.userStyles),i}function Lt(e,t){var r=e.content,n=Nt(r.columns);if(r.head.length===0){var i=_(n,"head");i&&r.head.push(i)}if(r.foot.length===0){var i=_(n,"foot");i&&r.foot.push(i)}var a=e.settings.theme,s=e.styles;return{columns:n,head:B("head",r.head,n,s,a,t),body:B("body",r.body,n,s,a,t),foot:B("foot",r.foot,n,s,a,t)}}function B(e,t,r,n,i,a){var s={},h=t.map(function(l,o){for(var f=0,u={},g=0,d=0,p=0,y=r;p<y.length;p++){var v=y[p];if(s[v.index]==null||s[v.index].left===0)if(d===0){var m=void 0;Array.isArray(l)?m=l[v.index-g-f]:m=l[v.dataKey];var w={};typeof m=="object"&&!Array.isArray(m)&&(w=m?.styles||{});var S=It(e,v,o,i,n,a,w),C=new st(m,S,e);u[v.dataKey]=C,u[v.index]=C,d=C.colSpan-1,s[v.index]={left:C.rowSpan-1,times:d}}else d--,g++;else s[v.index].left--,d=s[v.index].times,f++}return new ot(l,o,e,u)});return h}function _(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var i=Mt(t,n.raw);i!=null&&(r[n.dataKey]=i)}}),Object.keys(r).length>0?r:null}function Mt(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function Nt(e){return e.map(function(t,r){var n,i;return typeof t=="object"?i=(n=t.dataKey)!==null&&n!==void 0?n:r:i=r,new Rt(i,t,r)})}function It(e,t,r,n,i,a,s){var h=vt(n),l;e==="head"?l=i.headStyles:e==="body"?l=i.bodyStyles:e==="foot"&&(l=i.footStyles);var o=P({},h.table,h[e],i.styles,l),f=i.columnStyles[t.dataKey]||i.columnStyles[t.index]||{},u=e==="body"?f:{},g=e==="body"&&r%2===0?P({},h.alternateRow,i.alternateRowStyles):{},d=pt(a),p=P({},d,o,g,u);return P(p,s)}function Ot(e,t,r){var n;r===void 0&&(r={});var i=nt(e,t),a=new Map,s=[],h=[],l=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?l=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(l=[t.settings.horizontalPageBreakRepeat]),l.forEach(function(g){var d=t.columns.find(function(p){return p.dataKey===g||p.index===g});d&&!a.has(d.index)&&(a.set(d.index,!0),s.push(d.index),h.push(t.columns[d.index]),i-=d.wrappedWidth)});for(var o=!0,f=(n=r?.start)!==null&&n!==void 0?n:0;f<t.columns.length;){if(a.has(f)){f++;continue}var u=t.columns[f].wrappedWidth;if(o||i>=u)o=!1,s.push(f),h.push(t.columns[f]),i-=u;else break;f++}return{colIndexes:s,columns:h,lastIndex:f-1}}function Yt(e,t){for(var r=[],n=0;n<t.columns.length;n++){var i=Ot(e,t,{start:n});i.columns.length&&(r.push(i),n=i.lastIndex)}return r}function ht(e,t){var r=t.settings,n=r.startY,i=r.margin,a={x:i.left,y:n},s=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),h=n+i.bottom+s;if(r.pageBreak==="avoid"){var l=t.body,o=l.reduce(function(g,d){return g+d.height},0);h+=o}var f=new F(e);(r.pageBreak==="always"||r.startY!=null&&h>f.pageSize().height)&&(ut(f),a.y=i.top),t.callWillDrawPageHooks(f,a);var u=P({},a);t.startPageNumber=f.pageNumber(),r.horizontalPageBreak?$t(f,t,u,a):(f.applyStyles(f.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(g){return D(f,t,g,a,t.columns)}),f.applyStyles(f.userStyles),t.body.forEach(function(g,d){var p=d===t.body.length-1;A(f,t,g,p,u,a,t.columns)}),f.applyStyles(f.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(g){return D(f,t,g,a,t.columns)})),tt(f,t,u,a),t.callEndPageHooks(f,a),t.finalY=a.y,e.lastAutoTable=t,f.applyStyles(f.userStyles)}function $t(e,t,r,n){var i=Yt(e,t),a=t.settings;if(a.horizontalPageBreakBehaviour==="afterAllRows")i.forEach(function(o,f){e.applyStyles(e.userStyles),f>0?W(e,t,r,n,o.columns,!0):U(e,t,n,o.columns),Qt(e,t,r,n,o.columns),E(e,t,n,o.columns)});else for(var s=-1,h=i[0],l=function(){var o=s;if(h){e.applyStyles(e.userStyles);var f=h.columns;s>=0?W(e,t,r,n,f,!0):U(e,t,n,f),o=q(e,t,s+1,n,f),E(e,t,n,f)}var u=o-s;i.slice(1).forEach(function(g){e.applyStyles(e.userStyles),W(e,t,r,n,g.columns,!0),q(e,t,s+1,n,g.columns,u),E(e,t,n,g.columns)}),s=o};s<t.body.length-1;)l()}function U(e,t,r,n){var i=t.settings;e.applyStyles(e.userStyles),(i.showHead==="firstPage"||i.showHead==="everyPage")&&t.head.forEach(function(a){return D(e,t,a,r,n)})}function Qt(e,t,r,n,i){e.applyStyles(e.userStyles),t.body.forEach(function(a,s){var h=s===t.body.length-1;A(e,t,a,h,r,n,i)})}function q(e,t,r,n,i,a){e.applyStyles(e.userStyles),a=a??t.body.length;var s=Math.min(r+a,t.body.length),h=-1;return t.body.slice(r,s).forEach(function(l,o){var f=r+o===t.body.length-1,u=lt(e,t,f,n);l.canEntireRowFit(u,i)&&(D(e,t,l,n,i),h=r+o)}),h}function E(e,t,r,n){var i=t.settings;e.applyStyles(e.userStyles),(i.showFoot==="lastPage"||i.showFoot==="everyPage")&&t.foot.forEach(function(a){return D(e,t,a,r,n)})}function Kt(e,t,r){var n=r.getLineHeight(e.styles.fontSize),i=e.padding("vertical"),a=Math.floor((t-i)/n);return Math.max(0,a)}function _t(e,t,r,n){var i={};e.spansMultiplePages=!0,e.height=0;for(var a=0,s=0,h=r.columns;s<h.length;s++){var l=h[s],o=e.cells[l.index];if(o){Array.isArray(o.text)||(o.text=[o.text]);var f=new st(o.raw,o.styles,o.section);f=P(f,o),f.text=[];var u=Kt(o,t,n);o.text.length>u&&(f.text=o.text.splice(u,o.text.length));var g=n.scaleFactor(),d=n.getLineHeightFactor();o.contentHeight=o.getContentHeight(g,d),o.contentHeight>=t&&(o.contentHeight=t,f.styles.minCellHeight-=t),o.contentHeight>e.height&&(e.height=o.contentHeight),f.contentHeight=f.getContentHeight(g,d),f.contentHeight>a&&(a=f.contentHeight),i[l.index]=f}}var p=new ot(e.raw,-1,e.section,i,!0);p.height=a;for(var y=0,v=r.columns;y<v.length;y++){var l=v[y],f=p.cells[l.index];f&&(f.height=p.height);var o=e.cells[l.index];o&&(o.height=e.height)}return p}function Ut(e,t,r,n){var i=e.pageSize().height,a=n.settings.margin,s=a.top+a.bottom,h=i-s;t.section==="body"&&(h-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var l=t.getMinimumRowHeight(n.columns,e),o=l<r;if(l>h)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!o)return!1;var f=t.hasRowSpan(n.columns),u=t.getMaxCellHeight(n.columns)>h;return u?(f&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(f||n.settings.rowPageBreak==="avoid")}function A(e,t,r,n,i,a,s){var h=lt(e,t,n,a);if(r.canEntireRowFit(h,s))D(e,t,r,a,s);else if(Ut(e,r,h,t)){var l=_t(r,h,t,e);D(e,t,r,a,s),W(e,t,i,a,s),A(e,t,l,n,i,a,s)}else W(e,t,i,a,s),A(e,t,r,n,i,a,s)}function D(e,t,r,n,i){n.x=t.settings.margin.left;for(var a=0,s=i;a<s.length;a++){var h=s[a],l=r.cells[h.index];if(!l){n.x+=h.width;continue}e.applyStyles(l.styles),l.x=n.x,l.y=n.y;var o=t.callCellHooks(e,t.hooks.willDrawCell,l,r,h,n);if(o===!1){n.x+=h.width;continue}qt(e,l,n);var f=l.getTextPos();X(l.text,f.x,f.y,{halign:l.styles.halign,valign:l.styles.valign,maxWidth:Math.ceil(l.width-l.padding("left")-l.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,l,r,h,n),n.x+=h.width}n.y+=r.height}function qt(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var i=et(n.lineWidth,n.fillColor);i&&e.rect(t.x,r.y,t.width,t.height,i)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),Jt(e,t,r,n.lineWidth))}function Jt(e,t,r,n){var i,a,s,h;n.top&&(i=r.x,a=r.y,s=r.x+t.width,h=r.y,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),l(n.top,i,a,s,h)),n.bottom&&(i=r.x,a=r.y+t.height,s=r.x+t.width,h=r.y+t.height,n.right&&(s+=.5*n.right),n.left&&(i-=.5*n.left),l(n.bottom,i,a,s,h)),n.left&&(i=r.x,a=r.y,s=r.x,h=r.y+t.height,n.top&&(a-=.5*n.top),n.bottom&&(h+=.5*n.bottom),l(n.left,i,a,s,h)),n.right&&(i=r.x+t.width,a=r.y,s=r.x+t.width,h=r.y+t.height,n.top&&(a-=.5*n.top),n.bottom&&(h+=.5*n.bottom),l(n.right,i,a,s,h));function l(o,f,u,g,d){e.getDocument().setLineWidth(o),e.getDocument().line(f,u,g,d,"S")}}function lt(e,t,r,n){var i=t.settings.margin.bottom,a=t.settings.showFoot;return(a==="everyPage"||a==="lastPage"&&r)&&(i+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-i}function W(e,t,r,n,i,a){i===void 0&&(i=[]),a===void 0&&(a=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!a&&t.foot.forEach(function(h){return D(e,t,h,n,i)}),t.callEndPageHooks(e,n);var s=t.settings.margin;tt(e,t,r,n),ut(e),t.pageNumber++,n.x=s.left,n.y=s.top,r.y=s.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(h){return D(e,t,h,n,i)}),e.applyStyles(e.userStyles))}function ut(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function Gt(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],i=at(this,n),a=ft(this,i);return ht(this,a),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,i){X(t,r,n,i,this)},e.API.autoTableSetDefaults=function(t){return F.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){F.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var i=new F(this),a=it(i,t,window,r,!1),s=a.head,h=a.body,l=((n=s[0])===null||n===void 0?void 0:n.map(function(o){return o.content}))||[];return{columns:l,rows:h,data:h}}}var L;function Xt(e,t){var r=at(e,t),n=ft(e,r);ht(e,n)}try{if(typeof window<"u"&&window){var J=window,G=J.jsPDF||((L=J.jspdf)===null||L===void 0?void 0:L.jsPDF);G&&Gt(G)}}catch(e){console.error("Could not apply autoTable plugin",e)}const ne=(e,t,r,n)=>{const i=new dt,a=typeof e=="object"&&e&&Array.isArray(e.items)&&(e.currency||e.taxRate!==void 0);let s,h,l,o,f="R",u=0,g="Draft",d="",p,y;a?(s=(e.clientName||"Quote").trim(),h=e.items||[],l=e.id||e.reference||"",o=!0,f=e.currency||f,u=typeof e.taxRate=="number"?e.taxRate:0,g=e.status||g,d=e.notes||"",p=e.createdAt,y=e.updatedAt):(s=e?.trim?.()||"Quote",h=[],l=r,o=n);const v=h.map(c=>({name:c.title||c.name||"Item",description:c.description||c.subtitle||"",qty:(c.quantity!==void 0?c.quantity:c.qty!==void 0?c.qty:1)||1,unit:(c.unitPrice!==void 0?c.unitPrice:c.price!==void 0?c.price:0)||0,category:c.category||""})),m=o?v:v.filter(c=>c.unit);if(i.setFontSize(20),i.text("ðŸ§¾ CollEco Travel â€“ Quotation",10,18),i.setFontSize(12),i.text(`Quote For: ${s}`,10,28),l&&i.text(`Reference: ${l}`,10,34),a&&(i.text(`Status: ${g}`,10,40),d)){const c=i.splitTextToSize(`Notes: ${d}`,190);i.text(c,10,46)}let w=48;a&&d&&(w=46+i.splitTextToSize(`Notes: ${d}`,190).length*6+4);const S=m.map((c,R)=>[R+1,c.name,c.qty,H(c.unit,f),H(c.unit*c.qty,f)]);Xt(i,{startY:w,head:[["#","Item","Qty","Unit Price","Total"]],body:S});const C=m.reduce((c,R)=>c+R.unit*R.qty,0),k=u?C*(u/100):0,gt=C+k;let b=i.lastAutoTable.finalY+8;i.setFontSize(12),i.text(`Subtotal: ${H(C,f)}`,10,b),b+=6,u&&(i.text(`Tax (${u.toFixed(2)}%): ${H(k,f)}`,10,b),b+=6),i.setFontSize(13),i.text(`Grand Total: ${H(gt,f)}`,10,b),b+=8,a&&(p&&(i.setFontSize(8),i.text(`Created: ${new Date(p).toLocaleString()}`,10,b)),y&&(i.setFontSize(8),i.text(`Updated: ${new Date(y).toLocaleString()}`,10,b+4))),i.save(`${s.replace(/\s+/g,"_")}_Quote.pdf`)};export{ne as g,ee as u};
