# Security Reports

This directory contains audit reports generated by security scanning scripts.

## Contents

- `audit-report-*.json` - Google Cloud audit log analysis results
- `audit-report-*.csv` - CSV format exports for spreadsheet analysis

## Scripts

### Google Cloud Audit Log Review

```bash
# Check last 24 hours
npm run security:audit:gcloud

# Check specific time range
npm run security:audit:gcloud -- --start="2025-12-04T09:00:00Z" --end="2025-12-04T12:00:00Z"

# Check specific API key
npm run security:audit:gcloud -- --api-key="AIzaSy..." --format="csv"
```

## Report Structure

### JSON Format

```json
{
  "metadata": {
    "startTime": "ISO 8601 timestamp",
    "endTime": "ISO 8601 timestamp",
    "apiKey": "Partial key (first 10 chars)",
    "projectId": "GCP project ID",
    "generatedAt": "Report generation timestamp"
  },
  "summary": {
    "totalRequests": 247,
    "uniqueIPs": 12,
    "suspiciousActivity": 0,
    "geographicAnomalies": 0,
    "rateLimitHits": 0
  },
  "analysis": {
    "findings": [
      {
        "severity": "HIGH|MEDIUM|LOW",
        "type": "Finding category",
        "description": "Human-readable description",
        "details": "Additional context"
      }
    ],
    "recommendations": ["Action item 1", "Action item 2"]
  },
  "entries": [
    {
      "timestamp": "ISO 8601",
      "severity": "INFO|WARNING|ERROR",
      "resource": {
        "type": "maps_api",
        "labels": {
          "api_key": "Partial key",
          "api_method": "API endpoint"
        }
      },
      "httpRequest": {
        "requestUrl": "Full URL",
        "remoteIp": "Source IP",
        "userAgent": "Client identifier",
        "status": 200
      }
    }
  ]
}
```

### CSV Format

```csv
Timestamp,Severity,API Method,Remote IP,Status,Suspicious
2025-12-04T09:30:15.234Z,WARNING,maps.googleapis.com/maps/api/js,203.0.113.42,200,false
```

## Retention Policy

- **Keep**: All HIGH severity findings indefinitely
- **Archive**: MEDIUM/LOW findings after 90 days
- **Delete**: INFO entries after 30 days

Archived reports are moved to `security-reports/archive/YYYY-MM/`

## .gitignore

This directory is **gitignored** to prevent sensitive audit data from being committed.

```
security-reports/
!security-reports/.gitkeep
```

Only this `.gitkeep` file is tracked in version control.

## Compliance

For SOC 2 / ISO 27001 compliance:
- Export reports monthly
- Store securely (encrypted at rest)
- Access logs required for audits
- Retain for minimum 7 years

## Contact

Security Team: security@colleco.travel  
Incident Response: See `SECURITY_INCIDENT.md`
